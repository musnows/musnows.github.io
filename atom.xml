<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>æ…•é›ªçš„å¯’èˆ</title>
  
  <subtitle>é›ªä¸‹äº†ä¸€å¤œ</subtitle>
  <link href="https://blog.musnow.top/atom.xml" rel="self"/>
  
  <link href="https://blog.musnow.top/"/>
  <updated>2023-12-09T12:12:55.000Z</updated>
  <id>https://blog.musnow.top/</id>
  
  <author>
    <name>æ…•é›ªå¹´å</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>ã€Nginxã€‘nginxé€šè¿‡é…ç½®æ–‡ä»¶é˜»æ­¢æµ·å¤–ipè®¿é—®</title>
    <link href="https://blog.musnow.top/posts/2029711168/"/>
    <id>https://blog.musnow.top/posts/2029711168/</id>
    <published>2023-12-09T08:12:55.000Z</published>
    <updated>2023-12-09T12:12:55.000Z</updated>
    
    <content type="html"><![CDATA[<p>nginxé€šè¿‡é…ç½®æ–‡ä»¶é˜»æ­¢æµ·å¤–ipè®¿é—®</p><h1 id="è¯´æ˜"><a href="#è¯´æ˜" class="headerlink" title="è¯´æ˜"></a>è¯´æ˜</h1><p>å› ä¸ºæœ€è¿‘å‘ç°æœ‰ä¸å°‘åˆ·è¯„è®ºçš„è„šæœ¬ï¼Œåœ¨nginxè¯·æ±‚æ—¥å¿—é‡Œé¢çœ‹äº†çœ¼ï¼Œéƒ½æ˜¯æµ·å¤–çš„ipï¼Œåæ­£æˆ‘çš„åšå®¢ä¹Ÿæ˜¯å…¨ä¸­æ–‡ã€‚æ‰€ä»¥å¹²è„†æŠŠæµ·å¤–ipç¦æ­¢artalkè¯„è®ºã€‚</p><p>åœ¨<code>/etc/nginx/nginx.conf</code>ä¸­å¯ä»¥çœ‹åˆ°é»˜è®¤çš„æ—¥å¿—è·¯å¾„ï¼Œåœ¨é‡Œé¢èƒ½æ‰¾åˆ°æ¯ä¸€ä¸ªè½¬å‘çš„è¯·æ±‚å’Œå…¶æºIPã€‚å…¶ä¸­artakæ–°å¢è¯„è®ºçš„è¯·æ±‚æ˜¯<code>/api/add</code>è·¯å¾„</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">access_log  /var/log/nginx/access.log  main;</span><br></pre></td></tr></table></figure><p>è€ƒè™‘åˆ°æ·»åŠ æµ·å¤–ipå±è”½å¯èƒ½ä¼šé˜»æ­¢ä¸€äº›çœŸçš„åœ¨å›½å¤–çš„æœ‹å‹ï¼Œå¦‚æœä½ åœ¨é˜…è¯»æœ¬ç«™åšå®¢æ—¶ï¼Œé‡åˆ°ç›¸å…³é—®é¢˜æ— æ³•ç›´æ¥è¯„è®ºä¸æˆ‘äº¤æµï¼Œå¯ä»¥ç§»æ­¥githubéšä¾¿æ‰¾ä¸ªæˆ‘çš„ä»“åº“å¼€ä¸ªissueæé—®ï¼</p><h1 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h1><h2 id="APNICä»‹ç»"><a href="#APNICä»‹ç»" class="headerlink" title="APNICä»‹ç»"></a>APNICä»‹ç»</h2><p>åæ–‡å‡ºç°çš„ç½‘ç«™æ˜¯æ¥è‡ª<strong>APNIC</strong> (Asia Pacific Network Information Center)ï¼Œå…¶æ˜¯IPåœ°å€ç®¡ç†æœºæ„ä¹‹ä¸€ï¼Œè´Ÿè´£äºšæ´²ã€å¤ªå¹³æ´‹åœ°åŒºã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">APNICæä¾›äº†æ¯æ—¥æ›´æ–°çš„äºšå¤ªåœ°åŒºIPv4ï¼ŒIPv6ï¼ŒASå·åˆ†é…çš„ä¿¡æ¯è¡¨ï¼š</span><br><span class="line">http://ftp.apnic.net/apnic/stats/apnic/delegated-apnic-latest</span><br><span class="line">è¯¥æ–‡ä»¶çš„æ ¼å¼ä¸å…·ä½“å†…å®¹å‚è§ï¼š</span><br><span class="line">http://ftp.apnic.net/pub/apnic/stats/apnic/README.TXT</span><br></pre></td></tr></table></figure><h2 id="è„šæœ¬è·å–ip"><a href="#è„šæœ¬è·å–ip" class="headerlink" title="è„šæœ¬è·å–ip"></a>è„šæœ¬è·å–ip</h2><p>åˆæ­¥è§£å†³æ–¹æ³•å‚è€ƒï¼š<a href="https://www.cnblogs.com/guoyabin/p/14263732.html">https://www.cnblogs.com/guoyabin/p/14263732.html</a></p><p>åŸåšä¸»æä¾›çš„è„šæœ¬å¦‚ä¸‹ï¼Œå¯ä»¥ä¸‹è½½æ‰€æœ‰æµ·å¤–ipåˆ—è¡¨å¹¶ç”Ÿæˆä¸€ä¸ªnginxé…ç½®ï¼Œå†™å…¥<code>/etc/nginx/blackip.conf</code>ä¸­</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">rm</span> -f legacy-apnic-latest black_`<span class="built_in">date</span> +%F`.conf &amp;&amp; wget http://ftp.apnic.net/apnic/stats/apnic/legacy-apnic-latest</span><br><span class="line"></span><br><span class="line">awk -F <span class="string">&#x27;|&#x27;</span> <span class="string">&#x27;&#123;if(NR&gt;2)printf(&quot;%s %s/%d%s\n&quot;,&quot;deny&quot;,$4,24,&quot;;&quot;)&#125;&#x27;</span> legacy-apnic-latest &gt; black_`<span class="built_in">date</span> +%F`.conf &amp;&amp; \</span><br><span class="line"><span class="built_in">rm</span> -f /etc/nginx/blackip.conf &amp;&amp; \</span><br><span class="line"><span class="built_in">ln</span> -s <span class="variable">$PWD</span>/black_`<span class="built_in">date</span> +%F`.conf /etc/nginx/blackip.conf </span><br></pre></td></tr></table></figure><p>è„šæœ¬æ‰§è¡Œåçš„æ•ˆæœå¦‚ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@bt-7274:/etc/nginx]# ll</span><br><span class="line">total 88</span><br><span class="line">lrwxrwxrwx 1 root root   34 Dec  9 16:03 blackip.conf -&gt; /root/docker/black_2023-12-09.conf</span><br></pre></td></tr></table></figure><p>æ–‡ä»¶å†…å®¹å¦‚ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@bt-7274:/etc/nginx/conf.d]# cat ../blackip.conf</span><br><span class="line">deny 128.134.0.0/24;</span><br><span class="line">deny 128.184.0.0/24;</span><br><span class="line">deny 128.250.0.0/24;</span><br><span class="line">deny 129.60.0.0/24;</span><br><span class="line">deny 129.78.0.0/24;</span><br><span class="line">...åé¢çš„çœç•¥äº†</span><br></pre></td></tr></table></figure><h2 id="nginxå±è”½æµ·å¤–ip"><a href="#nginxå±è”½æµ·å¤–ip" class="headerlink" title="nginxå±è”½æµ·å¤–ip"></a>nginxå±è”½æµ·å¤–ip</h2><p>å‚è€ƒåŸåšä¸»çš„åšæ³•ï¼Œä½ å¯ä»¥å°†è¿™ä¸ª<code>blackip.conf</code>åœ¨<code>/etc/nginx/nginx.conf</code>ä¸­çš„<strong>httpæ¨¡å—</strong>é‡Œé¢includeï¼Œè¿™æ ·ä¼šé˜»æ­¢å½“å‰æœåŠ¡å™¨æ‰€æœ‰åä»£çš„æµ·å¤–çš„è¯·æ±‚ã€‚</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">include</span> /etc/nginx/blackip.conf;</span><br></pre></td></tr></table></figure><p>è¿˜å¯ä»¥åœ¨å•ä¸ªé…ç½®æ–‡ä»¶çš„<a href="https://zinglix.xyz/2021/10/04/nginx-ssl-reject-handshake/">locationé‡Œé¢å¼•ç”¨</a></p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">  <span class="section">location</span> / &#123;</span><br><span class="line">      <span class="attribute">proxy_redirect</span> <span class="literal">off</span>; <span class="comment"># artalkçš„nginxé…ç½®ä¸­å¿…é¡»æœ‰è¿™ä¸ª</span></span><br><span class="line">      <span class="attribute">proxy_set_header</span> X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line">      <span class="attribute">proxy_set_header</span> X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">      <span class="attribute">proxy_set_header</span> Host <span class="variable">$host</span>;</span><br><span class="line">      <span class="attribute">proxy_set_header</span> Upgrade-Insecure-Requests <span class="number">1</span>;</span><br><span class="line">      <span class="attribute">proxy_set_header</span> X-Forwarded-Proto https;</span><br><span class="line"></span><br><span class="line">      <span class="attribute">include</span> /etc/nginx/blackip.conf; <span class="comment"># å¼•ç”¨é…ç½®</span></span><br><span class="line"></span><br><span class="line">      <span class="attribute">proxy_pass</span> http://127.0.0.1:14722;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹åé‡å¯nginxï¼Œæ²¡æœ‰æŠ¥é”™å°±æ˜¯okäº†</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart nginx</span><br></pre></td></tr></table></figure><p>ç”¨æµ·å¤–çš„æœåŠ¡å™¨è¯•è¯•èƒ½ä¸èƒ½è¯·æ±‚artalkï¼Œç”¨<a href="https://artk.musnow.top/sidebar/#/login">artk.musnow.top&#x2F;sidebar&#x2F;â€¦</a>è¿™ä¸ªç®¡ç†å‘˜ç™»å½•é¡µé¢æ¥è¿›è¡Œæµ‹è¯•ã€‚</p><p>å›½å†…æœåŠ¡å™¨è¯·æ±‚ç»“æœå¦‚ä¸‹ï¼Œå’Œæµè§ˆå™¨æ‰“å¼€çš„ç»“æœåŸºæœ¬æ˜¯ä¸€æ ·ï¼ˆç®¡ç†å‘˜ç™»å½•ç•Œé¢ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@bt-7274:/etc/nginx/conf.d]# curl https://artk.musnow.top/sidebar/#/login</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot; /&gt;</span><br><span class="line">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt;</span><br><span class="line">    &lt;title&gt;Artalk Sidebar&lt;/title&gt;</span><br><span class="line">    &lt;script type=&quot;module&quot; crossorigin src=&quot;./assets/index-5a0b3a93.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;link rel=&quot;stylesheet&quot; href=&quot;./assets/index-84fdcf98.css&quot;&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">    &lt;div id=&quot;app&quot;&gt;&lt;/div&gt;</span><br><span class="line">  </span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>æµ·å¤–æœåŠ¡å™¨è¯·æ±‚ç»“æœä¹Ÿæ˜¯ä¸Šé¢è¿™æ ·â€¦â€¦ç„¶åå‘ç°æ˜¯å› ä¸ºæˆ‘çš„æµ·å¤–æœåŠ¡å™¨ipå‹æ ¹ä¸åœ¨é‚£ä¸ªblackçš„denyåˆ—è¡¨é‡Œé¢</p><p>å°è¯•æŠŠipçš„ç½‘æ®µç»™åŠ è¿›å»ï¼Œé‡å¯nginxå†è¯•è¯•ã€‚<strong>å®Œç¾å¤„ç†</strong>ï¼æ·»åŠ å‰èƒ½æ­£å¸¸è¯·æ±‚åˆ°ï¼Œæ·»åŠ åå°±å˜æˆ403äº†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">[root@RainYun-8aNbbsmA:~]# curl https://artk.musnow.top/sidebar/#/login</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot; /&gt;</span><br><span class="line">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt;</span><br><span class="line">    &lt;title&gt;Artalk Sidebar&lt;/title&gt;</span><br><span class="line">    &lt;script type=&quot;module&quot; crossorigin src=&quot;./assets/index-5a0b3a93.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;link rel=&quot;stylesheet&quot; href=&quot;./assets/index-84fdcf98.css&quot;&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">    &lt;div id=&quot;app&quot;&gt;&lt;/div&gt;</span><br><span class="line">    </span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">[root@RainYun-8aNbbsmA:~]# </span><br><span class="line">[root@RainYun-8aNbbsmA:~]# curl https://artk.musnow.top/sidebar/#/login</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;&lt;title&gt;403 Forbidden&lt;/title&gt;&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;center&gt;&lt;h1&gt;403 Forbidden&lt;/h1&gt;&lt;/center&gt;</span><br><span class="line">&lt;hr&gt;&lt;center&gt;nginx/1.20.1&lt;/center&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">[root@RainYun-8aNbbsmA:~]# </span><br></pre></td></tr></table></figure><h2 id="nginxå±è”½éå›½å†…ip"><a href="#nginxå±è”½éå›½å†…ip" class="headerlink" title="nginxå±è”½éå›½å†…ip"></a>nginxå±è”½éå›½å†…ip</h2><p>æˆ‘å‰æ–‡æåˆ°äº†æˆ‘çš„æµ·å¤–æœåŠ¡å™¨çš„ipä¸åœ¨è¿™ä¸ªdenyçš„ipåˆ—è¡¨é‡Œé¢ï¼Œæ²¡æœ‰è¢«å±è”½ã€‚</p><p>è€ƒè™‘åˆ°ç½‘ä¸Šæœä¸åˆ°<code>legacy-apnic-latest</code>æ–‡ä»¶å­˜æ”¾çš„æ˜¯ä»€ä¹ˆipçš„ä¿¡æ¯ï¼Œæˆ‘å†³å®šæ¢ä¸€ä¸ªæ€è·¯ï¼šallowå›½å†…çš„ipï¼Œæ‹’ç»æ‰€æœ‰éå›½å†…çš„ip</p><blockquote><p>è·å–å›½å†…ipåˆ—è¡¨ <a href="https://www.cnblogs.com/sentangle/p/13201770.html">https://www.cnblogs.com/sentangle/p/13201770.html</a></p></blockquote><p>ä¸‹é¢è¿™ä¸ªurlé‡Œé¢çš„ipåœ°å€æ ‡æ˜äº†åœ°åŒºï¼Œæˆ‘ä»¬åªéœ€è¦å°†å…¶æå–å‡ºæ¥å³å¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://ftp.apnic.net/apnic/stats/apnic/delegated-apnic-latest</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ–‡ä»¶é‡Œé¢çš„å†…å®¹ç»“æ„å¦‚ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç­‰çº§æœºæ„|è·å¾—è¯¥IPæ®µçš„å›½å®¶/ç»„ç»‡|èµ„æºç±»å‹|èµ·å§‹IP|IPæ®µé•¿åº¦|åˆ†é…æ—¥æœŸ|åˆ†é…çŠ¶æ€</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬åªéœ€è¦æå–CNçš„æ‰€æœ‰IPï¼Œç„¶åå…è®¸ä»–ä»¬ï¼Œå†<code>deny all</code>é˜»æ­¢å…¶ä»–ipå°±å¯ä»¥äº†</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">rm</span> -f delegated-apnic-latest blackcn_`<span class="built_in">date</span> +%F`.conf &amp;&amp; wget http://ftp.apnic.net/apnic/stats/apnic/delegated-apnic-latest</span><br><span class="line"></span><br><span class="line">awk -F\| <span class="string">&#x27;/CN\|ipv4/ &#123; printf(&quot;%s %s/%d%s\n&quot;,&quot;allow&quot;,$4, 32-log($5)/log(2), &quot;;&quot;) &#125;&#x27;</span> delegated-apnic-latest &gt; blackcn_`<span class="built_in">date</span> +%F`.conf &amp;&amp; \</span><br><span class="line"><span class="built_in">rm</span> -f /etc/nginx/blackcn.conf &amp;&amp; \</span><br><span class="line"><span class="built_in">ln</span> -s <span class="variable">$PWD</span>/blackcn_`<span class="built_in">date</span> +%F`.conf /etc/nginx/blackcn.conf</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œè¿™ä¸ªè„šæœ¬åï¼Œä¼šç”Ÿæˆ<code>/etc/nginx/blackcn.conf</code>æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@bt-7274:/etc/nginx]# ll</span><br><span class="line">total 88</span><br><span class="line">lrwxrwxrwx 1 root root   42 Dec  9 16:54 blackcn.conf -&gt; /root/docker/nginx/blackcn_2023-12-09.conf</span><br><span class="line">lrwxrwxrwx 1 root root   40 Dec  9 16:56 blackip.conf -&gt; /root/docker/nginx/black_2023-12-09.conf</span><br></pre></td></tr></table></figure><p>å†…å®¹å¦‚ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">allow 223.248.0.0/14;</span><br><span class="line">allow 223.252.128.0/17;</span><br><span class="line">allow 223.254.0.0/16;</span><br><span class="line">allow 223.255.0.0/17;</span><br><span class="line">allow 223.255.236.0/22;</span><br><span class="line">allow 223.255.252.0/23;</span><br><span class="line">....</span><br></pre></td></tr></table></figure><p>è¿˜æ˜¯ä¿®æ”¹nginxå•ä¸ªç«™ç‚¹é…ç½®æ–‡ä»¶çš„locationä¸­çš„å†…å®¹</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">  <span class="section">location</span> / &#123;</span><br><span class="line">      <span class="attribute">proxy_redirect</span> <span class="literal">off</span>;</span><br><span class="line">  <span class="attribute">proxy_set_header</span> X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line">      <span class="attribute">proxy_set_header</span> X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">      <span class="attribute">proxy_set_header</span> Host <span class="variable">$host</span>;</span><br><span class="line">      <span class="attribute">proxy_set_header</span> Upgrade-Insecure-Requests <span class="number">1</span>;</span><br><span class="line">      <span class="attribute">proxy_set_header</span> X-Forwarded-Proto https;</span><br><span class="line"><span class="comment"># å…è®¸æ‰€æœ‰å›½å†…ip</span></span><br><span class="line">  <span class="attribute">include</span> /etc/nginx/blackcn.conf;</span><br><span class="line">  <span class="attribute">deny</span> all; <span class="comment"># é˜»æ­¢å…¶ä»–ip</span></span><br><span class="line"></span><br><span class="line">  <span class="attribute">proxy_pass</span> http://127.0.0.1:14722;</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure><p>å…ˆæ¥è¯•è¯•ä¸ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼ˆä¸åšä»»ä½•denyå’Œallowæ“ä½œçš„æƒ…å†µä¸‹ï¼‰æµ·å¤–ipè¯·æ±‚ç»“æœ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@RainYun-8aNbbsmA:~]# curl https://artk.musnow.top/sidebar/#/login</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot; /&gt;</span><br><span class="line">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt;</span><br><span class="line">    &lt;title&gt;Artalk Sidebar&lt;/title&gt;</span><br><span class="line">    &lt;script type=&quot;module&quot; crossorigin src=&quot;./assets/index-5a0b3a93.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;link rel=&quot;stylesheet&quot; href=&quot;./assets/index-84fdcf98.css&quot;&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">    &lt;div id=&quot;app&quot;&gt;&lt;/div&gt;</span><br><span class="line">    </span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>ç¬¦åˆé¢„æœŸï¼Œæ­£å¸¸è¯·æ±‚å‡ºäº†ç™»å½•é¡µé¢çš„htmlæ–‡ä»¶ã€‚</p><p>æ·»åŠ å¦‚ä¸Šä¿®æ”¹åï¼Œé‡å¯nginxï¼Œå†æ¬¡è¿›è¡Œæµ‹è¯•ã€‚è¿™ä¸€æ¬¡å·²ç»403é˜»æ­¢äº†ï¼Œå®Œç¾ï¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@RainYun-8aNbbsmA:~]# curl https://artk.musnow.top/sidebar/#/login</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;&lt;title&gt;403 Forbidden&lt;/title&gt;&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;center&gt;&lt;h1&gt;403 Forbidden&lt;/h1&gt;&lt;/center&gt;</span><br><span class="line">&lt;hr&gt;&lt;center&gt;nginx/1.20.1&lt;/center&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h1 id="The-end"><a href="#The-end" class="headerlink" title="The end"></a>The end</h1><p>ä½ å¯ä»¥å†™ä¸ªcrontabè®©å…¶å®šæ—¶æ‰§è¡Œè„šæœ¬å¹¶é‡å¯nginxï¼Œæˆ‘ä¸ªäººè¿˜æ˜¯é€‰æ‹©äººå·¥å¤„ç†äº†ï¼ˆä»€ä¹ˆæ—¶å€™æƒ³èµ·æ¥å°±å»æ›´æ–°ä¸€ä¸‹ipåˆ—è¡¨ï¼‰</p><p>æ„Ÿè°¢æœ¬æ–‡ä¸­å‡ºç°çš„åšå®¢çš„åšä¸»ã€‚æ²¡æœ‰ä»–ä»¬çš„å¸®åŠ©ï¼Œæˆ‘æ— æ³•ç¼–å†™å‡ºshellè„šæœ¬ã€‚</p>]]></content>
    
    
    <summary type="html">nginxé€šè¿‡é…ç½®æ–‡ä»¶é˜»æ­¢æµ·å¤–ipè®¿é—®</summary>
    
    
    
    <category term="ç©ä¸ŠLinux" scheme="https://blog.musnow.top/categories/%E7%8E%A9%E4%B8%8ALinux/"/>
    
    
    <category term="Linux" scheme="https://blog.musnow.top/tags/Linux/"/>
    
    <category term="Nginx" scheme="https://blog.musnow.top/tags/Nginx/"/>
    
  </entry>
  
  <entry>
    <title>ã€å›¾åºŠã€‘åˆ é™¤å¯¹è±¡å­˜å‚¨æ¡¶å‰ä¸€å®šè¦æ£€æŸ¥ï¼</title>
    <link href="https://blog.musnow.top/posts/3595872827/"/>
    <id>https://blog.musnow.top/posts/3595872827/</id>
    <published>2023-12-09T02:32:14.000Z</published>
    <updated>2023-12-09T02:32:14.000Z</updated>
    
    <content type="html"><![CDATA[<p>æˆ‘åˆå¹²è ¢äº‹äº†ï¼è™½ç„¶æ²¡æœ‰å¾ˆå¤§å½±å“ï¼Œä½†æ˜¯è¿™ç§é—®é¢˜è¿˜æ˜¯ä¸è¦å‘ç”Ÿçš„å¥½ã€‚</p><h2 id="ä»€ä¹ˆæƒ…å†µï¼Ÿ"><a href="#ä»€ä¹ˆæƒ…å†µï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæƒ…å†µï¼Ÿ"></a>ä»€ä¹ˆæƒ…å†µï¼Ÿ</h2><p>æˆ‘åœ¨åšå®¢å°šæœ‰å¼•ç”¨æŸä¸ªå¯¹è±¡å­˜å‚¨bucketä¸­å›¾ç‰‡çš„æƒ…å†µä¸‹ï¼Œåˆ é™¤äº†é‚£ä¸ªbucketï¼ˆå› ä¸ºè¿™ä¸ªbucketå¾ˆä¹…æ²¡æœ‰ç”¨ï¼Œç®—æ˜¯å¼ƒç”¨çš„ï¼‰</p><p>è¿˜å¥½ä»Šå¤©çœ‹æ—§ç¬”è®°çš„æ—¶å€™ï¼Œçªç„¶å‘ç°äº†è¿™ä¸ªé—®é¢˜ï¼Œç«‹é©¬å»é‡æ–°æœç´¢äº†ä¸€ä¸‹è¿™ä¸ªæ—§bucketçš„å›¾ç‰‡é“¾æ¥ï¼Œè¿˜å¥½è¿˜å¥½ï¼Œå—å½±å“çš„åªæœ‰ä¸¤ç¯‡æ–‡ç« </p><ul><li>ä¸€ç¯‡ä¹‹å‰å¯¼å‡ºè¿‡PDFï¼Œå›¾ç‰‡è¿˜èƒ½æ‰¾åˆ°</li><li>å¦å¤–ä¸€ç¯‡æ–‡ç« ä»¥æ–‡å­—ä¸ºä¸»ï¼Œå†…éƒ¨ä¸¢å¤±çš„å›¾ç‰‡å¯æœ‰å¯æ— </li></ul><p>æˆ‘æ¢å¤äº†ç¬¬ä¸€ç¯‡é‡Œé¢çš„å›¾ç‰‡ï¼Œç„¶åä¿®æ”¹äº†ç¬¬äºŒç¯‡ä¸­å’Œå›¾ç‰‡ç›¸å…³çš„æ–‡å­—è¯´æ˜ï¼Œç®—æ˜¯è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚</p><p>åˆé‡å†™æ£€æŸ¥äº†ä¸€ä¸‹ç¬”è®°ç›®å½•ï¼Œç®—æ˜¯å½»åº•æ²¡æœ‰è¿™ä¸ªè¢«æˆ‘åˆ é™¤çš„bucketé‡Œé¢çš„å›¾ç‰‡äº†ã€‚</p><p>è¿™ä¸€æ¬¡è¿˜å¥½ï¼Œç®—æ˜¯æ²¡æœ‰ä¸¢ä¸œè¥¿ï¼Œä¸ç„¶æ•°æ®ä¸å¤‡ä»½å°±åˆ é™¤çš„ç¬‘æ–™åˆè¦å¤šä¸€ä¸ªäº†â€¦â€¦ğŸ¤£</p><h2 id="ä»¥æ­¤ä¸ºæˆ’"><a href="#ä»¥æ­¤ä¸ºæˆ’" class="headerlink" title="ä»¥æ­¤ä¸ºæˆ’"></a>ä»¥æ­¤ä¸ºæˆ’</h2><p>åˆ é™¤bucketä¹‹å‰ä¸€å®šè¦æ£€æŸ¥è‡ªå·±åˆ°åº•è¿˜æœ‰æ²¡æœ‰ä½¿ç”¨è¿™ä¸ªbucketä¸­çš„æ–‡ä»¶æˆ–è€…å›¾ç‰‡ï¼</p><p>åˆ é™¤å›¾åºŠæœ¬åœ°ç›®å½•å‰ï¼Œä¸€å®šè¦æ£€æŸ¥è‡ªå·±è¿˜æœ‰æ²¡æœ‰è¿™ä¸ªæœ¬åœ°ç›®å½•é‡Œé¢çš„å›¾ç‰‡ï¼</p><p>æœ€ä½³æ–¹æ¡ˆï¼šä¸è¦ç®¡é‚£ä¸ªbucketï¼Œå°†å…¶è®¿é—®æƒé™æ”¹æˆ<strong>ç§æœ‰</strong>åï¼Œä½¿ç”¨å¤‡æ³¨åŠŸèƒ½å°†å…¶æ ‡è®°ä¸ºå¼ƒç”¨ã€‚ä»¥åä¸å†ä½¿ç”¨è¯¥bucketå³å¯ã€‚</p><p>å› ä¸ºå¯¹äºæˆ‘ä¸ªäººä½¿ç”¨æ¥è¯´ï¼Œä¸€ä¸ªbucketé‡Œé¢ä¸ä¼šæœ‰å¤ªå¤šæ–‡ä»¶ï¼Œç›®å‰æœ€å¤§çš„å›¾åºŠbucketä¹Ÿä¸è¿‡2GBè€Œå·²ï¼ŒæŠŠå®ƒç•™åœ¨é‚£é‡ŒèŠ±ä¸äº†å‡ ä¸ªé’±ï¼ä¸ç„¶æŠŠbucketåˆ äº†ï¼Œå“ªå¤©å‘ç°éœ€è¦å»é‡Œé¢æ‰¾æ—§æ–‡ä»¶çš„æ—¶å€™æ— ä»ä¸‹æ‰‹å°±éº»çƒ¦äº†ï¼</p><blockquote><p>è‡³äºæˆ‘ä¸ºä»€ä¹ˆè¦åˆ â€¦â€¦å…¶å®æ˜¯å› ä¸ºæˆ‘æœ‰ç‚¹å¼ºè¿«ç—‡ï¼Œä¸ç”¨è¿˜ç•™åœ¨é‚£é‡Œçœ‹ç€æœ‰ç‚¹ä¸çˆ½â€¦â€¦</p></blockquote><p>å½“ç„¶è¿˜æœ‰å¦å¤–ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨<code>rclone</code>ç­‰å·¥å…·ï¼Œå°†s3ä¸­çš„æ‰€æœ‰æ–‡ä»¶ä¸‹è½½åˆ°æœ¬åœ°ï¼Œæ‰“åŒ…å¤šåœ°å¤‡ä»½åï¼Œåˆ é™¤äº‘ç«¯bucket</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æˆ‘åˆå¹²è ¢äº‹äº†ï¼è™½ç„¶æ²¡æœ‰å¾ˆå¤§å½±å“ï¼Œä½†æ˜¯è¿™ç§é—®é¢˜è¿˜æ˜¯ä¸è¦å‘ç”Ÿçš„å¥½ã€‚&lt;/p&gt;
&lt;h2 id=&quot;ä»€ä¹ˆæƒ…å†µï¼Ÿ&quot;&gt;&lt;a href=&quot;#ä»€ä¹ˆæƒ…å†µï¼Ÿ&quot; class=&quot;headerlink&quot; title=&quot;ä»€ä¹ˆæƒ…å†µï¼Ÿ&quot;&gt;&lt;/a&gt;ä»€ä¹ˆæƒ…å†µï¼Ÿ&lt;/h2&gt;&lt;p&gt;æˆ‘åœ¨åšå®¢å°šæœ‰å¼•ç”¨æŸä¸ªå¯¹è±¡å­˜å‚¨bucke</summary>
      
    
    
    
    <category term="å·®ç”Ÿæ–‡å…·å¤š" scheme="https://blog.musnow.top/categories/%E5%B7%AE%E7%94%9F%E6%96%87%E5%85%B7%E5%A4%9A/"/>
    
    
    <category term="å›¾åºŠ" scheme="https://blog.musnow.top/tags/%E5%9B%BE%E5%BA%8A/"/>
    
  </entry>
  
  <entry>
    <title>ã€åšå®¢ã€‘hexoé…ç½®sitemapå’Œç™¾åº¦|bing|è°·æ­Œæ”¶å½•</title>
    <link href="https://blog.musnow.top/posts/3595872826/"/>
    <id>https://blog.musnow.top/posts/3595872826/</id>
    <published>2023-12-08T12:32:14.000Z</published>
    <updated>2023-12-08T12:32:14.000Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘æ²¡äº‹æ‰¾äº‹ï¼Œåˆçœ‹äº†ä¼šå…³äºåšå®¢ä¸»é¢˜çš„ä¸œè¥¿ï¼Œä¹‹å‰çš„sitemapä¸€ç›´æ²¡æœ‰å¼„ä¸Šå»ï¼Œç°åœ¨æœ‰æ—¶é—´å°±å¼„ä¸€ä¸‹ã€‚</p><h1 id="1-hexoå®‰è£…sitemapæ’ä»¶"><a href="#1-hexoå®‰è£…sitemapæ’ä»¶" class="headerlink" title="1.hexoå®‰è£…sitemapæ’ä»¶"></a>1.hexoå®‰è£…sitemapæ’ä»¶</h1><p>åœ¨ä½ çš„hexoè·¯å¾„ä¸‹æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå®‰è£…sitemapç”Ÿæˆæ’ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-generator-baidu-sitemap --save</span><br><span class="line">npm install hexo-generator-sitemap --save</span><br></pre></td></tr></table></figure><p>å®æµ‹åœ¨windows11çš„<code>node v16.20.2</code>å’Œ<code>npm  9.8.1</code>ä¸‹å¯ä»¥æ­£å¸¸å®‰è£…ï¼Œä½†æ˜¯å®‰è£…baidu-sitemapæ’ä»¶çš„æ—¶å€™å¯èƒ½ä¼šæœ‰è­¦å‘Šï¼ˆä¸å½±å“ä½¿ç”¨ï¼‰</p><p>å®‰è£…å®Œæ¯•æ’ä»¶åï¼Œåœ¨ä½ çš„hexoé…ç½®æ–‡ä»¶<code>_config.yml</code>ä¸­æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼ŒæŒ‡å®šç«™ç‚¹åœ°å›¾çš„æ–‡ä»¶åå­—å³å¯ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç™¾åº¦å’Œè°·æ­Œçš„sitemap</span></span><br><span class="line"><span class="comment"># npm install hexo-generator-baidu-sitemap --save</span></span><br><span class="line"><span class="comment"># npm install hexo-generator-sitemap --save</span></span><br><span class="line"><span class="attr">baidusitemap:</span></span><br><span class="line">    <span class="attr">path:</span> <span class="string">baidusitemap.xml</span></span><br><span class="line"><span class="attr">sitemap:</span></span><br><span class="line">    <span class="attr">path:</span> <span class="string">sitemap.xml</span></span><br></pre></td></tr></table></figure><p>è¯·æ³¨æ„ï¼Œéœ€è¦ä¿®æ”¹çš„æ˜¯hexoçš„é…ç½®æ–‡ä»¶ï¼Œå¹¶éä¸»é¢˜é…ç½®æ–‡ä»¶ï¼</p><h1 id="2-å¦‚ä½•ä¿®æ”¹hexoä¸»é¢˜ç”Ÿæˆçš„index-htmlæ–‡ä»¶ï¼Ÿ"><a href="#2-å¦‚ä½•ä¿®æ”¹hexoä¸»é¢˜ç”Ÿæˆçš„index-htmlæ–‡ä»¶ï¼Ÿ" class="headerlink" title="2.å¦‚ä½•ä¿®æ”¹hexoä¸»é¢˜ç”Ÿæˆçš„index.htmlæ–‡ä»¶ï¼Ÿ"></a>2.å¦‚ä½•ä¿®æ”¹hexoä¸»é¢˜ç”Ÿæˆçš„index.htmlæ–‡ä»¶ï¼Ÿ</h1><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œç«™ç‚¹å¹³å°éƒ½ä¼šè®©ä½ åœ¨<code>index.html</code>çš„<code>&lt;head&gt;</code>é‡Œé¢åŠ ä¸€ä¸ªhtmlè¯­å¥ï¼Œæ¥éªŒè¯ç«™ç‚¹çš„æ‰€æœ‰æƒã€‚æ¯”å›¾ç™¾åº¦çš„éªŒè¯htmlè¯­å¥å¦‚ä¸‹</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;baidu-site-verification&quot;</span> <span class="attr">content</span>=<span class="string">&quot;éªŒè¯ç &quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><p>éƒ¨åˆ†hexoä¸»é¢˜å¯èƒ½æä¾›äº†è‡ªå®šä¹‰<code>&lt;head&gt;</code>çš„é€‰é¡¹ï¼ˆæ¯”å¦‚butterflyä¸»é¢˜å°±æœ‰ï¼‰</p><p>å¦‚æœä½ ä½¿ç”¨çš„ä¸»é¢˜æ²¡æœ‰æä¾›è‡ªå®šä¹‰<code>&lt;head&gt;</code>ï¼Œå¯ä»¥å°è¯•åœ¨ä¸»é¢˜æ–‡ä»¶å¤¹ä¸‹æœç´¢indexæˆ–è€…headå…³é”®å­—ï¼Œæ¥æ‰¾åˆ°å½“å‰ä¸»é¢˜ä½¿ç”¨çš„<code>index.html</code>ç”Ÿæˆæºæ–‡ä»¶</p><blockquote><p>è¯¥æ–¹æ³•<strong>ä»…</strong>é€‚ç”¨äºå°†ä¸»é¢˜æ–‡ä»¶ç›´æ¥ä¸‹è½½åˆ°<code>themes</code>æ–‡ä»¶å¤¹ä¸‹çš„æƒ…å†µï¼Œå› ä¸ºå¦‚æœä½ ç”¨çš„æ˜¯npmå®‰è£…çš„ä¸»é¢˜ï¼Œé‚£ä¹ˆä¿®æ”¹çš„ä¸»é¢˜æ–‡ä»¶æ˜¯ä¸ä¼šå¯¹å…¶ä»–åœ°æ–¹çš„éƒ¨ç½²ç”Ÿæ•ˆçš„ï¼Œä¸‹ä¸€æ¬¡æ›´æ–°ä¸»é¢˜è¿˜ä¼šè¦†ç›–æ‰ã€‚</p></blockquote><p>æ¯”å¦‚ä¸‹å›¾æ˜¯keepä¸»é¢˜<code>v3.6.1</code>ç‰ˆæœ¬ä¸­çš„<code>head.ejs</code>ï¼Œä½ åªéœ€è¦æŠŠæä¾›çš„metaæ ‡ç­¾åŠ åˆ°è¿™é‡Œé¢ï¼Œä¸‹ä¸€æ¬¡éƒ¨ç½²çš„æ—¶å€™çš„<code>index.html</code>ä¸­å°±ä¼šå¸¦ä¸Šè¿™ä¸ªæ ‡å¤´äº†ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">themes\keep\layout\_partial\head.ejs</span><br></pre></td></tr></table></figure><p><img src="https://img.musnow.top/i/2023/12/c5c020be0607437acbd2d4364edd839b.png" alt="image-20231208205004240"></p><h1 id="3-ç«™é•¿å¹³å°æ·»åŠ sitemap"><a href="#3-ç«™é•¿å¹³å°æ·»åŠ sitemap" class="headerlink" title="3.ç«™é•¿å¹³å°æ·»åŠ sitemap"></a>3.ç«™é•¿å¹³å°æ·»åŠ sitemap</h1><h2 id="ç™¾åº¦"><a href="#ç™¾åº¦" class="headerlink" title="ç™¾åº¦"></a>ç™¾åº¦</h2><p>ç™¾åº¦èµ„æºæœç´¢å¹³å° <a href="https://ziyuan.baidu.com/site/index#/">https://ziyuan.baidu.com/site/index#/</a></p><p>ç™¾åº¦å®åœ¨æ˜¯æ— è¯­ï¼Œä¹‹å‰å®‰è£…äº†<code>hexo-baidu-url-submit</code>æ’ä»¶ï¼Œä¸»åŠ¨è°ƒç”¨ç™¾åº¦apiç»™ä»–æ¨é€urlï¼Œç»“æœå¼„äº†å·²ç»å¿«ä¸€å¹´äº†ï¼Œè¿˜æ²¡æœ‰æ”¶å½•æˆ‘çš„ç«™ç‚¹ã€‚</p><blockquote><p>å®è¯è¯´ï¼Œç™¾åº¦ä¸æ”¶å½•ç«™ç‚¹ï¼Œç½‘ç«™çœ‹çš„äººå°±å¾ˆå°‘ã€‚ç™¾åº¦æˆ‘è‡ªå·±åšå®¢çš„å…³é”®è¯ï¼Œç»“æœæ˜¯ä¸€å †è¢«ç™¾åº¦æ”¶å½•çš„çˆ¬è™«ç«™ç‚¹ç”¨æˆ‘çš„æ–‡ç« èµšæµé‡ã€‚å”‰â€¦â€¦</p></blockquote><p>åœ¨èµ„æºæœç´¢å¹³å°çš„ç«™ç‚¹ç®¡ç†ä¸­æ·»åŠ ä½ çš„ç«™ç‚¹ï¼Œç”¨ç¬¬äºŒç‚¹æåˆ°çš„æ–¹å¼è¿›è¡ŒéªŒè¯</p><p><img src="https://img.musnow.top/i/2023/12/f5049ad4122b226e6621e3f77bbca406.png" alt="image-20231208205611557"></p><p>æ·»åŠ å®Œæ¯•åï¼Œåœ¨æ™®é€šæ”¶å½•ä¸­å¯ä»¥æ‰¾åˆ°sitemapæäº¤çš„åŒºåŸŸã€‚ä½†æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆæˆ‘è¿™é‡Œçš„æäº¤é…é¢æ˜¯0ï¼Œæœç´¢äº†ä¸€ä¸‹ä¹Ÿæ²¡æœ‰æ‰¾åˆ°åŸå› ã€‚</p><p><img src="https://img.musnow.top/i/2023/12/f1271309829d10b946af8dc1834d6530.png" alt="image-20231208205652153"></p><p><a href="https://zmingcx.com/baidu-linksubmit-sitemap.html">ç™¾åº¦èµ„æºå¹³å°æäº¤sitemapæ˜¯å–æ¶ˆäº†è¿˜æ˜¯æˆ‘è¢«é™åˆ¶äº†ï¼Ÿ</a></p><p>æœ‰äººè¯´æ˜¯ç«™ç‚¹è´¨é‡å¤ªä½è¢«ç™¾åº¦å±è”½äº†ï¼Œä½†æ˜¯è¿™ä¸ªæƒ…å†µä¹Ÿæ˜¯å¾ˆå¤šäººéƒ½é‡åˆ°è¿‡çš„ã€‚ä¼°è®¡æ˜¯ç™¾åº¦ç­–ç•¥æ›´æ–°ä»€ä¹ˆçš„ï¼Œä¸å…è®¸ä½ æ·»åŠ äº†å§ï¼</p><p>å¦‚æœä½ å·²ç»æ·»åŠ äº†sitemapï¼Œè¯·ä¸è¦å°†å…¶åˆ é™¤ï¼Œå…å¾—åˆ°æ—¶å€™åˆæ²¡æœ‰åŠæ³•æ·»åŠ äº†ã€‚</p><h2 id="bing"><a href="#bing" class="headerlink" title="bing"></a>bing</h2><p>bingçš„ç«™é•¿å¹³å°ç›´æ¥æœå°±è¡Œï¼š<a href="https://www.bing.com/webmasters/about?setlang=zh-cn">https://www.bing.com/webmasters/about?setlang=zh-cn</a></p><blockquote><p>å›½å†…è£¸è¿å¯èƒ½ä¸ç¨³å®šï¼Œéœ€è¦ç”¨ç‚¹æ–¹æ³•ã€‚</p><p>ä¸è¿‡bingå³ä¾¿ä¸æäº¤sitemapä¹Ÿå’”å’”æ”¶å½•äº†æˆ‘çš„åšå®¢ï¼Œä¸»æ‰“ä¸€ä¸ªä¸»åŠ¨+æ¥è€…ä¸æ‹’ã€‚</p></blockquote><p>è¿›å»ä¹‹åï¼Œç”¨å¾®è½¯è´¦æˆ·ç™»å½•ï¼Œç„¶åç‚¹å‡»æ–°å¢ç«™ç‚¹ï¼Œ<strong>è¾“å…¥ä½ åšå®¢çš„åŸŸå</strong></p><p><img src="https://img.musnow.top/i/2023/12/46eaebbcbe275e5719c48c0fa212d482.png" alt="image-20231208203803163"></p><p>bingä¼šè®©ä½ éªŒè¯ç«™ç‚¹æ‰€æœ‰æƒï¼Œæ ¹æ®ä¸‹é¢ä¸‰ç§æ–¹å¼çš„æŒ‡å¼•ï¼Œé€‰æ‹©ä¸€ç§å°±è¡Œäº†ã€‚å¦‚æœä½ ä¸çŸ¥é“å¦‚ä½•ä¿®æ”¹hexoçš„æºæ–‡ä»¶ï¼Œä½¿ç”¨<strong>CNAMEéªŒè¯</strong>æ–¹å¼æ˜¯æœ€ç®€å•çš„ï¼ˆåªè¦ä½ æœ‰åŸŸåæœ‰æƒå°±è¡Œäº†ï¼‰ã€‚</p><p><img src="https://img.musnow.top/i/2023/12/6decdf248d463e8dcf22c1408d1521a8.png" alt="image-20231208204120311"></p><p>ä¸è¿‡ä¼°è®¡æœ‰å¾ˆå¤šè€å“¥éƒ½æ˜¯ç™½å«–çš„github pagesæˆ–è€…netlify&#x2F;vercelçš„<strong>äºŒçº§åŸŸå</strong>ï¼Œåœ¨æ²¡æœ‰åŸŸåæ‰€æœ‰æƒçš„æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥ç”¨å‰ä¸¤ç§æ–¹å¼æ¥éªŒè¯ã€‚</p><ul><li>XMLæ–‡ä»¶æ–¹å¼ï¼šå°†bingæä¾›çš„XMLæ–‡ä»¶ä¸‹è½½ï¼Œç„¶åæ”¾åˆ°ä½ hexoæºç›®å½•çš„<strong>source</strong>æ–‡ä»¶å¤¹ä¸‹ï¼Œå°±å¯ä»¥äº†ã€‚</li><li>HTML MATEæ ‡è®°éªŒè¯ï¼šéƒ¨åˆ†hexoä¸»é¢˜å¯èƒ½æä¾›äº†è‡ªå®šä¹‰headerçš„é€‰é¡¹ï¼ˆæ¯”å¦‚butterflyä¸»é¢˜å°±æœ‰ï¼‰å…¶ä»–ä¸»é¢˜å¯ä»¥å‚è€ƒä¸Šæ–‡ç¬¬äºŒç‚¹æ“ä½œ</li></ul><p>åŸŸåéªŒè¯å®Œæ¯•åï¼Œåœ¨å·¦ä¾§å¯ä»¥æäº¤ç½‘ç«™åœ°å›¾ï¼ˆå³sidemapï¼‰</p><p>ç›´æ¥ç‚¹å‡»æŒ‰é’®æäº¤ä½ çš„ç«™ç‚¹åœ°å›¾çš„urlå°±å¯ä»¥äº†ã€‚bingä¼šè‡ªåŠ¨è¿›è¡Œå¤„ç†ï¼Œå¦‚ä¸‹å›¾æˆ‘çš„ç¬¬ä¸€ä¸ªsitemapå·²ç»æˆåŠŸå¤„ç†å‡ºæ¥äº†383ä¸ªé“¾æ¥ï¼Œéå¸¸å®Œç¾ã€‚</p><p><img src="https://img.musnow.top/i/2023/12/24f236053b3ebece4028124e987e6c65.png" alt="image-20231208204707769"></p><h2 id="è°·æ­Œ"><a href="#è°·æ­Œ" class="headerlink" title="è°·æ­Œ"></a>è°·æ­Œ</h2><p>å®è¯è¯´ï¼Œä¸€ä¸ªçº¯ä¸­æ–‡ä¸”é¢å‘å›½å†…è¯»è€…çš„ç«™ç‚¹ï¼Œåœ¨è°·æ­Œä¸Šé¢æ”¶å½•äº†ä¼°è®¡ä¹Ÿæ²¡å¤šå¤§ç”¨å¤„ï¼Œä½†æ˜¯å¯ä»¥æ²¡ç”¨ï¼Œä½†ä¸èƒ½æ²¡æœ‰ã€‚ä¹Ÿç»™ä»–å¼„ä¸€ä¸‹å§ã€‚</p><p><a href="https://search.google.com/search-console/welcome">https://search.google.com/search-console/welcome</a></p><p>é¦–å…ˆæ˜¯è¾“å…¥ç«™ç‚¹ç½‘å€ï¼Œå› ä¸ºæˆ‘ä¸éœ€è¦éªŒè¯æ‰€æœ‰ç«™ç‚¹ï¼ŒåªæŠŠåšå®¢æ”¶å½•äº†å°±è¡Œï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘é€‰çš„æ˜¯ç½‘å€å‰ç¼€ã€‚è¾“å…¥ç«™ç‚¹çš„æ—¶å€™éœ€è¦æŠŠhttpä¹Ÿå¸¦ä¸Š</p><p><img src="https://img.musnow.top/i/2023/12/940d735d204146063e8cb6de8db30326.png" alt="image-20231208210159103"></p><p>è°·æ­Œçš„éªŒè¯æ–¹å¼ä¹Ÿæœ‰å¾ˆå¤šç§ï¼Œè¿™é‡Œçš„æ“ä½œå’Œbingæ˜¯ä¸€æ ·çš„ï¼ŒæŠŠå®ƒå‘ç»™ä½ çš„æ–‡ä»¶ç›´æ¥æ”¾åˆ°hexoçš„sourceè·¯å¾„ä¸‹å°±å¯ä»¥äº†ï¼Œæˆ–è€…é‡‡ç”¨htmlæ ‡ç­¾çš„æ–¹å¼éªŒè¯ã€‚</p><p><img src="https://img.musnow.top/i/2023/12/6b7aef8d762ec3127bf418fba2257ff7.png" alt="image-20231208210317624"></p><p>éªŒè¯æˆåŠŸåï¼Œé€‰æ‹©å‰å¾€èµ„æºç•Œé¢ï¼Œå³å‰å¾€å½“å‰ç«™ç‚¹çš„æ§åˆ¶å°ã€‚</p><p>å¦‚æœä½ ä¸å°å¿ƒç‚¹äº†å®Œæˆï¼Œç«™ç‚¹èµ„æºç•Œé¢åœ¨ç«™é•¿å·¥å…·çš„<strong>å·¦ä¾§è¾¹æ </strong>é‡Œé¢ï¼Œåœ¨é‡Œé¢å¯ä»¥æ‰¾åˆ°ä½ å·²ç»æ·»åŠ äº†çš„ç«™ç‚¹ã€‚</p><p><img src="https://img.musnow.top/i/2023/12/2b62fc8c0f4a83a969894d7a97f13007.png" alt="image-20231208210604314"></p><p>åœ¨å·¦ä¾§é€‰æ‹©ç«™ç‚¹åœ°å›¾ï¼Œç‚¹å‡»æ·»åŠ å³å¯</p><p><img src="https://img.musnow.top/i/2023/12/f8159f7211dc0f12fc854ae74476f2f8.png" alt="image-20231208210802621"></p><p><img src="https://img.musnow.top/i/2023/12/d57012975919635230b6bd8f57e9871b.png" alt="image-20231208210849226"></p><h1 id="æå®šï¼"><a href="#æå®šï¼" class="headerlink" title="æå®šï¼"></a>æå®šï¼</h1><p>æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œæ¬¢è¿è¯„è®ºåŒºæå‡ºï¼</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æœ€è¿‘æ²¡äº‹æ‰¾äº‹ï¼Œåˆçœ‹äº†ä¼šå…³äºåšå®¢ä¸»é¢˜çš„ä¸œè¥¿ï¼Œä¹‹å‰çš„sitemapä¸€ç›´æ²¡æœ‰å¼„ä¸Šå»ï¼Œç°åœ¨æœ‰æ—¶é—´å°±å¼„ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;h1 id=&quot;1-hexoå®‰è£…sitemapæ’ä»¶&quot;&gt;&lt;a href=&quot;#1-hexoå®‰è£…sitemapæ’ä»¶&quot; class=&quot;headerlink&quot; title=&quot;1</summary>
      
    
    
    
    <category term="å·®ç”Ÿæ–‡å…·å¤š" scheme="https://blog.musnow.top/categories/%E5%B7%AE%E7%94%9F%E6%96%87%E5%85%B7%E5%A4%9A/"/>
    
    
    <category term="Hexo" scheme="https://blog.musnow.top/tags/Hexo/"/>
    
  </entry>
  
  <entry>
    <title>ã€Linuxã€‘lcov2.0å®‰è£…å’Œperlä¿®æ”¹é•œåƒæº</title>
    <link href="https://blog.musnow.top/posts/1274282021/"/>
    <id>https://blog.musnow.top/posts/1274282021/</id>
    <published>2023-11-26T12:12:55.000Z</published>
    <updated>2023-11-26T12:12:55.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å®‰è£…lcov-2-0"><a href="#å®‰è£…lcov-2-0" class="headerlink" title="å®‰è£…lcov 2.0"></a>å®‰è£…lcov 2.0</h1><p>ä½ å¯èƒ½ä¸çŸ¥é“lcovæ˜¯ä»€ä¹ˆï¼Œç®€è€Œè¨€ä¹‹ï¼Œå®ƒæ˜¯ä¸€ä¸ªä»£ç å•å…ƒæµ‹è¯•è¦†ç›–ç‡çš„æ˜¾ç¤ºå·¥å…·ï¼ŒåŸºäºgcovã€‚</p><ul><li>ä»€ä¹ˆæ˜¯å•å…ƒæµ‹è¯•è¦†ç›–ç‡ï¼Ÿ</li></ul><p>æˆ‘ä»¬éœ€è¦å¯¹é¡¹ç›®ä¸­çš„æ¯ä¸ªå‡½æ•°ç¼–å†™å•å…ƒæµ‹è¯•ï¼Œå…¶å®å°±æ˜¯æµ‹è¯•å‡½æ•°çš„åŠŸèƒ½ã€‚é€šè¿‡gcc&#x2F;g++çš„ç›¸å…³ç¼–è¯‘é€‰é¡¹ï¼Œå¯ä»¥å¾—åˆ°ä¸€ä¸ªgcdaæ–‡ä»¶ï¼Œå†…éƒ¨åŒ…å«æŸä¸ªcppæ–‡ä»¶ä¸­ç›¸å…³å‡½æ•°è¢«æ‰§è¡Œäº†å¤šå°‘æ¬¡ï¼Œä»¥åŠæŸäº›if&#x2F;switchä¸­çš„å¤šåˆ†æ”¯æ˜¯å¦è¦†ç›–ä¸Šäº†ï¼›</p><p>lcovå°±å¯ä»¥è§£æè¿™äº›gcdaæ–‡ä»¶ï¼Œå¾—åˆ°å¦‚ä¸‹å›¾æ‰€ç¤ºçš„å‡½æ•°<strong>æµ‹è¯•è¦†ç›–ç‡</strong>çš„æŠ¥å‘Š</p><p><img src="https://img.musnow.top/i/2023/11/6115958c076400afbfaf6ace5c1e89b9.png" alt="image-20231126201406666"></p><p>åŒ…æ‹¬å•å…ƒæµ‹è¯•åœ¨å†…ï¼Œè¿™éƒ¨åˆ†å¯¹ä»£ç å‡½æ•°æµ‹è¯•çš„æ“ä½œä¸€èˆ¬è¢«ç§°ä¹‹ä¸º<code>åŠŸèƒ½å®‰å…¨</code>ï¼Œè¿™é‡Œå°±ä¸å¤šè¯´äº†ã€‚</p><p>lcov 2.0çš„å®‰è£…å‘½ä»¤ç›¸å¯¹æ¥è¯´å¾ˆç®€å•ï¼Œå°±æ˜¯ä¸‹é¢è¿™äº›</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">wget https://github.com/linux-test-project/lcov/releases/download/v2.0/lcov-2.0.tar.gz</span><br><span class="line">tar -zxvf lcov-2.0.tar.gz</span><br><span class="line"><span class="built_in">cd</span> lcov-2.0</span><br><span class="line">sudo make install</span><br></pre></td></tr></table></figure><h1 id="perl"><a href="#perl" class="headerlink" title="perl"></a>perl</h1><p>ä½¿ç”¨lcovçš„æ—¶å€™éœ€è¦perlï¼Œæ­¤æ—¶å°±éœ€è¦ä¿®æ”¹é•œåƒæºã€‚é»˜è®¤çš„perl moduleçš„æºæ˜¯åœ¨å›½å¤–çš„ï¼Œå›½å†…åŸºæœ¬ä¸Šæ˜¯å®Œå…¨ç”¨ä¸äº†ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># centos8 å®‰è£…perl</span></span><br><span class="line">sudo yum install perl</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ çš„lcovè¿è¡Œçš„æ—¶å€™é‡åˆ°ä¸‹é¢ç±»ä¼¼çš„é”™è¯¯ï¼Œé‚£ä¹ˆå°±æ˜¯å› ä¸ºperlç¼ºå°‘å¯¹åº”moduleå¯¼è‡´çš„ï¼Œæ¯”å¦‚å¦‚ä¸‹æŠ¥é”™æ˜¯å› ä¸ºç¼ºå°‘<code>Capture::Tiny</code>è¿™ä¸ªmoduleï¼›</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Can&#x27;t locate Capture/Tiny.pm in @INC (you may need to install the Capture::Tiny module) (@INC contains: /usr/local/lib/lcov /usr/local/lib64/perl5 /usr/local/share/perl5 /usr/lib64/perl5/vendor_perl /usr/share/perl5/vendor_perl /usr/lib64/perl5 /usr/share/perl5) at /usr/local/lib/lcov/lcovutil.pm line 14.</span><br><span class="line">BEGIN failed--compilation aborted at /usr/local/lib/lcov/lcovutil.pm line 14.</span><br><span class="line">Compilation failed in require at /usr/local/bin/lcov line 102.</span><br><span class="line">BEGIN failed--compilation aborted at /usr/local/bin/lcov line 102.</span><br><span class="line">make: *** [makefile:6: lcov] Error 2</span><br></pre></td></tr></table></figure><h2 id="perlä½¿ç”¨æ¸…åæº"><a href="#perlä½¿ç”¨æ¸…åæº" class="headerlink" title="perlä½¿ç”¨æ¸…åæº"></a>perlä½¿ç”¨æ¸…åæº</h2><p>ä½¿ç”¨æ¸…åæºå°±è¡Œäº† <a href="https://mirrors.tuna.tsinghua.edu.cn/help/CPAN/">https://mirrors.tuna.tsinghua.edu.cn/help/CPAN/</a></p><p>å› ä¸ºæˆ‘ç”¨çš„centosçš„ç³»ç»Ÿï¼Œå®‰è£…çš„perlç‰ˆæœ¬å¾ˆè€ï¼Œ<code>v5.26.3</code>ï¼Œæ‰€ä»¥è¿™é‡Œè®°å½•ä¸€ä¸ªæ‰‹åŠ¨ä¿®æ”¹é•œåƒæºçš„åŠæ³•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">perl --version</span><br></pre></td></tr></table></figure><p>åœ¨rootç”¨æˆ·ä¸‹æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œä¼šè¿›å…¥ä¸€ä¸ªperlçš„å‘½ä»¤è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">perl -MCPAN -e shell</span><br></pre></td></tr></table></figure><p>åœ¨perlçš„å‘½ä»¤è¡Œä¸­æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">o conf init</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆå±•ç°çš„ç»“æœåº”è¯¥å¦‚ä¸‹ï¼Œä¼šè‡ªåŠ¨å¾€å½“å‰ç”¨æˆ·çš„å®¶ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªé…ç½®æ–‡ä»¶</p><p><img src="https://img.musnow.top/i/2023/11/fdfb49a8a83aa12789080503070a9a7a.png" alt="image-20231126200126012"></p><p>è¿™é‡Œåˆ›å»ºçš„é…ç½®æ–‡ä»¶æ˜¯åœ¨rootç”¨æˆ·ä¸‹ï¼Œè¾“å…¥<code>quit</code>é€€å‡ºperlçš„å‘½ä»¤è¡Œåï¼Œæˆ‘ä»¬ç›´æ¥vimæ‰“å¼€è¿™ä¸ªé…ç½®æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /root/.cpan/CPAN/MyConfig.pm</span><br></pre></td></tr></table></figure><p>åœ¨é‡Œé¢æ‰¾åˆ°urllisté€‰é¡¹ï¼Œæ ¹æ®å·²æœ‰æ ¼å¼æ·»åŠ ä¸€ä¸ªæ–°çš„é•œåƒè·¯å¾„å°±å¯ä»¥äº†</p><p><img src="https://img.musnow.top/i/2023/11/0f2b4af79a73a2f95bb6f6de6b17560b.png" alt="image-20231126200230352"></p><p>æˆ‘è¿™é‡Œæ·»åŠ åçš„urllisté…ç½®é¡¹å¦‚ä¸‹ï¼Œç¬¬ä¸€é¡¹æ˜¯é•œåƒæºå°±OK</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;urllist&#x27; =&gt; [q[https://mirrors.tuna.tsinghua.edu.cn/CPAN/], q[http://www.cpan.org/]],</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯è¦æ³¨æ„ä¸€ä¸‹ï¼Œåœ¨æˆ‘è¿™è¾¹çš„ç½‘ç»œç¯å¢ƒä¸­ï¼Œæ¸…åæºåœ¨perlå®‰è£…åŒ…çš„æ—¶å€™ä¹Ÿå®¹æ˜“æŠ½é£ï¼Œæˆ‘è¯•å‡ºæ¥æ¯”è¾ƒç¨³å®šçš„ipå¦‚ä¸‹ï¼Œå°†å…¶å†™å…¥<code>/etc/hosts</code>æ–‡ä»¶ä¸­ï¼Œè¿™æ ·å®‰è£…perlåŒ…çš„æ—¶å€™å°±ä¸ä¼štimeoutäº†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">101.6.15.130 mirrors.tuna.tsinghua.edu.cn</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªipåç»­å¯èƒ½ä¼šæœ‰å˜åŒ–å•Šï¼Œè¯·ä»¥ä½ çš„å®é™…æƒ…å†µä¸ºå‡†ï¼</p><h2 id="perlå®‰è£…module"><a href="#perlå®‰è£…module" class="headerlink" title="perlå®‰è£…module"></a>perlå®‰è£…module</h2><p>åç»­å®‰è£…åŒ…çš„æ—¶å€™ï¼Œå°±å¯ä»¥ç”¨ä¸Šé•œåƒæºäº†ï¼Œå®‰è£…åŒ…çš„è¯­å¥å¦‚ä¸‹ï¼Œè¯·æ³¨æ„è¿™ä¸ªå®‰è£…è¯­å¥æœ€åè¿˜æœ‰ä¸ªè‹±æ–‡çš„å•å¼•å·ï¼Œä¸€å®šä¸è¦æŠŠä»–åˆ äº†ï¼</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo perl -MCPAN -e <span class="string">&#x27;install &quot;åŒ…å&quot;&#x27;</span></span><br></pre></td></tr></table></figure><p>æˆ‘éœ€è¦ç”¨perlæ˜¯å› ä¸ºè¦ç”¨åˆ°lcovï¼Œåœ¨lcovä»“åº“çš„readmeé‡Œé¢æåˆ°äº†lcovéœ€è¦çš„perlåŒ…ï¼Œä¸€ä¸ªä¸€ä¸ªå®‰è£…å°±è¡Œäº†ï¼ˆä»¥ä¸‹èŠ‚é€‰è‡ª<code>lcov2.0</code>çš„ä»“åº“READMEï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">These perl packages include:</span><br><span class="line"></span><br><span class="line">  - Capture::Tiny</span><br><span class="line">  - DateTime</span><br><span class="line">  - Devel::Cover</span><br><span class="line">  - Digest::MD5</span><br><span class="line">  - File::Spec</span><br><span class="line">  - at least one flavor of JSON module.</span><br><span class="line">    In order of performance/preference:</span><br><span class="line">       - JSON::XS</span><br><span class="line">       - Cpanel::JSON::XS</span><br><span class="line">       - JSON::PP</span><br><span class="line">       - JSON</span><br><span class="line"> - Memory::Process</span><br><span class="line"> - Module::Load::Conditional</span><br><span class="line"> - Scalar::Util</span><br><span class="line"> - Time::HiRes</span><br><span class="line"></span><br><span class="line">If your system is missing any of these, then you may be able to install them</span><br><span class="line">via:</span><br><span class="line"></span><br><span class="line">   $ perl -MCPAN -e &#x27;install &quot;packageName&quot;&#x27;</span><br></pre></td></tr></table></figure><p>æ¯”å¦‚æˆ‘éœ€è¦å®‰è£…<code>Capture::Tiny</code>åŒ…ï¼Œå°±ç”¨å¦‚ä¸‹å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo perl -MCPAN -e <span class="string">&#x27;install &quot;Capture::Tiny&quot;&#x27;</span></span><br></pre></td></tr></table></figure><p>æ­£å¸¸å®‰è£…çš„å‘½ä»¤è¾“å‡ºç»“æœå¦‚ä¸‹å›¾æ‰€ç¤º</p><p><img src="https://img.musnow.top/i/2023/11/566a4438035e393943d353c48b016149.png" alt="image-20231126201023622"></p><h2 id="ubuntuå®‰è£…perl-module"><a href="#ubuntuå®‰è£…perl-module" class="headerlink" title="ubuntuå®‰è£…perl module"></a>ubuntuå®‰è£…perl module</h2><p>å¦‚æœæ˜¯ubuntuï¼Œå®‰è£…perlçš„åŒ…ä¼šæ–¹ä¾¿ä¸€ç‚¹ï¼Œå› ä¸ºaptæºé‡Œé¢æ˜¯æœ‰perlçš„module</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ubuntu 22.04 å¯ä»¥ç›´æ¥å®‰è£…ä¸‹é¢çš„ä¾èµ–é¡¹ï¼Œå°±å¯ä»¥ä½¿ç”¨lcov 2.0äº†</span></span><br><span class="line">sudo apt install -y perl libcapture-tiny-perl libdatetime-perl</span><br></pre></td></tr></table></figure><p>ä½ å¯ä»¥æ ¹æ®perlçš„åŒ…åä¸­çš„<strong>å…³é”®å­—</strong>ï¼Œå°è¯•åœ¨<code>apt list</code>é‡Œé¢æ‰¾æ‰¾æœ‰æ²¡æœ‰å¯¹åº”çš„åŒ…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt list | grep åŒ…å</span><br></pre></td></tr></table></figure><h1 id="ä½¿ç”¨lcov"><a href="#ä½¿ç”¨lcov" class="headerlink" title="ä½¿ç”¨lcov"></a>ä½¿ç”¨lcov</h1><p>å¯¹äºlcov2.0çš„å‘½ä»¤ä½¿ç”¨ï¼Œå¯ä»¥å‚è€ƒæˆ‘çš„linuxä»“åº“ä¸­çš„æµ‹è¯•</p><p><a href="https://gitee.com/musnows/raspberry-practice/tree/master/lcov_test">https://gitee.com/musnows/raspberry-practice/tree/master/lcov_test</a></p>]]></content>
    
    
    <summary type="html">lcov2.0å®‰è£…å’Œperlä¿®æ”¹é•œåƒæº</summary>
    
    
    
    <category term="ç©ä¸ŠLinux" scheme="https://blog.musnow.top/categories/%E7%8E%A9%E4%B8%8ALinux/"/>
    
    
    <category term="Linux" scheme="https://blog.musnow.top/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>ã€C++ã€‘ç©ºå¯¹è±¡æŒ‡é’ˆä¹Ÿèƒ½è®¿é—®æˆå‘˜å‡½æ•°ï¼Ÿ</title>
    <link href="https://blog.musnow.top/posts/3858168549/"/>
    <id>https://blog.musnow.top/posts/3858168549/</id>
    <published>2023-11-16T08:40:46.000Z</published>
    <updated>2023-11-16T08:40:46.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1-èµ·å› "><a href="#1-èµ·å› " class="headerlink" title="1.èµ·å› "></a>1.èµ·å› </h1><p>ä»Šå¤©å†™ä»£ç çš„æ—¶å€™é‡åˆ°ä¸€ä¸ªbugï¼Œä¸€ä¸ªç±»ä¸­çš„setå‡½æ•°åœ¨è®¾ç½®ä¸€ä¸ªPODç±»å‹çš„æ—¶å€™å‡ºç°äº†å¼‚å¸¸ï¼Œç›´æ¥æ®µé”™è¯¯é€€å‡ºäº†ã€‚</p><blockquote><p>å°tipsï¼ŒPODç±»å‹æŒ‡çš„æ˜¯å†…ç½®ç±»å‹ã€‚</p></blockquote><p>æƒ³äº†å¥½ä¹…ï¼Œéƒ½æ²¡å‘ç°è¿™é‡Œçš„é—®é¢˜åˆ°åº•æ˜¯å› ä¸ºä»€ä¹ˆã€‚åæ¥æ‰çŸ¥é“ï¼ŒåŸæ¥ç©ºçš„å¯¹è±¡æŒ‡é’ˆï¼Œä¹Ÿèƒ½è¢«è§£å¼•ç”¨è®¿é—®åˆ°å‡½æ•°ï¼</p><h1 id="2-ç¤ºä¾‹"><a href="#2-ç¤ºä¾‹" class="headerlink" title="2.ç¤ºä¾‹"></a>2.ç¤ºä¾‹</h1><p>ä¸‹é¢æ˜¯å…³äºè¿™ä¸ªæƒ…å†µçš„ç¤ºä¾‹ä»£ç </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">mytest</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">mytest</span>() = <span class="keyword">default</span>;</span><br><span class="line">    <span class="built_in">mytest</span>(<span class="type">int</span> a):_a(<span class="number">0</span>)&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">set_int</span><span class="params">(<span class="type">int</span> a)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;set int to &quot;</span> &lt;&lt; a &lt;&lt; endl;</span><br><span class="line">        _a = a;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">print</span><span class="params">(<span class="type">int</span> a)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;just a print&quot;</span> &lt;&lt; a &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">int</span> _a = <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    mytest* ptr = <span class="literal">nullptr</span>;</span><br><span class="line">    ptr-&gt;<span class="built_in">print</span>(<span class="number">20</span>);</span><br><span class="line">    ptr-&gt;<span class="built_in">set_int</span>(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œè¿™ä¸ªç¨‹åºï¼Œä¼šå‡ºç°æ®µé”™è¯¯ã€‚ä½†ä½ ä¼šå‘ç°è¿™ä¸ªæ®µé”™è¯¯å¹¶ä¸æ˜¯å› ä¸ºæˆ‘ä»¬çš„<code>ptr-&gt;</code> é‡Œé¢å‡ºç°çš„ï¼Œè€Œæ˜¯æˆåŠŸè¿›å…¥äº†set_intå‡½æ•°ï¼Œæ‰§è¡Œäº†æ‰“å°ï¼Œæœ€ç»ˆå¯¹æˆå‘˜å˜é‡<code>_a</code>èµ‹å€¼çš„æ—¶å€™å‡ºç°çš„ï¼</p><p>å¯¹è±¡æŒ‡é’ˆä¸ºç©ºï¼Œä»£è¡¨å‹æ ¹ä¸å­˜åœ¨ä¸€ä¸ªå®é™…çš„å¯¹è±¡ï¼Œä¹Ÿæ²¡åŠæ³•å¯¹ä¸å­˜åœ¨çš„æˆå‘˜å˜é‡æ“ä½œã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; ./test</span><br><span class="line">just a print20</span><br><span class="line">set int to 10</span><br><span class="line">[1]    280362 segmentation fault  ./test</span><br></pre></td></tr></table></figure><p>å½“ä»£ç å¾ˆå¤šçš„æ—¶å€™ï¼Œå°±ä¼šå› ä¸ºå¿½ç•¥è¿™ä¸ªç‰¹æ€§ï¼ˆå…¶å®æˆ‘å½“æ—¶æ˜¯å‹æ ¹ä¸çŸ¥é“ï¼‰è€Œè¯¯ä»¥ä¸ºé”™è¯¯å‡ºç°åœ¨set_intå‡½æ•°ä¸­ã€‚</p><p>æ²¡æœ‰æƒ³åˆ°æ˜¯å¤–å±‚çš„å¯¹è±¡æŒ‡é’ˆä¸ºç©ºå¯¼è‡´çš„ã€‚</p><h1 id="3-ä¸ºä»€ä¹ˆï¼Ÿ"><a href="#3-ä¸ºä»€ä¹ˆï¼Ÿ" class="headerlink" title="3.ä¸ºä»€ä¹ˆï¼Ÿ"></a>3.ä¸ºä»€ä¹ˆï¼Ÿ</h1><p>åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­ï¼Œå¯¹è±¡å°±å·²ç»ç»‘å®šäº†å‡½æ•°åœ°å€ã€‚ä¸€ä¸ªç±»çš„æ‰€æœ‰å¯¹è±¡ï¼Œä½¿ç”¨çš„å‡½æ•°åœ°å€éƒ½æ˜¯ä¸€æ ·çš„ã€‚å½“ç¼–è¯‘<code>ptr-&gt;set_int(10)</code> çš„æ—¶å€™ï¼Œå‡½æ•°çš„åœ°å€å°±å·²ç»å’Œè¿™ä¸ªæŒ‡é’ˆç»‘å®šäº†ï¼Œè°ƒç”¨å®ƒç­‰ä»·äºç›´æ¥è°ƒç”¨ set_int å‡½æ•°ã€‚</p><p>å¦‚æœè¿™ä¸ªå‡½æ•°ä¸­æ²¡æœ‰éœ€è¦ç”¨åˆ°æˆå‘˜å˜é‡çš„åœ°æ–¹ï¼Œä¹Ÿå°±ä¸éœ€è¦è§£å¼•ç”¨thisæŒ‡é’ˆï¼Œæ˜¯ä¸ä¼šå‡ºé”™çš„ã€‚æ¯”å¦‚ä¸Šæ–¹ä»£ç ä¸­çš„printå‡½æ•°ï¼Œå°±æ²¡æœ‰å‡ºç°å¼‚å¸¸ã€‚</p><p>ä½†å¦‚æœå‡½æ•°å†…è®¿é—®äº†å†…ç½®æˆå‘˜ï¼Œé‚£ä¹ˆå°±ä¼šå‡ºç°è§£å¼•ç”¨ç©ºæŒ‡é’ˆå¯¼è‡´çš„æ®µé”™è¯¯ï¼</p>]]></content>
    
    
    <summary type="html">çœŸæ²¡æƒ³åˆ°ï¼Œç©ºå¯¹è±¡æŒ‡é’ˆä¹Ÿèƒ½è®¿é—®æˆå‘˜å‡½æ•°å•Šï¼Ÿ</summary>
    
    
    
    <category term="é‡è§C++" scheme="https://blog.musnow.top/categories/%E9%81%87%E8%A7%81C/"/>
    
    
    <category term="C++" scheme="https://blog.musnow.top/tags/C/"/>
    
    <category term="æ•°æ®ç»“æ„" scheme="https://blog.musnow.top/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢ç»ã€‘C++é¢ç­‹è®°å½• (ä¸€) 231021</title>
    <link href="https://blog.musnow.top/posts/721187015/"/>
    <id>https://blog.musnow.top/posts/721187015/</id>
    <published>2023-10-21T10:50:14.000Z</published>
    <updated>2023-10-21T10:50:14.000Z</updated>
    
    <content type="html"><![CDATA[<p>è®°å½•éƒ¨åˆ†ä»ç‰›å®¢ç½‘ä¸Šçœ‹åˆ°çš„é¢ç­‹</p><span id="more"></span><h1 id="1-å£°æ˜ä¸€ä¸ªvectorï¼Œå½“vectorè¿‡å¤§æ—¶ä¼šæ ˆæº¢å‡ºå—ï¼Ÿ"><a href="#1-å£°æ˜ä¸€ä¸ªvectorï¼Œå½“vectorè¿‡å¤§æ—¶ä¼šæ ˆæº¢å‡ºå—ï¼Ÿ" class="headerlink" title="1.å£°æ˜ä¸€ä¸ªvectorï¼Œå½“vectorè¿‡å¤§æ—¶ä¼šæ ˆæº¢å‡ºå—ï¼Ÿ"></a>1.å£°æ˜ä¸€ä¸ªvectorï¼Œå½“vectorè¿‡å¤§æ—¶ä¼šæ ˆæº¢å‡ºå—ï¼Ÿ</h1><p>ç­”æ¡ˆæ˜¯ä¼šã€‚</p><p>é»˜è®¤ç”³è¯·çš„vectoræ˜¯æ”¾åœ¨æ ˆåŒºçš„ï¼Œæ ˆåŒºçš„å¤§å°&lt;&lt;å †åŒºçš„å¤§å°ã€‚æ‰€ä»¥å¦‚æœæˆ‘ä»¬åœ¨æ ˆåŒºä¸­å¼€è¾Ÿçš„vectorä¸­æ’å…¥å·¨é‡çš„æ•°æ®ï¼Œæ˜¯ä¼šå¯¼è‡´æ ˆæº¢å‡ºçš„ã€‚</p><p>è§£å†³åŠæ³•æ˜¯å°†æ•°æ®å­˜æ”¾åˆ°å †åŒºä¸Šï¼ˆä½¿ç”¨newæ¥åˆ›å»ºvectorï¼Œè€Œä¸æ˜¯ç›´æ¥åˆ›å»ºï¼‰</p><h1 id="2-å¦‚ä½•å®ç°å¤šæ¬¡è¿è¡Œç¨‹åºä½†åªæœ‰ä¸€ä¸ªåå°è¿›ç¨‹ï¼Ÿ"><a href="#2-å¦‚ä½•å®ç°å¤šæ¬¡è¿è¡Œç¨‹åºä½†åªæœ‰ä¸€ä¸ªåå°è¿›ç¨‹ï¼Ÿ" class="headerlink" title="2.å¦‚ä½•å®ç°å¤šæ¬¡è¿è¡Œç¨‹åºä½†åªæœ‰ä¸€ä¸ªåå°è¿›ç¨‹ï¼Ÿ"></a>2.å¦‚ä½•å®ç°å¤šæ¬¡è¿è¡Œç¨‹åºä½†åªæœ‰ä¸€ä¸ªåå°è¿›ç¨‹ï¼Ÿ</h1><p>ä½¿ç”¨å‘½åäº’æ–¥é”ï¼Œç¨‹åºå¯åŠ¨å‰ç”³è¯·é”ã€‚</p><ul><li>å¦‚æœé”æ²¡æœ‰è¢«ç”³è¯·ï¼Œä»£è¡¨æ˜¯ç¬¬ä¸€ä¸ªè¿›ç¨‹ï¼Œå¯ä»¥æ­£å¸¸è¿è¡Œ</li><li>å¦‚æœé”å·²ç»è¢«å ç”¨ï¼Œä»£è¡¨å·²ç»æœ‰è¿›ç¨‹äº†ï¼Œç›´æ¥é€€å‡ºå½“å‰è¿›ç¨‹ï¼ˆè¿™é‡Œè¦ä½¿ç”¨try_locké¿å…é˜»å¡ç­‰å¾…ï¼‰</li></ul><p>åœ¨Linuxä¸‹å¯ä»¥ç”¨å‘½åä¿¡å·é‡æ¥å®ç°ç±»ä¼¼è¿›ç¨‹å…±äº«é”çš„æ“ä½œã€‚è¿™éƒ¨åˆ†å¯ä»¥å»å­¦ä¹ è¿›ç¨‹é€šä¿¡ä¸­ä¿¡å·é‡çš„éƒ¨åˆ†ã€‚</p><p>å’¨è¯¢äº†å‘è¿™ç¯‡é¢ç­‹çš„å¤§ä½¬ï¼Œè¯´æ˜¯ç”¨æ–‡ä»¶ä¿å­˜ä¹‹å‰è¿›ç¨‹çš„PIDï¼Œè¯»å–å‡ºæ¥å°†ä¹‹å‰çš„è¿›ç¨‹killæ‰ã€‚</p><h1 id="3-äºŒåˆ†æ³•çš„å‰ææ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#3-äºŒåˆ†æ³•çš„å‰ææ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="3.äºŒåˆ†æ³•çš„å‰ææ˜¯ä»€ä¹ˆï¼Ÿ"></a>3.äºŒåˆ†æ³•çš„å‰ææ˜¯ä»€ä¹ˆï¼Ÿ</h1><ul><li>æ•°æ®æœ‰åº</li><li>æ•°æ®ç»“æ„æ”¯æŒéšæœºè®¿é—®</li></ul><h1 id="4-äº’æ–¥é”å’Œè‡ªæ—‹é”æœ‰ä»€ä¹ˆåŒºåˆ«"><a href="#4-äº’æ–¥é”å’Œè‡ªæ—‹é”æœ‰ä»€ä¹ˆåŒºåˆ«" class="headerlink" title="4.äº’æ–¥é”å’Œè‡ªæ—‹é”æœ‰ä»€ä¹ˆåŒºåˆ«"></a>4.äº’æ–¥é”å’Œè‡ªæ—‹é”æœ‰ä»€ä¹ˆåŒºåˆ«</h1><ul><li>äº’æ–¥é”æ˜¯åœ¨å†…æ ¸æ€è¿›è¡Œé˜»å¡ç­‰å¾…</li><li>è‡ªæ—‹é”æ˜¯åœ¨ç”¨æˆ·æ€ä¸æ–­å¾ªç¯æ²¦é™·æ£€æµ‹é”çš„çŠ¶æ€</li></ul><p>å¦‚æœä½¿ç”¨åœºæ™¯æ˜¯è¾ƒé•¿è¿è¡Œçš„å…±äº«èµ„æºï¼Œé‚£ä¹ˆå°±ä½¿ç”¨äº’æ–¥é”ã€‚é¿å…è‡ªæ—‹é”ä¸æ–­æ²¦é™·æ£€æµ‹æ¶ˆè€—å¤§é‡CPUèµ„æºã€‚</p><p>å¦‚æœä½¿ç”¨åœºæ™¯çš„å…±äº«èµ„æºè®¿é—®é€Ÿåº¦å¿«ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨è‡ªæ—‹é”ã€‚é¿å…äº’æ–¥é”é¢‘ç¹è¿›è¡Œç”¨æˆ·ã€å†…æ ¸æ€çš„è½¬æ¢è€Œé€ æˆæ¶ˆè€—ï¼ˆè¿™é‡ŒæŒ‡å…¶ä»–éœ€è¦è·å–é”çš„è¿›ç¨‹å¾—è¿›å…¥å†…æ ¸æ€é˜»å¡ç­‰å¾…ï¼‰</p><h1 id="5-TCPä¸‰æ¬¡æ¡æ‰‹é™¤äº†åºåˆ—å·è¿˜å‘äº†ä»€ä¹ˆå…¶ä»–ä¸œè¥¿ï¼Ÿ"><a href="#5-TCPä¸‰æ¬¡æ¡æ‰‹é™¤äº†åºåˆ—å·è¿˜å‘äº†ä»€ä¹ˆå…¶ä»–ä¸œè¥¿ï¼Ÿ" class="headerlink" title="5.TCPä¸‰æ¬¡æ¡æ‰‹é™¤äº†åºåˆ—å·è¿˜å‘äº†ä»€ä¹ˆå…¶ä»–ä¸œè¥¿ï¼Ÿ"></a>5.TCPä¸‰æ¬¡æ¡æ‰‹é™¤äº†åºåˆ—å·è¿˜å‘äº†ä»€ä¹ˆå…¶ä»–ä¸œè¥¿ï¼Ÿ</h1><ul><li>SYNå’ŒACKè¿™äº›è¡¨è®°ä½ï¼ˆå…·ä½“å¤ä¹ ä¸‰æ¬¡æ¡æ‰‹æ¯ä¸ªé˜¶æ®µçš„å‘é€ï¼‰</li><li>åŒæ–¹æœåŠ¡è¿›ç¨‹çš„ç«¯å£å·</li><li>èµ·å§‹åºåˆ—å·å’Œå¯¹å¯¹æ–¹å‘é€çš„SYNæŠ¥æ–‡çš„åº”ç­”åºåˆ—å·</li><li>TCPæ ¡éªŒå’Œ</li><li>TCPçª—å£å¤§å°</li></ul><p>åç»­å»ºç«‹è¿æ¥åï¼Œå°±ä¼šæ ¹æ®åŒæ–¹çš„çª—å£å¤§å°å’Œæ•°æ®çš„åºåˆ—å·å¼€å§‹ç›¸äº’é€šä¿¡ã€‚</p><h1 id="6-å­ç±»é‡å†™çˆ¶ç±»å‡½æ•°ï¼Œå­ç±»ä¸­è¯¥å‡½æ•°å£°æ˜ä¸ºprivateï¼Œèƒ½å¦é‡å†™æˆåŠŸï¼Ÿ"><a href="#6-å­ç±»é‡å†™çˆ¶ç±»å‡½æ•°ï¼Œå­ç±»ä¸­è¯¥å‡½æ•°å£°æ˜ä¸ºprivateï¼Œèƒ½å¦é‡å†™æˆåŠŸï¼Ÿ" class="headerlink" title="6.å­ç±»é‡å†™çˆ¶ç±»å‡½æ•°ï¼Œå­ç±»ä¸­è¯¥å‡½æ•°å£°æ˜ä¸ºprivateï¼Œèƒ½å¦é‡å†™æˆåŠŸï¼Ÿ"></a>6.å­ç±»é‡å†™çˆ¶ç±»å‡½æ•°ï¼Œå­ç±»ä¸­è¯¥å‡½æ•°å£°æ˜ä¸ºprivateï¼Œèƒ½å¦é‡å†™æˆåŠŸï¼Ÿ</h1><p>ç”¨ä¸‹é¢è¿™ä¸ªæ¯›å¯æˆ¿æ¥è¿›è¡Œæµ‹è¯•ï¼Œåœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å­ç±»çš„é‡å†™å‡½æ•°éƒ½å’Œçˆ¶ç±»æœ‰ç›¸åŒçš„ä½œç”¨åŸŸå£°æ˜ç¬¦ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">foo1</span>();</span><br><span class="line"><span class="built_in">foo2</span>();</span><br><span class="line"><span class="built_in">foo3</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">foo1</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;A::foo1&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">foo2</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;A::foo2&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">foo3</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;A::foo3&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span> : <span class="keyword">public</span> A</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">foo1</span>();</span><br><span class="line"><span class="built_in">foo2</span>();</span><br><span class="line"><span class="built_in">foo3</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">foo1</span><span class="params">()</span> <span class="keyword">override</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;B::foo1&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">foo2</span><span class="params">()</span> <span class="keyword">override</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;B::foo2&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">foo3</span><span class="params">()</span> <span class="keyword">override</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;B::foo3&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">B b;</span><br><span class="line">b.<span class="built_in">test</span>();</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;----&quot;</span> &lt;&lt; endl;</span><br><span class="line">A *bb = &amp;b;</span><br><span class="line">bb-&gt;<span class="built_in">test</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç›´æ¥è¿è¡Œï¼Œç»“æœä¹Ÿç¬¦åˆé¢„æœŸï¼Œç›®å‰è°ƒç”¨çš„æ˜¯å­ç±»é‡å†™åçš„è™šå‡½æ•°ï¼Œæ‰€æœ‰å‡½æ•°éƒ½é‡å†™æˆåŠŸã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">B::foo1</span><br><span class="line">B::foo2</span><br><span class="line">B::foo3</span><br><span class="line">----</span><br><span class="line">B::foo1</span><br><span class="line">B::foo2</span><br><span class="line">B::foo3</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">B</span> : <span class="keyword">public</span> A</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">foo1</span>();</span><br><span class="line"><span class="built_in">foo2</span>();</span><br><span class="line"><span class="built_in">foo3</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">foo2</span><span class="params">()</span> <span class="keyword">override</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;B::foo2&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">foo3</span><span class="params">()</span> <span class="keyword">override</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;B::foo3&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">foo1</span><span class="params">()</span> <span class="keyword">override</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;B::foo1&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// ç¼–è¯‘èƒ½é€šè¿‡ï¼Œè¿è¡Œè¾“å‡ºå’Œä¸Šæ–¹æ²¡åŒºåˆ«</span></span><br></pre></td></tr></table></figure><p>æˆ‘å°è¯•äº†å„ç§ä¿®æ”¹ä½œç”¨åŸŸçš„æ–¹å¼ï¼ŒåŒ…æ‹¬å°†å­ç±»ä¸­foo3å‡½æ•°æ”¹æˆå…¬æœ‰ï¼Œfoo1å‡½æ•°æ”¹æˆç§æœ‰ï¼Œéƒ½èƒ½æ­£å¸¸å®Œæˆé‡å†™ã€‚è¿™é‡Œçš„ä½œç”¨åŸŸå£°æ˜ç¬¦åªæ˜¯ä¼šæ”¹å˜<strong>å­ç±»å¤–æ˜¯å¦èƒ½è°ƒç”¨è¿™ä¸ªå‡½æ•°</strong>ï¼Œå’Œèƒ½å¦å®Œæˆè™šå‡½æ•°é‡å†™æ— å…³ï¼</p><p>è¯·æ³¨æ„ï¼Œå¦‚æœä½ å°†<strong>ç»§æ‰¿æ–¹å¼ç”±publicæ”¹æˆprivate</strong>ï¼Œé‚£ä¹ˆå°±æ— æ³•åœ¨ç±»å¤–ä½¿ç”¨çˆ¶ç±»æŒ‡é’ˆæŒ‡å‘å­ç±»å¯¹è±¡äº†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">â•°â”€ g++ test2.cpp -o test</span><br><span class="line">test2.cpp: In function â€˜int main()â€™:</span><br><span class="line">test2.cpp:316:11: error: â€˜Aâ€™ is an inaccessible base of â€˜Bâ€™</span><br><span class="line">  A *bb = &amp;b;</span><br></pre></td></tr></table></figure><p>ä½†è¿™ä¾æ—§ä¸å½±å“å­ç±»å‡½æ•°é‡å†™çˆ¶ç±»å‡½æ•°ï¼ˆæˆ‘çš„ä¾æ®æ˜¯overrideå…³é”®å­—æ²¡æœ‰æŠ¥é”™ï¼‰</p><h1 id="7-pthread-createèƒ½ä¼ å…¥ç±»æˆå‘˜å‡½æ•°çš„æŒ‡é’ˆå—"><a href="#7-pthread-createèƒ½ä¼ å…¥ç±»æˆå‘˜å‡½æ•°çš„æŒ‡é’ˆå—" class="headerlink" title="7.pthread_createèƒ½ä¼ å…¥ç±»æˆå‘˜å‡½æ•°çš„æŒ‡é’ˆå—"></a>7.pthread_createèƒ½ä¼ å…¥ç±»æˆå‘˜å‡½æ•°çš„æŒ‡é’ˆå—</h1><p>å¯ä»¥ï¼Œä½†æ˜¯å¿…é¡»æ˜¯é™æ€æˆå‘˜å‡½æ•°ã€‚</p><p>å¦‚æœæ˜¯æ™®é€šæˆå‘˜å‡½æ•°ï¼Œé‚£å°±éœ€è¦ç”¨ä¸­é—´å‡½æ•°æ¥å¤„ç†ï¼Œæ¯”å¦‚ä¸‹é¢çš„ç¤ºä¾‹ä»£ç ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;functional&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span>* <span class="title">threadFunc</span><span class="params">(<span class="type">void</span>* arg)</span> </span>&#123;</span><br><span class="line">    std::function&lt;<span class="type">void</span>()&gt; func = *<span class="keyword">reinterpret_cast</span>&lt;std::function&lt;<span class="built_in">void</span>()&gt;*&gt;(arg);</span><br><span class="line">    <span class="built_in">func</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    std::function&lt;<span class="type">void</span>()&gt; myFunc = []() &#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;Hello from thread!&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="type">pthread_t</span> thread;</span><br><span class="line">    <span class="built_in">pthread_create</span>(&amp;thread, <span class="literal">nullptr</span>, &amp;threadFunc, <span class="built_in">reinterpret_cast</span>&lt;<span class="type">void</span>*&gt;(&amp;myFunc));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç­‰å¾…çº¿ç¨‹ç»“æŸ</span></span><br><span class="line">    <span class="built_in">pthread_join</span>(thread, <span class="literal">nullptr</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥ç”¨<code>std::function</code>åŒ…è£…ä¸€ä¸ªç±»çš„æˆå‘˜å‡½æ•°ï¼Œå¹¶ç”¨<code>std::bind</code>å°†å¯¹è±¡çš„thisæŒ‡é’ˆç»‘å®šåˆ°ç¬¬ä¸€ä¸ªå‚æ•°ä¸Šã€‚å¤–å±‚å†å¥—ä¸Šä¸€ä¸ªç”¨äºæ‰§è¡Œè¯¥å‡½æ•°çš„voidå‡½æ•°ï¼Œå°±èƒ½ä¼ ç»™<code>pthread_create</code>ã€‚</p><p><code>std::function</code>çš„å¯¹è±¡ä¸èƒ½ç›´æ¥ä¼ ç»™Cè¯­è¨€çš„å‡½æ•°æŒ‡é’ˆï¼Œå³ä¾¿å‚æ•°å¯¹åº”ã€‚ä¼šæŠ¥é”™ã€‚</p><h1 id="8-å‡½æ•°å†…staticå˜é‡çš„ä½œç”¨"><a href="#8-å‡½æ•°å†…staticå˜é‡çš„ä½œç”¨" class="headerlink" title="8.å‡½æ•°å†…staticå˜é‡çš„ä½œç”¨"></a>8.å‡½æ•°å†…staticå˜é‡çš„ä½œç”¨</h1><p>åœ¨å‡½æ•°å†…å®šä¹‰ä¸€ä¸ªstaticå˜é‡ï¼Œè¯¥å˜é‡åªä¼šåœ¨è¿›å…¥è¿™ä¸ªå‡½æ•°çš„æ—¶å€™åˆå§‹åŒ–ä¸€æ¬¡ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è®¡ç®—æŸä¸€æœˆçš„1å·æ˜¯ä¸€å¹´çš„ç¬¬å‡ å¤©(ä¸è€ƒè™‘é—°å¹´)</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">DayOfYear</span><span class="params">(<span class="type">int</span> month)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> day_array = &#123;<span class="number">0</span>,<span class="number">31</span>,<span class="number">59</span>,<span class="number">90</span>,<span class="number">120</span>,<span class="number">151</span>,<span class="number">181</span>,<span class="number">212</span>,<span class="number">243</span>,<span class="number">273</span>,<span class="number">304</span>,<span class="number">334</span>&#125;;</span><br><span class="line">    <span class="keyword">return</span> day_array[month];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¯”å¦‚ä¸Šé¢çš„å‡½æ•°ï¼Œæˆ‘ä»¬å®šä¹‰çš„dayæ•°ç»„å°±åªä¼šåœ¨ç¬¬ä¸€æ¬¡è¿›å…¥è¿™ä¸ªå‡½æ•°çš„æ—¶å€™åˆå§‹åŒ–ã€‚ä¹‹åè¿›å…¥è¿™ä¸ªå‡½æ•°å°†ä¸åœ¨åˆå§‹åŒ–ï¼Œå°±èŠ‚çœäº†åˆå§‹åŒ–ä¸€ä¸ªæ•°ç»„çš„æ¶ˆè€—ã€‚å‡ºäº†è¿™ä¸ªå‡½æ•°åï¼Œè¯¥æ•°ç»„å˜é‡ä¾æ—§å­˜åœ¨ã€‚</p><p>è¯·æ³¨æ„ï¼Œè¿™ä¸ªstaticè¯­å¥å¹¶ä¸åªæ˜¯å˜é‡åªåˆå§‹åŒ–ä¸€æ¬¡ï¼Œå®é™…ä¸Šè¿™ä¸€è¡Œè¯­å¥åœ¨è¯¥å‡½æ•°ä¸­éƒ½åªä¼šè¿›è¡Œä¸€æ¬¡</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">bool</span> <span class="title function_">checkFlag</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">static</span> <span class="type">bool</span> flag = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span>(!flag)&#123;</span><br><span class="line">        <span class="comment">// ..è¿›è¡Œå¯¹åº”ä¿®æ”¹</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¯”å¦‚ä¸Šé¢çš„ä»£ç ä¸­ï¼Œå¦‚æœç”¨æ­£å¸¸æ€ç»´æ¥ç†è§£ï¼Œä½ ä¼šè§‰å¾—è¿™ä¸ªifè¯­å¥æ¯æ¬¡éƒ½ä¼šåˆ¤æ–­ä¸ºçœŸè€Œè¿›å…¥å…¶ä¸­ã€‚ä½†å®é™…ä¸Šflagçš„å®šä¹‰åªä¼šè¢«å®šä¹‰ä¸€æ¬¡ï¼Œ<strong>åªè¦æˆ‘ä»¬åœ¨ifä¸­å°†å…¶æ”¹æˆäº†true</strong>ï¼Œé‚£ä¹ˆä¸‹ä¸€æ¬¡è¿›å…¥è¯¥å‡½æ•°çš„æ—¶å€™ï¼Œ<strong>flagä¾æ—§ä¼šæ˜¯true</strong>ï¼Œ<code>static bool flag = false;</code>è¯­å¥ä¼šè¢«ç›´æ¥è·³è¿‡ï¼Œå¹¶ä¸ä¼šå†æ¬¡æ‰§è¡Œèµ‹å€¼ï¼</p><p>æˆ‘ä¹‹å‰ç†è§£çš„å°±æ˜¯flagå˜é‡åªä¼šè¢«åˆ›å»ºä¸€æ¬¡ï¼Œä½†staticåçš„èµ‹å€¼ä¾æ—§ä¼šæ‰§è¡Œã€‚è¿™ä¸ªç†è§£æ˜¯<strong>é”™è¯¯</strong>çš„ï¼</p>]]></content>
    
    
    <summary type="html">C++é¢ç­‹è®°å½• (ä¸€) 231021</summary>
    
    
    
    <category term="æ±‚èŒè·¯ä¸Šä¸€å»ä¸å¤è¿”" scheme="https://blog.musnow.top/categories/%E6%B1%82%E8%81%8C%E8%B7%AF%E4%B8%8A%E4%B8%80%E5%8E%BB%E4%B8%8D%E5%A4%8D%E8%BF%94/"/>
    
    
    <category term="é¢ç»" scheme="https://blog.musnow.top/tags/%E9%9D%A2%E7%BB%8F/"/>
    
  </entry>
  
  <entry>
    <title>ã€Linuxã€‘wslå®‰è£…çš„ubuntuä¸æ”¯æŒPOSIXæ¶ˆæ¯é˜Ÿåˆ— | å·²è§£å†³</title>
    <link href="https://blog.musnow.top/posts/4006913293/"/>
    <id>https://blog.musnow.top/posts/4006913293/</id>
    <published>2023-10-17T04:30:55.000Z</published>
    <updated>2023-10-17T04:30:55.000Z</updated>
    
    <content type="html"><![CDATA[<p>wslå®‰è£…çš„ubuntuä¸æ”¯æŒPOSIXæ¶ˆæ¯é˜Ÿåˆ—çš„è§£å†³åŠæ³•</p><span id="more"></span><h1 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h1><p><img src="https://img.musnow.top/i/2023/10/f317c38d511b44a48ff5dc5df48b1c80.png"></p><p>å¦‚é¢˜ï¼Œæˆ‘çš„win10ä¸Šå®‰è£…äº†wslçš„ubuntuåï¼ˆå¾®è½¯å•†åº—ä¸‹è½½çš„wslçš„Ubuntuï¼‰è¿™ä¸ªç³»ç»Ÿå†…éƒ¨ä¸æ”¯æŒPOSIXçš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œè™½ç„¶æœ‰<code>&lt;mqueue.h&gt;</code>å¤´æ–‡ä»¶ï¼Œä½†æ˜¯æ²¡æœ‰å®ç°ï¼Œä¼šæŠ¥é”™ã€‚</p><p>å¦‚æœæƒ³æ‰¾ä¸ªç®€å•çš„åŠæ³•å‘¢ï¼Œé‚£å°±æ˜¯ç”¨systemVçš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå¯è¿™æ˜¯ä¸ª<strong>è™šæ‹Ÿæœºæœ¬åœ°ç¯å¢ƒé—®é¢˜</strong>ï¼Œæˆ‘ç”¨virtualboxå®‰è£…çš„è™šæ‹Ÿæœºå°±èƒ½æ­£å¸¸ä½¿ç”¨ã€‚æ‰€ä»¥è‚¯å®šå¾—è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ¢æˆsystemVçš„æ¶ˆæ¯é˜Ÿåˆ—å°±æœ‰ç‚¹ã€Œæ©è€³ç›—é“ƒã€çš„æ„å‘³äº†ã€‚</p><h1 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h1><p>ä¸‹é¢æ˜¯ä¸€ä¸ªPOSIXæ¶ˆæ¯é˜Ÿåˆ—çš„demo</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;errno.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;mqueue.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">mqd_t</span> mqID;</span><br><span class="line">    mqID = <span class="built_in">mq_open</span>(<span class="string">&quot;/testmQueue&quot;</span>, O_RDWR | O_CREAT, <span class="number">0666</span>, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (mqID &lt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;open message queue error...&quot;</span>&lt;&lt;<span class="built_in">strerror</span>(errno)&lt;&lt;endl;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    mq_attr mqAttr;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">mq_getattr</span>(mqID, &amp;mqAttr) &lt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;get the message queue attribute error&quot;</span>&lt;&lt;endl;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;mq_flags:&quot;</span>&lt;&lt;mqAttr.mq_flags&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;mq_maxmsg:&quot;</span>&lt;&lt;mqAttr.mq_maxmsg&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;mq_msgsize:&quot;</span>&lt;&lt;mqAttr.mq_msgsize&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;mq_curmsgs:&quot;</span>&lt;&lt;mqAttr.mq_curmsgs&lt;&lt;endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœç¼–è¯‘åè¿è¡Œå‡ºç°äº†ä¸‹é¢çš„æŠ¥é”™ï¼Œä»£è¡¨å½“å‰ç³»ç»Ÿä¸æ”¯æŒPOSIXæ¶ˆæ¯é˜Ÿåˆ—ã€‚å½“å‰ç³»ç»Ÿä¸‹æœ‰mqueueå¤´æ–‡ä»¶ï¼Œä½†å¹¶æ²¡æœ‰å‡½æ•°çš„å®ç°ä½“</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@DESKTOP-5SQO6N0:~# ./test</span><br><span class="line">open message queue error...No such file or directory</span><br><span class="line">open message queue error...Function not implemented</span><br></pre></td></tr></table></figure><h1 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h1><p>éœ€è¦å°†wslç‰ˆæœ¬1æ”¹æˆç‰ˆæœ¬2ï¼Œå¦åˆ™æ— å®Œæ•´Linuxå†…æ ¸æ”¯æŒï¼Œæ— æ³•ä½¿ç”¨POSIXæ¶ˆæ¯é˜Ÿåˆ—ã€‚<strong>è¿™ä¹Ÿæ˜¯WSLç‰ˆæœ¬1å’Œ2çš„é‡å¤§åŒºåˆ«ä¹‹ä¸€</strong>ã€‚</p><p>ç”¨å¦‚ä¸‹å‘½ä»¤å°†å½“å‰è™šæ‹Ÿæœºæ”¹æˆwsl2ç‰ˆæœ¬ï¼Œå°±å¯ä»¥ä½¿ç”¨äº†ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wsl -l -v # ç”¨è¿™ä¸ªå‘½ä»¤æŸ¥çœ‹å½“å‰è™šæ‹Ÿæœºçš„versionæ˜¯ä¸æ˜¯1</span><br><span class="line">wsl --update # æ›´æ–°wsl</span><br><span class="line">wsl --set-version è™šæ‹Ÿæœºå 2  # æŠŠæŒ‡å®šè™šæ‹Ÿæœºæ”¹æˆwslç‰ˆæœ¬2</span><br></pre></td></tr></table></figure><h2 id="å†æ¬¡æµ‹è¯•"><a href="#å†æ¬¡æµ‹è¯•" class="headerlink" title="å†æ¬¡æµ‹è¯•"></a>å†æ¬¡æµ‹è¯•</h2><p>æ­£å¸¸æƒ…å†µä¸‹ï¼Œä¸Šé¢çš„æ¶ˆæ¯é˜Ÿåˆ—ä»£ç åº”è¯¥è¾“å‡ºå¦‚ä¸‹å†…å®¹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@DESKTOP-5SQO6N0:~# ./test</span><br><span class="line">mq_flags:0</span><br><span class="line">mq_maxmsg:10</span><br><span class="line">mq_msgsize:8192</span><br><span class="line">mq_curmsgs:0</span><br></pre></td></tr></table></figure><h2 id="ç»‘å®šç›®å½•"><a href="#ç»‘å®šç›®å½•" class="headerlink" title="ç»‘å®šç›®å½•"></a>ç»‘å®šç›®å½•</h2><p>é™¤äº†ä¸Šé¢è¿™ä¸ªé—®é¢˜ï¼Œåœ¨ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—ä¹‹å‰è¿˜å¯ä»¥monutä¸€ä¸‹è·¯å¾„ï¼Œå‚è€ƒmanæ‰‹å†Œä¸­çš„æ•™ç¨‹ï¼ˆä¼¼ä¹ä¸æ˜¯å¿…é¡»è¦åšçš„ï¼Œmountäº†è¿™ä¸ªè·¯å¾„ä¹‹åèƒ½æ›´å¥½åœ°çœ‹åˆ°ç°æœ‰çš„æ¶ˆæ¯é˜Ÿåˆ—ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir /dev/mqueue</span><br><span class="line">mount -t mqueue none /dev/mqueue</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">wslå®‰è£…çš„ubuntuä¸æ”¯æŒPOSIXæ¶ˆæ¯é˜Ÿåˆ—çš„è§£å†³åŠæ³•</summary>
    
    
    
    <category term="ç©ä¸ŠLinux" scheme="https://blog.musnow.top/categories/%E7%8E%A9%E4%B8%8ALinux/"/>
    
    
    <category term="Linux" scheme="https://blog.musnow.top/tags/Linux/"/>
    
    <category term="è™šæ‹Ÿæœº" scheme="https://blog.musnow.top/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>ã€å¾®æœºã€‘DOSBoxåœ¨windowsä¸Šçš„å®‰è£…å’Œmasmçš„é…ç½®</title>
    <link href="https://blog.musnow.top/posts/2839269095/"/>
    <id>https://blog.musnow.top/posts/2839269095/</id>
    <published>2023-10-16T17:49:13.000Z</published>
    <updated>2023-10-16T17:49:13.000Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘å­¦æ ¡å­¦ä¹ å¾®å‹è®¡ç®—æœºåŸç†ä¸æ¥å£æŠ€æœ¯ï¼Œéœ€è¦ç”¨åˆ°DOSBoxæ¥æ¨¡æ‹ŸDOSç¯å¢ƒè¿›è¡Œæ±‡ç¼–ç¼–ç¨‹çš„å­¦ä¹ ã€‚</p><p>æœ¬æ–‡è®°å½•äº†å¦‚ä½•åœ¨windows11&#x2F;10ä¸Šå®‰è£…<code>DOSBox0.74</code>å¹¶é…ç½®<code>masm5</code></p><h1 id="1-å®‰è£…"><a href="#1-å®‰è£…" class="headerlink" title="1.å®‰è£…"></a>1.å®‰è£…</h1><p>è¿™ä¸¤ä¸ªè½¯ä»¶æˆ‘æ‰“åŒ…ä¸Šä¼ åˆ°äº†ç™¾åº¦äº‘ç›˜ã€‚æ”¾å¿ƒï¼ŒåŠ èµ·æ¥ä¹Ÿå°±2mbï¼Œä¸‹è½½åº”è¯¥ä¸ä¼šå¾ˆä¹…</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">é“¾æ¥: https://pan.baidu.com/s/1vjbSL7iwP8WpMVA9K505ZA</span><br><span class="line">æå–ç : kr4x</span><br></pre></td></tr></table></figure><h2 id="1-1-DOSBox"><a href="#1-1-DOSBox" class="headerlink" title="1.1 DOSBox"></a>1.1 DOSBox</h2><p>ç‚¹å‡»<code>DOSBox0.74</code>çš„å®‰è£…åŒ…ï¼Œæ— è„‘ä¸‹ä¸€æ­¥å®‰è£…å³å¯</p><p><img src="https://img.musnow.top/i/2023/10/4ef1475a8016a019d58a90bd6845e70d.png" alt="image-20231017015458406"></p><p>å®‰è£…å‡ºæ¥çš„å›¾æ ‡å¦‚ä¸‹</p><p><img src="https://img.musnow.top/i/2023/10/cc5f29112bed916bb978c49a9a23636d.png" alt="image-20231017015529621"></p><h2 id="1-2-masm5"><a href="#1-2-masm5" class="headerlink" title="1.2 masm5"></a>1.2 masm5</h2><p>æ‰¾ä¸€ä¸ªç©ºçš„æ–‡ä»¶å¤¹ï¼Œæ–‡ä»¶è·¯å¾„ä¸­ä¸èƒ½åŒ…å«ç©ºæ ¼ã€ç‰¹æ®Šå­—ç¬¦å’Œä¸­æ–‡ï¼Œå°†<code>masm5.zip</code>ä¸­çš„æ–‡ä»¶å…¨éƒ¨è§£å‹åˆ°è¿™ä¸ªæ–‡ä»¶å¤¹ä¸­ï¼Œå¦‚ä¸‹å›¾</p><p><img src="https://img.musnow.top/i/2023/10/21d3adc3a7e767d3aa3d0eba69df75e9.png" alt="image-20231017015700958"></p><p>éšåä¿®æ”¹DOSBoxè½¯ä»¶çš„é…ç½®æ–‡ä»¶ï¼Œå³é”®æ¡Œé¢ä¸ŠDosboxè½¯ä»¶çš„å¿«æ·å›¾æ ‡ï¼Œé€‰æ‹©<code>æ‰“å¼€æ–‡ä»¶æ‰€åœ¨ä½ç½®</code>æ‰¾åˆ°DOSBoxè½¯ä»¶çš„å®‰è£…è·¯å¾„ï¼Œç‚¹å‡»<code>DOSBox 0.74 Options.bat</code>æ–‡ä»¶ï¼Œç¨ç­‰ç‰‡åˆ»ï¼Œä¼šä»¥è®°äº‹æœ¬çš„æ–¹å¼æ‰“å¼€é…ç½®æ–‡ä»¶ã€‚</p><p><img src="https://img.musnow.top/i/2023/10/06f84cbaea8c2c0380807a61e01f1a7d.png" alt="image-20231017015801923"></p><p>æ‹‰åˆ°é…ç½®æ–‡ä»¶æœ€åº•ä¸‹ï¼Œæ–°å¢å¦‚ä¸‹é…ç½®ã€‚ä½ åªéœ€è¦ä¿®æ”¹<code>D:\GAME\masm</code>ä¸ºä½ çš„masm5æ–‡ä»¶çš„è§£å‹ç›®å½•å°±è¡Œäº†ã€‚è¿™ä¸ªæ–‡ä»¶è·¯å¾„ä¸­ä¸èƒ½æœ‰ç©ºæ ¼ï¼Œä¹Ÿä¸èƒ½æœ‰ç‰¹æ®Šå­—ç¬¦å’Œä¸­æ–‡ï¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">MOUNT C D:\GAME\masm</span><br><span class="line">path=%path%; \masm</span><br><span class="line">C: </span><br><span class="line">cd \asm</span><br></pre></td></tr></table></figure><p>é…ç½®å®Œæˆåï¼Œå¯åŠ¨DOSboxï¼ŒæŸ¥çœ‹masmå‘½ä»¤æ˜¯å¦èƒ½æ­£å¸¸ä½¿ç”¨ã€‚å¦‚å›¾æ‰€ç¤ºï¼Œæ²¡æœ‰æŠ¥é”™masmå‘½ä»¤ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆå°±æ˜¯é…ç½®å¥½äº†ã€‚</p><p><img src="https://img.musnow.top/i/2023/10/62cba64fa60c2fd957b5968d4387109b.png" alt="image-20231017020002774"></p><h1 id="2-ä¿®æ”¹DOSBoxçª—å£å¤§å°"><a href="#2-ä¿®æ”¹DOSBoxçª—å£å¤§å°" class="headerlink" title="2.ä¿®æ”¹DOSBoxçª—å£å¤§å°"></a>2.ä¿®æ”¹DOSBoxçª—å£å¤§å°</h1><p>é»˜è®¤æƒ…å†µä¸‹DOSBoxçš„å‘½ä»¤è¡Œçª—å£æ˜¯éå¸¸éå¸¸éå¸¸å°çš„ï¼Œæˆ‘ä»¬éœ€è¦å°†å…¶æ”¹å¤§ã€‚åŒæ ·æ˜¯ä¿®æ”¹DOSBoxçš„é…ç½®æ–‡ä»¶ï¼Œå¦‚ä½•æ‰“å¼€é…ç½®æ–‡ä»¶å‚è€ƒä¸Šæ–‡ã€‚</p><p>æŒ‰ä¸‹å›¾æ‰€ç¤ºä¿®æ”¹</p><p><img src="https://img.musnow.top/i/2023/10/2b5bab3f2fc1dbb0a766659d1eb51130.png" alt="image-20231017020347782"></p><p>è¯·æ³¨æ„ï¼Œè¿™é‡Œçš„1280å’Œ1080ä¸­é—´çš„æ˜¯å¤§å†™çš„Xï¼Œå¹¶ä¸æ˜¯ä¹˜å·</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">windowresolution=1280X1080</span><br><span class="line">output=opengl</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹äº†ä¹‹åä¿å­˜ï¼Œå†é‡æ–°æ‰“å¼€DOSBoxï¼Œç•Œé¢å°±åº”è¯¥ä¼šå˜å¤§äº†ã€‚å¦‚æœä½ è§‰å¾—è¿˜æ˜¯å°äº†ï¼Œå¯ä»¥ä¿®æ”¹è¿™é‡Œçš„åˆ†è¾¨ç‡ï¼Œç»§ç»­è®©ä»–å˜å¤§ä¸€ç‚¹ã€‚</p><h1 id="3-ç¼–è¯‘ä¸€ä¸ªæ±‡ç¼–ç¨‹åº"><a href="#3-ç¼–è¯‘ä¸€ä¸ªæ±‡ç¼–ç¨‹åº" class="headerlink" title="3.ç¼–è¯‘ä¸€ä¸ªæ±‡ç¼–ç¨‹åº"></a>3.ç¼–è¯‘ä¸€ä¸ªæ±‡ç¼–ç¨‹åº</h1><p>ç”¨ä¸‹é¢æœ€ç®€å•çš„æ±‡ç¼–ç¨‹åºåšæµ‹è¯•ï¼Œå°†å¦‚ä¸‹å†…å®¹å†™å…¥åˆ°<code>test.asm</code>ä¸­ï¼Œå¹¶æ”¾å…¥å’Œmasmçš„åŒä¸€ç›®å½•ä¸‹ï¼ˆå¿…é¡»è¦æ˜¯åŒä¸€ç›®å½•ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">CODE SEGMENT ;USE16</span><br><span class="line">     ASSUME CS:CODE</span><br><span class="line">BEG: MOV DL,&#x27;H&#x27;</span><br><span class="line">     MOV AH, 2 ; è°ƒç”¨2å·DOSç³»ç»Ÿè°ƒç”¨è¾“å‡ºå­—ç¬¦åˆ°å±å¹•ä¸Š</span><br><span class="line">     INT 21H</span><br><span class="line">     MOV AH, 4CH</span><br><span class="line">     INT 21H</span><br><span class="line">CODE  ENDS</span><br><span class="line">        END BEG</span><br></pre></td></tr></table></figure><p>æ‰“å¼€DOSBoxï¼Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">masm test.asm</span><br><span class="line">link test.obj</span><br></pre></td></tr></table></figure><p>è¾“å‡ºå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œç¬¬ä¸€ä¸ªå‘½ä»¤çš„ä½œç”¨æ˜¯ç¼–è¯‘æºæ–‡ä»¶ï¼ˆæ³¨æ„çœ‹æœ‰æ²¡æœ‰ç¼–è¯‘æŠ¥é”™ï¼‰ï¼›ç¬¬äºŒä¸ªå‘½ä»¤çš„ä½œç”¨æ˜¯é“¾æ¥objæ–‡ä»¶ï¼Œæœ€ç»ˆä¼šå¼¹å‡ºæ¥ä¸€ä¸ªè­¦å‘Šï¼Œä¸ç”¨ç®¡ä»–ã€‚</p><p><img src="https://img.musnow.top/i/2023/10/60d8190bb6bda5b544018ce777909c0f.png" alt="image-20231017020903839"></p><p>æœ€ç»ˆæ‰§è¡Œtestï¼ŒæˆåŠŸè¾“å‡ºå­—ç¬¦Håˆ°ç»ˆç«¯ä¸Šã€‚</p><p><img src="https://img.musnow.top/i/2023/10/8cace87b33fc71a4387afa5d7765e8a4.png" alt="image-20231017020946832"></p><p>èƒ½èµ°åˆ°è¿™ä¸€æ­¥ï¼Œå°±ä»£è¡¨ä½ çš„masmåŸºæœ¬ç¯å¢ƒå·²ç»é…ç½®å¥½äº†ã€‚å¯ä»¥ç”¨æ¥ç¼–è¯‘è¿è¡Œæ±‡ç¼–ä»£ç äº†</p>]]></content>
    
    
    <summary type="html">DOSBoxåœ¨windowsä¸Šçš„å®‰è£…å’Œmasmçš„é…ç½®</summary>
    
    
    
    <category term="å·®ç”Ÿæ–‡å…·å¤š" scheme="https://blog.musnow.top/categories/%E5%B7%AE%E7%94%9F%E6%96%87%E5%85%B7%E5%A4%9A/"/>
    
    
    <category term="win" scheme="https://blog.musnow.top/tags/win/"/>
    
  </entry>
  
  <entry>
    <title>ã€Linuxã€‘ubuntu/centos8å®‰è£…zshç»ˆç«¯</title>
    <link href="https://blog.musnow.top/posts/2565866661/"/>
    <id>https://blog.musnow.top/posts/2565866661/</id>
    <published>2023-10-15T09:12:55.000Z</published>
    <updated>2023-10-15T09:12:55.000Z</updated>
    
    <content type="html"><![CDATA[<p>æ ¹æ®è¿™ç¯‡çŸ¥ä¹æ–‡ç« è¿›è¡Œ <a href="https://zhuanlan.zhihu.com/p/514636147">https://zhuanlan.zhihu.com/p/514636147</a></p><h1 id="1-å®‰è£…zsh"><a href="#1-å®‰è£…zsh" class="headerlink" title="1.å®‰è£…zsh"></a>1.å®‰è£…zsh</h1><p>å…ˆå®‰è£…zshå¹¶è®¾ç½®ä¸ºé»˜è®¤çš„ç»ˆç«¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ubuntu</span></span><br><span class="line">sudo apt install zsh</span><br><span class="line"><span class="comment"># centos </span></span><br><span class="line">sudo yum install zsh util-linux-user</span><br><span class="line"><span class="comment"># é€šç”¨</span></span><br><span class="line">chsh -s /bin/zsh</span><br></pre></td></tr></table></figure><blockquote><p>å¦‚æœcentosä¸‹æ‰¾ä¸åˆ°chshå‘½ä»¤ï¼Œå‚è€ƒæ­¤åšå®¢ï¼š<a href="https://blog.csdn.net/FungLeo/article/details/99448425">https://blog.csdn.net/FungLeo/article/details/99448425</a></p></blockquote><p>ç„¶åå®‰è£…oh-my-zshï¼Œè¿™æ˜¯ä¸€ä¸ªå¤§ä½¬åœ¨githubä¸Šå¼€æºçš„ä¸€ä¸ªzshé…ç½®é¡¹ï¼Œç›¸å¯¹æ–¹ä¾¿ç‚¹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget --no-check-certificate https://github.com/robbyrussell/oh-my-zsh/raw/master/tools/install.sh -O - | sh </span><br></pre></td></tr></table></figure><p>å¦‚æœgithubè¿ä¸ä¸Šå°±ç”¨giteeï¼Œå¦‚æœä½ ç”¨çš„æ˜¯å­ç”¨æˆ·ï¼Œé‚£ä¹ˆ<strong>è¿™ä¸ªå‘½ä»¤ä¸è¦ç”¨sudoæƒé™æ‰§è¡Œ</strong>ï¼å¦åˆ™åç»­å­ç”¨æˆ·ä¼šå› ä¸ºæƒé™é—®é¢˜æ²¡åŠæ³•ä½¿ç”¨ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sh -c <span class="string">&quot;<span class="subst">$(curl -fsSL https://gitee.com/shmhlsy/oh-my-zsh-install.sh/raw/master/install.sh)</span>&quot;</span></span><br></pre></td></tr></table></figure><p>æœ€ç»ˆå‡ºç°å¦‚å›¾æ‰€ç¤ºçš„ç•Œé¢å°±æ˜¯å®‰è£…æˆåŠŸäº†ã€‚</p><p><img src="https://img.musnow.top/i/2023/10/5ebc935468a46d95ac77e65dc879c66d.png" alt="image-20231015205326739"></p><h1 id="2-å®‰è£…zshæ’ä»¶"><a href="#2-å®‰è£…zshæ’ä»¶" class="headerlink" title="2.å®‰è£…zshæ’ä»¶"></a>2.å®‰è£…zshæ’ä»¶</h1><p>å®‰è£…è¿™ä¸¤ä¸ªæœ€å¸¸ç”¨çš„æ’ä»¶å°±å¯ä»¥äº†</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># zsh-autosuggestions å‘½ä»¤è¡Œå‘½ä»¤é”®å…¥æ—¶çš„å†å²å‘½ä»¤å»ºè®®</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/zsh-users/zsh-autosuggestions <span class="variable">$&#123;ZSH_CUSTOM:-~/.oh-my-zsh/custom&#125;</span>/plugins/zsh-autosuggestions</span><br><span class="line"><span class="comment"># zsh-syntax-highlighting å‘½ä»¤è¡Œè¯­æ³•é«˜äº®æ’ä»¶</span></span><br><span class="line">git <span class="built_in">clone</span> https://gitee.com/Annihilater/zsh-syntax-highlighting.git <span class="variable">$&#123;ZSH_CUSTOM:-~/.oh-my-zsh/custom&#125;</span>/plugins/zsh-syntax-highlighting</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå†å²å‘½ä»¤å»ºè®®çš„æ’ä»¶æ˜¯ç”¨æ–¹å‘é”®ğŸ‘‰æ¥è¿›è¡Œè¡¥å…¨çš„ï¼Œä¸è¦å’Œæˆ‘ä¸€æ ·å‚»ä¹ä¹æŒ‰tabã€‚</p><h1 id="3-é…ç½®æ–‡ä»¶å’Œä¸»é¢˜"><a href="#3-é…ç½®æ–‡ä»¶å’Œä¸»é¢˜" class="headerlink" title="3.é…ç½®æ–‡ä»¶å’Œä¸»é¢˜"></a>3.é…ç½®æ–‡ä»¶å’Œä¸»é¢˜</h1><p>åŸæ–‡ä¸­çš„é…ç½®æ–‡ä»¶æœ‰å¾ˆå¤šåœ°æ–¹éƒ½ä¸å¯¹åŠ²ï¼Œéœ€è¦æˆ‘ä»¬ä¿®æ”¹ï¼›</p><p>é¦–å…ˆæ˜¯<code>oh-my-zsh</code>çš„å®‰è£…è·¯å¾„ï¼Œéœ€è¦æ”¹æˆä½ çš„ç”¨æˆ·å®¶ç›®å½•ä¸‹ï¼Œç„¶åéœ€è¦å…ˆå®‰è£…ä¸€ä¸‹<code>powerlevel10k</code>ä¸»é¢˜ï¼Œè¿™ä¸ªä¸»é¢˜å¾ˆå¥½ç”¨ï¼</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> --depth=1 https://gitee.com/romkatv/powerlevel10k.git <span class="variable">$&#123;ZSH_CUSTOM:-<span class="variable">$HOME</span>/.oh-my-zsh/custom&#125;</span>/themes/powerlevel10k</span><br></pre></td></tr></table></figure><p>é…ç½®æ–‡ä»¶<code>~/.zshrc</code>æ”¹æˆå¦‚ä¸‹å†…å®¹ï¼ˆå»ºè®®å°†åŸæœ¬çš„é…ç½®æ–‡ä»¶cpå¤‡ä»½ä¸€ä¸‹ï¼‰å…¶ä¸­çš„zshå®‰è£…è·¯å¾„ä¸€å®šè¦ä¿®æ”¹ï¼Œå¦åˆ™æ— æ³•æ­£å¸¸é…ç½®ï¼</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é˜²æ­¢ä¸­æ–‡ä¹±ç </span></span><br><span class="line"><span class="built_in">export</span> LC_ALL=en_US.UTF-8</span><br><span class="line"><span class="built_in">export</span> LANG=en_US.UTF-8</span><br><span class="line"><span class="comment"># oh-my-zshçš„å®‰è£…è·¯å¾„ï¼ˆzshçš„é…ç½®è·¯å¾„ï¼‰</span></span><br><span class="line">ZSH=<span class="string">&quot;/home/ä½ çš„ç”¨æˆ·å/.oh-my-zsh&quot;</span></span><br><span class="line"><span class="comment"># ZSH_THEME=&quot;robbyrussell&quot;</span></span><br><span class="line"><span class="comment"># è®¾ç½®å­—ä½“æ¨¡å¼ä»¥åŠé…ç½®å‘½ä»¤è¡Œçš„ä¸»é¢˜</span></span><br><span class="line">POWERLEVEL9K_MODE=<span class="string">&#x27;nerdfont-complete&#x27;</span></span><br><span class="line"><span class="comment"># ZSH_THEME=&quot;agnoster&quot;</span></span><br><span class="line">ZSH_THEME=<span class="string">&quot;powerlevel10k/powerlevel10k&quot;</span> <span class="comment"># ä¸»é¢˜æ¨èè¿™ä¸ªï¼Œéœ€è¦è¿›è¡Œå®‰è£…</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯åŠ¨é”™è¯¯å‘½ä»¤è‡ªåŠ¨æ›´æ­£</span></span><br><span class="line">ENABLE_CORRECTION=<span class="string">&quot;true&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨å‘½ä»¤æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨å°çº¢ç‚¹è¿›è¡Œæç¤º</span></span><br><span class="line">COMPLETION_WAITING_DOTS=<span class="string">&quot;true&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é…ç½®è¦ä½¿ç”¨çš„æ’ä»¶</span></span><br><span class="line">plugins=(</span><br><span class="line">        git</span><br><span class="line">        extract</span><br><span class="line">        zsh-autosuggestions</span><br><span class="line">        zsh-syntax-highlighting</span><br><span class="line">)</span><br><span class="line"><span class="built_in">source</span> <span class="variable">$ZSH</span>/oh-my-zsh.sh</span><br><span class="line"><span class="built_in">source</span> <span class="variable">$ZSH_CUSTOM</span>/plugins/zsh-autosuggestions/zsh-autosuggestions.zsh</span><br><span class="line"><span class="comment"># pythonè™šæ‹Ÿç¯å¢ƒç›¸å…³è®¾ç½®</span></span><br><span class="line"><span class="keyword">if</span> [ -f /usr/local/bin/virtualenvwrapper.sh ];</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">    <span class="built_in">export</span> WORKON_HOME=<span class="variable">$HOME</span>/.virtualenvs</span><br><span class="line">    <span class="built_in">export</span> VIRTUALENVWRAPPER_PYTHON=/usr/bin/python3</span><br><span class="line">    <span class="built_in">source</span> /usr/local/bin/virtualenvwrapper.sh</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure><p>æ”¹å¥½äº†ä¹‹åï¼Œå¯ç”¨ä»–ï¼Œç„¶åå°±å¯ä»¥äº†ï¼›æ‰§è¡Œä¸‹æ–¹å‘½ä»¤åï¼Œå°±ä¼šè‡ªåŠ¨å¼¹å‡º<code>powerlevel10k</code>ä¸»é¢˜çš„é…ç½®å¼•å¯¼è¿‡ç¨‹ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source ~/.zshrc</span><br></pre></td></tr></table></figure><p><img src="https://img.musnow.top/i/2023/10/684bc428ce3e1369d8d60997845180a8.png" alt="image-20231015205703586"></p><p>å¦‚æœè®¾ç½®å®Œæ¯•åï¼Œä½ å¯¹<code>powerlevel10k/powerlevel10k</code>çš„é…ç½®åˆä¸æ»¡æ„äº†ï¼Œå¯ä»¥æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤é‡æ–°é…ç½®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p10k configure</span><br></pre></td></tr></table></figure><p>ä½ å¯èƒ½ä¹Ÿä¼šé‡åˆ°å¦‚ä¸‹æŠ¥é”™ï¼ŒåŸå› æœªçŸ¥ï¼Œä½†ä¼¼ä¹ä¸å½±å“ä½¿ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">â¯ ls</span><br><span class="line">_p9k_worker_stop:zle:4: No handler installed for fd 12</span><br><span class="line">_p9k_worker_stop:5: failed to close file descriptor 12: bad file descriptor</span><br></pre></td></tr></table></figure><p>å¦‚ä¸ŠæŠ¥é”™è§£å†³åŠæ³•å‚è€ƒgithubçš„issueå†…çš„è¯´æ˜</p><p><a href="https://github.com/romkatv/powerlevel10k/issues/1554">https://github.com/romkatv/powerlevel10k/issues/1554</a></p><p>åœ¨é…ç½®æ–‡ä»¶<code>.zshrc</code>çš„æœ«å°¾åŠ ä¸Šä¸‹é¢è¿™ä¸€è¡Œï¼Œç„¶åsourceè®©å…¶ç”Ÿæ•ˆå°±å¯ä»¥äº†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unset ZSH_AUTOSUGGEST_USE_ASYNC</span><br></pre></td></tr></table></figure><h1 id="4-ä½¿ç”¨å°æŠ€å·§"><a href="#4-ä½¿ç”¨å°æŠ€å·§" class="headerlink" title="4.ä½¿ç”¨å°æŠ€å·§"></a>4.ä½¿ç”¨å°æŠ€å·§</h1><p>è¾“å…¥å‘½ä»¤çš„æ—¶å€™é”®å…¥tabï¼Œä¼šå¼¹å‡ºä¸€äº›å‘½ä»¤çš„æç¤º</p><p><img src="https://img.musnow.top/i/2023/10/486730657def543552dc7a82163410e9.png" alt="image-20231015210623737"></p><p>è¾“å…¥ä¹‹å‰å†™è¿‡çš„å‘½ä»¤çš„æ—¶å€™ï¼Œä¼šå‡ºç°å†å²å‘½ä»¤æç¤ºï¼Œä½¿ç”¨æ–¹å‘é”®å³ğŸ‘‰å°±å¯ä»¥è¡¥å…¨è¿™ä¸ªå‘½ä»¤</p><p><img src="https://img.musnow.top/i/2023/10/eb1e448943c27dd0bdeb29267b26d252.png" alt="image-20231015210708230"></p><p>zshä¸»è¦å°±æ˜¯è¿™ä¸€ç‚¹éå¸¸çš„æ–¹ä¾¿ï¼Œè‡³äºä¼šä¸ä¼šå’Œé»˜è®¤çš„<code>/bin/bash</code>æœ‰æ€§èƒ½å·®å¼‚ï¼Œé‚£å°±ä¸çŸ¥é“äº†ã€‚</p><p>å¦å¤–ï¼Œåœ¨zshç»ˆç«¯ä¸­ç›´æ¥é‡å®šå‘ä¼šå¡ä½ï¼Œå¦‚ä¸‹å‘½ä»¤å°±ä¼šé˜»å¡æ‰ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; æ–‡æœ¬æ–‡ä»¶</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥è¦ç”¨echoï¼ˆä¸€èˆ¬æˆ‘æ˜¯ç”¨æ¥æ¸…ç©ºæŸä¸ªæ–‡æœ¬æ–‡ä»¶ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &gt; æ–‡æœ¬æ–‡ä»¶</span><br></pre></td></tr></table></figure><h1 id="5-zshå®‰è£…ågitä¸­æ–‡ä¹±ç "><a href="#5-zshå®‰è£…ågitä¸­æ–‡ä¹±ç " class="headerlink" title="5.zshå®‰è£…ågitä¸­æ–‡ä¹±ç "></a>5.zshå®‰è£…ågitä¸­æ–‡ä¹±ç </h1><p>å®‰è£…zshåç”¨<code>git log</code>æŸ¥çœ‹æäº¤ä¿¡æ¯çš„æ—¶å€™å‘ç°ä¸­æ–‡ä¹±ç ã€‚</p><h2 id="5-1-ä¿®æ”¹zshé…ç½®æ–‡ä»¶"><a href="#5-1-ä¿®æ”¹zshé…ç½®æ–‡ä»¶" class="headerlink" title="5.1 ä¿®æ”¹zshé…ç½®æ–‡ä»¶"></a>5.1 ä¿®æ”¹zshé…ç½®æ–‡ä»¶</h2><p>å…¶å®ä¸Šæ–‡ä¸­æåˆ°çš„é…ç½®æ–‡ä»¶é‡Œé¢å·²ç»æœ‰è¿™ä¸¤ä¸ªé…ç½®é¡¹äº†ï¼Œè¯´æ˜é—®é¢˜ä¸åœ¨è¿™é‡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># é˜²æ­¢ä¸­æ–‡ä¹±ç </span><br><span class="line">export LC_ALL=en_US.UTF-8</span><br><span class="line">export LANG=en_US.UTF-8</span><br></pre></td></tr></table></figure><h2 id="5-2-æ‰§è¡Œgité…ç½®"><a href="#5-2-æ‰§è¡Œgité…ç½®" class="headerlink" title="5.2 æ‰§è¡Œgité…ç½®"></a>5.2 æ‰§è¡Œgité…ç½®</h2><p>ä¸€ç¯‡åšå®¢è¯´è¦æ‰§è¡Œä¸‹é¢çš„gitå‘½ä»¤ï¼Œä¹Ÿæ²¡æœ‰ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git config --global core.quotepath false </span><br><span class="line">git config --global gui.encoding utf-8 </span><br><span class="line">git config --global i18n.commit.encoding utf-8 </span><br><span class="line">git config --global i18n.logoutputencoding utf-8 </span><br><span class="line">set LESSCHARSET=utf-8</span><br></pre></td></tr></table></figure><h2 id="5-3-ä¿®æ”¹ç³»ç»Ÿå­—ç¬¦é…ç½®"><a href="#5-3-ä¿®æ”¹ç³»ç»Ÿå­—ç¬¦é…ç½®" class="headerlink" title="5.3 ä¿®æ”¹ç³»ç»Ÿå­—ç¬¦é…ç½®"></a>5.3 ä¿®æ”¹ç³»ç»Ÿå­—ç¬¦é…ç½®</h2><p>å¦å¤–ä¸€ç¯‡åšå®¢è¯´è¦ä¿®æ”¹ç³»ç»Ÿçš„å­—ç¬¦é›†é…ç½®ï¼Œå¦‚ä¸‹ç¯å¢ƒå˜é‡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export LESSCHARSET=utf-8</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œåç¡®å®okäº†ï¼Œå¯ä»¥ç¼–è¾‘<code>/etc/profile</code>æ–‡ä»¶ï¼Œåœ¨è¯¥æ–‡ä»¶æœ«å°¾è¿½åŠ å¦‚ä¸‹å†…å®¹è®©å…¶å§‹ç»ˆç”Ÿæ•ˆ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export LESSCHARSET=utf-8</span><br></pre></td></tr></table></figure><p>éšåç”¨sourceå‘½ä»¤åˆ·æ–°è¿™ä¸ªé…ç½®æ–‡ä»¶å³å¯ã€‚</p><h1 id="6-ç²˜è´´æ–‡æœ¬å¾ˆæ…¢çš„é—®é¢˜"><a href="#6-ç²˜è´´æ–‡æœ¬å¾ˆæ…¢çš„é—®é¢˜" class="headerlink" title="6.ç²˜è´´æ–‡æœ¬å¾ˆæ…¢çš„é—®é¢˜"></a>6.ç²˜è´´æ–‡æœ¬å¾ˆæ…¢çš„é—®é¢˜</h1><p>å‚è€ƒ <a href="https://github.com/zsh-users/zsh-autosuggestions/issues/238">zsh-users&#x2F;zsh-autosuggestions&#x2F;issues&#x2F;238</a> è§£å†³è¿™ä¸ªé—®é¢˜</p><p>åœ¨<code>.zshrc</code>ä¹‹åæ·»åŠ å¦‚ä¸‹é…ç½®é¡¹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># This speeds up pasting w/ autosuggest</span><br><span class="line"># https://github.com/zsh-users/zsh-autosuggestions/issues/238</span><br><span class="line">pasteinit() &#123;</span><br><span class="line">  OLD_SELF_INSERT=$&#123;$&#123;(s.:.)widgets[self-insert]&#125;[2,3]&#125;</span><br><span class="line">  zle -N self-insert url-quote-magic # I wonder if you&#x27;d need `.url-quote-magic`?</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">pastefinish() &#123;</span><br><span class="line">  zle -N self-insert $OLD_SELF_INSERT</span><br><span class="line">&#125;</span><br><span class="line">zstyle :bracketed-paste-magic paste-init pasteinit</span><br><span class="line">zstyle :bracketed-paste-magic paste-finish pastefinish</span><br></pre></td></tr></table></figure><p>é…ç½®äº†ä¹‹åï¼Œsourceä½¿å…¶ç”Ÿæ•ˆã€‚</p><p>è¿™æ—¶å€™åœ¨ç»ˆç«¯é‡Œé¢ç²˜è´´å†…å®¹çš„æ—¶å€™ï¼Œå°±ä¸ä¼šä¸€ä¸ªä¸€ä¸ªå­—ç¬¦åœ°æ‰“å°å‡ºæ¥äº†ã€‚é‚£æ ·å®åœ¨æ˜¯å¤ªæ…¢äº†ã€‚</p>]]></content>
    
    
    <summary type="html">ubuntu/centos8è™šæ‹Ÿæœºå®‰è£…zshç»ˆç«¯</summary>
    
    
    
    <category term="ç©ä¸ŠLinux" scheme="https://blog.musnow.top/categories/%E7%8E%A9%E4%B8%8ALinux/"/>
    
    
    <category term="Linux" scheme="https://blog.musnow.top/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>ã€è™šæ‹Ÿæœºã€‘WIN11çš„WSLå®‰è£…CentOS8Streamè™šæ‹Ÿæœº</title>
    <link href="https://blog.musnow.top/posts/4065446782/"/>
    <id>https://blog.musnow.top/posts/4065446782/</id>
    <published>2023-10-15T03:30:55.000Z</published>
    <updated>2023-10-15T03:30:55.000Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬äººæ‰€ä½¿ç”¨çš„ç³»ç»Ÿæ˜¯ <code>win11 22H2 å®¶åº­ç‰ˆ</code>ï¼Œå¦‚æœä½ ä¸æ˜¯éCentOSä¸å¯ï¼Œå¼ºçƒˆå»ºè®®ç›´æ¥å»å¾®è½¯åº”ç”¨å•†åº—é‡Œé¢ä¸‹è½½Ubuntuï¼Œå…¨è‡ªåŠ¨å®‰è£…åˆ°WSLï¼Œå•¥éƒ½ä¸ç”¨ç®¡ã€‚(å°±æ˜¯å¥½åƒæ²¡åŠæ³•é€‰æ‹©å®‰è£…è·¯å¾„)</p><h1 id="1-å¯ç”¨WSL"><a href="#1-å¯ç”¨WSL" class="headerlink" title="1.å¯ç”¨WSL"></a>1.å¯ç”¨WSL</h1><p>åˆšå¼€å§‹å®‰è£…WSLçš„æ—¶å€™ï¼Œå‚è€ƒçš„æ˜¯<a href="https://blog.csdn.net/qq_38442140/article/details/120724215">è¿™ä¸ªåšå®¢</a>ã€‚è¯´å®è¯ï¼Œæˆ‘ä¸ªäººå¹¶ä¸å–œæ¬¢è¿™ç¯‡åšå®¢ã€‚å› ä¸ºé‡Œé¢é—æ¼äº†å¾ˆå¤šä¸œè¥¿ï¼Œå¹¶ä¸”åœ¨ä¸æ°å½“çš„ä½ç½®è´´å‡ºäº†å‘½ä»¤ï¼Œå¯¼è‡´è¯»è€…ä¼šè¯¯ä»¥ä¸ºæ˜¯éœ€è¦æ‰§è¡Œè¿™äº›å‘½ä»¤ã€‚</p><p>æ¯”å¦‚æˆ‘å°±ç†è§£é”™è¯¯ï¼Œå…ˆæ‰§è¡Œäº†è®¾ç½®wslé»˜è®¤ç‰ˆæœ¬ä¸º2çš„å‘½ä»¤ï¼Œ<strong>è¿™ä¸ªå‘½ä»¤å…ˆä¸è¦æ‰§è¡Œ</strong>ï¼åæ–‡ä¼šå‘Šè¯‰ä½ ä¸ºä»€ä¹ˆã€‚</p><p>è¿™ç¯‡åšå®¢ä¸­å¯¹å¼€å¯wslçš„è®¾ç½®çš„ä½ç½®æè¿°ä¹Ÿä¸å®Œå…¨ï¼Œçœ‹ä¸Šå»åƒä»ç½‘ä¸Šå“ªé‡ŒæŠ„è¿‡æ¥çš„win10çš„è®¾ç½®é€»è¾‘ï¼ˆwin11çš„ä½ç½®å®Œå…¨ä¸ä¸€æ ·ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¯¥åšå®¢åŸæ–‡ï¼šåœ¨windowsè®¾ç½®ä¸­æ‰“å¼€ã€å¯ç”¨æˆ–å…³é—­WindwosåŠŸèƒ½ã€‘ï¼Œå‹¾é€‰ã€é€‚ç”¨äºLinuxçš„Windwoså­ç³»ç»Ÿã€‘ï¼Œç‚¹å‡»ç¡®å®šåä¼šç³»ç»Ÿä¼šæç¤ºé‡å¯ï¼Œé€‰æ‹©ç¡®è®¤å³å¯</span><br></pre></td></tr></table></figure><p>å®é™…ä¸Šåœ¨win11ä¸­ï¼Œéœ€è¦å¤šç‚¹å¥½å‡ ä¸ªåœ°æ–¹æ‰èƒ½æ‰¾åˆ°è¿™ä¸ªè®¾ç½®çš„ä½ç½®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å³é”®æ¡Œé¢ - ä¸ªæ€§åŒ– - è¿›å…¥win11è®¾ç½®ç•Œé¢ - åº”ç”¨ - å¯é€‰åŠŸèƒ½ - (å¾€ä¸‹æ»‘)æ›´å¤šwindowsåŠŸèƒ½</span><br></pre></td></tr></table></figure><p><img src="https://img.musnow.top/i/2023/10/542d2e77f4272f4598629626e44ee2a7.png" alt="image-20231015104701566"></p><blockquote><p>è¿™éƒ½æ˜¯æˆ‘å¯¹ä¸€ä¸ª<strong>ä¸å®Œå–„åšå®¢</strong>çš„åæ§½ï¼Œä½†å¹¶æ²¡æœ‰è´¬ä½è¿™ä¸ªæ•™ç¨‹çš„æ„æ€å•Šï¼è‡³å°‘ä»–å‘Šè¯‰æˆ‘åŸºæœ¬æ­¥éª¤åº”è¯¥åšå“ªäº›ã€‚</p><p>ä¸ºä»€ä¹ˆæˆ‘è¦åæ§½å‘¢ï¼Ÿå› ä¸ºè¿™ç§å†™çš„ä¸å…¨çš„åšå®¢ç»å¸¸ä¼šè®©è¯»è€…å¾—å»é‡æ–°æœç´¢æŸäº›è®¾ç½®çš„ä½ç½®ï¼Œè€Œä½œè€…æ˜æ˜æ˜¯å·²ç»èµ°è¿‡è¿™ä¸ªæµç¨‹çš„ã€‚åšå®¢é‡Œé¢ä½œè€…çš„æˆªå›¾æ˜æ˜¾æ˜¯windows11ï¼Œä½†ä»–æä¾›çš„è®¾ç½®å´æ˜¯win10ä¸­çš„æ—§ä½ç½®ã€‚å¤šèŠ±30ç§’å†™æ¸…æ¥šä½ç½®å¹¶å¸¦ä¸Šæˆªå›¾ï¼Œä¸çŸ¥é“èƒ½èŠ‚çœè¯»è€…å¤šå°‘æ—¶é—´â€¦â€¦å¦‚æœä½ ä½“ä¼šè¿‡æŸ¥èµ„æ–™çš„æ—¶å€™é˜…è¯»è¿™äº›ã€Œæ–­å¤´çŸ­å°¾ã€çš„åšå®¢ï¼Œåº”è¯¥ä¹Ÿèƒ½ä½“ä¼šåˆ°æˆ‘çš„å¿ƒæƒ…ã€‚</p></blockquote><p>å›åˆ°æ­£é¢˜ã€‚åœ¨æ›´å¤š windows åŠŸèƒ½é€‰é¡¹æ¡†ä¸­ï¼ˆwin10&#x2F;11çš„è¿™ä¸ªé€‰é¡¹æ¡†åŸºæœ¬ç›¸åŒï¼‰ï¼Œå‹¾é€‰ä¸Šä¸‹é¢çš„å‡ ä¸ªé€‰é¡¹ï¼Œä¸‰ä¸ªéƒ½è¦å‹¾é€‰ä¸Šï¼</p><ul><li>é€‚ç”¨äº Linux çš„ Windows å­ç³»ç»Ÿ</li><li>è™šæ‹Ÿæœºå¹³å°</li><li>windows è™šæ‹Ÿæœºç›‘æ§ç¨‹åºå¹³å°</li></ul><p>ç‚¹å‡»ç¡®å®šï¼Œå°±æˆåŠŸå¯ç”¨äº† WSLã€‚ç³»ç»Ÿä¼šå¼¹å‡ºä¸€ä¸ªè¿›åº¦æ¡ï¼Œä¸‹è½½ä¸€äº›ä¸œè¥¿ã€‚</p><p><img src="https://img.musnow.top/i/2023/10/61b796407e655ae94c7ff535edaeae69.png" alt="image-20231015104951463"></p><p>å¤„ç†å®Œæ¯•åï¼ŒWIN+Rè¾“å…¥cmdï¼Œæ‰“å¼€å‘½ä»¤è¡Œå·¥å…·ï¼Œåœ¨å‘½ä»¤è¡Œå·¥å…·ä¸­è¾“å…¥<code>wsl -l -v</code>å‘½ä»¤ï¼Œæœ‰ç›¸å…³è¾“å‡ºå°±æ˜¯å¯ç”¨æˆåŠŸäº†ï¼</p><p>åˆå§‹åŒ–æƒ…å†µä¸‹ï¼Œæ‰§è¡Œè¿™ä¸ªå‘½ä»¤ï¼Œåº”è¯¥ä¼šæç¤ºä½ å½“å‰ä»€ä¹ˆè™šæ‹Ÿæœºéƒ½æ²¡æœ‰å®‰è£…ã€‚</p><h1 id="2-å®‰è£…Centos8"><a href="#2-å®‰è£…Centos8" class="headerlink" title="2.å®‰è£…Centos8"></a>2.å®‰è£…Centos8</h1><h2 id="2-1-ä¸‹è½½ç³»ç»Ÿzip"><a href="#2-1-ä¸‹è½½ç³»ç»Ÿzip" class="headerlink" title="2.1 ä¸‹è½½ç³»ç»Ÿzip"></a>2.1 ä¸‹è½½ç³»ç»Ÿzip</h2><p>å» <a href="https://github.com/wsldl-pg/CentWSL/releases/tag/8.1.1911.1">github&#x2F;wsldl-pg&#x2F;CentWSL</a> ä¸Šä¸‹è½½é€‚ç”¨äºwslçš„<code>CentOS8</code>ç³»ç»Ÿçš„zip</p><blockquote><p>è¿™ä¸ªä¹Ÿå¯ä»¥ï¼š<a href="https://github.com/mishamosher/CentOS-WSL">https://github.com/mishamosher/CentOS-WSL</a></p></blockquote><p><img src="https://img.musnow.top/i/2023/10/c42449d2875a2e60a296953f2bfcfae8.png" alt="image-20231015104110576"></p><p>æŠŠzipè§£å‹åˆ°ä½ æƒ³å®‰è£…è™šæ‹Ÿæœºçš„ä½ç½®ï¼ˆä¸€å®šè¦æ˜¯ä¸€ä¸ªç©ºæ–‡ä»¶å¤¹ï¼‰ï¼Œç„¶åå³é”®<code>CentOS8.exe</code>ï¼Œä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œã€‚</p><p><img src="https://img.musnow.top/i/2023/10/a13a0b3e0db1dab54e499c9c7bf5ddc6.png" alt="image-20231015104455537"></p><h2 id="2-2-æŠ¥é”™HRESULT-0x80370102è§£å†³"><a href="#2-2-æŠ¥é”™HRESULT-0x80370102è§£å†³" class="headerlink" title="2.2 æŠ¥é”™HRESULT:0x80370102è§£å†³"></a>2.2 æŠ¥é”™HRESULT:0x80370102è§£å†³</h2><p>å®‰è£…CentOS8çš„æ—¶å€™ï¼Œå°±é‡åˆ°äº†è¿™ä¸ª<strong>issue</strong>ä¸­çš„é—®é¢˜ğŸ‘‡</p><p><a href="https://github.com/wsldl-pg/CentWSL/issues/36">github.com&#x2F;wsldl-pg&#x2F;CentWSL&#x2F;issues&#x2F;36</a></p><p>ç”¨ç®¡ç†å‘˜èº«ä»½è¿è¡Œ<code>CentOS8.exe</code>ä¹‹åï¼Œå¼¹å‡ºçš„ç»ˆç«¯ä¼šè¾“å‡ºå¦‚ä¸‹å†…å®¹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ERROR:Installation Failed!</span><br><span class="line">HRESULT:0x80370102</span><br></pre></td></tr></table></figure><p>æ ¹æ®<a href="https://github.com/wsldl-pg/CentWSL/issues/36">è¯¥issue</a> ä¸­æœ€åä¸€ä¸ªå›å¤çš„è§£å†³åŠæ³•ï¼Œæˆ‘å…ˆå°†wslç‰ˆæœ¬è®¾ç½®å›äº†1ï¼ˆè¿™å°±æ˜¯ä¸ºä»€ä¹ˆå‰æ–‡è¯´ä¸è¦å…ˆè®¾ç½®ä¸ºé»˜è®¤wsl2ï¼‰</p><p><img src="https://img.musnow.top/i/2023/10/d19e82cbafe8e5eba20d8c6eef64687a.png" alt="image-20231015112649042"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wsl --set-default-version 1</span><br></pre></td></tr></table></figure><p>é‡å¤å¦‚ä¸Šå®‰è£…æ­¥éª¤ï¼ˆä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ<code>CentOS8.exe</code>ï¼‰ï¼Œå°±æˆåŠŸå®‰è£…äº†è™šæ‹Ÿæœºã€‚åœ¨win11çš„æ–‡ä»¶ç®¡ç†å™¨å·¦ä¾§ä¼šå¤šå‡ºæ¥ä¸€ä¸ªLinuxå›¾æ ‡ï¼Œé‡Œé¢æœ‰CentOS8çš„ç³»ç»Ÿé‡Œé¢çš„æ–‡ä»¶ã€‚</p><p><img src="https://img.musnow.top/i/2023/10/721c72e099c746ab5f618282dc205e27.png" alt="image-20231015105247440"></p><p>åœ¨windowsçš„powershellæˆ–è€…cmdä¸­ï¼Œè¾“å…¥<code>wsl</code>ï¼Œå°±å¯ä»¥è¿›å…¥CentOS8çš„bashï¼›è§ä¸‹å›¾ï¼Œæˆ‘ä»¬å·²ç»æˆåŠŸå®‰è£…å¥½äº†ä¸€ä¸ªCentOS8çš„è™šæ‹Ÿæœºã€‚å†…éƒ¨çš„æ–‡ä»¶å°±æ˜¯CentOS8ç³»ç»Ÿçš„é»˜è®¤æ–‡ä»¶ã€‚</p><p>åœ¨å†…éƒ¨æ‰§è¡Œ<code>exit</code>å‘½ä»¤ï¼Œå°±å¯ä»¥é€€å‡ºwslè™šæ‹Ÿæœºï¼Œå›åˆ°windowsçš„ç»ˆç«¯ä¸‹ã€‚</p><p><img src="https://img.musnow.top/i/2023/10/fa9eb9786e59758af270ae93f120ed51.png" alt="image-20231015105338512"></p><p>è€Œä¸”WSLæœ‰ä¸ªæœ€å¤§çš„å¥½å¤„ï¼Œå°±æ˜¯å®ƒèƒ½è‡ªåŠ¨æŒ‚è½½windowsä¸‹çš„æ–‡ä»¶åˆ°<code>/mnt</code>ç›®å½•ä¸‹ï¼Œè¿™ä¸ªç›®å½•é‡Œé¢å¯ä»¥çœ‹åˆ°æˆ‘çš„win11å®¿ä¸»æœºçš„3ä¸ªç¡¬ç›˜åˆ†åŒºï¼›windowsçš„æ–‡ä»¶èµ„æºç®¡ç†å™¨é‡Œé¢ä¹Ÿå¯ä»¥çœ‹åˆ°Linuxä¸­çš„æ–‡ä»¶ï¼Œ<strong>æ–¹ä¾¿æˆ‘ä»¬åœ¨windowså’Œlinuxä¸‹äº’ä¼ æ–‡ä»¶</strong>ï¼ˆå°±ä¸éœ€è¦ç”¨sftpå·¥å…·äº†ï¼‰</p><p>ç‰¹åˆ«æ˜¯å¦‚æœä½ éœ€è¦å†™å¸¦Doxygenæ–‡æ¡£çš„é¡¹ç›®ï¼Œåœ¨ç”ŸæˆDoxygençš„htmlåï¼Œå°±èƒ½ç›´æ¥ä»è¿™é‡Œåœ¨windowsçš„æµè§ˆå™¨ä¸­æ‰“å¼€ç½‘é¡µï¼Œè€Œä¸éœ€è¦ç”¨sftpæˆ–è€…å…¶ä»–å·¥å…·ä¼ åˆ°windowsä¸‹å†æ‰“å¼€äº†ï¼</p><blockquote><p>å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥ç”¨å¸¦GUIçš„Linuxç³»ç»Ÿæ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p></blockquote><h2 id="2-3-æ›´æ–°ä¸ºWSL2"><a href="#2-3-æ›´æ–°ä¸ºWSL2" class="headerlink" title="2.3 æ›´æ–°ä¸ºWSL2"></a>2.3 æ›´æ–°ä¸ºWSL2</h2><p>ä½¿ç”¨<code>wsl -l -v</code>å‘½ä»¤ï¼Œå¯ä»¥çœ‹åˆ°å½“å‰è¿è¡Œçš„wslè™šæ‹Ÿæœºï¼Œç‰ˆæœ¬æ˜¯1</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users\S2522\Desktop&gt; wsl -l -v</span><br><span class="line">  NAME       STATE           VERSION</span><br><span class="line">* CentOS8    Running         1</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥å°†å…¶å‡çº§ä¸ºWSL2ç‰ˆæœ¬ï¼Œä½†æ˜¯è¿™é‡Œä¼šå‘Šè¯‰ä½ éœ€è¦æ›´æ–°å†…æ ¸ç»„ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users\S2522\Desktop&gt; wsl --set-version CentOS8 2</span><br><span class="line">æ­£åœ¨è¿›è¡Œè½¬æ¢ï¼Œè¿™å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿæ—¶é—´...</span><br><span class="line">æœ‰å…³ä¸ WSL 2 çš„ä¸»è¦åŒºåˆ«çš„ä¿¡æ¯ï¼Œè¯·è®¿é—® https://aka.ms/wsl2</span><br><span class="line">WSL 2 éœ€è¦æ›´æ–°å…¶å†…æ ¸ç»„ä»¶ã€‚æœ‰å…³ä¿¡æ¯ï¼Œè¯·è®¿é—® https://aka.ms/wsl2kernel</span><br></pre></td></tr></table></figure><p>é‚£å°±æ›´æ–°å‘—ï¼<a href="https://aka.ms/wsl2kernel">å¾®è½¯å®˜æ–¹æ–‡æ¡£</a> ä¸­ä¼šå‘Šè¯‰ä½ éœ€è¦ <code>wsl.exe --install</code> æˆ– <code>wsl.exe --update</code>å‘½ä»¤ã€‚</p><p>è¿™é‡Œæˆ‘æ‰§è¡Œäº†<code>wsl --update</code>å‘½ä»¤ï¼Œæ‰§è¡Œåä¼šå¼¹çª—è¦ä½ æä¾›ç®¡ç†æƒé™ï¼Œå¹¶å‡ºç°ä¸€ä¸ªè¿›åº¦æ¡ï¼Œç­‰ä»–è·‘å®Œå°±è¡Œã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users\S2522\Desktop&gt; wsl --update</span><br><span class="line">æ­£åœ¨å®‰è£…: é€‚ç”¨äº Linux çš„ Windows å­ç³»ç»Ÿ</span><br><span class="line">å·²å®‰è£… é€‚ç”¨äº Linux çš„ Windows å­ç³»ç»Ÿã€‚</span><br></pre></td></tr></table></figure><p>æ›´æ–°å¥½äº†ï¼Œå†é‡æ–°æ‰§è¡Œ<code>wsl --set-version CentOS8 2</code>å‡çº§å‘½ä»¤ï¼Œä¼šæç¤ºä½ æ­£åœ¨æ‰§è¡Œè½¬æ¢ï¼Œéœ€è¦ç­‰å¾…ä¸€ä¼šã€‚</p><p><img src="https://img.musnow.top/i/2023/10/a870772fe8f185d55935bb2eb1d720d3.png" alt="image-20231015105730332"></p><p>æœ€ç»ˆæˆåŠŸè½¬æ¢äº†ï¼Œä½¿ç”¨å‘½ä»¤<code>wsl -l -v</code>é‡Œé¢æ˜¾ç¤ºçš„ç‰ˆæœ¬ä¹Ÿæ˜¯2äº†ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users\S2522\Desktop&gt; wsl --set-version CentOS8 2</span><br><span class="line">æœ‰å…³ä¸ WSL 2 å…³é”®åŒºåˆ«çš„ä¿¡æ¯ï¼Œè¯·è®¿é—® https://aka.ms/wsl2</span><br><span class="line"></span><br><span class="line">æ­£åœ¨è¿›è¡Œè½¬æ¢ï¼Œè¿™å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿæ—¶é—´ã€‚</span><br><span class="line">æ“ä½œæˆåŠŸå®Œæˆã€‚</span><br><span class="line">PS C:\Users\S2522\Desktop&gt; wsl -l -v</span><br><span class="line">  NAME       STATE           VERSION</span><br><span class="line">* CentOS8    Stopped         2</span><br></pre></td></tr></table></figure><p>æå®šï¼ç°åœ¨æˆ‘ä»¬å°±æœ‰ä¸€ä¸ªæ–¹ä¾¿çš„CentOS8çš„WSLç¯å¢ƒå•¦ï¼</p><p>å¯ä»¥ç”¨å¦‚ä¸‹å‘½ä»¤ï¼Œå°†å½“å‰çš„CentOS8è®¾ç½®ä¸ºé»˜è®¤çš„wslè™šæ‹Ÿæœºã€‚è¿™æ ·åœ¨windowså‘½ä»¤è¡Œä¸­æ‰§è¡Œwslæˆ–è€…bashå‘½ä»¤ï¼Œå°±èƒ½ç›´æ¥è¿›å…¥CentOS8ä¸­ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wslconfig /setdefault CentOS8</span><br></pre></td></tr></table></figure><p>é‡å¯ç”µè„‘åï¼Œåœ¨powershellçš„ä¸‹æ‹‰æ ä¸­ä¼šè‡ªåŠ¨å‡ºç°CentOS8çš„é€‰é¡¹ï¼Œç‚¹å‡»å®ƒä¹Ÿèƒ½è¿›å…¥wslè™šæ‹Ÿæœºç¯å¢ƒä¸­ã€‚</p><p><img src="https://img.musnow.top/i/2023/10/e40e68ef976f8ef57c9f73d03a8dc892.png" alt="image-20231015134927313"></p><h1 id="3-è§£å†³yumæŠ¥é”™é—®é¢˜"><a href="#3-è§£å†³yumæŠ¥é”™é—®é¢˜" class="headerlink" title="3.è§£å†³yumæŠ¥é”™é—®é¢˜"></a>3.è§£å†³yumæŠ¥é”™é—®é¢˜</h1><p>å› ä¸ºè¿™ä¸ªCentOSçš„é•œåƒæ˜¯æœ€å°å®‰è£…ç‰ˆæœ¬ï¼ˆç±»ä¼¼äºDockerå®‰è£…çš„CentOSï¼‰ï¼Œæ‰€ä»¥å†…éƒ¨çš„yumæºéƒ½æ˜¯åæ‰çš„ã€‚æ‰§è¡Œ<code>yum update</code>ä¼šå‡ºç°å¦‚ä¸‹æŠ¥é”™ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@7945R9P ~]# yum -y update</span><br><span class="line">Failed to set locale, defaulting to C.UTF-8</span><br><span class="line">CentOS-8 - AppStream                                                                     68  B/s |  38  B     00:00</span><br><span class="line">Failed to download metadata for repo &#x27;AppStream&#x27;</span><br><span class="line">Error: Failed to download metadata for repo &#x27;AppStream&#x27;</span><br></pre></td></tr></table></figure><p>è¿™æ—¶å€™éœ€è¦è¿›è¡Œyumæºçš„é‡æ–°è®¾ç½®ï¼Œå‚è€ƒæœ¬ç«™åšå®¢è§£å†³è¿™ä¸ªé—®é¢˜å°±è¡Œ</p><p> <a href="https://blog.musnow.top/posts/1296728696/">ã€Dockerã€‘é…ç½®CentOSå®¹å™¨æ—¶å‡ºç° Error Failed to download metadata for repo â€˜appstreamâ€™ Cannot prepare internal mirrorlist | è½¬è½½</a></p><p>æå®šyumä¹‹åï¼Œå°±å¯ä»¥æ­£å¸¸å®‰è£…ä½ æƒ³è¦çš„å¼€å‘è½¯ä»¶äº†ã€‚è¿™ä¸ªç³»ç»Ÿå¾ˆè½»é‡ï¼Œsudoå’Œpasswdç­‰å¾ˆå¤šå®Œæ•´ç³»ç»Ÿä¼šè‡ªå¸¦çš„å‘½ä»¤éƒ½æ²¡æœ‰ï¼Œéœ€è¦è‡ªè¡Œå®‰è£…ä¸€äº›ã€‚</p><p>å¦å¤–ï¼Œæˆ‘å†™è¿‡ä¸€ä¸ªCentOS8çš„åˆå§‹åŒ–è„šæœ¬ï¼Œå¯ä»¥è‡ªåŠ¨åŒ–å®‰è£…ä¸€äº›è½¯ä»¶ï¼Œè¿™é‡Œå®‰è£…çš„è½¯ä»¶å¹¶ä¸ä¸€å®šæ˜¯ä½ æƒ³è¦çš„ï¼Œè¯·é…Œæƒ…å‚è€ƒï¼š<a href="https://gitee.com/musnows/centos8-init">https://gitee.com/musnows/centos8-init</a></p><hr><p>è€Œä¸”ï¼Œé»˜è®¤æƒ…å†µä¸‹çš„lså‘½ä»¤ä¹Ÿæ²¡æœ‰é¢œè‰²è¾“å‡ºï¼Œéœ€è¦ä¿®æ”¹bashé…ç½®æ¥è®¾ç½®å‘½ä»¤åˆ«å</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">alias</span> <span class="built_in">ls</span>=<span class="string">&#x27;ls --color=auto&#x27;</span></span><br></pre></td></tr></table></figure><p>ä½ ä¹Ÿå¯ä»¥æ ¹æ®è‡ªå·±çš„å–œå¥½ï¼Œæ”¹æˆzshæˆ–è€…å…¶ä»–ç»ˆç«¯ã€‚</p><h1 id="4-vscodeè¿æ¥"><a href="#4-vscodeè¿æ¥" class="headerlink" title="4.vscodeè¿æ¥"></a>4.vscodeè¿æ¥</h1><p>æ™®é€šçš„è™šæ‹Ÿæœºæˆ‘ä»¬éœ€è¦ç”¨vscodeçš„remote sshæ’ä»¶æ¥è¿æ¥ï¼Œä½†æ˜¯WSLä¸»æœºæˆ‘ä»¬ç›´æ¥ç”¨vscçš„<strong>WSLæ’ä»¶</strong>æ¥è¿æ¥å°±è¡Œäº†ï¼Œä½¿ç”¨çš„æ•ˆæœå’Œremote sshæ’ä»¶æ˜¯ç›¸åŒçš„</p><p><img src="https://img.musnow.top/i/2023/10/4211aec9f60b6984a3a680c1a900b5c8.png" alt="image-20231015111412100"></p><p>åœ¨å·¦ä¾§è¿™ä¸ªè¿œç¨‹è¿æ¥æ§åˆ¶å™¨ä¸­ï¼ˆå’ŒRemote sshæ˜¯åŒä¸€ä¸ªä½ç½®ï¼‰ï¼Œæ‰¾åˆ°ä¸Šæ–¹çš„ä¸‹æ‹‰æ¡ï¼Œæ”¹æˆWSLç›®æ ‡ï¼Œå°±èƒ½çœ‹åˆ°æˆ‘ä»¬çš„CentOS8è™šæ‹Ÿæœºã€‚ç‚¹å‡»è¿æ¥å®ƒå°±å¯ä»¥äº†ã€‚</p><p><img src="https://img.musnow.top/i/2023/10/344e4ab417ab6246fa14351b211f016c.png" alt="image-20231015111429863"></p><p>ä½†æ˜¯vscodeé»˜è®¤é“¾æ¥çš„æ˜¯rootç”¨æˆ·ï¼Œä¸€èˆ¬æƒ…å†µä¸‹è‚¯å®šä¸ä¼šåœ¨rootä¸‹å†™ä»£ç çš„ã€‚æ‰€ä»¥éœ€è¦é…ç½®ä¸€ä¸‹å­ç”¨æˆ·</p><p>ä¿®æ”¹è™šæ‹Ÿæœºä¸­çš„<code>/etc/wsl.conf</code>æ–‡ä»¶ï¼Œæ·»åŠ ä¸‹é¢ä¸¤è¡Œ</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[user]</span><br><span class="line">default=ç”¨æˆ·å</span><br></pre></td></tr></table></figure><p>ç„¶åå›åˆ°windowsçš„å‘½ä»¤è¡Œï¼Œé‡å¯wsl</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wsl --shutdown CentOS8</span><br></pre></td></tr></table></figure><p>å†æ¬¡å¯åŠ¨wslï¼Œè¿™æ ·vscå°±èƒ½é»˜è®¤é“¾æ¥ä½ çš„å­ç”¨æˆ·äº†ã€‚</p><h1 id="5-ä¿®æ”¹wslèµ„æºé™åˆ¶"><a href="#5-ä¿®æ”¹wslèµ„æºé™åˆ¶" class="headerlink" title="5.ä¿®æ”¹wslèµ„æºé™åˆ¶"></a>5.ä¿®æ”¹wslèµ„æºé™åˆ¶</h1><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<strong>wsl2çš„è™šæ‹Ÿæœºèƒ½è®¿é—®åˆ°å®Œæ•´çš„ç³»ç»Ÿèµ„æº</strong>ï¼ŒåŒ…æ‹¬æ‰€æœ‰CPUæ ¸å¿ƒå’Œå†…å­˜ã€‚</p><p>è¿™å°±ä¼šå¯¼è‡´å¦‚æœLinuxä¸‹å¯¹ä¸€äº›ä¸œè¥¿è¿›è¡Œäº†ç¼“å­˜è€Œæ²¡æœ‰åŠæ—¶æ¸…ç†ï¼ŒWindowsæ˜¯æ²¡åŠæ³•å›æ”¶è¿™éƒ¨åˆ†å†…å­˜çš„ã€‚<strong>æœ€ç»ˆå°±å¯¼è‡´æˆ‘ä»¬Windowså®¿ä¸»æœºæ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜å¯ç”¨äº†</strong>ï¼Œè¿™æ€ä¹ˆè¡Œï¼Ÿ</p><blockquote><p>è¿™ç§æƒ…å†µä¸‹ï¼Œä¸€èˆ¬windowsç³»ç»Ÿä¼šæŠŠwslç›´æ¥ç»™å¹²æ‰ï¼Œé‚£æˆ‘ä»¬è™šæ‹Ÿæœºé‡Œé¢è·‘çš„æ´»ä¹Ÿæ²¡åŠæ³•å®Œæˆäº†ã€‚è¦çŸ¥é“ï¼ŒLinuxå¯æ˜¯å¾ˆå–œæ¬¢cacheå†…å­˜çš„ï¼Œå¾ˆå®¹æ˜“ä¼šæŠŠå®¿ä¸»æœºçš„å†…å­˜ç»™å¹²æ²¡ã€‚</p></blockquote><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®wslçš„è™šæ‹Ÿæœºå†…å­˜&#x2F;CPUé™åˆ¶ã€‚</p><p>åœ¨<strong>Linuxä¸‹</strong>å¯ä»¥ç”¨è¿™ä¸¤ä¸ªå‘½ä»¤æ¥æŸ¥çœ‹cpuå’Œå†…å­˜çš„é…ç½®ä¿¡æ¯ï¼Œåˆšå¼€å§‹çš„æ—¶å€™åº”è¯¥æ˜¯å’Œä½ çš„å®¿ä¸»æœºçš„CPUå’Œå†…å­˜ä¸€æ ·ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /proc/cpuinfo | grep processor <span class="comment"># æŸ¥çœ‹cpuæ ¸å¿ƒæ•°é‡</span></span><br><span class="line"><span class="built_in">cat</span> /proc/meminfo | grep Total     <span class="comment"># æŸ¥çœ‹å†…å­˜ä¿¡æ¯</span></span><br></pre></td></tr></table></figure><p>åœ¨windowsçš„<strong>Cç›˜</strong>çš„<strong>ç”¨æˆ·æ–‡ä»¶å¤¹</strong>ä¸‹ï¼Œåˆ›å»ºä¸€ä¸ª<code>.wslconfig</code>æ–‡ä»¶ï¼Œå¹¶åœ¨å†…éƒ¨å†™å…¥é™åˆ¶</p><ul><li>processorsæ˜¯cpuæ ¸æ•°é™åˆ¶</li><li>memoryå’Œswapéƒ½æ˜¯å†…å­˜é™åˆ¶</li></ul><p>é¡¶å¤šè®¾ç½®ä¸ºå®¿ä¸»æœºå†…å­˜çš„ä¸€åŠï¼Œé¿å…å®¿ä¸»æœºå¡é¡¿ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[wsl2]</span><br><span class="line">processors=8</span><br><span class="line">memory=8GB</span><br><span class="line">swap=8GB</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªé…ç½®æ–‡ä»¶çš„è·¯å¾„æ˜¯ï¼ˆwindowsä¸‹ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\ä½ çš„ç”¨æˆ·å\.wslconfig</span><br></pre></td></tr></table></figure><p>éšååœ¨windowsçš„ç»ˆç«¯ä¸­ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼Œç»ˆæ­¢è¿™ä¸ªwslè™šæ‹Ÿæœº</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users\S2522\Desktop&gt; wsl --shutdown CentOS8</span><br><span class="line">PS C:\Users\S2522\Desktop&gt; wsl -l -v</span><br><span class="line">  NAME       STATE           VERSION</span><br><span class="line">* CentOS8    Stopped         2</span><br></pre></td></tr></table></figure><p>wslå‘½ä»¤ä¸­å¹¶æ²¡æœ‰<code>--start</code>é€‰é¡¹ï¼Œæˆ‘ä»¬ç›´æ¥ç”¨wslå‘½ä»¤ï¼Œå°±ä¼šè‡ªåŠ¨é‡å¯å¹¶è¿›å…¥è¿™ä¸ªè™šæ‹Ÿæœºã€‚</p><p>è¿™æ—¶å€™å†åœ¨è™šæ‹Ÿæœºå†…éƒ¨çœ‹çœ‹CPUå’Œå†…å­˜ä¿¡æ¯ï¼Œå°±å¯ä»¥çœ‹åˆ°ä½ åˆšåˆšé…ç½®çš„æ€§èƒ½é™åˆ¶ç»“æœäº†ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@7945R9P ~]# cat /proc/cpuinfo | grep processor</span><br><span class="line">processor       : 0</span><br><span class="line">processor       : 1</span><br><span class="line">processor       : 2</span><br><span class="line">processor       : 3</span><br><span class="line">processor       : 4</span><br><span class="line">processor       : 5</span><br><span class="line">processor       : 6</span><br><span class="line">processor       : 7</span><br><span class="line">[root@7945R9P ~]# cat /proc/meminfo | grep Total</span><br><span class="line">MemTotal:        8136640 kB</span><br><span class="line">SwapTotal:       8388608 kB</span><br><span class="line">VmallocTotal:   34359738367 kB</span><br><span class="line">HugePages_Total:       0</span><br></pre></td></tr></table></figure><h2 id="åˆ é™¤wslä¸»æœº"><a href="#åˆ é™¤wslä¸»æœº" class="headerlink" title="åˆ é™¤wslä¸»æœº"></a>åˆ é™¤wslä¸»æœº</h2><p>åˆ é™¤è™šæ‹Ÿæœºçš„å‘½ä»¤å¦‚ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wsl --unregister &lt;DistributionName&gt;</span><br></pre></td></tr></table></figure><p>æ›´å¤šå‘½ä»¤å‚è€ƒå¾®è½¯å®˜ç½‘ <a href="https://learn.microsoft.com/zh-cn/windows/wsl/basic-commands">https://learn.microsoft.com/zh-cn/windows/wsl/basic-commands</a></p><h1 id="6-å¯ç”¨systemctl"><a href="#6-å¯ç”¨systemctl" class="headerlink" title="6.å¯ç”¨systemctl"></a>6.å¯ç”¨systemctl</h1><p>æˆ‘ä»¬çš„ç³»ç»Ÿé‡Œé¢æœ‰systemctlå‘½ä»¤ï¼Œä½†æ˜¯æ²¡æœ‰åŠæ³•ä½¿ç”¨ã€‚ç½‘ä¸Šæœ‰äº›æ•™ç¨‹è¯´ç”¨serviceå‘½ä»¤æ¥æ›¿ä»£ï¼Œä½†CentOSä¸­æ˜¯æ²¡æœ‰serviceå‘½ä»¤çš„ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@7945R9P bison-3.8]# systemctl</span><br><span class="line">System has not been booted with systemd as init system (PID 1). Can&#x27;t operate.</span><br><span class="line">Failed to connect to bus: Host is down</span><br></pre></td></tr></table></figure><h2 id="6-1-distrod-ç¬¬ä¸‰æ–¹å·¥å…·"><a href="#6-1-distrod-ç¬¬ä¸‰æ–¹å·¥å…·" class="headerlink" title="6.1 distrod ç¬¬ä¸‰æ–¹å·¥å…·"></a>6.1 distrod ç¬¬ä¸‰æ–¹å·¥å…·</h2><p>æˆ‘ä»¬éœ€è¦ç”¨distrodæ¥å®‰è£…systemctlçš„ç»„ä»¶ï¼Œæ‰èƒ½æˆåŠŸå¯ç”¨å®ƒã€‚å…·ä½“æ•™ç¨‹å‚è€ƒgithubä»“åº“çš„READMEä¸­çš„ä»‹ç»ã€‚ä¸æ˜¯å¾ˆéš¾</p><blockquote><p><a href="https://github.com/nullpo-head/wsl-distrod">https://github.com/nullpo-head/wsl-distrod</a></p></blockquote><p>å…ˆä¸‹è½½ä¸€ä¸ªè‡ªåŠ¨å®‰è£…çš„è„šæœ¬ï¼ˆè¿ä¸ä¸Šgithubä¼šæŠ¥sslæˆ–è€…timeouté”™è¯¯ï¼Œè¯·ä½¿ç”¨å…¶ä»–åŠæ³•ä¸‹è½½è¿™ä¸ªè„šæœ¬å†ä¸¢åˆ°è™šæ‹Ÿæœºé‡Œé¢å»å°±è¡Œï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl -L -O &quot;https://raw.githubusercontent.com/nullpo-head/wsl-distrod/main/install.sh&quot;</span><br><span class="line">chmod +x install.sh</span><br><span class="line">sudo ./install.sh install</span><br></pre></td></tr></table></figure><p>ç„¶åç”¨ä¸‹é¢ä¸¤ä¸ªå‘½ä»¤ä¹‹ä¸€æ¥å¯åŠ¨ï¼ˆç¬¬ä¸€ä¸ªå‘½ä»¤æ˜¯ä¼šåœ¨windowså¼€æœºè‡ªåŠ¨å¯åŠ¨çš„ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/opt/distrod/bin/distrod enable --start-on-windows-boot</span><br><span class="line">/opt/distrod/bin/distrod enable</span><br></pre></td></tr></table></figure><p>æ›´å¤šå†…å®¹ç›¸è§<a href="https://github.com/nullpo-head/wsl-distrod">è¯¥ä»“åº“README</a>ï¼›</p><p>è¯·æ³¨æ„ï¼Œæ‰§è¡Œç¬¬ä¸€ä¸ªè‡ªå¯åŠ¨å‘½ä»¤çš„æ—¶å€™éœ€è¦windowsçš„ç®¡ç†å‘˜æƒé™ï¼Œæ­¤æ—¶éœ€è¦è¾“å…¥çš„æ˜¯ç³»ç»Ÿç™»å½•çš„å¾®è½¯è´¦æˆ·çš„å¯†ç ï¼ˆä¸æ˜¯ä½ çš„PINï¼‰ï¼Œçœ‹ä¸‹é¢ï¼Œæˆ‘ç¬¬ä¸€æ¬¡è¾“å…¥å¯†ç è¾“å…¥çš„å°±æ˜¯PINï¼Œæ˜¾ç¤ºé”™è¯¯ï¼Œç¬¬äºŒæ¬¡è¾“å…¥äº†å¾®è½¯è´¦æˆ·çš„å¯†ç æ‰æˆåŠŸã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@7945R9P pkg]# /opt/distrod/bin/distrod enable --start-on-windows-boot</span><br><span class="line">[Distrod] Distrod has been enabled. Now your shell will start under systemd.</span><br><span class="line">[Distrod] Enabling atuomatic startup of Distrod. UAC dialog will appear because scheduling</span><br><span class="line">a task requires the admin privilege. Please hit enter to proceed.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Error</span><br><span class="line">It seems the task has not been scheduled successfully. You may have typed a wrong password, or you may not have the</span><br><span class="line">necessary administrative privileges. Do you want to retry?</span><br><span class="line">[Y] Yes  [N] No  [?] å¸®åŠ© (é»˜è®¤å€¼ä¸ºâ€œYâ€): y</span><br><span class="line">Enabling autostart has succeeded.</span><br><span class="line">[Distrod] Distrod will now start automatically on Windows startup.</span><br></pre></td></tr></table></figure><p>æ“ä½œå®Œæˆåï¼Œéœ€è¦é‡å¯è™šæ‹Ÿæœºã€‚ç”¨å¦‚ä¸‹å‘½ä»¤å°†å¯¹åº”çš„wslè™šæ‹Ÿæœºå…³é—­å°±è¡Œäº†ï¼Œå†æ¬¡æ‰§è¡Œwslå°±ä¼šé‡å¯è¿™ä¸ªè™šæ‹Ÿæœºã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wsl --terminate CentOS8</span><br></pre></td></tr></table></figure><p>å¦‚å›¾ï¼Œæˆ‘çš„systemctlå‘½ä»¤å·²ç»ç”Ÿæ•ˆã€‚</p><p><img src="https://img.musnow.top/i/2023/10/9340e7964572037fbd3b58f1b379b177.png" alt="image-20231015150251531"></p><p>ä¹Ÿèƒ½æ­£å¸¸é€šè¿‡systemctlå‘½ä»¤å¯åŠ¨mariadbæ•°æ®åº“</p><p><img src="https://img.musnow.top/i/2023/10/6edf311cf4a5dd1749328456a0008255.png" alt="image-20231015150404823"></p><h2 id="6-2-å¾®è½¯å®˜æ–¹ï¼ˆæ¨èï¼‰"><a href="#6-2-å¾®è½¯å®˜æ–¹ï¼ˆæ¨èï¼‰" class="headerlink" title="6.2 å¾®è½¯å®˜æ–¹ï¼ˆæ¨èï¼‰"></a>6.2 å¾®è½¯å®˜æ–¹ï¼ˆæ¨èï¼‰</h2><blockquote><p>å‚è€ƒ <a href="https://zhuanlan.zhihu.com/p/569883693">https://zhuanlan.zhihu.com/p/569883693</a></p></blockquote><p>æŸ¥çœ‹wslç‰ˆæœ¬å·å‘½ä»¤ä¸ºï¼š <code>wsl --version</code>ï¼Œå¦‚æœæ­¤å‘½ä»¤æœªæ­£å¸¸å›æ˜¾ç‰ˆæœ¬å·ï¼Œæˆ–ç‰ˆæœ¬å·ä½äº<code>0.67.6</code>ï¼Œé‚£ä¹ˆä½ å®‰è£…çš„wslè¿˜ä¸æ”¯æŒsystemdã€‚å¦‚ä¸‹ï¼Œæˆ‘çš„wslç‰ˆæœ¬å·²ç»æ˜¯æ”¯æŒçš„äº†ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users\S2522\Desktop&gt; wsl --version</span><br><span class="line">WSL ç‰ˆæœ¬ï¼š 1.2.5.0</span><br><span class="line">å†…æ ¸ç‰ˆæœ¬ï¼š 5.15.90.1</span><br><span class="line">WSLg ç‰ˆæœ¬ï¼š 1.0.51</span><br><span class="line">MSRDC ç‰ˆæœ¬ï¼š 1.2.3770</span><br><span class="line">Direct3D ç‰ˆæœ¬ï¼š 1.608.2-61064218</span><br><span class="line">DXCore ç‰ˆæœ¬ï¼š 10.0.25131.1002-220531-1700.rs-onecore-base2-hyp</span><br><span class="line">Windows ç‰ˆæœ¬ï¼š 10.0.22621.2134</span><br></pre></td></tr></table></figure><p>è¿›å…¥wslçš„CentOSè™šæ‹Ÿæœºï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;[boot]\nsystemd=true&quot;</span> | sudo <span class="built_in">tee</span> -a /etc/wsl.conf</span><br></pre></td></tr></table></figure><p>éšåexité€€å‡ºè™šæ‹Ÿæœºï¼Œ<strong>å›åˆ°windowsç»ˆç«¯å‘½ä»¤è¡Œ</strong>ï¼Œé‡å¯wsl</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wsl <span class="literal">--shutdown</span></span><br></pre></td></tr></table></figure><p>éšåå†æ¬¡åœ¨windowså‘½ä»¤è¡Œä¸‹æ‰§è¡Œwslå‘½ä»¤ï¼Œé‡å¯è¿™ä¸ªè™šæ‹Ÿæœºï¼›</p><p>é‡å¯wslè™šæ‹Ÿæœºåï¼Œåœ¨<strong>è™šæ‹Ÿæœºå†…éƒ¨</strong>æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps --no-headers -o <span class="built_in">comm</span> 1</span><br></pre></td></tr></table></figure><ul><li>å¦‚æœè¿™ä¸ªå‘½ä»¤è¿”å›ç»“æœæ˜¯<strong>systemd</strong>ï¼Œåˆ™ä»£è¡¨æˆ‘ä»¬çš„<code>systemctl</code>å‘½ä»¤å·²ç»å¯ä»¥ä½¿ç”¨ã€‚</li><li>å¦‚æœè¿”å›çš„æ˜¯<code>init</code>ï¼Œåˆ™è®¾ç½®å¤±è´¥</li></ul><p>å¦‚ä¸‹å›¾ï¼Œæˆ‘å·²ç»è®¾ç½®æˆåŠŸäº†ï¼</p><p><img src="https://img.musnow.top/i/2023/10/a072fdd5b53abc04cf444c1ab0ac9ad2.png" alt="image-20231015204810685"></p><p>å¾®è½¯å®˜æ–¹æ”¯æŒçš„systemdè¿˜æ˜¯æœ‰ä¸€ç‚¹æ˜¯ä¼˜äºdistrodçš„ï¼Œé‚£å°±æ˜¯å¯ç”¨äº†å®˜æ–¹ systemd çš„ wsl2 å®ä¾‹ï¼Œåœ¨ç”¨æˆ·åœæ­¢æ“ä½œåï¼Œ<strong>ä¼šè‡ªåŠ¨å…³é—­</strong>ï¼Œå’Œæœªå¯ç”¨ systemd æ—¶çš„ç‰¹æ€§ä¸€æ ·ï¼Œè¿™æœ‰åˆ©äºèŠ‚çº¦ç”µè„‘çš„è®¡ç®—èµ„æºã€‚</p>]]></content>
    
    
    <summary type="html">win11å®‰è£…wslå’ŒCentOS8Streamè™šæ‹Ÿæœº</summary>
    
    
    
    <category term="ç©ä¸ŠLinux" scheme="https://blog.musnow.top/categories/%E7%8E%A9%E4%B8%8ALinux/"/>
    
    
    <category term="Linux" scheme="https://blog.musnow.top/tags/Linux/"/>
    
    <category term="è™šæ‹Ÿæœº" scheme="https://blog.musnow.top/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>ã€ä¸ƒç‰›äº‘ã€‘artalkè¡¨æƒ…é‡åˆ°è·¨åŸŸè®¿é—®é—®é¢˜</title>
    <link href="https://blog.musnow.top/posts/489538601/"/>
    <id>https://blog.musnow.top/posts/489538601/</id>
    <published>2023-10-02T04:35:28.000Z</published>
    <updated>2023-10-02T04:35:28.000Z</updated>
    
    <content type="html"><![CDATA[<p>å¦‚é¢˜ï¼Œå½“æˆ‘åœ¨æˆ‘è‡ªå·±ç¼–å†™çš„æ–‡æ¡£ç«™ç‚¹ <a href="https://khl-py.eu.org/">https://khl-py.eu.org/</a> è®¿é—®æˆ‘çš„artalkæœåŠ¡æ—¶ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªartalkè¡¨æƒ…çš„è¯·æ±‚ï¼Œè¢«æµè§ˆå™¨çš„è·¨åŸŸç­–ç•¥ç»™æŒ¡ä½äº†ã€‚è¿™ä¼šå¯¼è‡´artalkè¯„è®ºä¸­æ— æ³•å‘é€è¡¨æƒ…ï¼ˆè™½ç„¶æ— ä¼¤å¤§é›…ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Access to fetch at &#x27;https://img.musnow.top/i/artalk-emoji.json&#x27; from origin &#x27;https://khl-py.eu.org&#x27; has been blocked by CORS policy: No &#x27;Access-Control-Allow-Origin&#x27; header is present on the requested resource. If an opaque response serves your needs, set the request&#x27;s mode to &#x27;no-cors&#x27; to fetch the resource with CORS disabled.</span><br></pre></td></tr></table></figure><p>ç™¾åº¦äº†ä¸€ä¸‹ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä¸ƒç‰›äº‘çš„CDNç­–ç•¥ä¸­è¿›è¡Œé…ç½®ï¼ˆæˆ‘çš„ä¸ƒç‰›äº‘KODOæ˜¯ç»‘å®šåˆ°CDNä¸Šï¼Œé€šè¿‡CDNè¿›è¡Œè®¿é—®çš„ï¼‰</p><p>æ‰¾åˆ°CDNç•Œé¢ä¸­çš„<strong>HTTPå“åº”å¤´é…ç½®</strong></p><p><img src="https://img.musnow.top/i/2023/10/6e1119859945ce9b07928a2bff2643d8.png" alt="image-20231002222846450"></p><p>ç‚¹å‡»ä¿®æ”¹é…ç½®ï¼Œæ·»åŠ å¦‚ä¸‹ä¸¤ç‚¹</p><p><img src="https://img.musnow.top/i/2023/10/6b3b5f2bc783ef6bf7cc614d5bc2a1e7.png" alt="image-20231002222920540"></p><p>ä¿å­˜åè¿‡ä¸€ä¼šï¼Œå°±ä¸ä¼šå‡ºç°è¿™ä¸ªè·¨åŸŸè®¿é—®é—®é¢˜äº†ã€‚è‡³äºè¿™éƒ¨åˆ†è®¾ç½®ä¼šä¸ä¼šå¯¼è‡´æœ‰äººç›—åˆ·ä½ çš„CDNæµé‡ï¼Œä»å¾…æ›´å¤šçš„è§‚å¯Ÿã€‚</p><p>å¦å¤–ï¼Œå¦‚æœä½ çš„CDNè¿˜å¼€å¯äº†é˜²ç›—é“¾ï¼Œè¿˜éœ€è¦æŠŠå¯¹åº”åŸŸåå¡«å…¥é˜²ç›—é“¾çš„ç™½åå•ä¸­ï¼</p>]]></content>
    
    
    <summary type="html">ä¸ƒç‰›äº‘å­˜æ”¾çš„artalkè¡¨æƒ…é‡åˆ°è·¨åŸŸè®¿é—®é—®é¢˜</summary>
    
    
    
    <category term="å·®ç”Ÿæ–‡å…·å¤š" scheme="https://blog.musnow.top/categories/%E5%B7%AE%E7%94%9F%E6%96%87%E5%85%B7%E5%A4%9A/"/>
    
    
    <category term="å›¾åºŠ" scheme="https://blog.musnow.top/tags/%E5%9B%BE%E5%BA%8A/"/>
    
  </entry>
  
  <entry>
    <title>ã€Cè¯­è¨€ã€‘clock_gettimeå‡½æ•°çš„ä½¿ç”¨</title>
    <link href="https://blog.musnow.top/posts/107825263/"/>
    <id>https://blog.musnow.top/posts/107825263/</id>
    <published>2023-09-27T12:41:59.000Z</published>
    <updated>2023-09-27T13:29:17.000Z</updated>
    
    <content type="html"><![CDATA[<p>å‡½æ•°çš„åŸºæœ¬ä¿¡æ¯å¦‚ä¸‹</p><ul><li>å…¶ä¸­ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯é…ç½®ä½ æƒ³è·å–ä»€ä¹ˆç±»å‹çš„æ—¶é—´</li><li>ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ª<strong>è¾“å‡ºå‹å‚æ•°</strong>ï¼Œä¼šå°†å½“å‰æ—¶é—´å­˜æ”¾åˆ°ä¸€ä¸ªç»“æ„ä½“é‡Œé¢ç»™ä½ è¿”å›ã€‚</li><li>è¿”å›å€¼æ ‡è¯†æ˜¯å¦è·å–æˆåŠŸ</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å¤´æ–‡ä»¶</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//å‡½æ•°åŸå‹</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">clock_gettime</span><span class="params">( <span class="type">clockid_t</span> clock_id,<span class="keyword">struct</span> timespec * tp )</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// timespec ç»“æ„ä½“</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">timespec</span> &#123;</span> </span><br><span class="line">    <span class="type">__time_t</span> tv_sec; <span class="comment">/* ç§’ */</span> </span><br><span class="line">    __syscall_s <span class="type">long_t</span> tv_nsec; <span class="comment">/* çº³ç§’ */</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ªå‚æ•°æœ‰ä¸‹é¢å‡ ç§é€‰é¡¹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CLOCK_REALTIME: æ˜¯æŒ‡ç³»ç»Ÿæ—¶é—´ï¼Œéšç€ç³»ç»Ÿæ—¶é—´çš„æ”¹å˜è€Œæ”¹å˜ã€‚ç³»ç»Ÿæ—¶é’Ÿä¼šè¢«ç”¨æˆ·è€Œæ”¹å˜ã€‚å¹¶éä¸å˜çš„æ—¶é—´æˆ³ã€‚</span><br><span class="line">CLOCK_MONOTONIC: æŒ‡ä»ç³»ç»Ÿå¯åŠ¨æ—¶å¼€å§‹è®¡æ—¶ã€‚ä¸å—ç³»ç»Ÿè®¾ç½®å½±å“ï¼Œä¹Ÿä¸ä¼šè¢«ç”¨æˆ·æ”¹å˜ã€‚</span><br><span class="line">CLOCK_PROCESS_CPUTIME_ID: æŒ‡è¿™ä¸ªè¿›ç¨‹è¿è¡Œåˆ°å½“å‰ä»£ç æ—¶ï¼ŒCPUèŠ±è´¹çš„æ—¶é—´ã€‚</span><br><span class="line">CLOCK_THREAD_CPUTIME_ID: æŒ‡è¿™ä¸ªçº¿ç¨‹è¿è¡Œåˆ°å½“å‰ä»£ç æ—¶ï¼ŒCPUèŠ±è´¹çš„æ—¶é—´ã€‚</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ä¾‹å­</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">timespec</span> <span class="title">now</span>;</span></span><br><span class="line"></span><br><span class="line">    clock_gettime(CLOCK_MONOTONIC,&amp;now);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Seconds = %ld \t Nanoseconds = %ld\n&quot;</span>,, now.tv_sec, now.tv_nsec);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Seconds = 29642          Nanoseconds = 751516090</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">clock_gettimeå‡½æ•°çš„ä½¿ç”¨</summary>
    
    
    
    <category term="åˆè¯†Cè¯­è¨€" scheme="https://blog.musnow.top/categories/%E5%88%9D%E8%AF%86C%E8%AF%AD%E8%A8%80/"/>
    
    
    <category term="Cè¯­è¨€" scheme="https://blog.musnow.top/tags/C%E8%AF%AD%E8%A8%80/"/>
    
  </entry>
  
  <entry>
    <title>ã€Linuxã€‘valgrindæ£€æµ‹ç¨‹åºå†…å­˜æ³„æ¼</title>
    <link href="https://blog.musnow.top/posts/565285228/"/>
    <id>https://blog.musnow.top/posts/565285228/</id>
    <published>2023-09-26T10:12:55.000Z</published>
    <updated>2023-09-26T10:12:55.000Z</updated>
    
    <content type="html"><![CDATA[<p>valgrindæ˜¯ä¸€ä¸ªç”¨äºæ£€æµ‹debugå†…å­˜æ³„æ¼çš„å‘½ä»¤è¡Œå·¥å…·</p><h1 id="å®‰è£…éµå¾ªå¦‚ä¸‹å‘½ä»¤"><a href="#å®‰è£…éµå¾ªå¦‚ä¸‹å‘½ä»¤" class="headerlink" title="å®‰è£…éµå¾ªå¦‚ä¸‹å‘½ä»¤"></a>å®‰è£…éµå¾ªå¦‚ä¸‹å‘½ä»¤</h1><h2 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://sourceware.org/pub/valgrind/valgrind-3.21.0.tar.bz2</span><br></pre></td></tr></table></figure><h2 id="è§£å‹"><a href="#è§£å‹" class="headerlink" title="è§£å‹"></a>è§£å‹</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tar -xf valgrind-3.21.0.tar.bz2</span><br><span class="line">cd valgrind-3.21.0</span><br></pre></td></tr></table></figure><h2 id="é…ç½®-x2F-å®‰è£…ï¼Œéœ€è¦æœ‰rootæƒé™"><a href="#é…ç½®-x2F-å®‰è£…ï¼Œéœ€è¦æœ‰rootæƒé™" class="headerlink" title="é…ç½®&#x2F;å®‰è£…ï¼Œéœ€è¦æœ‰rootæƒé™"></a>é…ç½®&#x2F;å®‰è£…ï¼Œéœ€è¦æœ‰rootæƒé™</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo ./configure</span><br><span class="line">sudo make</span><br><span class="line">sudo make install</span><br></pre></td></tr></table></figure><h1 id="ä½¿ç”¨mencheck"><a href="#ä½¿ç”¨mencheck" class="headerlink" title="ä½¿ç”¨mencheck"></a>ä½¿ç”¨mencheck</h1><p>mencheckæ˜¯valgrindçš„ä¸€ä¸ªæ¨¡å—ï¼Œå…¶è¿˜æ‹¥æœ‰å…¶ä»–åŠŸèƒ½ï¼Œä½†æ˜¯æˆ‘ä»¬åœ¨è¿™é‡Œä¸åšä½¿ç”¨<br>Â â€“tool&#x3D;memcheckÂ  é€‰æ‹©memcheckå·¥å…·<br>Â â€“log-file&#x3D;log.txtÂ  æŒ‡å®šæ—¥å¿—è¾“å‡ºæ–‡ä»¶åˆ°Â log.txtÂ <br>Â â€“leak-check&#x3D;no|summary|fullÂ  æŒ‡å®šè¾“å‡ºæ—¥å¿—çš„è¯¦ç»†ç¨‹åº¦</p><p>åŸºæœ¬ä½¿ç”¨å‘½ä»¤çš„ä¸€ä¸ªç¤ºä¾‹ï¼Œæœ€åçš„Â <code>./test</code>Â æ˜¯ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">valgrind --tool=memcheck --log-file=log.txt --leak-check=full ./test</span><br></pre></td></tr></table></figure><h2 id="è¯´æ˜"><a href="#è¯´æ˜" class="headerlink" title="è¯´æ˜"></a>è¯´æ˜</h2><p>memcheckæ¨¡å—æ£€æµ‹çš„èŒƒå›´åŒ…æ‹¬ </p><ul><li>ä½¿ç”¨æœªåˆå§‹åŒ–çš„å†…å­˜</li><li>ä½¿ç”¨å·²ç»è¢«é‡Šæ”¾çš„å†…å­˜</li><li>ä½¿ç”¨è¶…å‡ºmallocåˆ†é…ç©ºé—´çš„å†…å­˜</li><li>å¯¹å †æ ˆçš„éæ³•è®¿é—®</li><li>æ˜¯å¦æœ‰é‡Šæ”¾ç”³è¯·çš„ç©ºé—´</li><li>memcpyä¸­srcå’Œdstçš„é‡å ï¼ˆå‚æ•°çš„å†…å­˜ç©ºé—´æœ‰é‡åˆéƒ¨åˆ†ï¼‰</li></ul><p>æ³¨æ„ï¼Œå¯¹äºæŸäº›newå’Œmallocå‡ºæ¥çš„å¸¸é©»å¯¹è±¡ï¼ˆæ¯”å¦‚å…¨å±€çš„æŸä¸ªå¯¹è±¡ï¼Œå•ä¾‹æ¨¡å¼ä¸­å°±ä¼šé‡åˆ°ï¼‰å¹¶ä¸èƒ½ç®—ä½œå†…å­˜æ³„æ¼ï¼Œå› ä¸ºå®ƒæ˜¯éœ€è¦è¢«ä½¿ç”¨çš„ã€‚</p><h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><p>æ•´äº†ä¸ªæœ€ç®€å•çš„ä»£ç Â </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstddef&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;memory&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line">â€‹</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test_leak</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> *p = (<span class="type">int</span> *)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(<span class="type">int</span>));</span><br><span class="line">    *p = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line">â€‹</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> *p1 = (<span class="type">int</span> *)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(<span class="type">int</span>));</span><br><span class="line">    *p1 = <span class="number">2</span>;</span><br><span class="line">â€‹</span><br><span class="line">    <span class="type">int</span> *p2 = (<span class="type">int</span> *)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(<span class="type">int</span>));</span><br><span class="line">    *p2 = <span class="number">3</span>;</span><br><span class="line">    <span class="comment">// åªææ„ä¸€ä¸ªï¼Œçœ‹çœ‹èƒ½ä¸èƒ½æ£€æŸ¥å‡ºæŠ¥é”™</span></span><br><span class="line">    <span class="built_in">free</span>(p2);</span><br><span class="line">    <span class="built_in">test_leak</span>();<span class="comment">// åªæœ‰è°ƒç”¨çš„æ¨¡å—å‡ºç°å†…å­˜æ³„æ¼æ‰èƒ½è¢«æ£€æµ‹åˆ°</span></span><br><span class="line">    <span class="comment">// å¦‚æœä¸è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œåˆ™ä¸ä¼šæ£€æµ‹åˆ°è¿™é‡Œçš„é—®é¢˜</span></span><br><span class="line">    <span class="comment">// å› ä¸ºvalgrindæ˜¯æ“ä½œç›‘çœ‹å¯æ‰§è¡Œæ–‡ä»¶çš„ï¼Œå¹¶ä¸æ˜¯æ¥æ‰«æä»£ç çš„</span></span><br><span class="line">â€‹</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œé¢æœ‰3ä¸ªmallocï¼Œå…¶ä¸­æœ‰ä¸¤ä¸ªæ˜¯æ²¡æœ‰freeçš„ï¼Œé‚£ä¹ˆç”¨valgrindå¯ä»¥æ£€æµ‹å‡ºæ¥å—ï¼Ÿ</p><p>ç­”æ¡ˆæ˜¯è‚¯å®šçš„:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">==24089== Memcheck, a memory error detector</span><br><span class="line">==24089== Copyright (C) 2002-2022, and GNU GPL&#x27;d, by Julian Seward et al.</span><br><span class="line">==24089== Using Valgrind-3.21.0 and LibVEX; rerun with -h for copyright info</span><br><span class="line">==24089== Command: ./test</span><br><span class="line">==24089== Parent PID: 24056</span><br><span class="line">==24089== </span><br><span class="line">==24089== </span><br><span class="line">==24089== HEAP SUMMARY:</span><br><span class="line">==24089==     in use at exit: 8 bytes in 2 blocks</span><br><span class="line">==24089==   total heap usage: 4 allocs, 2 frees, 72,716 bytes allocated</span><br><span class="line">==24089== </span><br><span class="line">==24089== 4 bytes in 1 blocks are definitely lost in loss record 1 of 2</span><br><span class="line">==24089==    at 0x484880F: malloc (vg_replace_malloc.c:431)</span><br><span class="line">==24089==    by 0x1091F8: main (in /home/lyk/ub-vm/test)</span><br><span class="line">==24089== </span><br><span class="line">==24089== 4 bytes in 1 blocks are definitely lost in loss record 2 of 2</span><br><span class="line">==24089==    at 0x484880F: malloc (vg_replace_malloc.c:431)</span><br><span class="line">==24089==    by 0x1091C1: test_leak() (in /home/lyk/ub-vm/test)</span><br><span class="line">==24089==    by 0x10922C: main (in /home/lyk/ub-vm/test)</span><br><span class="line">==24089== </span><br><span class="line">==24089== LEAK SUMMARY:</span><br><span class="line">==24089==    definitely lost: 8 bytes in 2 blocks</span><br><span class="line">==24089==    indirectly lost: 0 bytes in 0 blocks</span><br><span class="line">==24089==      possibly lost: 0 bytes in 0 blocks</span><br><span class="line">==24089==    still reachable: 0 bytes in 0 blocks</span><br><span class="line">==24089==         suppressed: 0 bytes in 0 blocks</span><br><span class="line">==24089== </span><br><span class="line">==24089== For lists of detected and suppressed errors, rerun with: -s</span><br><span class="line">==24089== ERROR SUMMARY: 2 errors from 2 contexts (suppressed: 0 from 0)</span><br></pre></td></tr></table></figure><p>åœ¨æœ€åçš„summryé‡Œé¢å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œæç¤ºÂ <code>definitely lost</code>Â äº†8ä¸ªå­—èŠ‚ï¼Œè€Œä¸”æ˜¯åœ¨ä¸¤ä¸ªä¸åŒçš„åŒºå—ä¸­ä¸¢å¤±çš„ã€‚å’Œæˆ‘ä»¬çš„ä»£ç å»åˆã€‚</p><p>å¦‚æœä½ ä¸è°ƒç”¨Â  <code>test_leak()</code> Â å‡½æ•°ï¼Œé‚£ä¹ˆå°±ä¸ä¼šå‡ºç°ç¬¬äºŒæ¬¡çš„å†…å­˜æ³„æ¼ï¼ŒæŠ¥å‘Šä¼šå˜æˆåªæœ‰ Â <code>4 bytes in 1 blocks</code>Â ï¼Œå› ä¸ºvalgrindæ˜¯é€šè¿‡å¯æ‰§è¡Œæ–‡ä»¶æ¥æ£€æµ‹æ˜¯å¦æœ‰å†…å­˜æ³„æ¼çš„ï¼Œä»–ä¸ä¼šæ‰«æä½ çš„ä»£ç ï¼ˆé‚£æ ·çš„æˆæœ¬å¤ªé«˜äº†è€Œä¸”ä¸ä¸€å®šå‡†ç¡®ï¼ï¼‰</p>]]></content>
    
    
    <summary type="html">valgrindæ˜¯ä¸€ä¸ªç”¨äºæ£€æµ‹debugå†…å­˜æ³„æ¼çš„å‘½ä»¤è¡Œå·¥å…·</summary>
    
    
    
    <category term="ç©ä¸ŠLinux" scheme="https://blog.musnow.top/categories/%E7%8E%A9%E4%B8%8ALinux/"/>
    
    
    <category term="Linux" scheme="https://blog.musnow.top/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>ã€C++ã€‘C++17çš„é‚£äº›æ–°ç‰¹æ€§</title>
    <link href="https://blog.musnow.top/posts/3858168547/"/>
    <id>https://blog.musnow.top/posts/3858168547/</id>
    <published>2023-09-26T04:40:46.000Z</published>
    <updated>2023-09-26T04:40:46.000Z</updated>
    
    <content type="html"><![CDATA[<p>å­¦ä¹ C++17çš„æ–°ç‰¹æ€§</p><h1 id="1-æ„é€ å‡½æ•°æ¨¡æ¿æ¨å¯¼"><a href="#1-æ„é€ å‡½æ•°æ¨¡æ¿æ¨å¯¼" class="headerlink" title="1.æ„é€ å‡½æ•°æ¨¡æ¿æ¨å¯¼"></a>1.æ„é€ å‡½æ•°æ¨¡æ¿æ¨å¯¼</h1><p>åœ¨ä¹‹å‰ï¼Œæˆ‘ä»¬å¦‚æœæƒ³ç”¨stlå®¹å™¨ï¼Œéƒ½éœ€è¦ç”¨<code>&lt;&gt;</code> æ¥æ‰‹åŠ¨æŒ‡å®šå‚æ•°ç±»å‹ã€‚ä½†åœ¨C++17ä¸­ï¼Œæˆ‘ä»¬ä¸éœ€è¦è¿™ä¹ˆåšäº†ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    std::vector v1 = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>&#125;;</span><br><span class="line">    std::pair p1  = &#123;<span class="number">1</span>,<span class="number">2.4234</span>&#125;;</span><br><span class="line">    cout &lt;&lt; <span class="built_in">typeid</span>(v1).<span class="built_in">name</span>() &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; <span class="built_in">typeid</span>(p1).<span class="built_in">name</span>() &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨C++11ç¼–è¯‘ï¼Œè¿™ä¸ªä»£ç ä¼šæŠ¥é”™ã€‚æŠ¥é”™çš„æ„æ€æ˜¯è®©æˆ‘ä»¬æŒ‡å®šå‚æ•°çš„æ¨¡æ¿ç±»å‹ã€‚</p><p>æ¯”å¦‚ <code>std::pair p1  = &#123;1,2.4234&#125;;</code> åœ¨C++11ä¸­åº”è¯¥å†™æˆ <code>std::pair&lt;int,double&gt; p1  = &#123;1,2.4234&#125;;</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">test.cpp:16:10: error: use of class template &#x27;std::pair&#x27; requires template arguments</span><br><span class="line">    std::pair p1  = &#123;1,2.4234&#125;;</span><br><span class="line">         ^</span><br><span class="line">/usr/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/stl_pair.h:211:12: note: template is declared here</span><br><span class="line">    struct pair</span><br><span class="line">           ^</span><br><span class="line">3 errors generated.</span><br><span class="line">make: *** [makefile:3: test] Error 1</span><br></pre></td></tr></table></figure><p>åœ¨C++17ä¸­ï¼Œè¿™æ ·çš„å†™æ³•å°±æ˜¯å¯ä»¥è¢«é€šè¿‡çš„äº†ï¼Œä¹Ÿèƒ½æ­£å¸¸æ¨æ–­å‡ºå‚æ•°çš„ç±»å‹ï¼Œåˆ†åˆ«æ˜¯ä¸€ä¸ªintçš„vectorï¼Œå’Œä¸€ä¸ªint+doubleçš„pairï¼›</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ make</span><br><span class="line">clang++ test.cpp -o test -std=c++17</span><br><span class="line">$ ./test</span><br><span class="line">St6vectorIiSaIiEE</span><br><span class="line">St4pairIidE</span><br></pre></td></tr></table></figure><h1 id="2-ç»“æ„åŒ–ç»‘å®š"><a href="#2-ç»“æ„åŒ–ç»‘å®š" class="headerlink" title="2.ç»“æ„åŒ–ç»‘å®š"></a>2.ç»“æ„åŒ–ç»‘å®š</h1><p>æˆ‘ä»¬å¯ä»¥ç”¨ <code>auto[å˜é‡1,å˜é‡2]</code>çš„æ–¹å¼æ¥æ¥å—ä¸€ä¸ªtupleæˆ–è€…pairçš„è¿”å›å€¼ï¼Œå°†å…¶ç»‘å®šåˆ°ä¸¤ä¸ªä¸åŒçš„å˜é‡ä¸Šã€‚</p><p>tupleæ˜¯C++11æ–°å¢çš„ä¸€ä¸ªæ•°æ®ç»“æ„ï¼Œå®ƒå’Œpairçš„ç”¨æ³•ç±»ä¼¼ï¼Œä¸åŒçš„æ˜¯å…ƒç»„æ”¯æŒæ— æ•°ä¸ªå‚æ•°ã€‚è€Œpairä»…æ”¯æŒä¸¤ä¸ªã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">std::tuple&lt;<span class="type">int</span>, <span class="type">double</span>&gt; <span class="title">func_tuple</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> std::<span class="built_in">tuple</span>&lt;<span class="type">int</span>,<span class="type">double</span>&gt;(<span class="number">1</span>, <span class="number">2.2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">std::pair&lt;<span class="type">int</span>, <span class="type">double</span>&gt; <span class="title">func_pair</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="number">1</span>,<span class="number">2</span>&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> [i, d] = <span class="built_in">func_tuple</span>(); </span><br><span class="line">    cout &lt;&lt; <span class="built_in">typeid</span>(i).<span class="built_in">name</span>() &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; <span class="built_in">typeid</span>(d).<span class="built_in">name</span>() &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">auto</span> [x,y] = <span class="built_in">func_pair</span>();</span><br><span class="line">    cout &lt;&lt; <span class="built_in">typeid</span>(x).<span class="built_in">name</span>() &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; <span class="built_in">typeid</span>(y).<span class="built_in">name</span>() &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨C++11æ¥ç¼–è¯‘ï¼Œç¼–è¯‘å™¨ä¼šæŠ¥é”™ï¼Œä½†ç¼–è¯‘ä¾æ—§èƒ½æˆåŠŸã€‚è¿™æ˜¯å› ä¸ºæˆ‘ä»¬çš„ç¼–è¯‘å™¨æ˜¯æ”¯æŒC++17çš„ï¼Œä½†åˆè¢«æŒ‡å®šäº†<code>-std=c++11</code>ï¼Œæ‰€ä»¥ç»™ç”¨æˆ·æŠ¥äº†ä¸ªè­¦å‘Šï¼Œä½†æ²¡æœ‰æŠ¥é”™ï¼ˆå› ä¸ºè¿™ä¸ªè¯­æ³•åœ¨C++17é‡Œé¢æ˜¯æ­£ç¡®çš„ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">clang++ test.cpp -o test -std=c++11</span><br><span class="line">test.cpp:34:10: warning: decomposition declarations are a C++17 extension [-Wc++17-extensions]</span><br><span class="line">    auto [i, d] = func_tuple(); </span><br><span class="line">         ^~~~~~</span><br><span class="line">test.cpp:40:10: warning: decomposition declarations are a C++17 extension [-Wc++17-extensions]</span><br><span class="line">    auto [x,y] = func_pair();</span><br><span class="line">         ^~~~~</span><br><span class="line">2 warnings generated.</span><br></pre></td></tr></table></figure><p>è¿è¡Œè¾“å‡ºç»“æœå¦‚ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ ./test</span><br><span class="line">i</span><br><span class="line">d</span><br><span class="line"></span><br><span class="line">i</span><br><span class="line">d</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šç»“æ„åŒ–ç»‘å®šä¸èƒ½åº”ç”¨äºconstexprï¼</p><p>ç»“æ„åŒ–ç»‘å®šä¸æ­¢å¯ä»¥ç»‘å®špairå’Œtupleï¼Œè¿˜å¯ä»¥ç»‘å®šæ•°ç»„å’Œç»“æ„ä½“ç­‰ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ³¨æ„è¿™é‡Œçš„structçš„æˆå‘˜ä¸€å®šè¦æ˜¯publicçš„ï¼Œä¸ç„¶å¤–éƒ¨æ— æ³•è®¿é—®ï¼Œè¿˜æ€ä¹ˆç»‘å®šï¼Ÿ</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Point</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> x;</span><br><span class="line">    <span class="type">int</span> y;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿”å›å€¼æ˜¯pointçš„å‡½æ•°</span></span><br><span class="line"><span class="function">Point <span class="title">func</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="number">1</span>, <span class="number">2</span>&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> array[<span class="number">3</span>] = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;;</span><br><span class="line">    <span class="keyword">auto</span> [a, b, c] = array;</span><br><span class="line">    cout &lt;&lt; a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; b &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; c &lt;&lt; endl;</span><br><span class="line">    <span class="comment">// ç›´æ¥æ¨å¯¼å‡ºä¸¤ä¸ªæˆå‘˜å˜é‡å¹¶èµ‹å€¼ç»™å˜é‡xå’Œy</span></span><br><span class="line">    <span class="type">const</span> <span class="keyword">auto</span> [x, y] = <span class="built_in">func</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆåŠŸç¼–è¯‘å¹¶è¾“å‡ºç»“æœ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ make</span><br><span class="line">clang++ test.cpp -o test -std=c++17</span><br><span class="line">$ ./test</span><br><span class="line">1 2 3</span><br><span class="line">1 2</span><br></pre></td></tr></table></figure><p>è‡ªå®šä¹‰ç±»å‹ä¹Ÿèƒ½å®ç°ç»“æ„åŒ–ç»‘å®šï¼Œè¿™é‡Œä»ç½‘ä¸Šæ‰’äº†ä¸€ä¸ªä»£ç ä¸‹æ¥ï¼Œå°±ä¸è‡ªå·±åšæµ‹è¯•äº†</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// éœ€è¦å®ç°ç›¸å…³çš„tuple_sizeå’Œtuple_elementå’Œget&lt;N&gt;æ–¹æ³•ã€‚</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Entry</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        name_ = <span class="string">&quot;name&quot;</span>;</span><br><span class="line">        age_ = <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">std::string <span class="title">GetName</span><span class="params">()</span> <span class="type">const</span> </span>&#123; <span class="keyword">return</span> name_; &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">GetAge</span><span class="params">()</span> <span class="type">const</span> </span>&#123; <span class="keyword">return</span> age_; &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    std::string name_;</span><br><span class="line">    <span class="type">int</span> age_;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="type">size_t</span> I&gt;</span><br><span class="line"><span class="function"><span class="keyword">auto</span> <span class="title">get</span><span class="params">(<span class="type">const</span> Entry&amp; e)</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">if</span> <span class="title">constexpr</span> <span class="params">(I == <span class="number">0</span>)</span> <span class="keyword">return</span> e.<span class="title">GetName</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> <span class="built_in">constexpr</span> (I == <span class="number">1</span>) <span class="keyword">return</span> e.<span class="built_in">GetAge</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> std &#123;</span><br><span class="line">    <span class="keyword">template</span>&lt;&gt; <span class="keyword">struct</span> <span class="title class_">tuple_size</span>&lt;Entry&gt; : integral_constant&lt;<span class="type">size_t</span>, <span class="number">2</span>&gt; &#123;&#125;;</span><br><span class="line">    <span class="keyword">template</span>&lt;&gt; <span class="keyword">struct</span> <span class="title class_">tuple_element</span>&lt;<span class="number">0</span>, Entry&gt; &#123; <span class="keyword">using</span> type = std::string; &#125;;</span><br><span class="line">    <span class="keyword">template</span>&lt;&gt; <span class="keyword">struct</span> <span class="title class_">tuple_element</span>&lt;<span class="number">1</span>, Entry&gt; &#123; <span class="keyword">using</span> type = <span class="type">int</span>; &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Entry e;</span><br><span class="line">    e.<span class="built_in">Init</span>();</span><br><span class="line">    <span class="keyword">auto</span> [name, age] = e;</span><br><span class="line">    cout &lt;&lt; name &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; age &lt;&lt; endl; <span class="comment">// name 10</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="3-ifè¯­å¥æ–°å¢åˆå§‹æ¡ä»¶"><a href="#3-ifè¯­å¥æ–°å¢åˆå§‹æ¡ä»¶" class="headerlink" title="3.ifè¯­å¥æ–°å¢åˆå§‹æ¡ä»¶"></a>3.ifè¯­å¥æ–°å¢åˆå§‹æ¡ä»¶</h1><p>åœ¨ä¹‹å‰æˆ‘ä»¬éƒ½æ˜¯ç”¨ <code>if(åˆ¤æ–­æ¡ä»¶)</code> æ¥ä½¿ç”¨ifè¯­å¥çš„ï¼ŒC++17ä¸­ç»™ifæ–°å¢äº†ä¸€ä¸ªç±»ä¼¼forå¾ªç¯ä¸­ç¬¬ä¸€ä¸ªå‚æ•°çš„ç›¸åŒå‚æ•°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if(åˆå§‹åŒ–æ¡ä»¶,åˆ¤æ–­æ¡ä»¶)</span><br></pre></td></tr></table></figure><p>æ¯”å¦‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="type">int</span> i=<span class="number">20</span>;i&lt;<span class="number">39</span>)&#123;</span><br><span class="line">    cout &lt;&lt;<span class="string">&quot;i&lt;39!&quot;</span>&lt;&lt;endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œæ•ˆæœå¦‚ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ ./test</span><br><span class="line">i&lt;39!</span><br></pre></td></tr></table></figure><h1 id="4-å†…è”å˜é‡"><a href="#4-å†…è”å˜é‡" class="headerlink" title="4.å†…è”å˜é‡"></a>4.å†…è”å˜é‡</h1><p>åœ¨ä¹‹å‰æˆ‘ä»¬æƒ³åˆå§‹åŒ–ä¸€ä¸ªç±»ä¸­çš„staticå˜é‡ï¼Œéœ€è¦åœ¨ç±»ä¸­å®šä¹‰ï¼Œç±»å¤–åˆå§‹åŒ–ã€‚ä½†å¦‚æœæ˜¯constçš„staticå˜é‡ï¼Œå°±èƒ½ç›´æ¥åœ¨ç±»ä¸­é€šè¿‡ç¼ºçœå€¼çš„æ–¹å¼æ¥åˆå§‹åŒ–ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨å¤´æ–‡ä»¶é‡Œé¢è¿™æ ·æ˜¯èƒ½é€šè¿‡ç¼–è¯‘çš„ï¼Œä½†æ˜¯ä¸å»ºè®®åœ¨å¤´æ–‡ä»¶ä¸­åˆå§‹åŒ–staticå˜é‡ï¼Œä¼šäº§ç”ŸODRå†²çª:</span></span><br><span class="line"><span class="comment">// Variable &#x27;value&#x27; defined in a header file; variable definitions in header files can lead to ODR violations</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">A</span> &#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> value;  </span><br><span class="line">    <span class="type">static</span> <span class="type">const</span> <span class="type">int</span> value_c=<span class="number">10</span>;  <span class="comment">// constå¯ä»¥ç›´æ¥åˆå§‹åŒ–</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> A::value = <span class="number">10</span>;</span><br></pre></td></tr></table></figure><p>åœ¨C++17ä¸­å†…è”å˜é‡å¼•å…¥åï¼Œæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥å®ç°åœ¨å¤´æ–‡ä»¶ä¸­åˆå§‹åŒ–staticéconstå˜é‡ï¼Œæˆ–è€…ç›´æ¥ç”¨ç¼ºçœå€¼æ¥åˆå§‹åŒ–äº†</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">A</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> value;</span><br><span class="line">    <span class="type">static</span> <span class="type">const</span> <span class="type">int</span> value_c = <span class="number">10</span>;</span><br><span class="line">    <span class="comment">// static int value = 10;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">inline</span> <span class="type">int</span> A::value = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ========= æˆ–è€… ========</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">B</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">inline</span> <span class="type">static</span> <span class="type">int</span> value = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">inline</span> <span class="type">static</span> <span class="type">const</span> <span class="type">int</span> value_c = <span class="number">10</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ç›¸æ¯”äºåŸæœ¬staticå˜é‡åˆå§‹åŒ–éœ€è¦æ”¾åˆ°å¦å¤–ä¸€ä¸ªcppæºæ–‡ä»¶ä¸­ï¼Œè¿™ç§ç›´æ¥åœ¨å¤´æ–‡ä»¶é‡Œé¢å£°æ˜+åˆå§‹åŒ–çš„æ–¹å¼èƒ½æ›´å¥½çš„ç¡®å®šå˜é‡çš„åˆå§‹å€¼ã€‚</p><h1 id="5-æŠ˜å è¡¨è¾¾å¼"><a href="#5-æŠ˜å è¡¨è¾¾å¼" class="headerlink" title="5.æŠ˜å è¡¨è¾¾å¼"></a>5.æŠ˜å è¡¨è¾¾å¼</h1><p>C++17å¼•å…¥äº†æŠ˜å è¡¨è¾¾å¼ä½¿å¯å˜å‚æ•°æ¨¡æ¿ç¼–ç¨‹æ›´æ–¹ä¾¿ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> ... Ts&gt;</span><br><span class="line"><span class="function"><span class="keyword">auto</span> <span class="title">sum</span><span class="params">(Ts ... ts)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (ts + ...);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> a &#123;<span class="built_in">sum</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>)&#125;; <span class="comment">// 15</span></span><br><span class="line">std::string a&#123;<span class="string">&quot;hello &quot;</span>&#125;;</span><br><span class="line">std::string b&#123;<span class="string">&quot;world&quot;</span>&#125;;</span><br><span class="line">cout &lt;&lt; <span class="built_in">sum</span>(a, b) &lt;&lt; endl; <span class="comment">// hello world</span></span><br></pre></td></tr></table></figure><p>å®è¯è¯´ï¼Œå¯å˜æ¨¡æ¿å‚æ•°è¿™éƒ¨åˆ†å°±æ²¡æœ‰å¼„æ˜ç™½è¿‡ï¼Œå®é™…ä¸Šä¹Ÿæ²¡æœ‰ç”¨è¿‡ï¼Œç›´æ¥è·³è¿‡ï¼</p><h1 id="6-constexpr-lambdaè¡¨è¾¾å¼"><a href="#6-constexpr-lambdaè¡¨è¾¾å¼" class="headerlink" title="6.constexpr+lambdaè¡¨è¾¾å¼"></a>6.constexpr+lambdaè¡¨è¾¾å¼</h1><p>C++17å‰lambdaè¡¨è¾¾å¼åªèƒ½åœ¨è¿è¡Œæ—¶ä½¿ç”¨ï¼ŒC++17å¼•å…¥äº†constexpr lambdaè¡¨è¾¾å¼ï¼Œå¯ä»¥ç”¨äºåœ¨ç¼–è¯‘æœŸè¿›è¡Œè®¡ç®—ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">int main() &#123; // c++17å¯ç¼–è¯‘</span><br><span class="line">    constexpr auto lamb = [] (int n) &#123; return n * n; &#125;;</span><br><span class="line">    static_assert(lamb(3) == 9, &quot;a&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è§„åˆ™å’Œæ™®é€šçš„constexprå‡½æ•°ç›¸åŒï¼Œå‚è€ƒæˆ‘çš„C++11å’Œ14çš„æ–‡ç« ã€‚è¿™é‡Œåšç®€å•è¯´æ˜ï¼š</p><p>constexprä¿®é¥°çš„å‡½æ•°ä½“ä¸èƒ½åŒ…å«æ±‡ç¼–è¯­å¥ã€gotoè¯­å¥ã€labelã€tryå—ã€é™æ€å˜é‡ã€çº¿ç¨‹å±€éƒ¨å­˜å‚¨ã€æ²¡æœ‰åˆå§‹åŒ–çš„æ™®é€šå˜é‡ï¼Œä¸èƒ½åŠ¨æ€åˆ†é…å†…å­˜ï¼Œä¸èƒ½æœ‰new deleteç­‰ï¼Œä¸èƒ½è™šå‡½æ•°ã€‚</p><h1 id="7-åµŒå¥—å‘½åç©ºé—´"><a href="#7-åµŒå¥—å‘½åç©ºé—´" class="headerlink" title="7.åµŒå¥—å‘½åç©ºé—´"></a>7.åµŒå¥—å‘½åç©ºé—´</h1><p>åœ¨ä¹‹å‰å¦‚æœéœ€è¦åµŒå¥—å‘½åç©ºé—´ï¼Œéœ€è¦è¿™æ ·å†™</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> A &#123;</span><br><span class="line">    <span class="keyword">namespace</span> B &#123;</span><br><span class="line">        <span class="keyword">namespace</span> C &#123;</span><br><span class="line">            <span class="function"><span class="type">void</span> <span class="title">func</span><span class="params">()</span></span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>C++17ä¸­å¯ä»¥ç›´æ¥ç”¨ç±»ä¼¼è®¿é—®é™å®šç¬¦çš„æ–¹å¼ï¼Œå‰é¢åŠ ä¸€ä¸ªnamespaceæ¥æ ‡æ˜åµŒå¥—çš„å‘½åç©ºé—´ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// c++17ï¼Œæ–¹ä¾¿äº†ï¼Œå¯è¯»æ€§ä¹Ÿæ›´å¥½</span></span><br><span class="line"><span class="keyword">namespace</span> A::B::C &#123;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">func</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="8-has-includeé¢„å¤„ç†è¡¨è¾¾å¼"><a href="#8-has-includeé¢„å¤„ç†è¡¨è¾¾å¼" class="headerlink" title="8.__has_includeé¢„å¤„ç†è¡¨è¾¾å¼"></a>8.__has_includeé¢„å¤„ç†è¡¨è¾¾å¼</h1><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">if</span> defined __has_include <span class="comment">// åˆ¤æ–­æ˜¯å¦æ”¯æŒè¿™ä¸ªè¡¨è¾¾å¼</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> __has_include(<span class="string">&lt;charconv&gt;</span>) <span class="comment">// æ”¯æŒï¼Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨è¯¥å¤´æ–‡ä»¶</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> has_charconv 1 <span class="comment">// å¤´æ–‡ä»¶å­˜åœ¨ï¼Œå®šä¹‰ä¸€ä¸ªå®</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;charconv&gt;</span> <span class="comment">// å¼•ç”¨è¿™ä¸ªå¤´æ–‡ä»¶</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure><p>å¦‚æœä¸€ä¸ªä»£ç ä¼šåœ¨å¤šä¸ªä¸åŒçš„å¹³å°ä¸‹è·‘ï¼Œè¿™ä¸ªåŠŸèƒ½å°±å¾ˆé‡è¦ã€‚æ¯”å¦‚æˆ‘ä¹‹å‰å†™é¡¹ç›®çš„æ—¶å€™éœ€è¦ä½¿ç”¨åˆ°jsoncppï¼Œåœ¨centoså’Œdeepinä¸‹ï¼Œå®‰è£…jsoncppçš„includeè·¯å¾„æ˜¯ä¸åŒçš„</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//centos</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;json/json.h&gt;</span></span></span><br><span class="line"><span class="comment">//deepin</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;jsoncpp/json/json.h&gt;</span></span></span><br></pre></td></tr></table></figure><p>è¿™ç§åœºæ™¯ä¸‹å°±å¯ä»¥ä½¿ç”¨ä¸Šé¢æåˆ°çš„è¿™ä¸ªé¢„å¤„ç†è¡¨è¾¾å¼è¿›è¡Œåˆ¤æ–­ï¼Œæ¥ç¡®è®¤ä½ çš„jsoncppè·¯å¾„åˆ°åº•åœ¨å“ªé‡Œã€‚æ³¨æ„ï¼Œè¿™åªèƒ½è§£å†³ä»yumå’Œaptå®‰è£…çš„jsoncppï¼Œå¦‚æœæ˜¯è‡ªå·±æ‰‹åŠ¨å®‰è£…çš„ï¼Œé‚£é¬¼çŸ¥é“ä½ å®‰è£…åˆ°å“ªé‡Œå»äº†ï¼ŸğŸ¤£</p><p>æ‰€ä»¥å¾ˆå¤šå¤§å‹é¡¹ç›®å¦‚æœéœ€è¦ä½¿ç”¨jsoncppè¿™ç§ç¬¬ä¸‰æ–¹ä¾èµ–é¡¹ç›®ï¼Œä¸€èˆ¬éƒ½ä¼šé‡‡ç”¨<code>git submodule</code>çš„æ–¹å¼ï¼Œç›´æ¥å°†ç¬¬ä¸‰æ–¹åº“ä¸‹è½½åˆ°å½“å‰é¡¹ç›®è·¯å¾„ä¸‹ï¼Œä»¥é¿å…ä¸åŒå¹³å°çš„ä¾èµ–é¡¹<code>include</code>è·¯å¾„ä¸å¯¹è€Œå¯¼è‡´æ— æ³•ç¼–è¯‘ç¨‹åºçš„é—®é¢˜ã€‚</p><h1 id="9-thisæŒ‡é’ˆæ•è·ï¼ˆlambdaï¼‰"><a href="#9-thisæŒ‡é’ˆæ•è·ï¼ˆlambdaï¼‰" class="headerlink" title="9.thisæŒ‡é’ˆæ•è·ï¼ˆlambdaï¼‰"></a>9.thisæŒ‡é’ˆæ•è·ï¼ˆlambdaï¼‰</h1><p>åœ¨lambdaè¡¨è¾¾å¼ä¸­ï¼Œé‡‡ç”¨<code>[this]</code>æ–¹å¼æ•è·çš„thisæŒ‡é’ˆæ˜¯<strong>å€¼ä¼ é€’</strong>æ•è·çš„ï¼Œä½†åœ¨ä¸€äº›æƒ…å†µä¸‹ï¼Œä¼šå‡ºç°è®¿é—®å·²ç»è¢«é‡Šæ”¾äº†çš„ç©ºé—´çš„è¡Œä¸ºï¼›æ¯”å¦‚å¦‚ä¸‹ä»£ç </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;functional&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;memory&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Foo</span></span><br><span class="line">&#123;</span><br><span class="line">    std::unique_ptr&lt;<span class="type">int</span>&gt; p;</span><br><span class="line"></span><br><span class="line">    <span class="function">std::function&lt;<span class="title">void</span><span class="params">()</span>&gt; <span class="title">f</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        p.<span class="built_in">reset</span>(<span class="keyword">new</span> <span class="built_in">int</span>(<span class="number">10</span>));</span><br><span class="line">        <span class="keyword">return</span> [&amp;]</span><br><span class="line">        &#123;</span><br><span class="line">            cout &lt;&lt; <span class="number">5</span> &lt;&lt; endl;</span><br><span class="line">            cout &lt;&lt; *p &lt;&lt; endl; <span class="comment">// å®é™…ä¸Šæ˜¯è¿™ä¸€æ­¥æŠ¥é”™çš„</span></span><br><span class="line">            <span class="comment">// è¿™é‡Œå¯¹*pçš„è®¿é—®å¯ä»¥è§£æä¸º *(this-&gt;p)ï¼Œä½†å®é™…ä¸ŠthisæŒ‡é’ˆå·²ç»è¢«é”€æ¯äº†</span></span><br><span class="line">            <span class="comment">// æ³¨æ„ï¼Œè¿™é‡Œé‡‡ç”¨äº†æ™ºèƒ½æŒ‡é’ˆï¼Œä¸å­˜åœ¨å†…å­˜æ³„æ¼ï¼ŒpæŒ‡é’ˆæŒ‡å‘çš„ç©ºé—´ä¹Ÿè¢«é”€æ¯äº†</span></span><br><span class="line">            <span class="comment">// ä½†æˆ‘ä»¬çš„æŠ¥é”™å…¶å®æ˜¯å¯¹thisæŒ‡é’ˆè§£å¼•ç”¨çš„æ—¶å€™å°±æŠ›å‡ºäº†</span></span><br><span class="line">            cout &lt;&lt; <span class="number">6</span> &lt;&lt; endl;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> foo = <span class="keyword">new</span> <span class="built_in">Foo</span>();</span><br><span class="line">    cout &lt;&lt; <span class="number">1</span> &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">auto</span> f = foo-&gt;<span class="built_in">f</span>();  <span class="comment">// è·å–äº†ä¸€ä¸ªç±»å†…æˆå‘˜å‡½æ•°</span></span><br><span class="line">    cout &lt;&lt; <span class="number">2</span> &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">delete</span> foo;  <span class="comment">// é”€æ¯è¿™ä¸ªå¯¹è±¡</span></span><br><span class="line">    cout &lt;&lt; <span class="number">3</span> &lt;&lt; endl;</span><br><span class="line">    <span class="comment">// å°è¯•åœ¨é”€æ¯åç»§ç»­ä½¿ç”¨è¿™ä¸ªå¯¹è±¡ï¼Œæˆ‘ä»¬æ˜¯é€šè¿‡lambdaä¸­=æ•è·çš„thisæŒ‡é’ˆæ¥è®¿é—®å¯¹è±¡çš„</span></span><br><span class="line">    <span class="built_in">f</span>();  <span class="comment">// è¿™é‡Œç›´æ¥æŠ¥é”™äº† Segmentation fault (core dumped)</span></span><br><span class="line">    cout &lt;&lt; <span class="number">4</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œè¿™ä¸ªç¨‹åºï¼Œå¯ä»¥çœ‹åˆ°æ˜¯åœ¨<code>*p</code>çš„ä½ç½®æŠ¥é”™é€€å‡ºçš„ï¼›å…·ä½“çš„åŸå› å‚è€ƒä»£ç ä¸­çš„æ³¨é‡Šã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ ./test</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">5</span><br><span class="line">Segmentation fault (core dumped)</span><br></pre></td></tr></table></figure><p>éœ€è¦æ³¨æ„ï¼Œlambdaè¡¨è¾¾å¼ä¸­ï¼Œä½¿ç”¨&#x3D;å’Œ&amp;éƒ½ä¼šé»˜è®¤é‡‡ç”¨<strong>ä¼ å€¼æ•è·thisæŒ‡é’ˆ</strong>ï¼Œå› ä¸ºthisæŒ‡é’ˆæ˜¯å­˜åœ¨äºå‡½æ•°ä½œç”¨åŸŸä¸­çš„ä¸€ä¸ªéšè—å‚æ•°ï¼Œå¹¶ä¸æ˜¯ç‹¬ç«‹åœ¨æˆå‘˜å‡½æ•°å¤–çš„å˜é‡ï¼Œæ‰€ä»¥æ˜¯å¯ä»¥è¢«æ•æ‰åˆ°çš„ï¼›å¦å¤–ï¼ŒthisæŒ‡é’ˆæ˜¯ä¸èƒ½è¢«ä¼ å¼•ç”¨æ•è·çš„ï¼Œ<code>[&amp;this]</code> çš„å†™æ³•æ˜¯ä¸å…è®¸çš„ï¼›</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">clang++ test.cpp -o test -std=c++17</span><br><span class="line">test.cpp:84:18: error: &#x27;this&#x27; cannot be captured by reference</span><br><span class="line">        return [&amp;this]</span><br><span class="line">                 ^</span><br><span class="line">1 error generated.</span><br></pre></td></tr></table></figure><p>C++17ä¸­æä¾›äº†ä¸€ä¸ªç‰¹æ®Šçš„å†™æ³• <code>[*this]</code> é€šè¿‡ä¼ å€¼çš„æ–¹å¼æ•è·äº†å½“å‰å¯¹è±¡æœ¬èº«ï¼Œæ­¤æ—¶lambdaè¡¨è¾¾å¼ä¸­å­˜åœ¨çš„å°±æ˜¯ä¸€ä¸ªå¯¹è±¡çš„æ‹·è´ï¼Œå³ä¾¿å½“å‰å¯¹è±¡è¢«é”€æ¯äº†ï¼Œæˆ‘ä»¬ä¾æ—§å¯ä»¥é€šè¿‡è¿™ä¸ªæ‹·è´è®¿é—®åˆ°ç›®æ ‡ï¼›</p><p>ä»£ç ä¿®æ”¹å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;functional&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;memory&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Foo</span></span><br><span class="line">&#123;</span><br><span class="line">    std::shared_ptr&lt;<span class="type">int</span>&gt; p; <span class="comment">// ä¸èƒ½ç”¨unique_ptrï¼Œå› ä¸ºå®ƒçš„æ‹·è´æ„é€ å‡½æ•°æ˜¯è¢«deleteç¦æ­¢ä½¿ç”¨çš„</span></span><br><span class="line"></span><br><span class="line">    <span class="function">std::function&lt;<span class="title">void</span><span class="params">()</span>&gt; <span class="title">f</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        p.<span class="built_in">reset</span>(<span class="keyword">new</span> <span class="built_in">int</span>(<span class="number">10</span>));</span><br><span class="line">        <span class="keyword">return</span> [*<span class="keyword">this</span>]</span><br><span class="line">        &#123;</span><br><span class="line">            cout &lt;&lt; <span class="number">5</span> &lt;&lt; endl;</span><br><span class="line">            cout &lt;&lt; *p &lt;&lt; endl;</span><br><span class="line">            cout &lt;&lt; <span class="number">6</span> &lt;&lt; endl;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> foo = <span class="keyword">new</span> <span class="built_in">Foo</span>();</span><br><span class="line">    cout &lt;&lt; <span class="number">1</span> &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">auto</span> f = foo-&gt;<span class="built_in">f</span>();  <span class="comment">// è·å–äº†ä¸€ä¸ªç±»å†…æˆå‘˜å‡½æ•°</span></span><br><span class="line">    cout &lt;&lt; <span class="number">2</span> &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">delete</span> foo;  <span class="comment">// é”€æ¯è¿™ä¸ªå¯¹è±¡</span></span><br><span class="line">    cout &lt;&lt; <span class="number">3</span> &lt;&lt; endl;</span><br><span class="line">    <span class="comment">// å°è¯•åœ¨é”€æ¯åç»§ç»­ä½¿ç”¨è¿™ä¸ªå¯¹è±¡ï¼Œæˆ‘ä»¬æ˜¯é€šè¿‡lambdaä¸­=æ•è·çš„thisæŒ‡é’ˆæ¥è®¿é—®å¯¹è±¡çš„</span></span><br><span class="line">    <span class="built_in">f</span>();  <span class="comment">// è¿™é‡Œç›´æ¥æŠ¥é”™äº† Segmentation fault (core dumped)</span></span><br><span class="line">    cout &lt;&lt; <span class="number">4</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶é‡æ–°ç¼–è¯‘ï¼Œå°±èƒ½æˆåŠŸè®¿é—®åˆ°æŒ‡é’ˆpæŒ‡å‘çš„å¯¹è±¡äº†ï¼Œå¹¶ä¸å—fooå¯¹è±¡å·²ç»è¢«deleteçš„å½±å“ï¼›</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ ./test</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">5</span><br><span class="line">10</span><br><span class="line">6</span><br><span class="line">4</span><br></pre></td></tr></table></figure><h1 id="10-å­—ç¬¦ä¸²è½¬æ¢"><a href="#10-å­—ç¬¦ä¸²è½¬æ¢" class="headerlink" title="10.å­—ç¬¦ä¸²è½¬æ¢"></a>10.å­—ç¬¦ä¸²è½¬æ¢</h1><blockquote><p>æ²¡çœ‹æ‡‚è¿™ä¸¤ä¸ªå‡½æ•°æ˜¯å¹²å˜›çš„ï¼Œæ‰¾åˆ°çš„ä»£ç è¿ç¼–è¯‘éƒ½è¿‡ä¸å»ï¼Œè·³è¿‡å§</p></blockquote><p>æ–°å¢from_charså‡½æ•°å’Œto_charså‡½æ•°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://zh.cppreference.com/w/cpp/utility/from_chars</span><br><span class="line">https://blog.csdn.net/defaultbyzt/article/details/120151801</span><br></pre></td></tr></table></figure><h1 id="11-std-variant"><a href="#11-std-variant" class="headerlink" title="11.std::variant"></a>11.std::variant</h1><p>C++17å¢åŠ <code>std::variant</code>å®ç°ç±»ä¼¼unionçš„åŠŸèƒ½ï¼Œä½†å´æ¯”unionæ›´é«˜çº§ï¼Œä¸¾ä¸ªä¾‹å­unioné‡Œé¢ä¸èƒ½æœ‰stringè¿™ç§ç±»å‹ï¼Œä½†<code>std::variant</code>å´å¯ä»¥ï¼Œè¿˜å¯ä»¥æ”¯æŒæ›´å¤šå¤æ‚ç±»å‹ï¼Œå¦‚mapç­‰ï¼Œçœ‹ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123; <span class="comment">// c++17å¯ç¼–è¯‘</span></span><br><span class="line">    <span class="function">std::variant&lt;<span class="type">int</span>, std::string&gt; <span class="title">var</span><span class="params">(<span class="string">&quot;hello&quot;</span>)</span></span>;</span><br><span class="line">    cout &lt;&lt; var.<span class="built_in">index</span>() &lt;&lt; endl;</span><br><span class="line">    var = <span class="number">123</span>;</span><br><span class="line">    cout &lt;&lt; var.<span class="built_in">index</span>() &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        var = <span class="string">&quot;world&quot;</span>;</span><br><span class="line">        std::string str = std::<span class="built_in">get</span>&lt;std::string&gt;(var); <span class="comment">// é€šè¿‡ç±»å‹è·å–å€¼</span></span><br><span class="line">        var = <span class="number">3</span>;</span><br><span class="line">        <span class="type">int</span> i = std::<span class="built_in">get</span>&lt;<span class="number">0</span>&gt;(var); <span class="comment">// é€šè¿‡indexè·å–å¯¹åº”å€¼</span></span><br><span class="line">        cout &lt;&lt; str &lt;&lt; endl;</span><br><span class="line">        cout &lt;&lt; i &lt;&lt; endl;</span><br><span class="line">    &#125; <span class="built_in">catch</span>(...) &#123;</span><br><span class="line">        <span class="comment">// xxx;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šä¸€èˆ¬æƒ…å†µä¸‹variantçš„ç¬¬ä¸€ä¸ªç±»å‹ä¸€èˆ¬è¦æœ‰å¯¹åº”çš„æ„é€ å‡½æ•°ï¼Œå¦åˆ™ç¼–è¯‘å¤±è´¥ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">A</span> &#123;</span><br><span class="line">    <span class="built_in">A</span>(<span class="type">int</span> i)&#123;&#125;  </span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    std::variant&lt;A, <span class="type">int</span>&gt; var; <span class="comment">// ç¼–è¯‘å¤±è´¥</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚ä½•é¿å…è¿™ç§æƒ…å†µå‘¢ï¼Œå¯ä»¥ä½¿ç”¨<code>std::monostate</code>æ¥æ‰“ä¸ªæ¡©ï¼Œæ¨¡æ‹Ÿä¸€ä¸ªç©ºçŠ¶æ€ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">std::variant&lt;std::monostate, A&gt; var; <span class="comment">// å¯ä»¥ç¼–è¯‘æˆåŠŸ</span></span><br></pre></td></tr></table></figure><h2 id="12-std-optional"><a href="#12-std-optional" class="headerlink" title="12.std::optional"></a>12.std::optional</h2><p><a href="https://en.cppreference.com/w/cpp/utility/optional">https://en.cppreference.com/w/cpp/utility/optional</a></p><p>æœ‰çš„æ—¶å€™ï¼Œæˆ‘ä»¬æƒ³åœ¨å¼‚å¸¸çš„æ—¶å€™æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸çš„å¯¹è±¡ï¼Œäº¦æˆ–è€…æ˜¯åœ¨å‡ºç°ä¸€äº›ä¸å¯é¢„æœŸçš„é”™è¯¯çš„æ—¶å€™ï¼Œè¿”å›ä¸€ä¸ªç©ºå€¼ã€‚è¦æ€ä¹ˆåŒºåˆ†ç©ºå€¼å’Œå¼‚å¸¸çš„å¯¹è±¡å‘¢ï¼Ÿ</p><p>åœ¨pythonä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªä¸“é—¨çš„Noneå¯¹è±¡å¯ä»¥æ¥å¤„ç†è¿™ä»¶äº‹ã€‚åœ¨MySQLä¸­ï¼Œæˆ‘ä»¬ä¹Ÿæœ‰NULLæ¥æ ‡è¯†ç©ºï¼›ä½†åœ¨CPPä¸­ï¼Œæˆ‘ä»¬åªå‰©ä¸‹ä¸€ä¸ª<code>nullptr</code>ï¼Œå…¶æœ¬è´¨æ˜¯ä¸ª<strong>æŒ‡é’ˆ</strong>ï¼Œä¸Pyä¸­çš„Noneå’ŒMySQLä¸­çš„NULLå®Œå…¨ä¸åŒï¼å¦‚æœæƒ³ç”¨æŒ‡é’ˆæ¥åŒºåˆ†ç©ºå’Œå¼‚å¸¸å¯¹è±¡ï¼Œé‚£å°±éœ€è¦ç”¨åˆ°åŠ¨æ€å†…å­˜ç®¡ç†ï¼Œäº¦æˆ–è€…æ˜¯ç”¨æ™ºèƒ½æŒ‡é’ˆæ¥é¿å…å†…å­˜æ³„æ¼ã€‚</p><p>è¯´äººè¯å°±æ˜¯ï¼Œåœ¨CPPä¸­æ²¡æœ‰ä¸€ä¸ªç±»ä¼¼Noneçš„å«ä¹‰ä¸ºç©ºçš„å¯¹è±¡ï¼Œæ¥å‘Šè¯‰è°ƒç”¨è¿™ä¸ªç¨‹åºçš„äººï¼Œåˆ°åº•æ˜¯å‘ç”Ÿäº†é”™è¯¯ï¼Œç”Ÿæˆäº†ä¸€ä¸ªé”™è¯¯çš„å¯¹è±¡ï¼Œè¿˜æ˜¯è¯´å‹æ ¹ä»€ä¹ˆéƒ½æ²¡æœ‰å¼„å‡ºæ¥ã€‚</p><p>äºæ˜¯<code>std::optional</code>å°±å‡ºç°äº†ï¼Œå…¶å¯ä»¥åŒ…å«ä¸€ä¸ªç±»å‹ï¼Œå¹¶æœ‰<code>std::nullopt</code>æ¥ä¸“é—¨æ ‡è¯†â€œç©ºâ€è¿™ä¸ªå«ä¹‰ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;optional&gt;</span></span></span><br><span class="line"><span class="function">std::optional&lt;<span class="type">int</span>&gt; <span class="title">StoI</span><span class="params">(<span class="type">const</span> std::string &amp;s)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> std::<span class="built_in">stoi</span>(s);</span><br><span class="line">    &#125; <span class="built_in">catch</span>(...) &#123;</span><br><span class="line">        <span class="keyword">return</span> std::<span class="literal">nullopt</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">func</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    std::string s&#123;<span class="string">&quot;123&quot;</span>&#125;;</span><br><span class="line">    std::optional&lt;<span class="type">int</span>&gt; o = <span class="built_in">StoI</span>(s);</span><br><span class="line">    <span class="keyword">if</span> (o) &#123;</span><br><span class="line">        cout &lt;&lt; *o &lt;&lt; endl;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;error&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬è¿›è¡Œäº†ifçš„åˆ¤æ–­ï¼Œé¦–å…ˆåˆ¤æ–­å˜é‡oæœ¬èº«ï¼Œä¸ºçœŸä»£è¡¨çš„ç¡®è¿”å›äº†ä¸€ä¸ªintå€¼ï¼Œä¸ºå‡ä»£è¡¨è¿”å›çš„æ˜¯<code>nullopt</code>ï¼›</p><p>éšåå†ä½¿ç”¨<code>*o</code>æ¥è®¿é—®åˆ°å†…éƒ¨æ‰˜ç®¡çš„æˆå‘˜ã€‚</p><p>éœ€è¦æ³¨æ„è¿™é‡Œæ˜¯ä¸¤å±‚çš„é€»è¾‘å…³ç³»ï¼Œåªæœ‰optionalå¯¹è±¡ä¸­æˆåŠŸæ‰˜ç®¡äº†ä¸€ä¸ªæŒ‡å®šçš„å‚æ•°ç±»å‹ï¼Œå…¶æœ¬èº«æ‰æ˜¯çœŸçš„ã€‚å¦‚æœæƒ³è®¿é—®å®ƒæ‰˜ç®¡çš„å¯¹è±¡ï¼Œåˆ™éœ€è¦ç”¨è§£å¼•ç”¨ã€‚</p><p>æ¯”å¦‚è¿™é‡Œï¼Œæˆ‘ä»¬çš„oå¯¹è±¡æ‰˜ç®¡çš„æ˜¯ä¸€ä¸ªboolç±»å‹çš„å‡ï¼Œä½†å‡å¹¶ä¸ä»£è¡¨ç©ºï¼Œoå¯¹è±¡æœ¬èº«çš„åˆ¤æ–­æ˜¯çœŸï¼Œå†…éƒ¨å¯¹<code>*o</code>çš„åˆ¤æ–­æ‰æ˜¯åˆ¤æ–­æ‰˜ç®¡çš„boolå€¼åˆ°åº•æ˜¯çœŸæ˜¯å‡ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;optional&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    std::optional&lt;<span class="type">bool</span>&gt; o = <span class="literal">false</span>;</span><br><span class="line">    cout &lt;&lt; <span class="built_in">typeid</span>(o).<span class="built_in">name</span>() &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">if</span> (o) <span class="comment">// è¿™é‡Œåˆ¤æ–­çš„æ˜¯optionalå¯¹è±¡æ˜¯å¦æœ‰æ‰˜ç®¡ä¸€ä¸ªboolå€¼</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(*o)&#123; <span class="comment">// è¿™é‡Œåˆ¤æ–­çš„æ˜¯æ‰˜ç®¡çš„boolå€¼æœ¬èº«</span></span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;true&quot;</span> &lt;&lt; endl;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;false&quot;</span> &lt;&lt; endl;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123; <span class="comment">// è¿™é‡Œåˆ™ä»£è¡¨æ‰˜ç®¡çš„æ˜¯nullopt</span></span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;error&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆè¿è¡Œæ‰“å°çš„ç»“æœæ˜¯<code>false</code>ï¼›</p><h1 id="13-std-any"><a href="#13-std-any" class="headerlink" title="13.std::any"></a>13.std::any</h1><p><a href="https://en.cppreference.com/w/cpp/utility/any">https://en.cppreference.com/w/cpp/utility/any</a></p><p>è¿™ä¸ªç±»å‹å¯ä»¥æ‰˜ç®¡ä»»æ„ç±»å‹çš„å€¼ï¼Œä¸ä¹‹å¯¹åº”çš„è¿˜æœ‰ä¸€ä¸ª<code>std::any_cast</code>æ¥å°†å…¶æ‰˜ç®¡çš„å€¼è½¬æˆæˆ‘ä»¬éœ€è¦çš„ç±»å‹ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;any&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123; <span class="comment">// c++17å¯ç¼–è¯‘</span></span><br><span class="line">    std::any a = <span class="number">1</span>;</span><br><span class="line">    cout &lt;&lt; a.<span class="built_in">type</span>().<span class="built_in">name</span>() &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; std::<span class="built_in">any_cast</span>&lt;<span class="type">int</span>&gt;(a) &lt;&lt; endl;</span><br><span class="line">    a = <span class="number">2.2f</span>;</span><br><span class="line">    cout &lt;&lt; a.<span class="built_in">type</span>().<span class="built_in">name</span>() &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; std::<span class="built_in">any_cast</span>&lt;<span class="type">float</span>&gt;(a) &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">if</span> (a.<span class="built_in">has_value</span>()) &#123;</span><br><span class="line">        cout &lt;&lt; a.<span class="built_in">type</span>().<span class="built_in">name</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    a.<span class="built_in">reset</span>();</span><br><span class="line">    <span class="keyword">if</span> (a.<span class="built_in">has_value</span>()) &#123;</span><br><span class="line">        cout &lt;&lt; a.<span class="built_in">type</span>().<span class="built_in">name</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    a = std::<span class="built_in">string</span>(<span class="string">&quot;a&quot;</span>);</span><br><span class="line">    cout &lt;&lt; a.<span class="built_in">type</span>().<span class="built_in">name</span>() &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; std::<span class="built_in">any_cast</span>&lt;std::string&gt;(a) &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœå¦‚ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">i 1</span><br><span class="line">f 2.2</span><br><span class="line">fNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE a</span><br></pre></td></tr></table></figure><p>è™½ç„¶anyçš„å‡ºç°è®©cppä¹Ÿåœ¨ä¸€å®šç¨‹åº¦ä¸Šèƒ½å®ç°â€œå¼±ç±»å‹â€å˜é‡ï¼Œä½†åœ¨å…·ä½“çš„å¼€å‘ä¸­ï¼Œæ˜ç¡®å˜é‡çš„ç±»å‹ä¾æ—§æ¯”ä½¿ç”¨anyå¥½å¾—å¤šã€‚ç‰¹åˆ«æ˜¯åœ¨å˜é‡çš„ç±»å‹å¹¶ä¸å¯ä»¥è¢«ç›´æ¥è½¬æ¢çš„æƒ…å†µä¸‹ã€‚</p><h1 id="14-std-apply"><a href="#14-std-apply" class="headerlink" title="14.std::apply"></a>14.std::apply</h1><p>ä½¿ç”¨<code>std::apply</code>å¯ä»¥å°†tupleå±•å¼€ä½œä¸ºå‡½æ•°çš„å‚æ•°ä¼ å…¥ï¼Œè§ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;tuple&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">add</span><span class="params">(<span class="type">int</span> first, <span class="type">int</span> second)</span> </span>&#123; <span class="keyword">return</span> first + second; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> add_lambda = [](<span class="keyword">auto</span> first, <span class="keyword">auto</span> second) &#123; <span class="keyword">return</span> first + second; &#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    std::cout &lt;&lt; std::<span class="built_in">apply</span>(add, std::<span class="built_in">pair</span>(<span class="number">1</span>, <span class="number">2</span>)) &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    std::cout &lt;&lt; <span class="built_in">add</span>(std::<span class="built_in">pair</span>(<span class="number">1</span>, <span class="number">2</span>)) &lt;&lt; <span class="string">&quot;\n&quot;</span>; <span class="comment">// error</span></span><br><span class="line">    std::cout &lt;&lt; std::<span class="built_in">apply</span>(add_lambda, std::<span class="built_in">tuple</span>(<span class="number">2.0f</span>, <span class="number">3.0f</span>)) &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="15-std-make-from-tuple"><a href="#15-std-make-from-tuple" class="headerlink" title="15.std::make_from_tuple"></a>15.std::make_from_tuple</h1><p>ä½¿ç”¨make_from_tupleå¯ä»¥å°†tupleå±•å¼€ä½œä¸ºæ„é€ å‡½æ•°å‚æ•°</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Foo</span> &#123;</span><br><span class="line">    <span class="built_in">Foo</span>(<span class="type">int</span> first, <span class="type">float</span> second, <span class="type">int</span> third) &#123;</span><br><span class="line">        std::cout &lt;&lt; first &lt;&lt; <span class="string">&quot;, &quot;</span> &lt;&lt; second &lt;&lt; <span class="string">&quot;, &quot;</span> &lt;&lt; third &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">   <span class="keyword">auto</span> tuple = std::<span class="built_in">make_tuple</span>(<span class="number">42</span>, <span class="number">3.14f</span>, <span class="number">0</span>);</span><br><span class="line">   std::<span class="built_in">make_from_tuple</span>&lt;Foo&gt;(std::<span class="built_in">move</span>(tuple));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="16-std-string-view"><a href="#16-std-string-view" class="headerlink" title="16.std::string_view"></a>16.std::string_view</h1><p><a href="https://zhuanlan.zhihu.com/p/166359481">https://zhuanlan.zhihu.com/p/166359481</a></p><p><a href="https://en.cppreference.com/w/cpp/string/basic_string_view">https://en.cppreference.com/w/cpp/string/basic_string_view</a></p><p>å¦‚æœæˆ‘ä»¬åªéœ€è¦ä¸€ä¸ªstringçš„åªè¯»ç±»å‹çš„è¯ï¼Œå¯ä»¥ç”¨string_viewæ¥æ‰˜ç®¡ã€‚å…¶å†…éƒ¨åªåŒ…å«ä¸€ä¸ªæŒ‡å‘ç›®æ ‡å­—ç¬¦ä¸²çš„æŒ‡é’ˆï¼Œä»¥åŠå­—ç¬¦ä¸²çš„é•¿åº¦ã€‚</p><p>string_viewå†…éƒ¨å°è£…äº†stringçš„æ‰€æœ‰åªè¯»æ¥å£ï¼Œæœ¬æ¥å°±æ˜¯ç»™ä½ è¯»çš„ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå› ä¸ºå†…éƒ¨åªæœ‰ä¸€ä¸ªæŒ‡é’ˆï¼Œæ‰€ä»¥å½“string_viewæ‰˜ç®¡çš„stringè¢«é”€æ¯äº†ï¼Œä¸ä¹‹å…³è”çš„æ‰€æœ‰string_viewéƒ½ä¼šå¤±æ•ˆï¼åŒæ ·æ˜¯å› ä¸ºå†…éƒ¨åªæœ‰ä¸€ä¸ªæŒ‡é’ˆå’Œå­—ç¬¦ä¸²çš„é•¿åº¦ä¸¤ä¸ªå˜é‡ï¼Œæ‰€ä»¥åœ¨ä¼ å€¼æ‹·è´çš„æ—¶å€™ï¼Œstring_viewçš„æ•ˆç‡ä¼šé«˜å¾ˆå¤šã€‚</p><ul><li>è¿™å’Œ<code>const string&amp;</code> ç±»å‹çš„ä¼ å€¼åˆæœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿä¼ å¼•ç”¨ä¸æ˜¯ä¹Ÿæ²¡æœ‰æ‹·è´æ¶ˆè€—å—ï¼Ÿ</li></ul><p>è¿™ä¸ªé—®é¢˜å¾ˆå¥½ï¼Œæˆ‘ä¸çŸ¥é“ï¼ç™¾åº¦ä¹Ÿæ²¡æœ‰ç™¾åº¦å‡ºæ¥â€¦â€¦</p><p>æˆ‘èƒ½æƒ³åˆ°çš„å°±æ˜¯ç”¨<code>string_view</code>ä½œä¸ºå‚æ•°çš„æ—¶å€™ï¼Œå¦‚æœå…¥å‚æ˜¯ä¸€ä¸ªå¸¸é‡å­—ç¬¦ä¸²ï¼Œæ­¤æ—¶ä¸éœ€è¦æ„é€ stringï¼Œè€Œä½¿ç”¨<code>const string&amp;</code> æ¥å—å¸¸é‡å­—ç¬¦ä¸²çš„æ—¶å€™ä¾æ—§éœ€è¦æ„é€ ä¸€ä¸ªstringå¯¹è±¡ã€‚è¿™éƒ¨åˆ†å°±ä¼šæœ‰ä¸€å®šçš„æ¶ˆè€—ã€‚</p><h1 id="17-as-const"><a href="#17-as-const" class="headerlink" title="17.as_const"></a>17.as_const</h1><p>C++17ä½¿ç”¨as_constå¯ä»¥å°†å·¦å€¼è½¬æˆconstç±»å‹</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">std::string str = <span class="string">&quot;str&quot;</span>;</span><br><span class="line"><span class="type">const</span> std::string&amp; constStr = std::<span class="built_in">as_const</span>(str);</span><br></pre></td></tr></table></figure><h1 id="18-file-system"><a href="#18-file-system" class="headerlink" title="18.file_system"></a>18.file_system</h1><p>C++17æ­£å¼å°†file_systemçº³å…¥æ ‡å‡†ä¸­ï¼Œæä¾›äº†å…³äºæ–‡ä»¶çš„å¤§å¤šæ•°åŠŸèƒ½ï¼ŒåŸºæœ¬ä¸Šåº”æœ‰å°½æœ‰ï¼Œè¿™é‡Œç®€å•ä¸¾å‡ ä¸ªä¾‹å­ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> fs = std::filesystem;</span><br><span class="line">fs::<span class="built_in">create_directory</span>(dir_path); <span class="comment">// åˆ›å»ºæ–‡ä»¶æˆ–è€…è·¯å¾„</span></span><br><span class="line">fs::<span class="built_in">copy_file</span>(src, dst, fs::copy_options::skip_existing); <span class="comment">// æ–‡ä»¶cp</span></span><br><span class="line">fs::<span class="built_in">exists</span>(filename); <span class="comment">// æ–‡ä»¶æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">fs::<span class="built_in">current_path</span>(err_code); <span class="comment">// è·å–å½“å‰è·¯å¾„</span></span><br></pre></td></tr></table></figure><h1 id="19-shared-mutex"><a href="#19-shared-mutex" class="headerlink" title="19.shared_mutex"></a>19.shared_mutex</h1><p>è¿™ç©æ„æ˜¯ä¸ªè¯»å†™é”ã€‚ç®€å•ä»‹ç»ä¸€ä¸‹ä»€ä¹ˆæ˜¯è¯»å†™é”ï¼š</p><ul><li>è¯»è€…å¯ä»¥æœ‰å¤šä¸ªï¼Œå†™è€…åªèƒ½æœ‰ä¸€ä¸ª</li><li>å†™é”æ˜¯äº’æ–¥çš„ï¼Œå¦‚æœAæœ‰é”ï¼ŒBæƒ³æ‹¿é”å°±å¾—é˜»å¡ç­‰å¾…</li><li>è¯»é”æ˜¯å…±äº«çš„ï¼ŒCæœ‰è¯»é”ï¼ŒDä¹Ÿæƒ³è¯»ï¼Œä¸¤ä¸ªäººå¯ä»¥ä¸€èµ·çœ‹</li><li>è¯»å†™é”æ˜¯äº’æ–¥çš„ï¼Œæœ‰äººå†™çš„æ—¶å€™ä¸èƒ½è¯»ï¼Œæœ‰äººè¯»çš„æ—¶å€™ä¸èƒ½å†™</li></ul><p>æ¢åˆ°ä¸“ä¸šæœ¯è¯­ä¸Šï¼Œå°±æ˜¯åˆ†ä¸ºç‹¬å é”ï¼ˆå†™é”ï¼‰å’Œå…±äº«é”ï¼ˆè¯»é”ï¼‰ï¼›</p><p>åœ¨C++14ä¸­å…¶å®å·²ç»æœ‰äº†ä¸€ä¸ª<code>shared_timed_mutex</code>ï¼ŒC++17ä¸­è¿™ä¸ªé”çš„æ“ä½œä¸å…¶åŸºæœ¬ä¸€è‡´ï¼Œåªä¸è¿‡å¤šäº†å‡ ä¸ªå’Œæ—¶é—´ç›¸å…³çš„æ¥å£</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">try_lock_for</span>(...);</span><br><span class="line"><span class="built_in">try_lock_shared_for</span>(...);</span><br><span class="line"><span class="built_in">try_lock_shared_until</span>(...);</span><br><span class="line"><span class="built_in">try_lock_until</span>(...);</span><br></pre></td></tr></table></figure><p>å…·ä½“ä½¿ç”¨å¯ä»¥å‚è€ƒ </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://zh.cppreference.com/w/cpp/thread/shared_mutex</span><br><span class="line">https://zhuanlan.zhihu.com/p/610781321</span><br></pre></td></tr></table></figure><h1 id="The-end"><a href="#The-end" class="headerlink" title="The end"></a>The end</h1><p>å…³äºC++17å¸¸ç”¨çš„åŸºæœ¬å°±æ˜¯è¿™äº›äº†ï¼Œåç»­é‡åˆ°æ–°çš„å†æ›´æ–°æœ¬æ–‡ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;å­¦ä¹ C++17çš„æ–°ç‰¹æ€§&lt;/p&gt;
&lt;h1 id=&quot;1-æ„é€ å‡½æ•°æ¨¡æ¿æ¨å¯¼&quot;&gt;&lt;a href=&quot;#1-æ„é€ å‡½æ•°æ¨¡æ¿æ¨å¯¼&quot; class=&quot;headerlink&quot; title=&quot;1.æ„é€ å‡½æ•°æ¨¡æ¿æ¨å¯¼&quot;&gt;&lt;/a&gt;1.æ„é€ å‡½æ•°æ¨¡æ¿æ¨å¯¼&lt;/h1&gt;&lt;p&gt;åœ¨ä¹‹å‰ï¼Œæˆ‘ä»¬å¦‚æœæƒ³ç”¨stlå®¹å™¨ï¼Œéƒ½éœ€è¦</summary>
      
    
    
    
    <category term="é‡è§C++" scheme="https://blog.musnow.top/categories/%E9%81%87%E8%A7%81C/"/>
    
    
    <category term="C++" scheme="https://blog.musnow.top/tags/C/"/>
    
    <category term="æ•°æ®ç»“æ„" scheme="https://blog.musnow.top/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
    <category term="C++17" scheme="https://blog.musnow.top/tags/C-17/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢ç»ã€‘230915ä¸Šæµ·æˆç£ç½‘ç»œç§‘æŠ€C/LINUXå®ä¹ ç”Ÿ</title>
    <link href="https://blog.musnow.top/posts/2553205100/"/>
    <id>https://blog.musnow.top/posts/2553205100/</id>
    <published>2023-09-15T06:50:14.000Z</published>
    <updated>2023-09-15T06:50:14.000Z</updated>
    
    <content type="html"><![CDATA[<p>10åˆ†é’Ÿå°±é¢å®Œäº†ï¼Œå ªç§°æ€¥é€Ÿï¼Œé¢è¯•å®˜è¯´æˆ‘ç­”çš„ä¸é”™ï¼›è€Œä¸”ä¸Šæ¥è‡ªæˆ‘ä»‹ç»å®Œæ¯•åå°±é—®é—®é¢˜ï¼Œä¸å¤šæ¯”æ¯”ğŸ¤£</p><span id="more"></span><h1 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h1><h2 id="1-Linuxä¸‹çº¿ç¨‹äº’æ–¥æ€ä¹ˆå®ç°"><a href="#1-Linuxä¸‹çº¿ç¨‹äº’æ–¥æ€ä¹ˆå®ç°" class="headerlink" title="1.Linuxä¸‹çº¿ç¨‹äº’æ–¥æ€ä¹ˆå®ç°"></a>1.Linuxä¸‹çº¿ç¨‹äº’æ–¥æ€ä¹ˆå®ç°</h2><p>åŠ é”ï¼Œpthreadï¼Œç„¶åæˆ‘è¿˜æåˆ°äº†cppçš„åŸå­å˜é‡</p><p><a href="https://blog.musnow.top/posts/1309150756/">https://blog.musnow.top/posts/1309150756/</a></p><h2 id="2-CPPå¤šæ€æ€ä¹ˆå®ç°"><a href="#2-CPPå¤šæ€æ€ä¹ˆå®ç°" class="headerlink" title="2.CPPå¤šæ€æ€ä¹ˆå®ç°"></a>2.CPPå¤šæ€æ€ä¹ˆå®ç°</h2><p>è™šå‡½æ•°è¡¨ï¼Œå·´æ‹‰å·´æ‹‰</p><p><a href="https://blog.musnow.top/posts/3933786088/">https://blog.musnow.top/posts/3933786088/</a></p><h2 id="3-CPPä¸ºå•¥è¦å¼•å…¥æ¨¡æ¿"><a href="#3-CPPä¸ºå•¥è¦å¼•å…¥æ¨¡æ¿" class="headerlink" title="3.CPPä¸ºå•¥è¦å¼•å…¥æ¨¡æ¿"></a>3.CPPä¸ºå•¥è¦å¼•å…¥æ¨¡æ¿</h2><p>ä»£ç æ›´é«˜å¤ç”¨</p><p><a href="https://blog.musnow.top/posts/2940029419/">https://blog.musnow.top/posts/2940029419/</a></p><h2 id="4-NATæ€ä¹ˆå®ç°çš„ï¼Ÿ"><a href="#4-NATæ€ä¹ˆå®ç°çš„ï¼Ÿ" class="headerlink" title="4.NATæ€ä¹ˆå®ç°çš„ï¼Ÿ"></a>4.NATæ€ä¹ˆå®ç°çš„ï¼Ÿ</h2><p>è½¬åŒ–è¡¨ï¼ŒIPåœ°å€æ›¿æ¢ï¼Œå·´æ‹‰å·´æ‹‰å§è¯´ä¸€å¤§å †</p><p><a href="https://blog.musnow.top/posts/3482559497/">https://blog.musnow.top/posts/3482559497/</a></p><h2 id="5-è¿›ç¨‹é€šä¿¡"><a href="#5-è¿›ç¨‹é€šä¿¡" class="headerlink" title="5.è¿›ç¨‹é€šä¿¡"></a>5.è¿›ç¨‹é€šä¿¡</h2><p>è€é—®é¢˜äº†</p><h2 id="6-inet-ntoaå‡½æ•°çŸ¥é“å—ï¼Ÿè¿ç»­è°ƒç”¨ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ"><a href="#6-inet-ntoaå‡½æ•°çŸ¥é“å—ï¼Ÿè¿ç»­è°ƒç”¨ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ" class="headerlink" title="6.inet_ntoaå‡½æ•°çŸ¥é“å—ï¼Ÿè¿ç»­è°ƒç”¨ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ"></a>6.inet_ntoaå‡½æ•°çŸ¥é“å—ï¼Ÿè¿ç»­è°ƒç”¨ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ</h2><blockquote><p>è¿™æ˜¯æœ€åä¸€ä¸ªé—®é¢˜ï¼Œé¢è¯•å®˜è¯´æˆ‘ç­”çš„æŒºå¥½çš„</p></blockquote><p>æˆ‘å…ˆè¯´äº†è¿™ä¸ªå‡½æ•°æ˜¯ç”¨äº16ä½IPåœ°å€å’Œå­—ç¬¦ä¸²çš„è½¬æ¢çš„ï¼›</p><p>ç„¶åé¢è¯•å®˜è¿™é‡Œé—®äº†ä¸€ä¸ªä¸šåŠ¡ä¸Šçš„é—®é¢˜</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%s %s\n&quot;</span>,<span class="built_in">inet_ntoa</span>(x),<span class="built_in">inet_ntoa</span>(y));<span class="comment">// xå’Œyæ˜¯ä¸¤ä¸ªipåœ°å€</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå‡½æ•°ä¼šä¸ä¼šæœ‰ä»€ä¹ˆé”™è¯¯çš„åœ°æ–¹ï¼Ÿ</p><blockquote><p>è¯·æ³¨æ„ï¼Œè¿™é‡Œæ˜¯é¢è¯•æ—¶å€™çš„æè¿°ï¼Œé¢è¯•å®˜è‚¯å®šåªèƒ½ç»™ä½ æè¿°ä¸ªå¤§æ¦‚çš„ï¼Œå¹¶ä¸ä¼šç»†è‡´åˆ°å…·ä½“çš„ä¼ å‚åº”è¯¥ä¼ ä»€ä¹ˆç±»å‹çš„å˜é‡ï¼Œæ‰€ä»¥ä¼ å‚xå’Œyä¹Ÿåªæ˜¯ä¸ªä¼ªä»£ç ï¼Œæƒ³é—®çš„åœ°æ–¹ä¸åœ¨è¿™é‡Œï¼</p></blockquote><p>è¿™é‡Œæˆ‘è¯´äº†<code>inet_ntoa</code>æ˜¯é‡‡ç”¨staticå˜é‡æ¥è¿”å›ipå­—ç¬¦ä¸²çš„ï¼Œçº¿ç¨‹ä¸å®‰å…¨ï¼Œæœ‰å¯èƒ½ä¸¤ä¸ªè°ƒç”¨æœ€ç»ˆè¿”å›äº†ä¸€ä¸ªç›¸åŒçš„IPåœ°å€ï¼Œåˆæ˜è¯´äº†æˆ‘ä¸ç¡®å®šï¼›ï¼ˆè‚¯å®šæœ‰é—®é¢˜ï¼Œä¸ç„¶é—®ä½ å¹²å˜›ï¼Ÿï¼‰</p><hr><p>é¢è¯•ç»“æŸäº†ï¼Œæ¥æµ‹è¯•ä¸€ä¸‹åˆ°åº•æ˜¯å•¥æƒ…å†µå§ï¼</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;netinet/in.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">in_addr</span> ip1;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">in_addr</span> ip2;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">inet_aton</span>(<span class="string">&quot;192.168.3.1&quot;</span>,&amp;ip1);</span><br><span class="line">    <span class="built_in">inet_aton</span>(<span class="string">&quot;10.161.33.42&quot;</span>,&amp;ip2);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s %s\n&quot;</span>,<span class="built_in">inet_ntoa</span>(ip1),<span class="built_in">inet_ntoa</span>(ip2));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼Œä¸¤ä¸ªIPåœ°å€è¿”å›äº†åŒä¸€ä¸ªï¼Œæˆ‘çŒœå¯¹äº†ï¼›</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ ./test</span><br><span class="line">192.168.3.1 192.168.3.1</span><br></pre></td></tr></table></figure><p>ä¸ºä»€ä¹ˆå‘¢ï¼Ÿæ‰“å°ä¸€ä¸‹åœ°å€ï¼Œä¼šå¾—åˆ°å¦‚ä¸‹è¾“å‡ºï¼Œä¸¤æ¬¡è°ƒç”¨è¿”å›äº†ç›¸åŒçš„åœ°å€ï¼Œè‡ªç„¶æ‰“å°å‡ºæ¥çš„ç»“æœç›¸åŒï¼›</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%x %x\n&quot;</span>,<span class="built_in">inet_ntoa</span>(ip1),<span class="built_in">inet_ntoa</span>(ip2));</span><br><span class="line"><span class="comment">//68db1ef0 68db1ef0</span></span><br></pre></td></tr></table></figure><p>å¯¹äºè¿™ä¸ªå‡½æ•°è€Œè¨€ï¼Œå®ƒéœ€è¦ç»™æˆ‘ä»¬è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œåˆå¿…é¡»ä¿è¯è¿™ä¸ªå­—ç¬¦ä¸²èƒ½åœ¨å‡½æ•°å¤–è¢«æ­£å¸¸è®¿é—®ï¼ˆä¸èƒ½è¢«é‡Šæ”¾ï¼‰ï¼Œå†åŠ ä¸Šè¿™æ˜¯ä¸€ä¸ªCè¯­è¨€æ¥å£ï¼Œé‚£ä¹ˆå°±åªæœ‰ä¸‰ç§æ–¹æ¡ˆäº†</p><ul><li>å‡½æ•°é‡Œé¢mallocï¼Œéœ€è¦ç”¨æˆ·æ‰‹åŠ¨free</li><li>staticå˜é‡</li><li>è®©ç”¨æˆ·ä¼ å…¥ä¸€ä¸ªæœ‰æ•ˆçš„åœ°å€ï¼Œå°†æ•°æ®å†™å…¥ä½œä¸ºè¾“å‡ºå‹å‚æ•°</li></ul><p>ç¬¬ä¸€ä¸ªæ–¹æ¡ˆè‚¯å®šæ˜¯ä¸å¯è¡Œçš„ï¼è¿™ç›¸å½“äºå®˜æ–¹æä¾›äº†ä¸€ä¸ª<strong>æå…¶å®¹æ˜“å¯¼è‡´å†…å­˜æ³„æ¼</strong>çš„æ¥å£ï¼è¿™ä¸å¾—è¢«å¼€å‘è€…å–·æ­»ï¼Ÿæ¯”å¦‚æœ¬é¢˜æåˆ°çš„åœºæ™¯é‡Œé¢å°±æ˜¯ä¸¤æ¬¡printfè€Œå·²ï¼Œé™¤æ­¤ä¹‹å¤–æ²¡æœ‰ä¿å­˜è¿™ä¸ªè¿”å›å€¼ï¼Œæ›´åˆ«æfreeäº†ï¼Œè¿™é‡Œå°±ç›´æ¥ä¸¤æ¬¡å†…å­˜æ³„æ¼äº†ï¼</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%s %s\n&quot;</span>,inet_ntoa(ip1),inet_ntoa(ip2));</span><br><span class="line"><span class="comment">// å¦‚æœç”¨mallocåçš„å­—ç¬¦ä¸²åœ°å€åšè¿”å›å€¼ï¼Œè¿™é‡Œå°±æ˜¯ä¸¤ä¸ªå†…å­˜æ³„æ¼</span></span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰ä¸ªæ–¹æ¡ˆä¹Ÿä¸æ–¹ä¾¿ï¼Œç³»ç»Ÿä¾èµ–ç”¨æˆ·ä¼ å…¥ä¸€ä¸ªæ•°ç»„çš„å…¥å‚ï¼Œæˆ‘ä»¬çŸ¥é“ipv4çš„IPåœ°å€å­—ç¬¦ä¸²æœ€é•¿æ˜¯<code>3*4+3=15</code>ä½ï¼Œé‚£ä¹ˆå¦‚æœç”¨æˆ·åªä¼ å…¥ä¸€ä¸ª<code>char arr[12]</code>å‘¢ï¼Ÿè¶Šç•Œè®¿é—®çš„é—®é¢˜æ€ä¹ˆè§£å†³ï¼Ÿç›¸å½“äºç³»ç»Ÿä¹‹ä¸­ä¾æ—§ä¼šå‡ºç°å‚æ•°ä¸åŒ¹é…è€Œå¯èƒ½å¯¼è‡´çš„åœ°å€è®¿é—®é”™è¯¯ï¼</p><p><strong>è€Œè¿™ä¸ªå‡½æ•°æœ¬èº«çš„å·¥ä½œå¾ˆç®€å•ï¼Œå®Œå…¨æ²¡å¿…è¦å¼„é‚£ä¹ˆå¤æ‚</strong>ï¼›</p><p>æœ€ç»ˆlinuxç³»ç»Ÿé‡‡ç”¨äº†staticå˜é‡çš„æ–¹å¼ï¼Œæ¥è¿”å›è¿™ä¸ªIPåœ°å€çš„å­—ç¬¦ä¸²ï¼›manæ‰‹å†Œé‡Œé¢æ˜¯è¿™ä¹ˆè¯´çš„ï¼Œç›´æ¥çœ‹æœ€åä¸€å¥ï¼Œç¿»è¯‘è¿‡æ¥çš„æ„æ€æ˜¯<strong>åç»­çš„è°ƒç”¨ä¼šè¦†ç›–æ‰å‰é¢çš„å€¼</strong>ï¼›</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> The inet_ntoa() function converts the Internet host address in, </span><br><span class="line"> given in network byte order, to a string in IPv4 dotted-decimal notation.  </span><br><span class="line"> The string  is returned in a statically allocated buffer,</span><br><span class="line">which subsequent calls will overwrite.</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥æœ€ç»ˆæˆ‘ä»¬çœ‹åˆ°çš„ç»“æœå°±æ˜¯ä¸¤æ¬¡æ‰“å°å‡ºäº†ç›¸åŒçš„IPåœ°å€ï¼›</p><p>è¿™é‡Œè¿˜æ¶‰åŠåˆ°ç¬¬äºŒä¸ªçŸ¥è¯†ç‚¹ï¼Œ<a href="https://blog.musnow.top/posts/3888883052/">printfçš„ä¼ å‚é¡ºåº</a>;</p><p>ç®€å•è¯´æ¥å°±æ˜¯printfæ˜¯ä»å³å¾€å·¦æ‰§è¡Œçš„ï¼ˆå…¶å®æ‰€æœ‰å‡½æ•°çš„ä¼ å‚éƒ½æ˜¯è¿™æ ·ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆç¼ºçœå€¼è¦ä»å³è¾¹å¾€å·¦ç»™ï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%s %s\n&quot;</span>,<span class="built_in">inet_ntoa</span>(ip1),<span class="built_in">inet_ntoa</span>(ip2));</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„æ‰§è¡Œé¡ºåºå¦‚ä¸‹</p><ul><li>ip2ç»“æ„ä½“ä¼ ç»™å‡½æ•°ï¼Œè½¬æˆipåœ°å€å­—ç¬¦ä¸²åå­˜åœ¨staticå˜é‡ä¸­</li><li>ip1ç»“æ„ä½“ä¼ ç»™å‡½æ•°ï¼Œè½¬æˆipåœ°å€å­—ç¬¦ä¸²åå­˜åœ¨äº†staticå˜é‡ä¸­ï¼Œè¦†ç›–äº†ip2çš„ç»“æœ</li></ul><p>æœ€ç»ˆæ‰“å°å‡ºæ¥çš„ä¸¤ä¸ªå­—ç¬¦ä¸²éƒ½æ˜¯ip1çš„åœ°å€ï¼</p><p>å¯¹äº<code>inet_aton</code>å‡½æ•°è€Œè¨€ï¼Œ<strong>æ­£ç¡®çš„è°ƒç”¨</strong>åŠæ³•æ˜¯æ¯æ¬¡è°ƒç”¨åéƒ½å–èµ°è¿”å›çš„IPåœ°å€å­—ç¬¦ä¸²ï¼Œå¯ä»¥ç”¨<code>std::string</code>æ¥æ”¶ï¼Œä¹Ÿå¯ä»¥ç”¨strcmpæ‹·è´åˆ°ä¸€ä¸ªè‡ªå·±å®šä¹‰çš„å­—ç¬¦ä¸²æ•°ç»„å˜é‡ä¸­ï¼›</p><p>ä½ å­¦ä¼šäº†å—ï¼Œéªšå¹´ï¼Ÿ</p><blockquote><p><code>inet_aton</code>è¿™ä¸ªå‡½æ•°æœ€æ—©å‡ºç°äºæœ¬ç«™çš„æ­¤åšå®¢ï¼š<a href="https://blog.musnow.top/posts/368672249/">ã€Linuxã€‘æ¥å†™ä¸€ä¸ªudpçš„æœåŠ¡ç«¯+å®¢æˆ·ç«¯</a></p></blockquote><h1 id="é¡¹ç›®"><a href="#é¡¹ç›®" class="headerlink" title="é¡¹ç›®"></a>é¡¹ç›®</h1><p>å› ä¸ºæ˜¯cppçš„å²—ä½ï¼Œæ‰€ä»¥æ²¡æœ‰é—®pythonçš„æœºå™¨äººé¡¹ç›®é—®é¢˜ï¼›</p><h2 id="1-è§†é¢‘ç‚¹æ’­ä¼ ä¸€åŠå…³é—­äº†æ€ä¹ˆè§£å†³"><a href="#1-è§†é¢‘ç‚¹æ’­ä¼ ä¸€åŠå…³é—­äº†æ€ä¹ˆè§£å†³" class="headerlink" title="1.è§†é¢‘ç‚¹æ’­ä¼ ä¸€åŠå…³é—­äº†æ€ä¹ˆè§£å†³"></a>1.è§†é¢‘ç‚¹æ’­ä¼ ä¸€åŠå…³é—­äº†æ€ä¹ˆè§£å†³</h2><p>ä¸¤æ¬¡é¢è¯•éƒ½é—®åˆ°äº†è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘æåˆ°äº†å°†æ–°çš„æ–‡ä»¶å’Œæœ¬åœ°å·²æœ‰æ–‡ä»¶è¿›è¡Œæ ¡éªŒï¼Œè·³è¿‡å·²æœ‰æ•°æ®</p><h2 id="2-ä¼ ä¸€åŠå‰©ä¸‹çš„æ•°æ®åç«¯æ€ä¹ˆå¤„ç†ï¼Œä»€ä¹ˆæ—¶å€™åˆ é™¤ï¼Ÿ"><a href="#2-ä¼ ä¸€åŠå‰©ä¸‹çš„æ•°æ®åç«¯æ€ä¹ˆå¤„ç†ï¼Œä»€ä¹ˆæ—¶å€™åˆ é™¤ï¼Ÿ" class="headerlink" title="2.ä¼ ä¸€åŠå‰©ä¸‹çš„æ•°æ®åç«¯æ€ä¹ˆå¤„ç†ï¼Œä»€ä¹ˆæ—¶å€™åˆ é™¤ï¼Ÿ"></a>2.ä¼ ä¸€åŠå‰©ä¸‹çš„æ•°æ®åç«¯æ€ä¹ˆå¤„ç†ï¼Œä»€ä¹ˆæ—¶å€™åˆ é™¤ï¼Ÿ</h2><p>æˆ‘æåˆ°äº†å‰åç«¯ç”¨md5éªŒè¯æ¥ç¡®è®¤è§†é¢‘æ–‡ä»¶æ— è¯¯ï¼Œå¦‚æœæœ‰é—®é¢˜ï¼Œå¯ä»¥è®¾ç½®ä¸€ä¸ªå®šæ—¶å™¨ï¼Œä¸€å°æ—¶ååˆ é™¤é”™è¯¯çš„æ•°æ®</p><h2 id="3-ç”¨æˆ·ä¿®æ”¹äº†è§†é¢‘åä¸Šä¼ æ€ä¹ˆå¤„ç†ï¼Ÿ"><a href="#3-ç”¨æˆ·ä¿®æ”¹äº†è§†é¢‘åä¸Šä¼ æ€ä¹ˆå¤„ç†ï¼Ÿ" class="headerlink" title="3.ç”¨æˆ·ä¿®æ”¹äº†è§†é¢‘åä¸Šä¼ æ€ä¹ˆå¤„ç†ï¼Ÿ"></a>3.ç”¨æˆ·ä¿®æ”¹äº†è§†é¢‘åä¸Šä¼ æ€ä¹ˆå¤„ç†ï¼Ÿ</h2><p>åŒç¬¬ä¸€ä¸ªï¼Œè¿›è¡Œä¸€å®šçš„æ•°æ®æ ¡éªŒï¼Œç„¶åå†å¤å†™æ²¡æœ‰çš„æ•°æ®ï¼›</p><blockquote><p>ç„¶è€Œè¿™äº›åŠŸèƒ½æˆ‘ä¸€ä¸ªéƒ½æ²¡æœ‰å®ç°ğŸ¤£</p></blockquote><h1 id="æ•ˆç‡"><a href="#æ•ˆç‡" class="headerlink" title="æ•ˆç‡"></a>æ•ˆç‡</h1><p>é¢ç»è¿˜æ²¡å†™å®Œï¼Œç»“æœå·²ç»å‡ºå•¦ï¼Œè¿‡äº†åˆè¯•ï¼ä½†æ˜¯è¦çº¿ä¸‹å¤è¯•ï¼›</p>]]></content>
    
    
    <summary type="html">230915ä¸Šæµ·æˆç£ç½‘ç»œç§‘æŠ€C/LINUXå®ä¹ ç”Ÿ</summary>
    
    
    
    <category term="æ±‚èŒè·¯ä¸Šä¸€å»ä¸å¤è¿”" scheme="https://blog.musnow.top/categories/%E6%B1%82%E8%81%8C%E8%B7%AF%E4%B8%8A%E4%B8%80%E5%8E%BB%E4%B8%8D%E5%A4%8D%E8%BF%94/"/>
    
    
    <category term="é¢ç»" scheme="https://blog.musnow.top/tags/%E9%9D%A2%E7%BB%8F/"/>
    
  </entry>
  
  <entry>
    <title>ã€MySQLã€‘å­—èŠ‚è·³åŠ¨MySQLè¿ç¯40é—®</title>
    <link href="https://blog.musnow.top/posts/3873856211/"/>
    <id>https://blog.musnow.top/posts/3873856211/</id>
    <published>2023-09-15T00:52:14.000Z</published>
    <updated>2023-09-15T00:52:30.000Z</updated>
    
    <content type="html"><![CDATA[<p>å­—èŠ‚MySQLè¿ç¯40é—®ï¼Œç½‘å›¾</p><span id="more"></span><p><img src="https://img.musnow.top/i/2023/09/188abb653b96cb823385befe4c196698.jpg" alt="QQå›¾ç‰‡20230915081943"></p><p>è™½ç„¶æ„Ÿè§‰è¿™ç©æ„å’Œå­—èŠ‚è·³åŠ¨æ²¡å…³ç³»ï¼Œä½†æ˜¯ç®¡ä»–çš„ï¼Ÿç›´æ¥å¼€å§‹å›ç­”ï¼</p><h1 id="1-MySQLä¸­æœ‰å“ªå‡ ç§é”ï¼Ÿ"><a href="#1-MySQLä¸­æœ‰å“ªå‡ ç§é”ï¼Ÿ" class="headerlink" title="1.MySQLä¸­æœ‰å“ªå‡ ç§é”ï¼Ÿ"></a>1.MySQLä¸­æœ‰å“ªå‡ ç§é”ï¼Ÿ</h1><blockquote><p>ä¼šçš„ä¸å…¨ï¼Œæ‰€ä»¥æŸ¥çš„GPT</p></blockquote><p>MySQLä¸­æœ‰å¤šç§ç±»å‹çš„é”ï¼Œä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ç§ï¼š</p><ol><li>å…±äº«é”ï¼ˆShared Lockï¼‰ï¼šä¹Ÿç§°ä¸º<strong>è¯»é”</strong>ï¼Œå¤šä¸ªä¼šè¯å¯ä»¥åŒæ—¶æŒæœ‰å…±äº«é”ï¼Œå¹¶ä¸”ä¸äº’æ–¥ã€‚å…±äº«é”é€‚ç”¨äºè¯»å–æ“ä½œï¼Œå¤šä¸ªä¼šè¯å¯ä»¥å¹¶å‘è¯»å–åŒä¸€ä»½æ•°æ®è€Œä¸ä¼šäº§ç”Ÿå†²çªã€‚</li><li>æ’ä»–é”ï¼ˆExclusive Lockï¼‰ï¼šä¹Ÿç§°ä¸º<strong>å†™é”</strong>ï¼Œæ’ä»–é”ä¸å…¶ä»–ä»»ä½•é”éƒ½äº’æ–¥ï¼Œåªæœ‰ä¸€ä¸ªä¼šè¯å¯ä»¥æŒæœ‰æ’ä»–é”ã€‚æ’ä»–é”é€‚ç”¨äºå†™å…¥æˆ–ä¿®æ”¹æ“ä½œï¼Œç¡®ä¿åœ¨æŸä¸ªä¼šè¯æŒæœ‰æ’ä»–é”çš„æ—¶å€™ï¼Œå…¶ä»–ä¼šè¯æ— æ³•åŒæ—¶è¿›è¡Œå†™å…¥æ“ä½œã€‚</li><li>è®°å½•é”ï¼ˆRecord Lockï¼‰ï¼šè®°å½•é”ï¼ˆ<strong>è¡Œé”</strong>ï¼‰æ˜¯é’ˆå¯¹æŸæ¡è®°å½•çš„é”å®šï¼Œç”¨äºä¿æŠ¤ç‰¹å®šè®°å½•çš„å®Œæ•´æ€§ã€‚åœ¨ä½¿ç”¨InnoDBå­˜å‚¨å¼•æ“æ—¶ï¼Œè¯»å–æˆ–ä¿®æ”¹æŸæ¡è®°å½•æ—¶ä¼šè‡ªåŠ¨ç»™è¯¥è®°å½•åŠ ä¸Šè®°å½•é”ï¼Œå…¶ä»–ä¼šè¯åˆ™æ— æ³•å¯¹è¯¥è®°å½•è¿›è¡Œå¹¶å‘å†™å…¥æˆ–åˆ é™¤æ“ä½œã€‚</li><li>Gapé”ï¼šGapé”æ˜¯InnoDBå¼•æ“çš„ä¸€ç§é”æœºåˆ¶ï¼Œ<strong>ç”¨äºé˜²æ­¢å¹»è¯»</strong>ã€‚å®ƒé”å®šäº†ä¸€ä¸ªèŒƒå›´ï¼Œä½†ä¸åŒ…å«å®é™…çš„è®°å½•ï¼Œç”¨äºé˜²æ­¢å…¶ä»–ä¼šè¯åœ¨è¿™ä¸ªèŒƒå›´å†…æ’å…¥æ–°è®°å½•ï¼Œä»¥é¿å…å¹»è¯»ç°è±¡çš„å‘ç”Ÿã€‚</li><li>è¡¨é”ï¼ˆTable Lockï¼‰ï¼šè¡¨é”æ˜¯å¯¹æ•´ä¸ªè¡¨æ ¼è¿›è¡Œé”å®šï¼Œå¯ä»¥åœ¨æŸäº›ç‰¹æ®Šæƒ…å†µä¸‹ä½¿ç”¨ï¼Œä½†ä¼šé˜»å¡å…¶ä»–ä¼šè¯çš„è¯»å–å’Œå†™å…¥æ“ä½œã€‚åœ¨éœ€è¦å¹¶å‘è¯»å†™çš„æƒ…å†µä¸‹ï¼Œè¡¨é”çš„æ€§èƒ½è¾ƒä½ï¼Œå› æ­¤ä¸€èˆ¬ä¸æ¨èä½¿ç”¨ã€‚</li></ol><p>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªNEXT-KEYé”ï¼š</p><p>NEXT-KEY é”æ˜¯ InnoDB å­˜å‚¨å¼•æ“ä¸­çš„ä¸€ç§é”æœºåˆ¶ï¼Œç”¨äº<strong>è§£å†³å¹»è¯»</strong>é—®é¢˜ã€‚å®ƒæ˜¯é€šè¿‡å°† Gap é”å’Œ è®°å½•é” ç»„åˆè€Œæˆçš„ã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œå½“ä¸€ä¸ªäº‹åŠ¡åœ¨ InnoDB è¡¨ä¸­æ‰§è¡ŒèŒƒå›´æŸ¥è¯¢æ—¶ï¼Œå¦‚ä½¿ç”¨ <code>&lt;</code>ã€<code>&lt;=</code>ã€<code>&gt;</code>ã€<code>&gt;=</code> ç­‰æ“ä½œç¬¦ï¼ŒInnoDB å¼•æ“ä¼šä¸ºæŸ¥è¯¢æ¶‰åŠåˆ°çš„èŒƒå›´åŠ ä¸Š NEXT-KEY é”ã€‚è¿™ä¸ª NEXT-KEY é”åŒ…å«ä¸¤éƒ¨åˆ†ï¼š</p><ol><li>Gap é”ï¼šé”å®šäº†æŸ¥è¯¢èŒƒå›´å†…çš„é—´éš™ï¼ˆGapï¼‰ï¼Œé˜²æ­¢å…¶ä»–äº‹åŠ¡å‘è¯¥èŒƒå›´å†…æ’å…¥æ–°çš„è®°å½•ã€‚</li><li>è®°å½•é”ï¼šé”å®šäº†æ»¡è¶³æŸ¥è¯¢æ¡ä»¶çš„è®°å½•ï¼Œé˜²æ­¢å…¶ä»–äº‹åŠ¡å¯¹è¿™äº›è®°å½•è¿›è¡Œå¹¶å‘ä¿®æ”¹æˆ–åˆ é™¤ã€‚</li></ol><p>é€šè¿‡ä½¿ç”¨ NEXT-KEY é”ï¼ŒInnoDB å¯ä»¥æœ‰æ•ˆåœ°é¿å…å¹»è¯»ç°è±¡çš„å‘ç”Ÿã€‚å®ƒä¿è¯äº†åœ¨ä¸€ä¸ªäº‹åŠ¡è¯»å–ä¸€ä¸ªèŒƒå›´çš„æ•°æ®æ—¶ï¼Œ<strong>å…¶ä»–äº‹åŠ¡æ— æ³•å¹¶å‘åœ°åœ¨è¯¥èŒƒå›´å†…æ’å…¥æ–°çš„è®°å½•</strong>ï¼Œä»è€Œä¿è¯äº†è¯»å–çš„ä¸€è‡´æ€§ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒNEXT-KEY é”åªåœ¨äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸º<strong>å¯é‡å¤è¯»</strong>ï¼ˆREPEATABLE READï¼‰æˆ–æ›´é«˜çº§åˆ«æ—¶ä½¿ç”¨ï¼ˆMySQLé»˜è®¤éš”ç¦»çº§åˆ«ä¸ºå¯é‡å¤è¯»ï¼‰ã€‚åœ¨è¾ƒé«˜çš„å¹¶å‘ç¯å¢ƒä¸‹ï¼Œä½¿ç”¨ NEXT-KEY é”å¯èƒ½ä¼šå¢åŠ é”å†²çªçš„æ¦‚ç‡ï¼Œå› æ­¤åœ¨è®¾è®¡æ•°æ®åº“å’ŒæŸ¥è¯¢æ—¶éœ€è¦è€ƒè™‘åˆ°é”çš„å¼€é”€å’Œäº‹åŠ¡çš„éš”ç¦»çº§åˆ«ã€‚</p><h1 id="2-MySQLä¸­æœ‰å“ªäº›ä¸åŒçš„è¡¨æ ¼ï¼Ÿ"><a href="#2-MySQLä¸­æœ‰å“ªäº›ä¸åŒçš„è¡¨æ ¼ï¼Ÿ" class="headerlink" title="2.MySQLä¸­æœ‰å“ªäº›ä¸åŒçš„è¡¨æ ¼ï¼Ÿ"></a>2.MySQLä¸­æœ‰å“ªäº›ä¸åŒçš„è¡¨æ ¼ï¼Ÿ</h1><blockquote><p>è¿™ä¸ªä¹Ÿæ˜¯GPTå›ç­”çš„ï¼Œæ³¨æ„ï¼Œè¡¨æ ¼å’Œå­˜å‚¨å¼•æ“ä¸æ˜¯åŒä¸€ä¸ªæ¦‚å¿µï¼</p></blockquote><p>åœ¨MySQLä¸­ï¼Œæœ‰ä»¥ä¸‹å‡ ç§ä¸åŒçš„è¡¨æ ¼ç±»å‹ï¼š</p><ol><li>MyISAMï¼šMyISAMæ˜¯æ—§ç‰ˆæœ¬MySQLçš„é»˜è®¤è¡¨æ ¼ç±»å‹ã€‚å®ƒæä¾›äº†å¿«é€Ÿçš„è¯»å–é€Ÿåº¦ï¼Œé€‚ç”¨äºå¤§é‡çš„å¹¶å‘è¯»å–æ“ä½œã€‚ä¸è¿‡ï¼ŒMyISAMä¸æ”¯æŒäº‹åŠ¡å¤„ç†å’Œå´©æºƒæ¢å¤åŠŸèƒ½ã€‚</li><li>InnoDBï¼šInnoDBæ˜¯ä¸€ç§æ”¯æŒäº‹åŠ¡å¤„ç†å’Œå´©æºƒæ¢å¤åŠŸèƒ½çš„è¡¨æ ¼ç±»å‹ã€‚å®ƒæä¾›äº†è¡Œçº§é”å®šå’Œå¤–é”®çº¦æŸç­‰é«˜çº§åŠŸèƒ½ï¼Œé€‚ç”¨äºéœ€è¦æ•°æ®å®Œæ•´æ€§å’Œå¹¶å‘å†™å…¥æ“ä½œçš„åœºæ™¯ã€‚InnoDBæ˜¯<strong>MySQL 5.5ç‰ˆæœ¬å</strong>çš„é»˜è®¤è¡¨æ ¼ç±»å‹ã€‚</li><li>Memoryï¼šMemoryï¼ˆä¹Ÿç§°ä¸ºHeapï¼‰è¡¨æ ¼æ˜¯å°†æ•°æ®å­˜å‚¨åœ¨å†…å­˜ä¸­çš„ä¸´æ—¶è¡¨æ ¼ç±»å‹ã€‚å®ƒåœ¨è¯»å–å’Œå†™å…¥æ–¹é¢éå¸¸å¿«é€Ÿï¼Œä½†å®ƒçš„æ•°æ®æ˜¯ä¸´æ—¶çš„ï¼Œå½“æ•°æ®åº“æœåŠ¡å™¨é‡å¯æ—¶ï¼Œè¡¨æ ¼ä¸­çš„æ•°æ®å°†ä¼šä¸¢å¤±ã€‚</li><li>Archiveï¼šArchiveè¡¨æ ¼æ˜¯ä¸€ç§é«˜åº¦å‹ç¼©çš„è¡¨æ ¼ç±»å‹ï¼Œé€‚ç”¨äºå­˜å‚¨å¤§é‡å†å²æ•°æ®å’Œå½’æ¡£æ•°æ®ã€‚å®ƒå¯¹äºè¯»å–æ“ä½œä¸å¤ªæœ‰æ•ˆï¼Œä½†åœ¨å¤§é‡å†™å…¥å’Œå­˜å‚¨ç©ºé—´æ–¹é¢å…·æœ‰ä¼˜åŠ¿ã€‚</li><li>CSVï¼šCSVè¡¨æ ¼å…è®¸å°†æ•°æ®ä»¥CSVï¼ˆé€—å·åˆ†éš”å€¼ï¼‰æ ¼å¼å­˜å‚¨åœ¨æ–‡ä»¶ä¸­ï¼Œæ”¯æŒå¯¼å…¥å’Œå¯¼å‡ºæ•°æ®ã€‚å®ƒä¸æ”¯æŒç´¢å¼•ï¼Œäº‹åŠ¡å¤„ç†å’Œå…¶ä»–é«˜çº§ç‰¹æ€§ã€‚</li></ol><p>é™¤äº†ä»¥ä¸Šåˆ—ä¸¾çš„å‡ ç§å¸¸è§çš„è¡¨æ ¼ç±»å‹å¤–ï¼ŒMySQLè¿˜æ”¯æŒå…¶ä»–ä¸€äº›ç‰¹æ®Šç”¨é€”çš„è¡¨æ ¼ç±»å‹ï¼Œå¦‚Partitionedï¼ˆåˆ†åŒºè¡¨æ ¼ï¼‰å’ŒFederatedï¼ˆè”åˆè¡¨æ ¼ï¼‰ç­‰ã€‚</p><ul><li>è¡¨æ ¼å’Œå­˜å‚¨å¼•æ“æ˜¯åŒä¸€ä¸ªä¸œè¥¿å—ï¼Ÿå¹¶<strong>ä¸æ˜¯</strong>ï¼</li></ul><p>åœ¨å…³ç³»å‹æ•°æ®åº“ä¸­ï¼Œè¡¨æ ¼ï¼ˆTableï¼‰æ˜¯æŒ‡ä¸€ä¸ªé€»è¾‘ä¸Šçš„æ•°æ®ç»“æ„ï¼Œç”¨æ¥ç»„ç»‡å’Œå­˜å‚¨æ•°æ®ã€‚ä¸€å¼ è¡¨æ ¼ç”±è‹¥å¹²åˆ—ï¼ˆColumnï¼‰å’Œè‹¥å¹²è¡Œï¼ˆRowï¼‰ç»„æˆï¼Œæ¯åˆ—å®šä¹‰äº†ä¸€ç§æ•°æ®ç±»å‹å’Œä¸€ä¸ªå­—æ®µåï¼Œè¡¨æ ¼ä¸­çš„æ¯ä¸€è¡Œåˆ™ä»£è¡¨ä¸€ä¸ªå®ä½“æˆ–è®°å½•ï¼Œæ¯ä¸ªå•å…ƒæ ¼å­˜å‚¨ç€å¯¹åº”åˆ—çš„ä¸€ä¸ªæ•°å€¼æˆ–å­—ç¬¦ä¸²ã€‚</p><p>å­˜å‚¨å¼•æ“ï¼ˆStorage Engineï¼‰åˆ™æ˜¯æŒ‡å®ç°äº†æ•°æ®åº“çš„è¡¨æ ¼å’Œç´¢å¼•ç­‰åŠŸèƒ½çš„åº•å±‚è½¯ä»¶æ¨¡å—ï¼Œå®ƒè´Ÿè´£å°†è¡¨æ ¼æ•°æ®å­˜å‚¨åˆ°ç£ç›˜ã€è·Ÿè¸ªå¹¶å¤„ç†äº‹åŠ¡ã€æ‰§è¡ŒæŸ¥è¯¢è¯­å¥ç­‰ä»»åŠ¡ã€‚ä¸åŒçš„å­˜å‚¨å¼•æ“å…·æœ‰å„è‡ªçš„ç‰¹ç‚¹å’Œä¼˜ç¼ºç‚¹ï¼Œåœ¨ä¸åŒåœºæ™¯ä¸‹é€‰æ‹©åˆé€‚çš„å­˜å‚¨å¼•æ“å¯ä»¥æé«˜æ•°æ®åº“çš„æ€§èƒ½å’Œå¯é æ€§ã€‚</p><h1 id="3-MyISAMå’ŒInnoDBçš„åŒºåˆ«ï¼Ÿ"><a href="#3-MyISAMå’ŒInnoDBçš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="3.MyISAMå’ŒInnoDBçš„åŒºåˆ«ï¼Ÿ"></a>3.MyISAMå’ŒInnoDBçš„åŒºåˆ«ï¼Ÿ</h1><p>MyISAM</p><ul><li>ä¸æ”¯æŒäº‹åŠ¡ï¼›</li><li>é‡‡ç”¨éèšç°‡ç´¢å¼•ï¼Œæ™®é€šç´¢å¼•å’Œä¸»é”®ç´¢å¼•çš„å½¢å¼ç›¸åŒï¼›</li><li>ä¸€å¼ è¡¨åŒ…å«ä¸‰ä¸ªæœ¬åœ°æ–‡ä»¶ï¼›</li></ul><p>InnoDB</p><ul><li>æ”¯æŒäº‹åŠ¡ï¼›</li><li>é‡‡ç”¨èšç°‡ç´¢å¼•ï¼Œæ™®é€šç´¢å¼•å­˜æ”¾çš„æ˜¯ä¸»é”®ç´¢å¼•ä¸­çš„keyå€¼ï¼Œéœ€è¦å›è¡¨æŸ¥è¯¢ï¼›å¯ä»¥ç”¨ç´¢å¼•è¦†ç›–æ¥ä¼˜åŒ–ï¼›</li><li>ä¸€å¼ è¡¨åŒ…å«ä¸¤ä¸ªæœ¬åœ°æ–‡ä»¶ï¼›</li></ul><h1 id="4-InnoDBæ”¯æŒçš„å››ç§äº‹åŠ¡éš”ç¦»çº§åˆ«å’ŒåŒºåˆ«"><a href="#4-InnoDBæ”¯æŒçš„å››ç§äº‹åŠ¡éš”ç¦»çº§åˆ«å’ŒåŒºåˆ«" class="headerlink" title="4.InnoDBæ”¯æŒçš„å››ç§äº‹åŠ¡éš”ç¦»çº§åˆ«å’ŒåŒºåˆ«"></a>4.InnoDBæ”¯æŒçš„å››ç§äº‹åŠ¡éš”ç¦»çº§åˆ«å’ŒåŒºåˆ«</h1><p>å››ç§éš”ç¦»çº§åˆ«ï¼šè¯»æœªæäº¤ï¼Œè¯»å·²æäº¤ï¼Œå¯é‡å¤è¯»ï¼Œä¸²è¡ŒåŒ–ï¼›</p><p>è¿™éƒ¨åˆ†ç›´æ¥å»çœ‹æˆ‘çš„<a href="https://blog.musnow.top/posts/3474107655/">MySQLç´¢å¼•</a>åšå®¢ï¼Œé‡Œé¢è¯¦ç»†ä»‹ç»äº†åŒºåˆ«ï¼Œè¿™é‡Œå°±ä¸é‡å†™ä¸€éäº†ï¼›</p><h1 id="5-CHARå’ŒVARCHARçš„åŒºåˆ«"><a href="#5-CHARå’ŒVARCHARçš„åŒºåˆ«" class="headerlink" title="5.CHARå’ŒVARCHARçš„åŒºåˆ«"></a>5.CHARå’ŒVARCHARçš„åŒºåˆ«</h1><ul><li>charæ˜¯å®šé•¿å­—ç¬¦ä¸²ï¼Œæœ€é•¿255ï¼›varcharæ˜¯å˜é•¿å­—ç¬¦ä¸²ï¼Œæœ€é•¿65535ï¼›</li><li>è¿™å°±æ„å‘³ç€varcharéœ€è¦æ›´å¤šç©ºé—´æ¥å­˜æ”¾å½“å‰å­—ç¬¦ä¸²é•¿åº¦ç­‰ä¿¡æ¯ï¼Œå¹¶ä¸”ä¼šæ ¹æ®å½“å‰å­—ç¬¦ä¸²é•¿åº¦åŠ¨æ€å¼€è¾Ÿç©ºé—´å¤§å°ï¼Œä¸ä¼šæœ‰é¢å¤–çš„å­˜å‚¨ç©ºé—´æµªè´¹ï¼›</li><li>è€Œcharæ˜¯å®šæ­»çš„ç©ºé—´ï¼Œ<code>char(8)</code>é‡Œé¢å³ä¾¿åªæœ‰ä¸€ä¸ªå­—ç¬¦ä¹Ÿä¼šå ç”¨å…«ä¸ªçš„ç©ºé—´ï¼ˆä¼šç”¨ç©ºæ ¼è¿›è¡Œè¡¥é½ï¼‰ï¼›</li><li>åœ¨å­—ç¬¦ä¸²é•¿åº¦ç¡®å®šçš„æƒ…å†µä¸‹ï¼Œæ¯”å¦‚è®¡ç®—é•¿åº¦ç¡®å®šçš„MD5ï¼Œé‚£å°±å¯ä»¥ç”¨charå®šé•¿å­˜å‚¨ï¼›é•¿åº¦ä¸ç¡®å®šçš„æƒ…å†µä¸‹ï¼Œæ¯”å¦‚äººåã€é‚®ç®±ç­‰ä¿¡æ¯ï¼Œå¯ä»¥é‡‡ç”¨varcharï¼›</li></ul><p>é¡ºå¸¦è¯´ä¸€ä¸‹varcharå’Œtextçš„åŒºåˆ«ï¼›éœ€è¦è¿›è¡Œç´¢å¼•çš„é•¿æ–‡å¯ä»¥ç”¨TEXTè¿›è¡Œå­˜å‚¨ï¼ˆæ³¨æ„ï¼Œåªæœ‰MyISAMæ”¯æŒå…¨æ–‡ç´¢å¼•ï¼‰</p><ol><li>å­˜å‚¨ç©ºé—´ï¼šVARCHARåˆ—å­˜å‚¨çš„å†…å®¹é•¿åº¦æ˜¯å¯å˜çš„ï¼Œè€ŒTEXTåˆ—å¯ä»¥å­˜å‚¨å¤§é‡çš„å¯å˜é•¿åº¦çš„æ–‡æœ¬æ•°æ®ã€‚VARCHARåœ¨å­˜å‚¨æ—¶ä¼šæ ¹æ®å®é™…å­˜å‚¨çš„å†…å®¹é•¿åº¦è¿›è¡Œè°ƒæ•´ï¼Œè€ŒTEXTæ²¡æœ‰å›ºå®šçš„æœ€å¤§é•¿åº¦é™åˆ¶ï¼Œå¯ä»¥ç”¨æ¥å­˜å‚¨éå¸¸é•¿çš„æ–‡æœ¬ã€‚ç”±äºTEXTå¯ä»¥å­˜å‚¨æ›´å¤§çš„æ•°æ®é‡ï¼Œå› æ­¤å®ƒé€šå¸¸å ç”¨æ›´å¤šçš„å­˜å‚¨ç©ºé—´ã€‚</li><li>æŸ¥è¯¢æ€§èƒ½ï¼šç”±äºVARCHARå…·æœ‰å›ºå®šçš„æœ€å¤§é•¿åº¦é™åˆ¶ï¼Œæ•°æ®åº“å¯ä»¥æ›´å¥½åœ°ä¼˜åŒ–å’Œç®¡ç†å­˜å‚¨ç©ºé—´ï¼Œè¿™å¯èƒ½ä¼šåœ¨æŸäº›æƒ…å†µä¸‹æå‡æŸ¥è¯¢æ€§èƒ½ã€‚è€ŒTEXTç”±äºå…¶å¯å˜é•¿åº¦å’Œå¤§å®¹é‡ï¼Œå¯èƒ½ä¼šå¯¹æŸäº›æŸ¥è¯¢æ“ä½œç¨æœ‰å½±å“ã€‚</li><li>ç´¢å¼•å’Œæ’åºï¼šVARCHARå¯ä»¥è¢«ç´¢å¼•å’Œæ’åºï¼Œè¿™æ„å‘³ç€å¯ä»¥æ ¹æ®è¿™äº›åˆ—è¿›è¡Œå¿«é€Ÿæœç´¢å’Œæ’åºæ“ä½œã€‚è€ŒTEXTç±»å‹é€šå¸¸ä¸ç›´æ¥æ”¯æŒç´¢å¼•å’Œæ’åºï¼Œéœ€è¦é¢å¤–çš„é…ç½®å’Œå¤„ç†æ‰èƒ½å®ç°ç±»ä¼¼çš„åŠŸèƒ½ã€‚</li></ol><p>å¦‚ä¸‹user1è¡¨åšæµ‹è¯•ï¼Œä¼šå‘ç°æˆ‘ä»¬æ— æ³•ç»™TEXTç±»å‹ä¸Šæ™®é€šç´¢å¼•ã€‚ç»™å‡ºçš„æç¤ºæ˜¯ï¼Œ<code>BLOG/TEXT</code>ç±»å‹ä¸èƒ½åœ¨æ²¡æœ‰æŒ‡å®šé•¿åº¦çš„æ—¶å€™ä¸Šç´¢å¼•ï¼›å› ä¸ºä½ çš„é•¿åº¦ä¸ç¡®å®šï¼Œå¦‚æœMySQLå°†ä¸€ä¸ªå‡ ä¸‡å­—çš„TEXTå­˜åˆ°å†…å­˜é‡Œé¢ä½œä¸ºç´¢å¼•èŠ‚ç‚¹ï¼Œé‚£ä¹ˆå°±ä¼šå ç”¨è¿‡å¤šçš„å†…å­˜ç©ºé—´ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; desc user1;</span><br><span class="line">+-------+------------------+------+-----+---------+-------+</span><br><span class="line">| Field | Type             | Null | Key | Default | Extra |</span><br><span class="line">+-------+------------------+------+-----+---------+-------+</span><br><span class="line">| id    | int(10) unsigned | NO   | PRI | NULL    |       |</span><br><span class="line">| name  | varchar(200)     | NO   |     | NULL    |       |</span><br><span class="line">| info  | text             | NO   |     | NULL    |       |</span><br><span class="line">+-------+------------------+------+-----+---------+-------+</span><br><span class="line">3 rows in set (0.001 sec)</span><br><span class="line">MariaDB [hello_mysql]&gt; alter table user1 add index(info);</span><br><span class="line">ERROR 1170 (42000): BLOB/TEXT column &#x27;info&#x27; used in key specification without a key length</span><br></pre></td></tr></table></figure><p>å³ä¾¿åœ¨åˆ›å»ºåˆ—çš„æ—¶å€™ç»™å®šäº†TEXTçš„é•¿åº¦ï¼Œä¾æ—§ä¸èƒ½åˆ›å»ºç´¢å¼•ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; alter table user1 add info1 TEXT(20) NOT NULL;</span><br><span class="line">Query OK, 0 rows affected (0.002 sec)</span><br><span class="line">Records: 0  Duplicates: 0  Warnings: 0</span><br><span class="line"></span><br><span class="line">MariaDB [hello_mysql]&gt; desc user1;</span><br><span class="line">+-------+------------------+------+-----+---------+-------+</span><br><span class="line">| Field | Type             | Null | Key | Default | Extra |</span><br><span class="line">+-------+------------------+------+-----+---------+-------+</span><br><span class="line">| id    | int(10) unsigned | NO   | PRI | NULL    |       |</span><br><span class="line">| name  | varchar(200)     | NO   |     | NULL    |       |</span><br><span class="line">| info  | text             | NO   |     | NULL    |       |</span><br><span class="line">| info1 | tinytext         | NO   |     | NULL    |       |</span><br><span class="line">+-------+------------------+------+-----+---------+-------+</span><br><span class="line">4 rows in set (0.001 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [hello_mysql]&gt; alter table user1 add index(info1);</span><br><span class="line">ERROR 1170 (42000): BLOB/TEXT column &#x27;info1&#x27; used in key specification without a key length</span><br></pre></td></tr></table></figure><p>æ­£ç¡®çš„å†™æ³•å¦‚ä¸‹ï¼Œéœ€è¦åœ¨åˆ›å»ºç´¢å¼•çš„æ—¶å€™ï¼Œæ‹¬å·æŒ‡å®šç´¢å¼•çš„é•¿åº¦ï¼›æ¯”å¦‚<code>index(info1(10))</code>å«ä¹‰å°±æ˜¯ç»™info1åˆ—çš„å‰10ä¸ªå­—ç¬¦å»ºç«‹ç´¢å¼•ã€‚åªè¦TEXTé‡Œé¢å­˜æ”¾çš„æ–‡æœ¬å‰10ä¸ªå­—ç¬¦é‡å¤ç‡ä½ï¼Œé‚£ä¹ˆè¿™ä¸ªç´¢å¼•å°±æ˜¯æœ‰æ„ä¹‰çš„ï¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; alter table user1 add index(info1(10));</span><br><span class="line">Query OK, 0 rows affected (0.007 sec)</span><br><span class="line">Records: 0  Duplicates: 0  Warnings: 0</span><br></pre></td></tr></table></figure><h1 id="6-ä¸»é”®å’Œå€™é€‰é”®-ç -æœ‰å•¥åŒºåˆ«ï¼Ÿ"><a href="#6-ä¸»é”®å’Œå€™é€‰é”®-ç -æœ‰å•¥åŒºåˆ«ï¼Ÿ" class="headerlink" title="6.ä¸»é”®å’Œå€™é€‰é”®(ç )æœ‰å•¥åŒºåˆ«ï¼Ÿ"></a>6.ä¸»é”®å’Œå€™é€‰é”®(ç )æœ‰å•¥åŒºåˆ«ï¼Ÿ</h1><p>å€™é€‰é”®æ˜¯ä¸€äº›å¯ä»¥é€‰ç”¨ï¼ˆå¤‡é€‰ï¼‰ä¸ºä¸»é”®æˆ–è€…å”¯ä¸€é”®çš„ç±»å‹ï¼›</p><p>æ¯”å¦‚ä¸€ä¸ªå­¦ç”Ÿè¡¨é‡Œé¢ï¼ŒåŒ…å«å­¦ç”Ÿä¸»é”®çš„INTè‡ªå¢IDï¼Œå­¦ç”Ÿå­¦å·ï¼Œå­¦ç”Ÿèº«ä»½è¯ï¼Œå­¦ç”Ÿå§“åï¼Œå­¦ç”Ÿæ€§åˆ«ç­‰ç­‰ä¿¡æ¯ï¼›åœ¨è¿™ä¸ªè¡¨é‡Œé¢ï¼Œé™¤äº†ä¸»é”®è¿™ä¸ªINTçš„IDï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æŠŠå­¦ç”Ÿçš„å­¦å·å’Œå­¦ç”Ÿçš„èº«ä»½è¯ä½œä¸ºä¸»é”®æˆ–è€…å”¯ä¸€é”®ï¼Œå› ä¸ºä»–ä»¬éƒ½åŒ…å«å”¯ä¸€æ€§ï¼</p><p>è¿™æ—¶å€™ï¼Œè¿™äº›å¯ä»¥ä½œä¸ºä¸»é”®çš„åˆ—ï¼Œå°±å«åšå€™é€‰é”®ï¼›</p><ul><li>å€™é€‰é”®ä¹Ÿéœ€è¦ä¿æŒå”¯ä¸€æ€§</li><li>å€™é€‰é”®éœ€è¦éµå¾ªæœ€å°åŸåˆ™ï¼Œä¸èƒ½æ˜¯æŸä¸€ä¸ªèšåˆå”¯ä¸€æ ‡è¯†çš„å­é›†ï¼›ï¼ˆæ¯”å¦‚æˆ‘éœ€è¦ç”¨<strong>éƒ¨é—¨IDå’Œéƒ¨é—¨å†…å‘˜å·¥ID</strong>æ¥å”¯ä¸€æ ‡è¯†ä¸€ä¸ªå‘˜å·¥ï¼Œæ­¤æ—¶éƒ¨é—¨IDå°±ä¸èƒ½ä½œä¸ºè¿™ä¸ªå‘˜å·¥è¡¨çš„å€™é€‰é”®ï¼Œå› ä¸ºåœ¨æ•´ä¸ªè¡¨ä¸­éƒ¨é—¨IDä¼šé‡å¤ï¼‰</li></ul><p>åœ¨ã€Šæ•°æ®åº“ç³»ç»Ÿæ¦‚ç‡ã€‹è¿™é—¨è¯¾é‡Œé¢ï¼Œä¼šæŠŠé”®ç§°ä½œä¸ºç ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªä¸œè¥¿ã€‚</p><blockquote><p>åˆ°åº•æ˜¯è°æŠŠkeyç¿»è¯‘æˆç çš„ï¼ŸçœŸæ— è¯­ğŸ˜’</p></blockquote><h1 id="7-myisamchkæ˜¯ç”¨æ¥å¹²ä»€ä¹ˆçš„"><a href="#7-myisamchkæ˜¯ç”¨æ¥å¹²ä»€ä¹ˆçš„" class="headerlink" title="7.myisamchkæ˜¯ç”¨æ¥å¹²ä»€ä¹ˆçš„"></a>7.myisamchkæ˜¯ç”¨æ¥å¹²ä»€ä¹ˆçš„</h1><p>ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼ˆåœ¨bashä¸‹ä½¿ç”¨ï¼Œä¸æ˜¯åœ¨MySQLå‘½ä»¤è¡Œä½¿ç”¨ï¼‰</p><blockquote><p>Myisamchkæ˜¯MyISAMè¡¨ç»´æŠ¤çš„ä¸€ä¸ªéå¸¸å®ç”¨çš„å·¥å…·ã€‚å¯ä»¥ä½¿ç”¨myisamchkå®ç”¨ç¨‹åºæ¥è·å¾—æœ‰å…³æ•°æ®åº“è¡¨çš„ä¿¡æ¯æˆ–æ£€æŸ¥ã€ä¿®å¤ã€ä¼˜åŒ–ä»–ä»¬ã€‚myisamchké€‚ç”¨MyISAMè¡¨(å¯¹åº”.MYIå’Œ.MYDæ–‡ä»¶çš„è¡¨)ã€‚</p></blockquote><p>è¿™ä¸ªå‘½ä»¤äº†è§£å³å¯ï¼Œä¸‹é¢æ˜¯ä¸¤ç¯‡ä½¿ç”¨åšå®¢ã€‚æœ‰éœ€è¦å†å»æ·±å…¥å­¦ä¹ ç”¨æ³•</p><p><a href="http://www.4u4v.net/myisamchk-gadgets-manual.html">http://www.4u4v.net/myisamchk-gadgets-manual.html</a></p><p><a href="https://www.cnblogs.com/analyzer/articles/1381538.html">https://www.cnblogs.com/analyzer/articles/1381538.html</a></p><h1 id="8-å¦‚æœè¡¨ä¸­æœ‰ä¸€åˆ—å®šä¹‰ä¸ºTIMESTAMPä¼šå‘ç”Ÿä»€ä¹ˆ"><a href="#8-å¦‚æœè¡¨ä¸­æœ‰ä¸€åˆ—å®šä¹‰ä¸ºTIMESTAMPä¼šå‘ç”Ÿä»€ä¹ˆ" class="headerlink" title="8.å¦‚æœè¡¨ä¸­æœ‰ä¸€åˆ—å®šä¹‰ä¸ºTIMESTAMPä¼šå‘ç”Ÿä»€ä¹ˆ"></a>8.å¦‚æœè¡¨ä¸­æœ‰ä¸€åˆ—å®šä¹‰ä¸ºTIMESTAMPä¼šå‘ç”Ÿä»€ä¹ˆ</h1><p>TIMESTAMPåº•å±‚ä¸€èˆ¬æ˜¯4ä¸ªå­—èŠ‚ï¼Œåœ¨MySQLé‡Œé¢è¿›è¡ŒæŸ¥è¯¢çš„æ—¶å€™ï¼Œä¼šæ ¹æ®ç³»ç»Ÿæ—¶åŒºï¼Œè½¬æˆå¯è¯»æ—¶é—´è¿›è¡Œè¾“å‡ºã€‚åŒ…æ‹¬ä½¿ç”¨cpp develåŒ…è·å–åˆ°çš„ä¹Ÿæ˜¯å¯è¯»æ—¶é—´ï¼›</p><p>å› ä¸ºåªæœ‰4ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥TIMESTAMPæœ€å¤šèƒ½è¡¨ç¤º <code>1970-01-01 00:00:01</code>åˆ°<code>2038-01-19 03:14:07</code>ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ä¸ª2038å¹´é—®é¢˜ï¼Œéœ€è¦æ”¹æˆ8å­—èŠ‚å­˜å‚¨æ‰èƒ½å­˜æ”¾æ›´é•¿çš„æ—¶é—´ã€‚</p><p>å¦å¤–ï¼Œå¦‚æœä½ æƒ³æ›´åŠ ç²¾ç¡®çš„æ ‡è¯†æ—¶é—´ï¼Œè€Œä¸ä¾èµ–äºMySQLå¯¹æ—¶é—´æˆ³çš„è‡ªåŠ¨è½¬æ¢ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç”¨BIGINTæˆ–è€…DECIMALç±»å‹æ¥å­˜æ”¾æ—¶é—´æˆ³æ•°å­—ï¼Œå†åœ¨åº”ç”¨å±‚è¿›è¡Œæ—¶é—´æˆ³å’Œå¯è¯»æ—¶é—´ä¹‹é—´çš„è½¬æ¢ã€‚</p><h1 id="9-æ€ä¹ˆçœ‹åˆ°è¡¨æ ¼å®šä¹‰çš„æ‰€æœ‰ç´¢å¼•"><a href="#9-æ€ä¹ˆçœ‹åˆ°è¡¨æ ¼å®šä¹‰çš„æ‰€æœ‰ç´¢å¼•" class="headerlink" title="9.æ€ä¹ˆçœ‹åˆ°è¡¨æ ¼å®šä¹‰çš„æ‰€æœ‰ç´¢å¼•"></a>9.æ€ä¹ˆçœ‹åˆ°è¡¨æ ¼å®šä¹‰çš„æ‰€æœ‰ç´¢å¼•</h1><p>ä¸¤ç§æ–¹å¼éƒ½å¯ä»¥</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> index <span class="keyword">from</span> è¡¨å;</span><br><span class="line"><span class="keyword">show</span> keys <span class="keyword">from</span> è¡¨å;</span><br></pre></td></tr></table></figure><h1 id="10-LIKEå£°æ˜ä¸­çš„-æ˜¯ä»€ä¹ˆæ„æ€"><a href="#10-LIKEå£°æ˜ä¸­çš„-æ˜¯ä»€ä¹ˆæ„æ€" class="headerlink" title="10.LIKEå£°æ˜ä¸­çš„%æ˜¯ä»€ä¹ˆæ„æ€"></a>10.LIKEå£°æ˜ä¸­çš„%æ˜¯ä»€ä¹ˆæ„æ€</h1><p>ä»£è¡¨é€šé…ç¬¦ï¼ŒåŒ¹é…æ‰€æœ‰å­—ç¬¦ä¸²ã€‚ä¸‹é¢ä¸¾å‡ ä¸ªä¾‹å­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">æŸ¥è¯¢ &#x27;å¼ %&#x27;</span><br><span class="line">    å¼ ä¸½ä¸½</span><br><span class="line">    å¼ æ‰£æ‰£</span><br><span class="line">    å¼ ä¸‰</span><br><span class="line">    å¼ é˜¿æ–¯é¡¿</span><br><span class="line"></span><br><span class="line">æŸ¥è¯¢ &#x27;%å¼ %&#x27;</span><br><span class="line">é‡Œå¼ é‡Œ</span><br><span class="line">    åå¤§å¼ æ’’æ‰“å‘</span><br><span class="line"></span><br><span class="line">æŸ¥è¯¢ &#x27;%å¼ &#x27;</span><br><span class="line">xxå¼ </span><br><span class="line">xxxxxå¼ </span><br></pre></td></tr></table></figure><p>éœ€è¦æ³¨æ„ï¼Œåªæœ‰<code>å…³é”®å­—%</code>çš„ä½¿ç”¨æ–¹å¼æ‰èƒ½ç”¨ä¸Šç´¢å¼•ï¼Œå¦å¤–ä¸¤ç§åŒ¹é…æ–¹å¼æ— æ³•ä½¿ç”¨ç´¢å¼•ï¼</p><h1 id="11-åˆ—å¯¹æ¯”è¿ç®—ç¬¦æ˜¯ä»€ä¹ˆ"><a href="#11-åˆ—å¯¹æ¯”è¿ç®—ç¬¦æ˜¯ä»€ä¹ˆ" class="headerlink" title="11.åˆ—å¯¹æ¯”è¿ç®—ç¬¦æ˜¯ä»€ä¹ˆ"></a>11.åˆ—å¯¹æ¯”è¿ç®—ç¬¦æ˜¯ä»€ä¹ˆ</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ç­‰äº =</span><br><span class="line">ä¸ç­‰äº &lt;&gt; !=</span><br><span class="line">å¤§äºå’Œå¤§äºç­‰äº  &gt; &gt;=</span><br><span class="line">å°äºå’Œå°äºç­‰äº  &lt; &lt;=</span><br><span class="line">åŒºé—´ BETWEEN .. AND ...</span><br><span class="line">æ˜¯å¦åœ¨åˆ—è¡¨ä¸­ IN</span><br><span class="line">æ¨¡ç³ŠåŒ¹é… LIKE</span><br><span class="line">NULLæ¯”è¾ƒ IS NULL, IS NOT NULL</span><br></pre></td></tr></table></figure><h1 id="12-BLOBå’ŒTEXTæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#12-BLOBå’ŒTEXTæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="12.BLOBå’ŒTEXTæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>12.BLOBå’ŒTEXTæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h1><p>GPTè¯´çš„ï¼š</p><ol><li>å­˜å‚¨å®¹é‡ï¼šBLOBå¯ä»¥å­˜å‚¨äºŒè¿›åˆ¶æ•°æ®ï¼Œè€ŒTEXTåªèƒ½å­˜å‚¨çº¯æ–‡æœ¬æ•°æ®ã€‚</li><li>å­—ç¬¦é›†æ’åºè§„åˆ™ï¼šBLOBæ²¡æœ‰å­—ç¬¦é›†æ’åºè§„åˆ™ï¼Œè€ŒTEXTæœ‰ï¼Œé»˜è®¤ä¸ºå­—ç¬¦é›†çš„æ’åºè§„åˆ™ã€‚</li><li>æ•°æ®æ’åºå’Œæ¯”è¾ƒï¼šBLOBä¼šæŒ‰äºŒè¿›åˆ¶æ–¹å¼è¿›è¡Œæ’åºå’Œæ¯”è¾ƒï¼Œè€ŒTEXTä¼šæŒ‰å­—ç¬¦æ’åºè§„åˆ™è¿›è¡Œæ’åºå’Œæ¯”è¾ƒã€‚</li><li>å­˜å‚¨æ–¹å¼ï¼šBLOBæ•°æ®ä»¥äºŒè¿›åˆ¶å½¢å¼å­˜å‚¨ï¼Œæ²¡æœ‰å­—ç¬¦é›†è½¬æ¢ï¼›è€ŒTEXTæ•°æ®ä¼šæ ¹æ®å­—ç¬¦é›†è¿›è¡Œè½¬æ¢å’Œå­˜å‚¨ã€‚</li><li>ç´¢å¼•ï¼šåœ¨MySQLä¸­ï¼ŒBLOBå’ŒTEXTåˆ—å¯ä»¥æœ‰ç´¢å¼•ï¼Œä½†æœ‰ä¸€äº›é™åˆ¶ã€‚BLOBåˆ—æˆ–å‰ç¼€ç´¢å¼•çš„æœ€å¤§é•¿åº¦æ˜¯768å­—èŠ‚ï¼Œå¯¹äºUTF-8å­—ç¬¦é›†æ˜¯255ä¸ªå­—ç¬¦ã€‚è€ŒTEXTåˆ—æˆ–å‰ç¼€ç´¢å¼•çš„æœ€å¤§é•¿åº¦æ˜¯3072å­—èŠ‚ï¼Œåœ¨UTF-8å­—ç¬¦é›†ä¸­æ˜¯1024ä¸ªå­—ç¬¦ã€‚</li><li>é»˜è®¤å€¼ï¼šBLOBå’ŒTEXTåˆ—ä¸èƒ½å…·æœ‰é»˜è®¤å€¼ã€‚</li></ol><p>æ€»çš„æ¥è¯´ï¼ŒBLOBé€‚åˆå­˜å‚¨äºŒè¿›åˆ¶æ•°æ®ï¼Œä¾‹å¦‚å›¾åƒã€éŸ³é¢‘æˆ–è§†é¢‘æ–‡ä»¶ç­‰ã€‚è€ŒTEXTé€‚åˆå­˜å‚¨çº¯æ–‡æœ¬æ•°æ®ï¼Œå¦‚é•¿æ–‡æœ¬ã€æ–‡ç« å†…å®¹ç­‰ã€‚æ ¹æ®å…·ä½“çš„éœ€æ±‚ï¼Œä½ å¯ä»¥é€‰æ‹©é€‚å½“çš„æ•°æ®ç±»å‹æ¥å­˜å‚¨ç›¸åº”çš„æ•°æ®ã€‚</p><blockquote><p>å®é™…ä¸Šï¼ŒæŠŠå›¾ç‰‡ã€éŸ³é¢‘è¿™äº›é™æ€èµ„æºå­˜å…¥æ•°æ®åº“æ˜¯ä¸åˆç†çš„â€¦â€¦</p></blockquote><h1 id="13-MySQL-fetch-arrayå’ŒMySQL-fetch-objæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#13-MySQL-fetch-arrayå’ŒMySQL-fetch-objæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="13.MySQL_fetch_arrayå’ŒMySQL_fetch_objæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>13.MySQL_fetch_arrayå’ŒMySQL_fetch_objæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h1><p>PHPé‡Œé¢çš„å‡½æ•°ï¼Œä¸å­¦ï¼Œç›´æ¥è·³è¿‡</p><h1 id="14-MyISAMè¡¨æ ¼å°†åœ¨é‚£é‡Œå­˜å‚¨ï¼Ÿå¹¶ä¸”è¿˜æä¾›å…¶å­˜å‚¨æ ¼å¼ï¼Ÿ"><a href="#14-MyISAMè¡¨æ ¼å°†åœ¨é‚£é‡Œå­˜å‚¨ï¼Ÿå¹¶ä¸”è¿˜æä¾›å…¶å­˜å‚¨æ ¼å¼ï¼Ÿ" class="headerlink" title="14.MyISAMè¡¨æ ¼å°†åœ¨é‚£é‡Œå­˜å‚¨ï¼Ÿå¹¶ä¸”è¿˜æä¾›å…¶å­˜å‚¨æ ¼å¼ï¼Ÿ"></a>14.MyISAMè¡¨æ ¼å°†åœ¨é‚£é‡Œå­˜å‚¨ï¼Ÿå¹¶ä¸”è¿˜æä¾›å…¶å­˜å‚¨æ ¼å¼ï¼Ÿ</h1><p>åœ¨linuxä¸‹ï¼ŒMyISAMè¡¨æ ¼ä»¥æ–‡ä»¶å½¢å¼å­˜å‚¨åœ¨æ•°æ®ç›®å½•ä¸‹çš„å¯¹åº”æ•°æ®åº“ç›®å½•ä¸­ã€‚æ¯ä¸ªè¡¨æ ¼å¯¹åº”ä¸€ä¸ª.MYDæ•°æ®æ–‡ä»¶ï¼ˆç”¨äºå­˜å‚¨è¡¨æ ¼æ•°æ®ï¼‰å’Œä¸€ä¸ª.MYIç´¢å¼•æ–‡ä»¶ï¼ˆç”¨äºå­˜å‚¨è¡¨æ ¼ç´¢å¼•ï¼‰ï¼Œä»¥åŠä¸€ä¸ª.frmè¡¨æ ¼å®šä¹‰æ–‡ä»¶ï¼ˆåŒ…å«è¡¨æ ¼å®šä¹‰ä¿¡æ¯ï¼Œå¦‚å­—æ®µåã€æ•°æ®ç±»å‹ç­‰ï¼‰</p><p>MyISAMä½¿ç”¨ä¸€ç§ç§°ä¸ºâ€œé™æ€è¡Œæ ¼å¼â€çš„å­˜å‚¨æ ¼å¼æ¥å­˜å‚¨è¡¨æ ¼æ•°æ®ã€‚è¿™ç§æ ¼å¼ç”¨äºåœ¨ç£ç›˜ä¸Šä¿å­˜ç”±å®šé•¿è¡Œç»„æˆçš„è¡¨æ ¼ï¼Œæ¯ä¸ªè¡Œå®šé•¿ï¼Œå ç”¨ç›¸åŒçš„å­˜å‚¨ç©ºé—´ï¼Œä»¥ä¾¿æ›´å¿«åœ°è¯»å–å’Œå†™å…¥æ•°æ®ã€‚MyISAMè¡¨æ ¼è¿˜æ”¯æŒåŠ¨æ€è¡Œæ ¼å¼ï¼Œè¿™ç§æ ¼å¼å…è®¸å¯å˜è¡Œé•¿åº¦ï¼Œå› æ­¤å¯ä»¥æ›´æœ‰æ•ˆåœ°å­˜å‚¨å¯å˜é•¿åº¦çš„æ•°æ®ç±»å‹ï¼ˆå¦‚VARCHARï¼ŒTEXTç­‰ï¼‰ã€‚</p><h1 id="15-MySQLå¦‚ä½•ä¼˜åŒ–DISTINCT"><a href="#15-MySQLå¦‚ä½•ä¼˜åŒ–DISTINCT" class="headerlink" title="15.MySQLå¦‚ä½•ä¼˜åŒ–DISTINCT?"></a>15.MySQLå¦‚ä½•ä¼˜åŒ–DISTINCT?</h1><p>ä½¿ç”¨ç´¢å¼•ï¼Œå‡å°‘æŸ¥è¯¢è¡Œæ•°æ¥ä¼˜åŒ–å»é‡æ“ä½œ</p><h1 id="16-å¦‚ä½•æ˜¾ç¤ºå‰50è¡Œï¼Ÿ"><a href="#16-å¦‚ä½•æ˜¾ç¤ºå‰50è¡Œï¼Ÿ" class="headerlink" title="16.å¦‚ä½•æ˜¾ç¤ºå‰50è¡Œï¼Ÿ"></a>16.å¦‚ä½•æ˜¾ç¤ºå‰50è¡Œï¼Ÿ</h1><p>æŸ¥è¯¢è¯­å¥åå¸¦ä¸Šlimitå°±å¯ä»¥</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> è¡¨å limit <span class="number">50</span>;</span><br></pre></td></tr></table></figure><h1 id="17-å¯ä»¥ä½¿ç”¨å¤šå°‘åˆ—åˆ›å»ºç´¢å¼•ï¼Ÿ"><a href="#17-å¯ä»¥ä½¿ç”¨å¤šå°‘åˆ—åˆ›å»ºç´¢å¼•ï¼Ÿ" class="headerlink" title="17.å¯ä»¥ä½¿ç”¨å¤šå°‘åˆ—åˆ›å»ºç´¢å¼•ï¼Ÿ"></a>17.å¯ä»¥ä½¿ç”¨å¤šå°‘åˆ—åˆ›å»ºç´¢å¼•ï¼Ÿ</h1><p>æ ¹æ®å®é™…ä½¿ç”¨åœºæ™¯æ¥ç¡®å®šç”¨å‡ åˆ—ï¼Œå¹¶æ²¡æœ‰å›ºå®šé™åˆ¶ã€‚ç†è®ºä¸Šæ¥è¯´éœ€è¦ä¿æŒæœ€å°åŸåˆ™ï¼Œä¸è¦åŒ…å«å¤šä½™çš„æ— æ•ˆåˆ—ï¼ˆé™¤éä½ éœ€è¦ç”¨æ¥è¿›è¡Œç´¢å¼•ä¼˜åŒ–ï¼Œå‡å°‘å›è¡¨æ“ä½œï¼‰</p><h1 id="18-nowå’Œcurrent-dateæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#18-nowå’Œcurrent-dateæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="18.nowå’Œcurrent_dateæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>18.nowå’Œcurrent_dateæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h1><p>nowä¼šè¿”å›ä¸€ç›´åˆ°æ—¶åˆ†ç§’çš„ä¿¡æ¯ï¼Œcurrent_dateåªä¼šè¿”å›å½“æ—¥æ—¥æœŸ</p><h1 id="19-ä»€ä¹ˆæ˜¯éæ ‡å‡†å­—ç¬¦ä¸²ç±»å‹"><a href="#19-ä»€ä¹ˆæ˜¯éæ ‡å‡†å­—ç¬¦ä¸²ç±»å‹" class="headerlink" title="19.ä»€ä¹ˆæ˜¯éæ ‡å‡†å­—ç¬¦ä¸²ç±»å‹"></a>19.ä»€ä¹ˆæ˜¯éæ ‡å‡†å­—ç¬¦ä¸²ç±»å‹</h1><blockquote><p>GPT</p></blockquote><p>éæ ‡å‡†å­—ç¬¦ä¸²ç±»å‹æ˜¯æŒ‡åœ¨æ•°æ®åº“ä¸­æ²¡æœ‰æ˜ç¡®å®šä¹‰æˆ–æ ‡å‡†åŒ–çš„å­—ç¬¦ä¸²æ•°æ®ç±»å‹ã€‚è¿™äº›ç±»å‹é€šå¸¸æ˜¯ç‰¹å®šæ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆDBMSï¼‰æˆ–åº”ç”¨ç¨‹åºå¼€å‘æ¡†æ¶æ‰€æ”¯æŒçš„æ‰©å±•ã€‚ç”±äºä¸åŒçš„DBMSå’Œæ¡†æ¶æœ‰å„è‡ªçš„ç‰¹æ€§å’Œéœ€æ±‚ï¼Œå¯èƒ½ä¼šå¼•å…¥é¢å¤–çš„éæ ‡å‡†å­—ç¬¦ä¸²ç±»å‹ä»¥æ»¡è¶³ç‰¹å®šçš„æ•°æ®å­˜å‚¨å’Œæ“ä½œéœ€æ±‚ã€‚</p><p>ä¸¾ä¾‹æ¥è¯´ï¼ŒMySQLæ•°æ®åº“åœ¨å…¶æ ‡å‡†å­—ç¬¦ä¸²ç±»å‹ä¸­åŒ…å«äº†CHARã€VARCHARã€TEXTç­‰ã€‚è€Œéæ ‡å‡†å­—ç¬¦ä¸²ç±»å‹å¯èƒ½æ˜¯æ ¹æ®å…·ä½“éœ€æ±‚å’Œæ‰©å±•å¼€å‘çš„ï¼Œå¦‚JSONã€XMLã€BLOBã€CLOBç­‰ã€‚è¿™äº›éæ ‡å‡†ç±»å‹åœ¨ä¸€äº›ç‰¹å®šåœºæ™¯ä¸­ä½¿ç”¨å¹¿æ³›ï¼Œä¾‹å¦‚å­˜å‚¨éç»“æ„åŒ–çš„æ–‡æœ¬æ•°æ®ã€å¤§å‹äºŒè¿›åˆ¶æ•°æ®ã€ä»¥åŠå­˜å‚¨å’ŒæŸ¥è¯¢å¤æ‚çš„ç»“æ„åŒ–æ•°æ®ç­‰ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œéæ ‡å‡†å­—ç¬¦ä¸²ç±»å‹åœ¨ä¸åŒçš„DBMSå’Œå¼€å‘æ¡†æ¶ä¹‹é—´å¯èƒ½å­˜åœ¨å·®å¼‚ï¼Œå¹¶ä¸”åœ¨è·¨å¹³å°å’Œè¿ç§»æ—¶å¯èƒ½ä¼šå‡ºç°å…¼å®¹æ€§é—®é¢˜ã€‚å› æ­¤ï¼Œåœ¨ä½¿ç”¨éæ ‡å‡†å­—ç¬¦ä¸²ç±»å‹æ—¶ï¼Œå»ºè®®ä»”ç»†äº†è§£ç›¸å…³çš„æ–‡æ¡£å’Œè§„èŒƒï¼Œå¹¶è¯„ä¼°å…¶å¯¹åº”ç”¨ç¨‹åºçš„å½±å“å’Œå¯ç§»æ¤æ€§ã€‚</p><h1 id="20-ä»€ä¹ˆæ˜¯é€šç”¨SQLå‡½æ•°"><a href="#20-ä»€ä¹ˆæ˜¯é€šç”¨SQLå‡½æ•°" class="headerlink" title="20.ä»€ä¹ˆæ˜¯é€šç”¨SQLå‡½æ•°"></a>20.ä»€ä¹ˆæ˜¯é€šç”¨SQLå‡½æ•°</h1><p>ä»¥ä¸‹åˆ—ä¸¾äº†ä¸€äº›å¸¸è§çš„é€šç”¨SQLå‡½æ•°ï¼š</p><ol><li>èšåˆå‡½æ•°ï¼šå¦‚SUMã€AVGã€COUNTã€MINã€MAXç­‰ï¼Œç”¨äºå¯¹æ•°æ®è¿›è¡Œç»Ÿè®¡å’Œèšåˆè®¡ç®—ã€‚</li><li>å­—ç¬¦ä¸²å‡½æ•°ï¼šå¦‚CONCATã€SUBSTRINGã€UPPERã€LOWERã€LENGTHç­‰ï¼Œç”¨äºå¤„ç†å’Œæ“ä½œå­—ç¬¦ä¸²æ•°æ®ã€‚</li><li>æ•°å€¼å‡½æ•°ï¼šå¦‚ABSã€ROUNDã€CEILINGã€FLOORç­‰ï¼Œç”¨äºæ‰§è¡Œæ•°å€¼è®¡ç®—å’Œè½¬æ¢ã€‚</li><li>æ—¥æœŸå’Œæ—¶é—´å‡½æ•°ï¼šå¦‚DATE, TIME, YEAR, MONTH, DAYç­‰ï¼Œç”¨äºå¤„ç†æ—¥æœŸå’Œæ—¶é—´æ•°æ®çš„è®¡ç®—å’Œæ ¼å¼åŒ–ã€‚</li><li>æ¡ä»¶å‡½æ•°ï¼šå¦‚IF, CASE WHEN, COALESCEç­‰ï¼Œç”¨äºæ ¹æ®æ¡ä»¶æ‰§è¡Œä¸åŒçš„é€»è¾‘å’Œè¿”å›ä¸åŒçš„ç»“æœã€‚</li><li>ç±»å‹è½¬æ¢å‡½æ•°ï¼šå¦‚CASTã€CONVERTç­‰ï¼Œç”¨äºåœ¨ä¸åŒçš„æ•°æ®ç±»å‹ä¹‹é—´è¿›è¡Œè½¬æ¢ã€‚</li></ol><p>è¿™åªæ˜¯ä¸€å°éƒ¨åˆ†é€šç”¨SQLå‡½æ•°çš„ä¾‹å­ï¼Œå®é™…ä¸Šè¿˜æœ‰å¾ˆå¤šå…¶ä»–çš„å‡½æ•°å¯ç”¨äºä¸åŒçš„æ•°æ®å¤„ç†å’ŒæŸ¥è¯¢éœ€æ±‚ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå°½ç®¡è¿™äº›å‡½æ•°åœ¨å¤§å¤šæ•°DBMSä¸­éƒ½å­˜åœ¨ï¼Œä½†æŸäº›ç‰¹å®šçš„DBMSå¯èƒ½ä¼šæä¾›é¢å¤–çš„å‡½æ•°æˆ–æœ‰ç¨å¾®ä¸åŒçš„è¯­æ³•ï¼Œå› æ­¤åœ¨ä½¿ç”¨å‡½æ•°æ—¶åº”æŸ¥é˜…ç›¸åº”çš„æ–‡æ¡£å’Œè§„èŒƒä»¥ç¡®ä¿å…¼å®¹æ€§å’Œæ­£ç¡®æ€§ã€‚</p><h1 id="21-MySQLæ”¯æŒäº‹åŠ¡å—ï¼Ÿ"><a href="#21-MySQLæ”¯æŒäº‹åŠ¡å—ï¼Ÿ" class="headerlink" title="21.MySQLæ”¯æŒäº‹åŠ¡å—ï¼Ÿ"></a>21.MySQLæ”¯æŒäº‹åŠ¡å—ï¼Ÿ</h1><p>è‚¯å®šæ”¯æŒï¼Œè¿™ä¸ªé—®é¢˜ç¬¬å››ç‚¹å°±å·²ç»è¯¦ç»†é—®äº†</p><h1 id="22-MySQLé‡Œé¢è®°å½•è´§å¸ç”¨ä»€ä¹ˆç±»å‹å¥½ï¼Ÿ"><a href="#22-MySQLé‡Œé¢è®°å½•è´§å¸ç”¨ä»€ä¹ˆç±»å‹å¥½ï¼Ÿ" class="headerlink" title="22.MySQLé‡Œé¢è®°å½•è´§å¸ç”¨ä»€ä¹ˆç±»å‹å¥½ï¼Ÿ"></a>22.MySQLé‡Œé¢è®°å½•è´§å¸ç”¨ä»€ä¹ˆç±»å‹å¥½ï¼Ÿ</h1><p>å› ä¸ºæµ®ç‚¹æ•°çš„ç²¾åº¦é—®é¢˜ï¼Œå¯ä»¥ç”¨BIGINTæ¥å­˜æ”¾ä»¥<strong>åˆ†</strong>ä¸ºå•ä½çš„è´§å¸ï¼Œå®é™…è°ƒç”¨çš„æ—¶å€™å†åŠ ä¸Šå°æ•°ç‚¹ï¼Œæ¥ä¿è¯æ•°æ®å‡†ç¡®ã€‚</p><p>å¦‚æœä¸ç”¨BIGINTï¼Œé‚£å°±éœ€è¦ç”¨DECIMALæ¥å­˜æ”¾è´§å¸ã€‚</p><blockquote><p>Bç«™å†²æµªçœ‹åˆ°çš„</p></blockquote><h1 id="23-MySQLæœ‰å…³æƒé™çš„è¡¨æœ‰é‚£å‡ ä¸ª"><a href="#23-MySQLæœ‰å…³æƒé™çš„è¡¨æœ‰é‚£å‡ ä¸ª" class="headerlink" title="23.MySQLæœ‰å…³æƒé™çš„è¡¨æœ‰é‚£å‡ ä¸ª"></a>23.MySQLæœ‰å…³æƒé™çš„è¡¨æœ‰é‚£å‡ ä¸ª</h1><p>åœ¨MySQLä¸­ï¼Œæœ‰å‡ ä¸ªä¸æƒé™ç›¸å…³çš„ç³»ç»Ÿè¡¨å’Œè§†å›¾ï¼Œç”¨äºç®¡ç†ç”¨æˆ·ã€è§’è‰²å’Œæƒé™ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„æƒé™ç›¸å…³çš„è¡¨å’Œè§†å›¾ï¼š</p><ol><li>mysql.userï¼šè¿™ä¸ªè¡¨åŒ…å«äº†MySQLå®ä¾‹ä¸Šçš„æ‰€æœ‰ç”¨æˆ·è´¦æˆ·ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç”¨æˆ·åã€å¯†ç ç­‰ã€‚è¯¥è¡¨è®°å½•äº†æ¯ä¸ªç”¨æˆ·çš„å…¨å±€æƒé™ã€‚</li><li>mysql.dbï¼šè¿™ä¸ªè¡¨è®°å½•äº†ç”¨æˆ·å¯¹æ•°æ®åº“çº§åˆ«çš„æƒé™ã€‚å®ƒæŒ‡å®šäº†å“ªä¸ªç”¨æˆ·å¯¹å“ªä¸ªæ•°æ®åº“å…·æœ‰ä»€ä¹ˆæ ·çš„æƒé™ã€‚</li><li>mysql.tables_privï¼šè¿™ä¸ªè¡¨è®°å½•äº†ç”¨æˆ·å¯¹è¡¨çº§åˆ«çš„æƒé™ã€‚å®ƒå­˜å‚¨äº†ç”¨æˆ·å¯¹æŸä¸ªå…·ä½“è¡¨çš„æƒé™ä¿¡æ¯ï¼ˆå¦‚SELECTã€INSERTã€UPDATEã€DELETEç­‰ï¼‰ã€‚</li><li>mysql.columns_privï¼šè¿™ä¸ªè¡¨è®°å½•äº†ç”¨æˆ·å¯¹åˆ—çº§åˆ«çš„æƒé™ã€‚å®ƒå­˜å‚¨äº†ç”¨æˆ·å¯¹è¡¨ä¸­æŸä¸ªå…·ä½“åˆ—çš„æƒé™ä¿¡æ¯ã€‚</li><li>mysql.procs_privï¼šè¿™ä¸ªè¡¨è®°å½•äº†ç”¨æˆ·å¯¹å­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°çš„æƒé™ã€‚</li><li>mysql.rolesï¼šè¿™ä¸ªè¡¨å­˜å‚¨äº†è§’è‰²çš„ç›¸å…³ä¿¡æ¯ï¼ŒåŒ…æ‹¬è§’è‰²åã€è§’è‰²çš„åˆ›å»ºè€…ç­‰ã€‚</li></ol><p>é™¤äº†ä¸Šè¿°çš„è¡¨ä¹‹å¤–ï¼ŒMySQLè¿˜æä¾›äº†ä¸€äº›æƒé™ç›¸å…³çš„è§†å›¾ï¼Œè¿™äº›è§†å›¾å¯ä»¥æ–¹ä¾¿åœ°æŸ¥çœ‹ç”¨æˆ·ã€è§’è‰²å’Œæƒé™çš„ä¿¡æ¯ï¼Œå¦‚ï¼š</p><ul><li>information_schema.USER_PRIVILEGESï¼šæ˜¾ç¤ºæ‰€æœ‰ç”¨æˆ·çš„æƒé™ä¿¡æ¯ã€‚</li><li>information_schema.SCHEMA_PRIVILEGESï¼šæ˜¾ç¤ºæ‰€æœ‰æ•°æ®åº“çš„æƒé™ä¿¡æ¯ã€‚</li><li>information_schema.TABLE_PRIVILEGESï¼šæ˜¾ç¤ºæ‰€æœ‰è¡¨çš„æƒé™ä¿¡æ¯ã€‚</li><li>information_schema.COLUMN_PRIVILEGESï¼šæ˜¾ç¤ºæ‰€æœ‰åˆ—çš„æƒé™ä¿¡æ¯ã€‚</li></ul><p>å¦‚ä¸‹æ˜¯ä¸ªä½¿ç”¨ç¤ºä¾‹</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> information_schema.USER_PRIVILEGES;</span><br></pre></td></tr></table></figure><p>è¿™äº›è¡¨å’Œè§†å›¾å¯ä»¥é€šè¿‡æŸ¥è¯¢ç›¸åº”çš„ç³»ç»Ÿè¡¨æˆ–è§†å›¾æ¥æŸ¥çœ‹å’Œç®¡ç†ç”¨æˆ·ã€è§’è‰²å’Œæƒé™ã€‚è¯·æ³¨æ„ï¼Œå…·ä½“çš„ç³»ç»Ÿè¡¨å’Œè§†å›¾åç§°å¯èƒ½å› MySQLç‰ˆæœ¬å’Œé…ç½®è€Œæœ‰æ‰€ä¸åŒã€‚ä¸ºäº†ç¡®ä¿å‡†ç¡®æ€§ï¼Œè¯·å‚è€ƒMySQLå®˜æ–¹æ–‡æ¡£æˆ–ç‰¹å®šç‰ˆæœ¬çš„æ–‡æ¡£ã€‚</p><h1 id="24-åˆ—çš„å­—ç¬¦ä¸²ç±»å‹å¯ä»¥æ˜¯ä»€ä¹ˆ"><a href="#24-åˆ—çš„å­—ç¬¦ä¸²ç±»å‹å¯ä»¥æ˜¯ä»€ä¹ˆ" class="headerlink" title="24.åˆ—çš„å­—ç¬¦ä¸²ç±»å‹å¯ä»¥æ˜¯ä»€ä¹ˆ"></a>24.åˆ—çš„å­—ç¬¦ä¸²ç±»å‹å¯ä»¥æ˜¯ä»€ä¹ˆ</h1><p>TEXT CHAR VARCHARï¼Œè¯¦è§ç¬¬äº”ç‚¹</p><h1 id="25-MySQLä½œä¸ºå‘å¸ƒç³»ç»Ÿçš„å­˜å‚¨ï¼Œä¸€å¤©äº”ä¸‡æ¡ä»¥ä¸Šçš„å¢é‡ï¼Œé¢„è®¡è¿ç»´ä¸‰å¹´ï¼Œå¦‚ä½•ä¼˜åŒ–ï¼Ÿ"><a href="#25-MySQLä½œä¸ºå‘å¸ƒç³»ç»Ÿçš„å­˜å‚¨ï¼Œä¸€å¤©äº”ä¸‡æ¡ä»¥ä¸Šçš„å¢é‡ï¼Œé¢„è®¡è¿ç»´ä¸‰å¹´ï¼Œå¦‚ä½•ä¼˜åŒ–ï¼Ÿ" class="headerlink" title="25.MySQLä½œä¸ºå‘å¸ƒç³»ç»Ÿçš„å­˜å‚¨ï¼Œä¸€å¤©äº”ä¸‡æ¡ä»¥ä¸Šçš„å¢é‡ï¼Œé¢„è®¡è¿ç»´ä¸‰å¹´ï¼Œå¦‚ä½•ä¼˜åŒ–ï¼Ÿ"></a>25.MySQLä½œä¸ºå‘å¸ƒç³»ç»Ÿçš„å­˜å‚¨ï¼Œä¸€å¤©äº”ä¸‡æ¡ä»¥ä¸Šçš„å¢é‡ï¼Œé¢„è®¡è¿ç»´ä¸‰å¹´ï¼Œå¦‚ä½•ä¼˜åŒ–ï¼Ÿ</h1><blockquote><p>æ²¡è§è¿‡è¿™ç§ä¸šåŠ¡ï¼Œåªèƒ½é—®GPT</p></blockquote><p>å¯¹äºä¸€ä¸ªMySQLä½œä¸ºå‘å¸ƒç³»ç»Ÿå­˜å‚¨çš„åœºæ™¯ï¼Œå¤„ç†æ¯å¤©è¶…è¿‡äº”ä¸‡æ¡å¢é‡æ•°æ®å¹¶ä¸”éœ€è¦ä¿æŒä¸‰å¹´çš„æ•°æ®ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›ä¼˜åŒ–å»ºè®®ï¼š</p><ol><li>æ•°æ®åº“ç¡¬ä»¶å’Œé…ç½®ä¼˜åŒ–ï¼š<ul><li>ç¡¬ä»¶æ€§èƒ½ï¼šç¡®ä¿æ•°æ®åº“æœåŠ¡å™¨å…·å¤‡è¶³å¤Ÿçš„è®¡ç®—ã€å†…å­˜å’Œå­˜å‚¨èµ„æºï¼Œä»¥å¤„ç†é«˜è´Ÿè½½çš„å†™å…¥å’Œè¯»å–æ“ä½œã€‚</li><li>å­˜å‚¨è®¾å¤‡ï¼šä½¿ç”¨é«˜æ€§èƒ½çš„å­˜å‚¨è®¾å¤‡ï¼ˆå¦‚SSDï¼‰æ¥æé«˜å†™å…¥å’Œè¯»å–é€Ÿåº¦ã€‚</li><li>MySQLå‚æ•°è°ƒä¼˜ï¼šæ ¹æ®å®é™…æƒ…å†µè°ƒæ•´MySQLçš„é…ç½®å‚æ•°ï¼Œä¾‹å¦‚è®¾ç½®åˆç†çš„ç¼“å†²åŒºå¤§å°ã€å¹¶å‘è¿æ¥æ•°ã€æŸ¥è¯¢ç¼“å­˜ç­‰ã€‚</li></ul></li><li>æ•°æ®åº“æ¶æ„ä¼˜åŒ–ï¼š<ul><li>åˆ†åº“åˆ†è¡¨ï¼šè€ƒè™‘å°†æ•°æ®è¿›è¡Œåˆ†åº“åˆ†è¡¨æ¥åˆ†æ‹…å•ä¸ªæ•°æ®åº“çš„è´Ÿè½½å‹åŠ›ã€‚æ ¹æ®æ•°æ®çš„ç‰¹ç‚¹å’Œè®¿é—®æ¨¡å¼ï¼Œåˆç†åˆ’åˆ†æ•°æ®åˆ°ä¸åŒçš„åº“è¡¨ä¸­ã€‚</li><li>ç´¢å¼•ä¼˜åŒ–ï¼šæ ¹æ®æŸ¥è¯¢éœ€æ±‚åˆ›å»ºåˆé€‚çš„ç´¢å¼•ï¼Œä»¥åŠ å¿«æŸ¥è¯¢é€Ÿåº¦ã€‚é¿å…è¿‡å¤šçš„ç´¢å¼•å’Œå†—ä½™ç´¢å¼•ï¼Œä»¥å‡å°‘ç»´æŠ¤æˆæœ¬ã€‚</li><li>åˆ†åŒºè¡¨ï¼šå¦‚æœæ•°æ®çš„æ—¶é—´èŒƒå›´æœ‰æ˜æ˜¾çš„ç•Œé™ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨MySQLçš„åˆ†åŒºè¡¨åŠŸèƒ½ï¼Œå°†æ•°æ®æŒ‰æ—¶é—´èŒƒå›´è¿›è¡Œåˆ†åŒºï¼Œæé«˜æŸ¥è¯¢æ€§èƒ½å’Œç»´æŠ¤æ•ˆç‡ã€‚</li></ul></li><li>æ•°æ®å†™å…¥ä¼˜åŒ–ï¼š<ul><li>æ‰¹é‡æ’å…¥ï¼šä½¿ç”¨æ‰¹é‡æ’å…¥æ–¹å¼ï¼ˆå¦‚INSERT INTO â€¦ VALUES (), (), ()â€¦ï¼‰æ¥å‡å°‘å•æ¡æ’å…¥çš„å¼€é”€ï¼Œæé«˜å†™å…¥æ€§èƒ½ã€‚</li><li>äº‹åŠ¡å¤„ç†ï¼šå°†å¤šä¸ªå†™å…¥æ“ä½œæ”¾åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œç¡®ä¿æ•°æ®çš„ä¸€è‡´æ€§å’Œå®Œæ•´æ€§ï¼Œå‡å°‘IOå¼€é”€ã€‚</li></ul></li><li>æ•°æ®å½’æ¡£å’Œå‹ç¼©ï¼š<ul><li>æ•°æ®å½’æ¡£ï¼šå¯¹äºå†å²æ•°æ®ï¼Œå¯ä»¥å°†å…¶å½’æ¡£åˆ°ç‹¬ç«‹çš„å­˜å‚¨ä»‹è´¨ä¸­ï¼Œä¾‹å¦‚å°†æ—§æ•°æ®è¿ç§»åˆ°å½’æ¡£æ•°æ®åº“æˆ–è€…ç¦»çº¿å­˜å‚¨ç³»ç»Ÿä¸­ä»¥å‡è½»ä¸»æ•°æ®åº“çš„è´Ÿè½½ã€‚</li><li>æ•°æ®å‹ç¼©ï¼šå¯¹äºä¸é¢‘ç¹æŸ¥è¯¢çš„å†å²æ•°æ®ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨å‹ç¼©ç®—æ³•ï¼ˆä¾‹å¦‚MySQLçš„å‹ç¼©è¡¨åŠŸèƒ½æˆ–è€…ç¬¬ä¸‰æ–¹å‹ç¼©åº“ï¼‰è¿›è¡Œå­˜å‚¨ï¼Œä»¥å‡å°‘å­˜å‚¨ç©ºé—´å ç”¨ã€‚</li></ul></li><li>ç›‘æ§å’Œä¼˜åŒ–å·¥å…·ï¼š<ul><li>ä½¿ç”¨ç›‘æ§å·¥å…·å®æ—¶ç›‘æµ‹æ•°æ®åº“çš„æ€§èƒ½æŒ‡æ ‡ï¼Œå¦‚æŸ¥è¯¢é€Ÿåº¦ã€ç£ç›˜ä½¿ç”¨ã€é”ç­‰æƒ…å†µï¼ŒåŠæ—¶å‘ç°æ½œåœ¨çš„æ€§èƒ½ç“¶é¢ˆå¹¶è¿›è¡Œè°ƒä¼˜ã€‚</li><li>ä½¿ç”¨æ€§èƒ½ä¼˜åŒ–å·¥å…·ï¼Œå¦‚Explainåˆ†æã€æ…¢æŸ¥è¯¢æ—¥å¿—ç­‰ï¼Œæ¥æ‰¾å‡ºæ…¢æŸ¥è¯¢å’Œä½æ•ˆçš„SQLè¯­å¥ï¼Œå¹¶è¿›è¡Œä¼˜åŒ–ã€‚</li></ul></li></ol><p>ä»¥ä¸Šæ˜¯ä¸€äº›å¸¸è§çš„ä¼˜åŒ–å»ºè®®ï¼Œå…·ä½“ä¼˜åŒ–æ–¹æ¡ˆè¿˜éœ€è¦æ ¹æ®å®é™…åœºæ™¯å’Œéœ€æ±‚è¿›è¡Œè°ƒæ•´ã€‚åŒæ—¶ï¼Œå»ºè®®åœ¨è¿›è¡Œä¼˜åŒ–å‰ï¼Œå……åˆ†äº†è§£åº”ç”¨çš„è¯»å†™ç‰¹å¾ã€æ•°æ®è®¿é—®æ¨¡å¼å’Œä¸šåŠ¡éœ€æ±‚ï¼Œä»¥ä¾¿æœ‰é’ˆå¯¹æ€§åœ°è¿›è¡Œä¼˜åŒ–å·¥ä½œã€‚</p><h1 id="26-é”çš„ä¼˜åŒ–ç­–ç•¥ï¼Ÿ"><a href="#26-é”çš„ä¼˜åŒ–ç­–ç•¥ï¼Ÿ" class="headerlink" title="26.é”çš„ä¼˜åŒ–ç­–ç•¥ï¼Ÿ"></a>26.é”çš„ä¼˜åŒ–ç­–ç•¥ï¼Ÿ</h1><h1 id="27-ç´¢å¼•çš„åº•å±‚å®ç°å’Œä¼˜åŒ–ï¼Ÿ"><a href="#27-ç´¢å¼•çš„åº•å±‚å®ç°å’Œä¼˜åŒ–ï¼Ÿ" class="headerlink" title="27.ç´¢å¼•çš„åº•å±‚å®ç°å’Œä¼˜åŒ–ï¼Ÿ"></a>27.ç´¢å¼•çš„åº•å±‚å®ç°å’Œä¼˜åŒ–ï¼Ÿ</h1><p>åº•å±‚ç”¨B+å®ç°ï¼Œä¼˜åŒ–ç´¢å¼•æ–¹å¼è§ç´¢å¼•åšå®¢ <a href="https://blog.musnow.top/posts/3474107655/">https://blog.musnow.top/posts/3474107655/</a></p><h1 id="28-ä»€ä¹ˆæƒ…å†µä¸‹æœ‰ç´¢å¼•ä½†æ˜¯æ— æ³•ä½¿ç”¨"><a href="#28-ä»€ä¹ˆæƒ…å†µä¸‹æœ‰ç´¢å¼•ä½†æ˜¯æ— æ³•ä½¿ç”¨" class="headerlink" title="28.ä»€ä¹ˆæƒ…å†µä¸‹æœ‰ç´¢å¼•ä½†æ˜¯æ— æ³•ä½¿ç”¨"></a>28.ä»€ä¹ˆæƒ…å†µä¸‹æœ‰ç´¢å¼•ä½†æ˜¯æ— æ³•ä½¿ç”¨</h1><p>ç´¢å¼•å¤±æ•ˆï¼Œè§ç´¢å¼•åšå®¢ <a href="https://blog.musnow.top/posts/3474107655/">https://blog.musnow.top/posts/3474107655/</a></p><h1 id="29-å®è·µä¸­å¦‚ä½•ä¼˜åŒ–MySQL"><a href="#29-å®è·µä¸­å¦‚ä½•ä¼˜åŒ–MySQL" class="headerlink" title="29.å®è·µä¸­å¦‚ä½•ä¼˜åŒ–MySQL"></a>29.å®è·µä¸­å¦‚ä½•ä¼˜åŒ–MySQL</h1><p>å¤ªå®½æ³›äº†ï¼Œä¸å¥½å›ç­”</p><ul><li>ç´¢å¼•ä¼˜åŒ–</li><li>åˆ†è¡¨</li><li>äº‹åŠ¡éš”ç¦»æ€§é€‰æ‹©</li></ul><h1 id="30-ä¼˜åŒ–æ•°æ®åº“çš„åŠæ³•ï¼Ÿ"><a href="#30-ä¼˜åŒ–æ•°æ®åº“çš„åŠæ³•ï¼Ÿ" class="headerlink" title="30.ä¼˜åŒ–æ•°æ®åº“çš„åŠæ³•ï¼Ÿ"></a>30.ä¼˜åŒ–æ•°æ®åº“çš„åŠæ³•ï¼Ÿ</h1><p>å’Œ29é¢˜é‡åˆï¼Œä¸åšå›ç­”</p><h1 id="31-ç®€å•æè¿°ç´¢å¼•ã€ä¸»é”®ã€å”¯ä¸€ç´¢å¼•ã€è”åˆç´¢å¼•çš„åŒºåˆ«ï¼Œå¯¹æ•°æ®åº“æ€§èƒ½æœ‰ä»€ä¹ˆå½±å“ï¼ˆè¯»å†™ä¸¤æ–¹é¢ï¼‰"><a href="#31-ç®€å•æè¿°ç´¢å¼•ã€ä¸»é”®ã€å”¯ä¸€ç´¢å¼•ã€è”åˆç´¢å¼•çš„åŒºåˆ«ï¼Œå¯¹æ•°æ®åº“æ€§èƒ½æœ‰ä»€ä¹ˆå½±å“ï¼ˆè¯»å†™ä¸¤æ–¹é¢ï¼‰" class="headerlink" title="31.ç®€å•æè¿°ç´¢å¼•ã€ä¸»é”®ã€å”¯ä¸€ç´¢å¼•ã€è”åˆç´¢å¼•çš„åŒºåˆ«ï¼Œå¯¹æ•°æ®åº“æ€§èƒ½æœ‰ä»€ä¹ˆå½±å“ï¼ˆè¯»å†™ä¸¤æ–¹é¢ï¼‰"></a>31.ç®€å•æè¿°ç´¢å¼•ã€ä¸»é”®ã€å”¯ä¸€ç´¢å¼•ã€è”åˆç´¢å¼•çš„åŒºåˆ«ï¼Œå¯¹æ•°æ®åº“æ€§èƒ½æœ‰ä»€ä¹ˆå½±å“ï¼ˆè¯»å†™ä¸¤æ–¹é¢ï¼‰</h1><p>è§ç´¢å¼•åšå®¢ <a href="https://blog.musnow.top/posts/3474107655/">https://blog.musnow.top/posts/3474107655/</a></p><h1 id="32-æ•°æ®åº“çš„äº‹åŠ¡æ˜¯ä»€ä¹ˆ"><a href="#32-æ•°æ®åº“çš„äº‹åŠ¡æ˜¯ä»€ä¹ˆ" class="headerlink" title="32.æ•°æ®åº“çš„äº‹åŠ¡æ˜¯ä»€ä¹ˆ"></a>32.æ•°æ®åº“çš„äº‹åŠ¡æ˜¯ä»€ä¹ˆ</h1><p>è§äº‹åŠ¡åšå®¢ <a href="https://blog.musnow.top/posts/2200233148/">https://blog.musnow.top/posts/2200233148/</a></p><h1 id="33-SQLæ³¨å…¥æ¼æ´çš„äº§ç”Ÿå’ŒåŸå› ï¼Œå¦‚ä½•é˜²æ­¢"><a href="#33-SQLæ³¨å…¥æ¼æ´çš„äº§ç”Ÿå’ŒåŸå› ï¼Œå¦‚ä½•é˜²æ­¢" class="headerlink" title="33.SQLæ³¨å…¥æ¼æ´çš„äº§ç”Ÿå’ŒåŸå› ï¼Œå¦‚ä½•é˜²æ­¢"></a>33.SQLæ³¨å…¥æ¼æ´çš„äº§ç”Ÿå’ŒåŸå› ï¼Œå¦‚ä½•é˜²æ­¢</h1><p>SQLæ³¨å…¥æ¼æ´æ˜¯ä¸€ç§å¸¸è§çš„å®‰å…¨æ¼æ´ï¼Œå®ƒå¯ä»¥ä½¿æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„SQLè¯­å¥æ¥ç»•è¿‡åº”ç”¨ç¨‹åºçš„è¾“å…¥éªŒè¯ï¼Œè¿›è€Œæ‰§è¡Œéæ³•çš„æ•°æ®åº“æ“ä½œæˆ–è·å–æ•æ„Ÿä¿¡æ¯ã€‚ä»¥ä¸‹æ˜¯SQLæ³¨å…¥æ¼æ´äº§ç”Ÿçš„åŸå› å’Œä¸€äº›é˜²æ­¢æ–¹æ³•ï¼š</p><ol><li>åŸå› ï¼š<ul><li>ä¸æ­£ç¡®çš„è¾“å…¥éªŒè¯ï¼šå½“åº”ç”¨ç¨‹åºæ²¡æœ‰å¯¹ç”¨æˆ·çš„è¾“å…¥è¿›è¡Œå……åˆ†éªŒè¯å’Œè¿‡æ»¤æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡è¾“å…¥ç‰¹å®šçš„å­—ç¬¦æˆ–è¯­å¥æ¥ä¿®æ”¹SQLè¯­å¥çš„ç»“æ„ï¼Œä»è€Œæ‰§è¡Œæ¶æ„æ“ä½œã€‚</li><li>æ‹¼æ¥å­—ç¬¦ä¸²æ„é€ SQLè¯­å¥ï¼šå¦‚æœåº”ç”¨ç¨‹åºä½¿ç”¨æ‹¼æ¥å­—ç¬¦ä¸²çš„æ–¹å¼æ„é€ SQLæŸ¥è¯¢è¯­å¥ï¼Œå¹¶ä¸”æœªå¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œæ­£ç¡®çš„è½¬ä¹‰å¤„ç†ï¼Œå°±å®¹æ˜“å—åˆ°SQLæ³¨å…¥æ”»å‡»ã€‚</li></ul></li><li>é˜²æ­¢æ–¹æ³•ï¼š<ul><li>ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢æˆ–é¢„ç¼–è¯‘è¯­å¥ï¼šå‚æ•°åŒ–æŸ¥è¯¢å°†ç”¨æˆ·è¾“å…¥ä½œä¸ºå‚æ•°ä¼ é€’ç»™SQLè¯­å¥ï¼Œè€Œä¸æ˜¯ç›´æ¥æ‹¼æ¥å­—ç¬¦ä¸²ã€‚è¿™æ ·å¯ä»¥é€šè¿‡æ•°æ®åº“é©±åŠ¨ç¨‹åºè‡ªåŠ¨å¤„ç†è½¬ä¹‰å’Œç¼–ç ï¼Œæœ‰æ•ˆé˜²æ­¢SQLæ³¨å…¥æ”»å‡»ã€‚</li><li>è¾“å…¥éªŒè¯å’Œè¿‡æ»¤ï¼šå¯¹ç”¨æˆ·çš„è¾“å…¥æ•°æ®è¿›è¡ŒéªŒè¯å’Œè¿‡æ»¤ï¼Œåªæ¥å—ç¬¦åˆè§„èŒƒçš„æ•°æ®ã€‚å¯ä»¥ä½¿ç”¨ç™½åå•ã€é»‘åå•ã€æ­£åˆ™è¡¨è¾¾å¼ç­‰æ–¹æ³•è¿›è¡Œè¾“å…¥éªŒè¯å’Œè¿‡æ»¤ã€‚</li><li>æœ€å°æƒé™åŸåˆ™ï¼šåœ¨æ•°æ®åº“ä¸­ä¸ºåº”ç”¨ç¨‹åºä½¿ç”¨çš„è´¦å·è®¾ç½®æœ€å°æƒé™ï¼Œå³åªæˆäºˆåº”ç”¨ç¨‹åºå®Œæˆå¿…è¦æ“ä½œæ‰€éœ€çš„æœ€ä½æƒé™ï¼Œé¿å…æ”»å‡»è€…åˆ©ç”¨æ³¨å…¥æ¼æ´è¿›è¡Œæ›´å±é™©çš„æ“ä½œã€‚</li><li>ä¸è¦ç›´æ¥æš´éœ²æ•°æ®åº“é”™è¯¯ä¿¡æ¯ï¼šåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä¸è¦å°†è¯¦ç»†çš„æ•°æ®åº“é”™è¯¯ä¿¡æ¯è¿”å›ç»™ç”¨æˆ·ï¼Œä»¥é˜²æ­¢æ”»å‡»è€…ä»ä¸­è·å–å…³é”®ä¿¡æ¯ã€‚å¯ä»¥è®°å½•é”™è¯¯æ—¥å¿—å¹¶ç»™ç”¨æˆ·ä¸€ä¸ªå‹å¥½çš„é”™è¯¯æç¤ºã€‚</li><li>å®šæœŸæ›´æ–°å’Œä¿®è¡¥æ•°æ®åº“å’Œåº”ç”¨ç¨‹åºï¼šåŠæ—¶å®‰è£…æ•°æ®åº“å’Œåº”ç”¨ç¨‹åºçš„å®‰å…¨è¡¥ä¸ï¼Œä»¥ä¿®å¤å·²çŸ¥çš„æ¼æ´ï¼Œå¹¶ç¡®ä¿ä½¿ç”¨æœ€æ–°çš„å®‰å…¨æªæ–½ã€‚</li></ul></li></ol><p>æ€»ä¹‹ï¼Œä¸ºäº†é˜²æ­¢SQLæ³¨å…¥æ¼æ´ï¼Œå…³é”®æ˜¯è¦å¯¹ç”¨æˆ·è¾“å…¥æ•°æ®è¿›è¡Œåˆç†éªŒè¯ã€è¿‡æ»¤å’Œè½¬ä¹‰å¤„ç†ï¼Œå¹¶ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢æˆ–é¢„ç¼–è¯‘è¯­å¥æ¥æ„é€ SQLè¯­å¥ã€‚åŒæ—¶ï¼Œä¿æŒåº”ç”¨ç¨‹åºå’Œæ•°æ®åº“çš„å®‰å…¨æ€§ï¼Œå¹¶åŠæ—¶æ›´æ–°å’Œä¿®è¡¥å·²çŸ¥çš„å®‰å…¨æ¼æ´ã€‚</p><h1 id="34-å¦‚ä½•ä¸ºè¡¨ä¸­å­—æ®µé€‰æ‹©åˆé€‚æ•°æ®ç±»å‹"><a href="#34-å¦‚ä½•ä¸ºè¡¨ä¸­å­—æ®µé€‰æ‹©åˆé€‚æ•°æ®ç±»å‹" class="headerlink" title="34.å¦‚ä½•ä¸ºè¡¨ä¸­å­—æ®µé€‰æ‹©åˆé€‚æ•°æ®ç±»å‹"></a>34.å¦‚ä½•ä¸ºè¡¨ä¸­å­—æ®µé€‰æ‹©åˆé€‚æ•°æ®ç±»å‹</h1><p>è‚¯å®šæ˜¯æ ¹æ®å…·ä½“æƒ…å†µå›ç­”</p><h1 id="35-å­˜å‚¨æ—¶æœŸï¼Ÿ"><a href="#35-å­˜å‚¨æ—¶æœŸï¼Ÿ" class="headerlink" title="35.å­˜å‚¨æ—¶æœŸï¼Ÿ"></a>35.å­˜å‚¨æ—¶æœŸï¼Ÿ</h1><p>æ„Ÿè§‰è¿™é“é¢˜æœ‰é—®é¢˜ï¼Œä¸ç®¡ä»–</p><h1 id="36-ç´¢å¼•ç›¸å…³é—®é¢˜ï¼Ÿ"><a href="#36-ç´¢å¼•ç›¸å…³é—®é¢˜ï¼Ÿ" class="headerlink" title="36.ç´¢å¼•ç›¸å…³é—®é¢˜ï¼Ÿ"></a>36.ç´¢å¼•ç›¸å…³é—®é¢˜ï¼Ÿ</h1><p>å’Œ31é‡åˆï¼Œä¸å›ç­”</p><h1 id="37-è§£é‡ŠMySQLä¸­å¤–è¿æ¥ã€å†…è¿æ¥ã€è‡ªè¿æ¥çš„åŒºåˆ«"><a href="#37-è§£é‡ŠMySQLä¸­å¤–è¿æ¥ã€å†…è¿æ¥ã€è‡ªè¿æ¥çš„åŒºåˆ«" class="headerlink" title="37.è§£é‡ŠMySQLä¸­å¤–è¿æ¥ã€å†…è¿æ¥ã€è‡ªè¿æ¥çš„åŒºåˆ«"></a>37.è§£é‡ŠMySQLä¸­å¤–è¿æ¥ã€å†…è¿æ¥ã€è‡ªè¿æ¥çš„åŒºåˆ«</h1><ol><li>å†…è¿æ¥ï¼ˆINNER JOINï¼‰ï¼š<ul><li>å†…è¿æ¥è¿”å›ä¸¤ä¸ªè¡¨ä¸­æ»¡è¶³è¿æ¥æ¡ä»¶çš„è®°å½•ï¼Œå³åªè¿”å›ä¸¤ä¸ªè¡¨ä¸­èƒ½å¤ŸåŒ¹é…çš„è¡Œã€‚</li><li>å†…è¿æ¥ä½¿ç”¨ä¸€ä¸ªè¿æ¥è°“è¯ï¼ˆJOINï¼‰æˆ–è€…åœ¨FROMå­å¥ä¸­ä½¿ç”¨é€—å·ï¼ˆ,ï¼‰æ¥è¡¨ç¤ºã€‚</li><li>å†…è¿æ¥å¯ä»¥æ ¹æ®æŒ‡å®šçš„è¿æ¥æ¡ä»¶å°†ä¸¤ä¸ªè¡¨ä¸­çš„åˆ—è¿›è¡ŒåŒ¹é…ã€‚å¦‚æœæœªæä¾›è¿æ¥æ¡ä»¶ï¼Œåˆ™ä¼šè¿”å›ä¸¤ä¸ªè¡¨çš„ç¬›å¡å°”ç§¯ã€‚</li><li>è¯­æ³•ç¤ºä¾‹ï¼šSELECT * FROM è¡¨1 INNER JOIN è¡¨2 ON è¡¨1.åˆ— &#x3D; è¡¨2.åˆ—;</li></ul></li><li>å¤–è¿æ¥ï¼ˆOUTER JOINï¼‰ï¼š<ul><li>å¤–è¿æ¥å°†è¿”å›ä¸¤ä¸ªè¡¨ä¸­æ»¡è¶³è¿æ¥æ¡ä»¶çš„è®°å½•ï¼Œå¹¶ä¸”è¿˜åŒ…æ‹¬ä¸æ»¡è¶³è¿æ¥æ¡ä»¶çš„è®°å½•ã€‚</li><li>å¤–è¿æ¥åˆ†ä¸ºå·¦å¤–è¿æ¥ï¼ˆLEFT JOINï¼‰å’Œå³å¤–è¿æ¥ï¼ˆRIGHT JOINï¼‰ã€‚</li><li>å·¦å¤–è¿æ¥è¿”å›å·¦è¡¨ä¸­çš„æ‰€æœ‰è®°å½•ï¼Œä»¥åŠå³è¡¨ä¸­ä¸å·¦è¡¨æ»¡è¶³è¿æ¥æ¡ä»¶çš„è®°å½•ã€‚å¦‚æœå³è¡¨ä¸­æ²¡æœ‰åŒ¹é…çš„è®°å½•ï¼Œåˆ™ä¼šè¿”å›NULLå€¼ã€‚</li><li>å³å¤–è¿æ¥è¿”å›å³è¡¨ä¸­çš„æ‰€æœ‰è®°å½•ï¼Œä»¥åŠå·¦è¡¨ä¸­ä¸å³è¡¨æ»¡è¶³è¿æ¥æ¡ä»¶çš„è®°å½•ã€‚å¦‚æœå·¦è¡¨ä¸­æ²¡æœ‰åŒ¹é…çš„è®°å½•ï¼Œåˆ™ä¼šè¿”å›NULLå€¼ã€‚</li><li>è¯­æ³•ç¤ºä¾‹ï¼š<ul><li>å·¦å¤–è¿æ¥ï¼šSELECT * FROM è¡¨1 LEFT JOIN è¡¨2 ON è¡¨1.åˆ— &#x3D; è¡¨2.åˆ—;</li><li>å³å¤–è¿æ¥ï¼šSELECT * FROM è¡¨1 RIGHT JOIN è¡¨2 ON è¡¨1.åˆ— &#x3D; è¡¨2.åˆ—;</li></ul></li></ul></li><li>è‡ªè¿æ¥ï¼ˆSELF JOINï¼‰ï¼š<ul><li>è‡ªè¿æ¥æ˜¯æŒ‡å°†è¡¨è§†ä¸ºä¸¤ä¸ªç‹¬ç«‹çš„å®ä¾‹ï¼Œä½¿ç”¨åˆ«åæ¥åŒºåˆ†å®ƒä»¬ï¼Œç„¶åæ ¹æ®æŸäº›æ¡ä»¶å°†å®ƒä»¬è¿æ¥åœ¨ä¸€èµ·ã€‚</li><li>è‡ªè¿æ¥é€šå¸¸ç”¨äºåœ¨åŒä¸€ä¸ªè¡¨ä¸­æ ¹æ®æŸç§å…³ç³»è¿›è¡Œæ•°æ®æŸ¥è¯¢ã€‚</li><li>è¯­æ³•ç¤ºä¾‹ï¼šSELECT åˆ«å1.åˆ—, åˆ«å2.åˆ— FROM è¡¨ åˆ«å1, è¡¨ åˆ«å2 WHERE åˆ«å1.åˆ— &#x3D; åˆ«å2.åˆ—;</li></ul></li></ol><p>æ€»ç»“ï¼š</p><ul><li>å†…è¿æ¥è¿”å›ä¸¤ä¸ªè¡¨ä¸­åŒ¹é…çš„è®°å½•ï¼Œå¤–è¿æ¥è¿”å›æ»¡è¶³è¿æ¥æ¡ä»¶çš„è®°å½•ä»¥åŠä¸æ»¡è¶³è¿æ¥æ¡ä»¶çš„è®°å½•ï¼Œè€Œè‡ªè¿æ¥æ˜¯å¯¹åŒä¸€ä¸ªè¡¨è¿›è¡Œè¿æ¥æ“ä½œã€‚</li><li>å†…è¿æ¥å’Œå¤–è¿æ¥éœ€è¦ä½¿ç”¨JOINå…³é”®å­—ï¼Œè€Œè‡ªè¿æ¥ä½¿ç”¨åŒä¸€ä¸ªè¡¨çš„åˆ«åè¿›è¡Œè¿æ¥ã€‚</li><li>å†…è¿æ¥å’Œå¤–è¿æ¥å¯ä»¥æ ¹æ®è¿æ¥æ¡ä»¶å°†ä¸¤ä¸ªè¡¨è¿›è¡Œå…³è”ï¼Œè€Œè‡ªè¿æ¥å¯ä»¥æ ¹æ®è¡¨ä¸­çš„æŸäº›æ¡ä»¶è¿›è¡Œå…³è”ã€‚</li></ul><h1 id="38-MySQLä¸­äº‹åŠ¡å›æ»šæœºåˆ¶æè¿°"><a href="#38-MySQLä¸­äº‹åŠ¡å›æ»šæœºåˆ¶æè¿°" class="headerlink" title="38.MySQLä¸­äº‹åŠ¡å›æ»šæœºåˆ¶æè¿°"></a>38.MySQLä¸­äº‹åŠ¡å›æ»šæœºåˆ¶æè¿°</h1><p>è§äº‹åŠ¡åšå®¢ <a href="https://blog.musnow.top/posts/2200233148/">https://blog.musnow.top/posts/2200233148/</a></p><h1 id="39-SQLè¯­è¨€åŒ…å«å“ªå‡ éƒ¨åˆ†ï¼Ÿæ¯éƒ¨åˆ†éƒ½æœ‰å“ªäº›æ“ä½œå…³é”®å­—"><a href="#39-SQLè¯­è¨€åŒ…å«å“ªå‡ éƒ¨åˆ†ï¼Ÿæ¯éƒ¨åˆ†éƒ½æœ‰å“ªäº›æ“ä½œå…³é”®å­—" class="headerlink" title="39.SQLè¯­è¨€åŒ…å«å“ªå‡ éƒ¨åˆ†ï¼Ÿæ¯éƒ¨åˆ†éƒ½æœ‰å“ªäº›æ“ä½œå…³é”®å­—"></a>39.SQLè¯­è¨€åŒ…å«å“ªå‡ éƒ¨åˆ†ï¼Ÿæ¯éƒ¨åˆ†éƒ½æœ‰å“ªäº›æ“ä½œå…³é”®å­—</h1><p>åŒ…æ‹¬DQLæ•°æ®æŸ¥è¯¢è¯­è¨€ï¼ŒDMLæ•°æ®æ“ä½œè¯­è¨€ï¼ˆå¢åˆ æ”¹ï¼‰ï¼Œæ•°æ®æ§åˆ¶è¯­è¨€DCLç”¨æ¥ç®¡ç†æ•°æ®åº“ï¼Œäº‹åŠ¡æ§åˆ¶è¯­è¨€TCLç”¨æ¥æ§åˆ¶äº‹åŠ¡ï¼Œæ•°æ®å®šä¹‰è¯­è¨€DDLç”¨æ¥åˆ›å»ºåˆ é™¤è¡¨</p><ol><li>æ•°æ®æŸ¥è¯¢è¯­è¨€ï¼ˆData Query Languageï¼ŒDQLï¼‰ï¼šç”¨äºä»æ•°æ®åº“ä¸­æŸ¥è¯¢å’Œæ£€ç´¢æ•°æ®ã€‚å¸¸ç”¨çš„æ“ä½œå…³é”®å­—åŒ…æ‹¬ï¼š<ul><li>SELECTï¼šç”¨äºä»ä¸€ä¸ªæˆ–å¤šä¸ªè¡¨ä¸­é€‰æ‹©æ•°æ®åˆ—ä»¥è¿›è¡ŒæŸ¥è¯¢ã€‚</li><li>FROMï¼šæŒ‡å®šè¦æŸ¥è¯¢çš„è¡¨ã€‚</li><li>WHEREï¼šç”¨äºæŒ‡å®šæŸ¥è¯¢çš„æ¡ä»¶ã€‚</li><li>GROUP BYï¼šæŒ‰ç…§æŒ‡å®šçš„åˆ—å¯¹ç»“æœè¿›è¡Œåˆ†ç»„ã€‚</li><li>HAVINGï¼šç”¨äºæŒ‡å®šå¯¹åˆ†ç»„åçš„ç»“æœè¿›è¡Œç­›é€‰çš„æ¡ä»¶ã€‚</li><li>ORDER BYï¼šæŒ‡å®šç»“æœé›†çš„æ’åºæ–¹å¼ã€‚</li></ul></li><li>æ•°æ®æ“ä½œè¯­è¨€ï¼ˆData Manipulation Languageï¼ŒDMLï¼‰ï¼šç”¨äºå¯¹æ•°æ®åº“ä¸­çš„æ•°æ®è¿›è¡Œå¢åŠ ã€ä¿®æ”¹å’Œåˆ é™¤æ“ä½œã€‚å¸¸ç”¨çš„æ“ä½œå…³é”®å­—åŒ…æ‹¬ï¼š<ul><li>INSERT INTOï¼šå‘è¡¨ä¸­æ’å…¥æ–°çš„è¡Œæˆ–æ•°æ®ã€‚</li><li>UPDATEï¼šæ›´æ–°è¡¨ä¸­å·²æœ‰çš„æ•°æ®ã€‚</li><li>DELETE FROMï¼šä»è¡¨ä¸­åˆ é™¤æŒ‡å®šçš„è¡Œæˆ–æ•°æ®ã€‚</li></ul></li><li>æ•°æ®å®šä¹‰è¯­è¨€ï¼ˆData Definition Languageï¼ŒDDLï¼‰ï¼šç”¨äºåˆ›å»ºã€ä¿®æ”¹å’Œåˆ é™¤æ•°æ®åº“å’Œè¡¨ç»“æ„ã€‚å¸¸ç”¨çš„æ“ä½œå…³é”®å­—åŒ…æ‹¬ï¼š<ul><li>CREATE DATABASEï¼šåˆ›å»ºæ–°çš„æ•°æ®åº“ã€‚</li><li>CREATE TABLEï¼šåˆ›å»ºæ–°çš„æ•°æ®è¡¨ã€‚</li><li>ALTER TABLEï¼šä¿®æ”¹å·²å­˜åœ¨çš„æ•°æ®è¡¨ç»“æ„ã€‚</li><li>DROP DATABASEï¼šåˆ é™¤ç°æœ‰çš„æ•°æ®åº“ã€‚</li><li>DROP TABLEï¼šåˆ é™¤ç°æœ‰çš„æ•°æ®è¡¨ã€‚</li></ul></li><li>æ•°æ®æ§åˆ¶è¯­è¨€ï¼ˆData Control Languageï¼ŒDCLï¼‰ï¼šç”¨äºç®¡ç†æ•°æ®åº“ä¸­çš„ç”¨æˆ·æƒé™å’Œè®¿é—®æƒé™ã€‚å¸¸ç”¨çš„æ“ä½œå…³é”®å­—åŒ…æ‹¬ï¼š<ul><li>GRANTï¼šæˆäºˆç”¨æˆ·ç‰¹å®šçš„æƒé™ã€‚</li><li>REVOKEï¼šæ’¤é”€ç”¨æˆ·çš„æƒé™ã€‚</li></ul></li><li>äº‹åŠ¡æ§åˆ¶è¯­è¨€ï¼ˆTransaction Control Languageï¼ŒTCLï¼‰ï¼šç”¨äºç®¡ç†æ•°æ®åº“çš„äº‹åŠ¡å¤„ç†ã€‚å¸¸ç”¨çš„æ“ä½œå…³é”®å­—åŒ…æ‹¬ï¼š<ul><li>COMMITï¼šæäº¤ä¸€ä¸ªäº‹åŠ¡ï¼Œä½¿å…¶æ°¸ä¹…ç”Ÿæ•ˆã€‚</li><li>ROLLBACKï¼šå›æ»šä¸€ä¸ªäº‹åŠ¡ï¼Œæ’¤é”€ä¹‹å‰çš„æ“ä½œï¼Œä½¿å…¶ä¸ç”Ÿæ•ˆã€‚</li><li>SAVEPOINTï¼šåœ¨äº‹åŠ¡ä¸­è®¾ç½®ä¿å­˜ç‚¹ï¼Œä»¥ä¾¿åœ¨éœ€è¦æ—¶è¿›è¡Œå›æ»šã€‚</li></ul></li></ol><h1 id="40-å®Œæ•´æ€§çš„çº¦æŸåŒ…æ‹¬é‚£äº›ï¼Ÿ"><a href="#40-å®Œæ•´æ€§çš„çº¦æŸåŒ…æ‹¬é‚£äº›ï¼Ÿ" class="headerlink" title="40.å®Œæ•´æ€§çš„çº¦æŸåŒ…æ‹¬é‚£äº›ï¼Ÿ"></a>40.å®Œæ•´æ€§çš„çº¦æŸåŒ…æ‹¬é‚£äº›ï¼Ÿ</h1><p>åŸå­æ€§ã€éš”ç¦»æ€§ã€æŒä¹…æ€§ï¼›è¿™é‡Œè¯´çš„å®Œæ•´æ€§åº”è¯¥å°±æ˜¯ä¸€è‡´æ€§ï¼›</p><p>å…·ä½“çš„è§£é‡Šä¾æ—§æ˜¯å»çœ‹äº‹åŠ¡çš„åšå®¢ <a href="https://blog.musnow.top/posts/2200233148/">https://blog.musnow.top/posts/2200233148/</a></p>]]></content>
    
    
    <summary type="html">å­—èŠ‚MySQLè¿ç¯40é—®</summary>
    
    
    
    <category term="å­¦ä¹ sql" scheme="https://blog.musnow.top/categories/%E5%AD%A6%E4%B9%A0sql/"/>
    
    
    <category term="mysql" scheme="https://blog.musnow.top/tags/mysql/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢ç»ã€‘230913ä¸Šæµ·é›¶å¿µç§‘æŠ€CPPå®ä¹ ç”Ÿ</title>
    <link href="https://blog.musnow.top/posts/2719794733/"/>
    <id>https://blog.musnow.top/posts/2719794733/</id>
    <published>2023-09-13T09:32:14.000Z</published>
    <updated>2023-09-13T10:32:14.000Z</updated>
    
    <content type="html"><![CDATA[<p>230913ä¸Šæµ·é›¶å¿µç§‘æŠ€CPPå®ä¹ ç”Ÿé¢è¯•è®°å½•</p><span id="more"></span><p>ä¸Šæ¥å…ˆåšäº†ä¸ªè‡ªæˆ‘ä»‹ç»ï¼Œç„¶åé¢è¯•å®˜ä»‹ç»äº†ä»–ä»¬æ˜¯åšç³»ç»Ÿè¿›ç¨‹è°ƒåº¦çš„ï¼›</p><h1 id="CPP"><a href="#CPP" class="headerlink" title="CPP"></a>CPP</h1><p>é¢˜ç›®é¡ºåºå¹¶éå®é™…é—®çš„é¡ºåº</p><h2 id="1-ç±»çš„å¤§å°"><a href="#1-ç±»çš„å¤§å°" class="headerlink" title="1.ç±»çš„å¤§å°"></a>1.ç±»çš„å¤§å°</h2><p>ç±»çš„å¤§å°å’Œä»€ä¹ˆä¸œè¥¿æœ‰å…³ç³»ï¼Ÿ</p><p>æˆ‘ç­”äº†æˆå‘˜å˜é‡å’Œè™šå‡½æ•°è¡¨</p><h2 id="2-å¤šæ€æ€ä¹ˆå®ç°çš„"><a href="#2-å¤šæ€æ€ä¹ˆå®ç°çš„" class="headerlink" title="2.å¤šæ€æ€ä¹ˆå®ç°çš„"></a>2.å¤šæ€æ€ä¹ˆå®ç°çš„</h2><p>é¡ºç€è™šå‡½æ•°è¡¨é—®çš„ï¼Œå°±è¯´äº†ä¸€ä¸‹åŠ¨æ€å¤šæ€çš„åŸºæœ¬å®ç°æ–¹å¼</p><h2 id="3-åªèƒ½åœ¨æ ˆä¸Šçš„ç±»"><a href="#3-åªèƒ½åœ¨æ ˆä¸Šçš„ç±»" class="headerlink" title="3.åªèƒ½åœ¨æ ˆä¸Šçš„ç±»"></a>3.åªèƒ½åœ¨æ ˆä¸Šçš„ç±»</h2><p>ç¦æ­¢æ‹·è´æ„é€ å’Œèµ‹å€¼ï¼Œæ„é€ å‡½æ•°ç§æœ‰åŒ–ï¼Œæä¾›å•ç‹¬å‡½æ•°åœ¨æ ˆä¸Šå¼€è¾Ÿç©ºé—´ï¼›</p><p>é¡ºä¾¿é—®äº†ä¸€ä¸‹åŠ¨æ€å†…å­˜ç®¡ç†çš„åŸºç¡€å½¢å¼</p><h2 id="4-æ™ºèƒ½æŒ‡é’ˆ"><a href="#4-æ™ºèƒ½æŒ‡é’ˆ" class="headerlink" title="4.æ™ºèƒ½æŒ‡é’ˆ"></a>4.æ™ºèƒ½æŒ‡é’ˆ</h2><p>å“ªäº›ç±»å‹ï¼Ÿæœ‰å•¥åŒºåˆ«ï¼Ÿweak ptræ€ä¹ˆè§£å†³å¾ªç¯å¼•ç”¨é—®é¢˜çš„ï¼Ÿ</p><p>weak ptrçš„lockå‡½æ•°ç”¨è¿‡å—ï¼Ÿæœ‰æ²¡æœ‰åŠæ³•è·å–åˆ°shared ptrçš„å¼•ç”¨è®¡æ•°ï¼Ÿ</p><p>unique_ptrå¯ä»¥è½¬æˆshare_ptrå—ï¼Ÿ</p><p>å¦‚æœè¦ç”¨C++11çš„ç±»å‹è½¬æ¢ï¼Œè¦ä½¿ç”¨å“ªä¸€ä¸ªæ¥è¿›è¡Œunique_ptrå’Œshare_ptrçš„è½¬æ¢ï¼Ÿï¼ˆè¿™ä¸ªä¸ä¼šï¼Œåº”è¯¥æ˜¯static_castï¼‰</p><p>å®šåˆ¶åˆ é™¤å™¨æ˜¯å¹²å˜›çš„ï¼Ÿ</p><p>æ™ºèƒ½æŒ‡é’ˆçº¿ç¨‹å®‰å…¨å—ï¼Ÿ</p><p>æ‹·è´æ„é€ share_pträ¼šä¸ä¼šæœ‰å†…å­˜æ³„æ¼ï¼Ÿ</p><h2 id="5-ç±»å‹è½¬æ¢"><a href="#5-ç±»å‹è½¬æ¢" class="headerlink" title="5.ç±»å‹è½¬æ¢"></a>5.ç±»å‹è½¬æ¢</h2><p>C++11çš„ç±»å‹è½¬æ¢ï¼Œå‡ ä¸ªï¼ŒåŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>æŒ‡é’ˆä¹‹é—´è½¬æ¢è¦ç”¨ä»€ä¹ˆï¼Ÿï¼ˆä¸ä¼šï¼Œç­”çš„staticï¼‰</p><p>dynamic_castçˆ¶å­è½¬æ¢çš„æ—¶å€™ï¼Œå‘ä¸Šè¿˜æ˜¯å‘ä¸‹æ˜¯å®‰å…¨çš„ï¼Ÿï¼ˆå­è½¬æˆçˆ¶æ˜¯å®‰å…¨çš„ï¼Œå³å‘ä¸Šå®‰å…¨ï¼‰</p><h2 id="6-å•ä¾‹"><a href="#6-å•ä¾‹" class="headerlink" title="6.å•ä¾‹"></a>6.å•ä¾‹</h2><p>å‡ ç§ç±»å‹ï¼Œæ€ä¹ˆå®ç°ï¼Ÿ</p><h2 id="7-æ¨¡æ¿"><a href="#7-æ¨¡æ¿" class="headerlink" title="7.æ¨¡æ¿"></a>7.æ¨¡æ¿</h2><p>æ¨¡æ¿çš„å£°æ˜å’Œå®šä¹‰ä¸ºå•¥ä¸èƒ½åˆ†ç¦»ï¼Ÿï¼ˆå¿˜è®°äº†ï¼‰</p><p>æ¨¡æ¿ç‰¹åŒ–æ˜¯ä»€ä¹ˆï¼Ÿå‡½æ•°æ¨¡æ¿æ”¯æŒåŠç‰¹åŒ–å—ï¼Ÿï¼ˆä¸æ”¯æŒï¼‰</p><h2 id="8-C-çº¿ç¨‹å’Œasyncæœ‰å•¥åŒºåˆ«ï¼Ÿ"><a href="#8-C-çº¿ç¨‹å’Œasyncæœ‰å•¥åŒºåˆ«ï¼Ÿ" class="headerlink" title="8.C++çº¿ç¨‹å’Œasyncæœ‰å•¥åŒºåˆ«ï¼Ÿ"></a>8.C++çº¿ç¨‹å’Œasyncæœ‰å•¥åŒºåˆ«ï¼Ÿ</h2><p>threadæ˜¯ç±»ï¼Œaysncæ˜¯å‡½æ•°</p><p>asyncæœ‰ä¸¤ç§ç”¨æ³•ï¼Œä¸€ä¸ªæ˜¯ç«‹é©¬å¼‚æ­¥æ‰§è¡Œï¼Œä¼šå¼€ä¸€ä¸ªçº¿ç¨‹ï¼›ç¬¬äºŒä¸ªæ˜¯å»¶è¿ŸåŒæ­¥æ‰§è¡Œï¼Œåœ¨ä½¿ç”¨<code>future.get</code>çš„æ—¶å€™æ‰ä¼šæ‰§è¡Œã€‚</p><p>è¿™éƒ¨åˆ†æ˜¯åœ¨äº‘è´¦æˆ¿é¢è¯•çš„æ—¶å€™é—®é“çš„ï¼Œå¾—äºæˆ‘ä¸“é—¨å»å­¦äº†ï¼Œå¼€å¿ƒï¼</p><h2 id="9-C-14æ–°ç‰¹æ€§"><a href="#9-C-14æ–°ç‰¹æ€§" class="headerlink" title="9.C++14æ–°ç‰¹æ€§"></a>9.C++14æ–°ç‰¹æ€§</h2><p>çŸ¥é“çš„å…¨è¯´äº†ï¼Œautoï¼Œlambdaæ–°ç‰¹æ€§ï¼Œconstexprï¼ˆå’Œc++11çš„åŒºåˆ«ï¼‰ï¼Œå˜é‡æ¨¡æ¿ï¼ŒäºŒè¿›åˆ¶å˜é‡ï¼Œç„¶åè¿˜è¯´äº†æœ€åå‡ ä¸ªstdçš„å‡½æ•°çœ‹ä¸æ˜ç™½ï¼›é¢è¯•å®˜äººå¾ˆå¥½ï¼Œä¸€ç›´è¯´æ²¡å…³ç³»ï¼›</p><p>ä¸“é—¨é—®äº†<code>constexpr</code>å£°æ˜å˜é‡å’Œconstæœ‰å•¥åŒºåˆ«ï¼ˆä¸çŸ¥é“ï¼‰</p><blockquote><p>GPTçš„å›ç­”</p><ol><li>æ—¶é—´ç‚¹ï¼š<code>constexpr</code> æ˜¯åœ¨ç¼–è¯‘æ—¶ç¡®å®šå€¼çš„ï¼Œè€Œ <code>const</code> æ˜¯åœ¨è¿è¡Œæ—¶ç¡®å®šå€¼çš„ã€‚</li><li>ç¼–è¯‘æœŸè®¡ç®—ï¼š<code>constexpr</code> å˜é‡å¯ä»¥ç”¨äºç¼–è¯‘æ—¶æœŸé—´çš„è®¡ç®—ï¼Œæ¯”å¦‚æ•°ç»„å¤§å°ã€æ¨¡æ¿å‚æ•°ç­‰éœ€è¦åœ¨ç¼–è¯‘é˜¶æ®µç¡®å®šå¤§å°çš„åœºæ™¯ã€‚è€Œ <code>const</code> å˜é‡åªæ˜¯è¡¨ç¤ºå®ƒçš„å€¼ä¸å¯ä»¥ä¿®æ”¹ï¼Œåœ¨ç¼–è¯‘é˜¶æ®µæ— æ³•ä½¿ç”¨ <code>const</code> å˜é‡è¿›è¡Œç¼–è¯‘æœŸè®¡ç®—ã€‚</li><li>åˆå§‹åŒ–ï¼š<code>constexpr</code> å˜é‡å¿…é¡»åœ¨å£°æ˜æ—¶è¿›è¡Œåˆå§‹åŒ–ï¼Œå¹¶ä¸”åªèƒ½ä½¿ç”¨å¸¸é‡è¡¨è¾¾å¼åˆå§‹åŒ–ï¼›<code>const</code> å˜é‡å¯ä»¥åœ¨å£°æ˜æ—¶åˆå§‹åŒ–ï¼Œä¹Ÿå¯ä»¥ç¨åèµ‹å€¼ï¼Œä½†èµ‹å€¼åå°±ä¸èƒ½å†ä¿®æ”¹ã€‚</li><li>åœ°å€ï¼š<code>constexpr</code> å˜é‡å¾€å¾€ä¼šè¢«ç¼–è¯‘å™¨ä¼˜åŒ–ï¼Œå¯èƒ½ä¸ä¼šå ç”¨å†…å­˜ç©ºé—´ï¼Œå¹¶ä¸”åœ¨ç¼–è¯‘æœŸé—´è¢«æ¶ˆé™¤ã€‚<code>const</code> å˜é‡åœ¨è¿è¡Œæ—¶åˆ†é…å†…å­˜ï¼Œå¹¶ä¸”æœ‰ç›¸åº”çš„å†…å­˜åœ°å€ã€‚</li><li>ä½†æ˜¯è¿™ä¸¤ä¸ªå…³é”®å­—å£°æ˜çš„å˜é‡éƒ½å…·æœ‰å¸¸é‡å±æ€§ï¼Œä¸å¯ä¿®æ”¹ï¼›</li></ol></blockquote><p>å¯¹C++17æœ‰æ²¡æœ‰äº†è§£ï¼Ÿï¼ˆæ— ï¼‰</p><h2 id="10-stlç”¨è¿‡ä»€ä¹ˆï¼Ÿ"><a href="#10-stlç”¨è¿‡ä»€ä¹ˆï¼Ÿ" class="headerlink" title="10.stlç”¨è¿‡ä»€ä¹ˆï¼Ÿ"></a>10.stlç”¨è¿‡ä»€ä¹ˆï¼Ÿ</h2><p>æŠŠå¸¸ç”¨çš„stléƒ½è¯´äº†ä¸€é</p><p>stlçº¿ç¨‹å®‰å…¨å—ï¼Ÿå½“ç„¶ä¸</p><h2 id="11-vectorå’ŒarrayåŒºåˆ«"><a href="#11-vectorå’ŒarrayåŒºåˆ«" class="headerlink" title="11.vectorå’ŒarrayåŒºåˆ«"></a>11.vectorå’ŒarrayåŒºåˆ«</h2><p>arrayæ˜¯å®šé•¿æ•°ç»„ï¼ŒvectoråŠ¨æ€å¼€è¾Ÿ</p><p>arrayå¯ä»¥ä½¿ç”¨è¿­ä»£å™¨ï¼Œä¿è¯ä»£ç é£æ ¼ç»Ÿä¸€</p><p>è¿™é‡Œé¡ºä¾¿æåˆ°äº†<code>[]</code>çš„é‡è½½ï¼Œé¢è¯•å®˜é—®äº†vectoré‡Œé¢atå‡½æ•°å’Œ<code>[]</code>é‡è½½çš„åŒºåˆ«ï¼ˆatä¼šæŠ›å¼‚å¸¸ï¼Œ<code>[]</code>ä¸ä¼šï¼‰</p><h2 id="12-emplace-backå’Œpush-backåŒºåˆ«"><a href="#12-emplace-backå’Œpush-backåŒºåˆ«" class="headerlink" title="12.emplace_backå’Œpush_backåŒºåˆ«"></a>12.emplace_backå’Œpush_backåŒºåˆ«</h2><p>æˆ‘è¯´äº†emplace_backèƒ½èŠ‚çœä¸€æ¬¡æ‹·è´çš„æ¶ˆè€—ï¼›</p><p>é¢è¯•å®˜é—®è¦æ€ä¹ˆä½¿ç”¨æ‰èƒ½èŠ‚çœè¿™ä¸ªæ¶ˆè€—ï¼Ÿä½¿ç”¨æ–¹å¼ï¼ˆä¸ä¼šï¼‰</p><p>emplace_backæ—¢ç„¶é«˜æ•ˆï¼Œä¸ºå•¥æ²¡æœ‰å–ä»£push_backï¼Ÿï¼ˆä¸ä¼šï¼Œè¿™é‡Œæˆ‘å°±è¯´äº†ä¸€ä¸‹è®¾è®¡è€ƒè™‘å…¼å®¹æ€§çš„é—®é¢˜ï¼‰</p><h2 id="13-åˆå§‹åŒ–åˆ—è¡¨ã€æ„é€ å‡½æ•°ä½“å†…åˆå§‹åŒ–ã€æˆå‘˜å˜é‡ç»™ç¼ºçœå€¼"><a href="#13-åˆå§‹åŒ–åˆ—è¡¨ã€æ„é€ å‡½æ•°ä½“å†…åˆå§‹åŒ–ã€æˆå‘˜å˜é‡ç»™ç¼ºçœå€¼" class="headerlink" title="13.åˆå§‹åŒ–åˆ—è¡¨ã€æ„é€ å‡½æ•°ä½“å†…åˆå§‹åŒ–ã€æˆå‘˜å˜é‡ç»™ç¼ºçœå€¼"></a>13.åˆå§‹åŒ–åˆ—è¡¨ã€æ„é€ å‡½æ•°ä½“å†…åˆå§‹åŒ–ã€æˆå‘˜å˜é‡ç»™ç¼ºçœå€¼</h2><p>é‚£ä¸ªæ›´å¥½ï¼Ÿæœ‰å•¥åŒºåˆ«ï¼Ÿ</p><p>å¼•ç”¨æ˜¯æ²¡æœ‰åŠæ³•ä½¿ç”¨ç¼ºçœå€¼çš„ï¼Œåªæœ‰å¸¸é‡&#x2F;æ™®é€šå˜é‡å¯ä»¥ç”¨ç¼ºçœå€¼ï¼›</p><p>åœ¨VS2019é‡Œé¢è°ƒè¯•æµ‹è¯•äº†ä¸€ä¸‹è¿è¡Œé¡ºåºï¼š</p><ul><li>ç¼ºçœå€¼ï¼ˆä¼šä¼˜åŒ–æˆåˆå§‹åŒ–åˆ—è¡¨ï¼‰&#x2F;åˆå§‹åŒ–åˆ—è¡¨</li><li>å‡½æ•°ä½“å†…</li></ul><p>å…·ä½“çš„æµ‹è¯•å‚è€ƒ <a href="https://blog.musnow.top/posts/2894176175/">CPPç±»å’Œå¯¹è±¡é»˜è®¤æˆå‘˜å‡½æ•°</a>ï¼Œé‡Œé¢è¯¦ç»†æ³¨æ˜äº†æ„é€ é¡ºåºï¼›</p><h2 id="14-é»˜è®¤æ„é€ å‡½æ•°"><a href="#14-é»˜è®¤æ„é€ å‡½æ•°" class="headerlink" title="14.é»˜è®¤æ„é€ å‡½æ•°"></a>14.é»˜è®¤æ„é€ å‡½æ•°</h2><p>ä»€ä¹ˆæ—¶å€™å¯ä»¥ä¸è‡ªå·±å†™æ„é€ å‡½æ•°ï¼Ÿ</p><p>è¿™é‡Œæ²¡æœ‰ç­”å…¨ï¼Œæ„Ÿè§‰è‡ªå·±å·²ç»è¢«ç»•æ™•äº†</p><h2 id="15-functionå’Œbindçš„ä½œç”¨"><a href="#15-functionå’Œbindçš„ä½œç”¨" class="headerlink" title="15.functionå’Œbindçš„ä½œç”¨"></a>15.functionå’Œbindçš„ä½œç”¨</h2><p>å¦‚é¢˜</p><h2 id="16-final-x2F-overide-x2F-explicit"><a href="#16-final-x2F-overide-x2F-explicit" class="headerlink" title="16.final&#x2F;overide&#x2F;explicit"></a>16.final&#x2F;overide&#x2F;explicit</h2><p>ä½œç”¨</p><p>explicitå¿˜è®°äº†ï¼Œ<strong>é¢è¯•å®˜è¯´æ²¡å…³ç³»ï¼Œåæ­£ä¹Ÿä¸ç”¨</strong>ğŸ¤£</p><h1 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h1><h2 id="1-è¿›ç¨‹é€šä¿¡"><a href="#1-è¿›ç¨‹é€šä¿¡" class="headerlink" title="1.è¿›ç¨‹é€šä¿¡"></a>1.è¿›ç¨‹é€šä¿¡</h2><p>æœ‰å“ªäº›ï¼Œè¿™é‡Œä¸»è¦é—®äº†å…±äº«å†…å­˜å’Œç®¡é“çš„ä¼˜åŠ£ï¼Œä½¿ç”¨è°çš„èµ„æºæ¶ˆè€—æ›´ä¼˜ï¼ˆè¿™é‡Œé—®çš„æ˜¯èµ„æºæ¶ˆè€—ï¼Œä¸æ˜¯é€šä¿¡é€Ÿåº¦ï¼‰</p><blockquote><p>æˆ‘ç­”çš„æ˜¯å› ä¸ºç®¡é“æ˜¯æ–‡ä»¶æè¿°ç¬¦ï¼Œæ“ä½œç³»ç»Ÿéœ€è¦ç»´æŠ¤æ–‡ä»¶å’Œè¿›ç¨‹ä¹‹é—´çš„å…³ç³»ï¼Œæ‰€ä»¥æ¶ˆè€—ä¼šé«˜ä¸€ç‚¹ï¼›ç„¶åå…±äº«å†…å­˜æ˜¯ç›´æ¥åœ¨é¡µè¡¨ä¸Šæ“ä½œï¼Œæ²¡æœ‰é¢å¤–çš„æ¶ˆè€—ï¼›</p><p>å’±ä¹Ÿä¸çŸ¥é“å¯¹ä¸å¯¹ï¼Œæ„Ÿè§‰ç­”æ¡ˆåº”è¯¥æ˜¯ä¸‹é¢è¿™ä¸ª</p><p><img src="https://img.musnow.top/i/2023/09/17766a5a0226a48b578aed58d9ed5c1d.png" alt="image-20230913212808024"></p></blockquote><p>é—®æœ‰æ²¡æœ‰ç”¨è¿‡æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆçŸ¥é“è¿™ç©æ„ï¼Œæ²¡ç”¨è¿‡ï¼‰</p><h2 id="2-è¿›ç¨‹å’Œçº¿ç¨‹åŒºåˆ«"><a href="#2-è¿›ç¨‹å’Œçº¿ç¨‹åŒºåˆ«" class="headerlink" title="2.è¿›ç¨‹å’Œçº¿ç¨‹åŒºåˆ«"></a>2.è¿›ç¨‹å’Œçº¿ç¨‹åŒºåˆ«</h2><p>è¯´äº†èµ„æºæ¶ˆè€—åŒºåˆ«ï¼ŒåŠŸèƒ½æ¯”è¾ƒéš”ç¦»çš„æ—¶å€™é€‚åˆç”¨è¿›ç¨‹ï¼Œè¿˜ä¸¾äº†ä¸ªepollçš„reactoræ¨¡å¼çš„ä¾‹å­ï¼ˆæˆ‘çç¼–çš„ï¼Œè¯´å®è¯ï¼Œä¹Ÿä¸çŸ¥é“å¯¹ä¸å¯¹ï¼‰</p><h2 id="3-å¼€å‘ç¯å¢ƒ"><a href="#3-å¼€å‘ç¯å¢ƒ" class="headerlink" title="3.å¼€å‘ç¯å¢ƒ"></a>3.å¼€å‘ç¯å¢ƒ</h2><p>å‰æœŸç”¨vs2019ï¼ŒåæœŸç”¨vscode+remote sshï¼›</p><p>é¢è¯•å®˜é—®æˆ‘å¾ˆå¤šä¸ªæ–‡ä»¶æ€ä¹ˆè¿›è¡Œç¼–è¯‘å’Œç®¡ç†ï¼Œæˆ‘è¯´äº†makefileï¼›é—®æœ‰æ²¡æœ‰ç”¨è¿‡cmakeï¼ˆæ— ï¼‰</p><h2 id="4-ç¼–è¯‘é“¾æ¥è¿‡ç¨‹"><a href="#4-ç¼–è¯‘é“¾æ¥è¿‡ç¨‹" class="headerlink" title="4.ç¼–è¯‘é“¾æ¥è¿‡ç¨‹"></a>4.ç¼–è¯‘é“¾æ¥è¿‡ç¨‹</h2><p>è¿™ä¸ªå…¶å®æ˜¯ç¬¬ä¸€ä¸ªé—®çš„é—®é¢˜ï¼Œå°±ç®€å•åœ°è¯´äº†ä¸€ä¸‹ï¼›</p><h2 id="5-åŠ¨é™æ€åº“"><a href="#5-åŠ¨é™æ€åº“" class="headerlink" title="5.åŠ¨é™æ€åº“"></a>5.åŠ¨é™æ€åº“</h2><p>æœ‰å•¥åŒºåˆ«ï¼Ÿä¼˜ç¼ºç‚¹ï¼Ÿ</p><h1 id="The-end"><a href="#The-end" class="headerlink" title="The end"></a>The end</h1><p>æ²¡æœ‰é—®ç½‘ç»œï¼Œä¹Ÿæ²¡æœ‰å†™OJï¼Œä¹Ÿæ²¡æœ‰é—®é¡¹ç›®ï¼›</p><p>è¿™æ¬¡çš„é¢è¯•å®˜å¾ˆè€å¿ƒï¼Œä¼šå¼•å¯¼ä½ å›ç­”é—®é¢˜ã€‚çˆ±äº†ï¼›</p>]]></content>
    
    
    <summary type="html">230913ä¸Šæµ·é›¶å¿µç§‘æŠ€CPPå®ä¹ ç”Ÿ</summary>
    
    
    
    <category term="æ±‚èŒè·¯ä¸Šä¸€å»ä¸å¤è¿”" scheme="https://blog.musnow.top/categories/%E6%B1%82%E8%81%8C%E8%B7%AF%E4%B8%8A%E4%B8%80%E5%8E%BB%E4%B8%8D%E5%A4%8D%E8%BF%94/"/>
    
    
    <category term="é¢ç»" scheme="https://blog.musnow.top/tags/%E9%9D%A2%E7%BB%8F/"/>
    
  </entry>
  
  <entry>
    <title>ã€MySQLã€‘äº‹åŠ¡</title>
    <link href="https://blog.musnow.top/posts/2200233148/"/>
    <id>https://blog.musnow.top/posts/2200233148/</id>
    <published>2023-09-10T00:52:14.000Z</published>
    <updated>2023-09-10T00:52:30.000Z</updated>
    
    <content type="html"><![CDATA[<p>å­¦ä¹ äº†ä¹‹åï¼Œä½ ä¼šå¯¹MySQLå¦‚ä½•è¿›è¡Œæ•°æ®çš„è®¿é—®æ§åˆ¶æœ‰æ›´æ·±åˆ»çš„äº†è§£ï¼›</p><span id="more"></span><p>æœ¬æ–‡ä¸­æœ‰å¤§é‡æˆªå›¾ï¼Œå¦‚æœå‡ºç°404çš„å›¾ç‰‡ï¼Œè¯·è¯„è®ºå‘ŠçŸ¥ï¼Œè°¢è°¢ï¼›</p><h1 id="1-ä»€ä¹ˆæ˜¯äº‹åŠ¡ï¼Ÿ"><a href="#1-ä»€ä¹ˆæ˜¯äº‹åŠ¡ï¼Ÿ" class="headerlink" title="1.ä»€ä¹ˆæ˜¯äº‹åŠ¡ï¼Ÿ"></a>1.ä»€ä¹ˆæ˜¯äº‹åŠ¡ï¼Ÿ</h1><h2 id="1-1-åœºæ™¯ä¸¾ä¾‹"><a href="#1-1-åœºæ™¯ä¸¾ä¾‹" class="headerlink" title="1.1 åœºæ™¯ä¸¾ä¾‹"></a>1.1 åœºæ™¯ä¸¾ä¾‹</h2><h3 id="1-1-1-è½¬è´¦"><a href="#1-1-1-è½¬è´¦" class="headerlink" title="1.1.1 è½¬è´¦"></a>1.1.1 è½¬è´¦</h3><p>å½“Aéœ€è¦ç»™Bè½¬è´¦50å…ƒçš„æ—¶å€™ï¼Œåå°åº”è¯¥è¿›è¡Œå¦‚ä½•å¤„ç†ï¼Ÿ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- å…ˆåˆ¤æ–­ç”¨æˆ·è¿˜æœ‰å¤šå°‘ä½™é¢ï¼ˆè¿™é‡Œçš„user_id=Aåªæ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼ŒçŸ¥é“ä»€ä¹ˆæ„æ€å°±è¡Œï¼‰</span></span><br><span class="line"><span class="keyword">select</span> money <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> user_id<span class="operator">=</span>A;</span><br><span class="line"><span class="comment">-- å¦‚æœä½™é¢å……è¶³ï¼Œé‚£å°±ç»™Aæ‰£50</span></span><br><span class="line"><span class="keyword">update</span> <span class="keyword">user</span> <span class="keyword">set</span> money <span class="operator">=</span> money <span class="operator">-</span> <span class="number">50</span> <span class="keyword">where</span> user_id<span class="operator">=</span>A;</span><br><span class="line"><span class="comment">-- ç„¶åç»™BåŠ 50</span></span><br><span class="line"><span class="keyword">update</span> <span class="keyword">user</span> <span class="keyword">set</span> money <span class="operator">=</span> money <span class="operator">+</span> <span class="number">50</span> <span class="keyword">where</span> user_id<span class="operator">=</span>B;</span><br></pre></td></tr></table></figure><p>è¿™ä¸€ä¸ªæ“ä½œï¼Œéœ€è¦3ä¸ªSQLè¯­å¥æ‰èƒ½å®Œæˆï¼Œä½†å¾ˆæ˜æ˜¾ï¼Œæˆ‘ä»¬å³ä¾¿åœ¨å½“å‰çš„æœåŠ¡å™¨ç«¯å¯¹è¿™3æ¡è¯­å¥çš„æ“ä½œè¿›è¡ŒåŠ é”ï¼Œä¹Ÿæ²¡æœ‰åŠæ³•é¿å…å¦‚ä¸‹çš„æƒ…å†µ</p><ul><li>æœåŠ¡å™¨è´Ÿè½½è¿‡é«˜ï¼Œè¿›ç¨‹è¢«killäº†</li><li>æœåŠ¡å™¨æ–­ç”µäº†</li><li>MySQLæœåŠ¡å™¨æŠ½é£æŒ‚æ‰äº†</li><li>ç­‰ç­‰ä¸å¯æŠ—åŠ›</li></ul><p>è¿™æ—¶å€™ï¼Œå¦‚æœåœ¨æ‰§è¡Œç¬¬ä¸€æ¡æŸ¥è¯¢è¯­å¥åå°±æŒ‚æ‰äº†ï¼Œé‚£è¿˜ä¸ä¼šæœ‰å•¥é—®é¢˜ï¼›ä½†å¦‚æœæ˜¯åœ¨æ‰§è¡Œå®Œæ¯•ç¬¬äºŒæ¡æ‰£é’±çš„è¯­å¥ä¹‹åæŒ‚æ‰äº†ï¼Œé‚£é—®é¢˜å°±å¤§äº†ï¼</p><ul><li>Aç»™Bè½¬é’±ï¼ŒAçš„é’±æ‰£äº†ï¼ŒBçš„é’±æ²¡æœ‰åŠ ï¼Œè¿™æ€ä¹ˆå¯ä»¥ï¼Ÿ</li></ul><p>æœ€ç»ˆè¿˜éœ€è¦ç¨‹åºå‘˜é€šè¿‡MySQLçš„æ—¥å¿—ä¸€ä¸ªä¸ªæ ¸å¯¹åˆ°åº•æ˜¯è°å‡ºç°äº†è¿™æ ·çš„æƒ…å†µï¼Œç»™äººå®¶æŠŠé’±åŠ å›å»ï¼Œé‚£å¤ªè¿‡éº»çƒ¦ï¼›åœ¨æ•°æ®é‡å¤§çš„æ—¶å€™ï¼Œè¿™ç§å·¥ä½œæ›´æ˜¯ä¸åº”è¯¥ç”±äººå·¥æ‰‹åŠ¨å®Œæˆçš„ï¼</p><p>æ‰€ä»¥ï¼ŒMySQLå°±éœ€è¦æä¾›ä¸€ç§æ–¹æ³•ï¼Œè®©æˆ‘ä»¬èƒ½å¤Ÿå®ç°ç±»ä¼¼åŸå­æ€§çš„æ“ä½œã€‚åœ¨æ‰§è¡Œè¿™3æ¡è¯­å¥çš„æ—¶å€™ï¼Œ<strong>åªèƒ½å‡ºç°ä¸¤ç§æƒ…å†µ</strong>ï¼š</p><ul><li>æˆåŠŸæ‰§è¡Œï¼ŒAæ‰£äº†é’±ï¼ŒBä¹ŸåŠ äº†é’±ï¼Œè½¬è´¦æˆåŠŸï¼›</li><li>æ‰§è¡Œå¤±è´¥ï¼Œä½†æ˜¯Aå’ŒBçš„é’±éƒ½æ²¡æœ‰å˜åŒ–ï¼Œå¹¶å‘ŠçŸ¥ç”¨æˆ·è½¬è´¦å¤±è´¥ï¼›</li></ul><p>è¿™æ ·æ‰æ˜¯é è°±çš„ç»“æœï¼</p><h3 id="1-1-2-å–ç¥¨"><a href="#1-1-2-å–ç¥¨" class="headerlink" title="1.1.2 å–ç¥¨"></a>1.1.2 å–ç¥¨</h3><p>å¦å¤–<span id="jump1">ä¸€ä¸ªåœºæ™¯</span>å°±æ˜¯å–ç¥¨ï¼Œå…¶ä¹ŸåŒ…å«äº†å¤šæ¡SQL</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> ticket <span class="keyword">where</span> tid<span class="operator">=</span>?; <span class="comment">-- æŸ¥è¯¢æŸæŸè½¦æ¬¡é«˜é“çš„ç¥¨è¿˜æœ‰æ²¡æœ‰ä½™é‡</span></span><br><span class="line"><span class="comment">-- æœ‰ä½™é‡ï¼Œè¿›è¡Œå”®å–æµç¨‹ï¼›è¿™é‡Œå¯èƒ½è¦æ“ä½œå¦å¤–ä¸€å¼ è¡¨æ¥æ·»åŠ ä¹°ç¥¨è€…çš„ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">update</span> ticket <span class="keyword">set</span> num<span class="operator">=</span>num<span class="number">-1</span> <span class="keyword">where</span> tid<span class="operator">=</span>?; <span class="comment">-- å”®å–æµç¨‹ç»“æŸï¼Œæ‰£å»è¿™å¼ ç¥¨</span></span><br></pre></td></tr></table></figure><p>å¦‚æœæœ‰ä¸¤ä¸ªå®¢æˆ·ç«¯éƒ½åŒæ—¶æ¥æ‰§è¡Œè¿™ä¸¤æ¡SQLè¯­å¥ï¼Œé‚£ä¹ˆå°±ä¼šå‡ºç°é—®é¢˜ï¼›</p><ul><li>åªå‰©ä¸€å¼ ç¥¨</li><li>å®¢æˆ·ç«¯Aè¿›è¡ŒæŸ¥è¯¢ï¼Œå‘ç°æœ‰ç¥¨ï¼Œå¼€å§‹æ‰§è¡Œå–ç¥¨æµç¨‹</li><li>å®¢æˆ·ç«¯Bè¿›è¡ŒæŸ¥è¯¢ï¼Œä¹Ÿå‘ç°æœ‰ç¥¨ï¼Œå¼€å§‹æ‰§è¡Œå–ç¥¨æµç¨‹</li><li>æ­¤æ—¶Aæ‰§è¡Œå®Œæ¯•ï¼Œå°†ç¥¨çš„æ•°é‡-1ï¼Œå–å®Œç¥¨äº†ï¼›</li><li>éšåBæ‰§è¡Œå®Œæ¯•ï¼Œä¹Ÿå°†ç¥¨çš„æ•°é‡-1ï¼Œæ­¤æ—¶å°±ä¼šå‡ºç°ç¥¨æ•°æ˜¯è´Ÿæ•°çš„æƒ…å†µï¼</li><li>æ›´éš¾å—çš„æ˜¯ï¼ŒåŒä¸€å¼ ç¥¨è¢«é”™è¯¯åœ°å–ç»™äº†ä¸¤ä¸ªç”¨æˆ·ï¼</li></ul><p>è¿™æ—¶å€™åœ¨å®¢æˆ·ç«¯é‡Œé¢åŠ é”æ˜¯ä¸é¡¶ç”¨çš„ï¼Œä¸¤ä¸ªå®¢æˆ·ç«¯éƒ½ä¸æ˜¯åŒä¸€ä¸ªè¿›ç¨‹ï¼Œé”æ— æ³•å…±äº«ï¼›éœ€è¦MySQLè§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå°±è¿˜å¾—æä¾›æ›´åŠ ä¸¥æ ¼çš„è®¿é—®æ§åˆ¶ï¼Œåœ¨Aæ²¡æœ‰å®Œæˆæ•´ä¸ªå–ç¥¨é€»è¾‘ï¼Œç¥¨æ•°æ²¡æœ‰æ‰£æ‰çš„æƒ…å†µä¸‹ï¼Œ<strong>Bä¸å¯ä»¥æ¥æŸ¥è¯¢ç¥¨æ•°</strong>ï¼›</p><h2 id="1-2-äº‹åŠ¡çš„ä»‹ç»"><a href="#1-2-äº‹åŠ¡çš„ä»‹ç»" class="headerlink" title="1.2 äº‹åŠ¡çš„ä»‹ç»"></a>1.2 äº‹åŠ¡çš„ä»‹ç»</h2><p>äº‹åŠ¡ï¼ˆtransactionï¼‰å°±æ˜¯ä¸€ç»„DMLè¯­å¥çš„é›†åˆï¼Œè¿™äº›è¯­å¥åœ¨é€»è¾‘ä¸Šæ˜¯ä¸€ä¸ªæ•´ä½“ï¼›æ‰§è¡Œè¿™ç»„è¯­å¥ï¼Œå¿…é¡»å…¨éƒ¨æˆåŠŸï¼Œäº¦æˆ–è€…æ˜¯å…¨éƒ¨å¤±è´¥ã€‚</p><p>åœ¨æ‰§è¡Œè¿™ç»„SQLçš„æ—¶å€™ï¼ŒMySQLéœ€è¦å°†å…¶è§†ä½œä¸€ä¸ªåŸå­æ€§çš„æ“ä½œï¼›è¿™ä¸ªæ“ä½œä¸èƒ½è¢«å…¶ä»–äº‹åŠ¡æ‰“æ–­ï¼Œå‡ºç°é—®é¢˜çš„æ—¶å€™è¿˜éœ€è¦å›æ»šåˆ°å¼€å§‹æ‰§è¡Œä¹‹å‰çš„åˆå§‹çŠ¶æ€ï¼›äº‹åŠ¡è¿˜èƒ½ä½¿ä¸åŒå®¢æˆ·ç«¯çœ‹åˆ°çš„æ•°æ®æ˜¯ä¸åŒçš„ï¼Œä¸åŒäº‹åŠ¡ä¹‹é—´çš„æ“ä½œä¸ä¼šç›¸äº’å½±å“ï¼›åªæœ‰äº‹åŠ¡ç»“æŸåï¼ŒåŒæ–¹æ‰èƒ½çœ‹åˆ°å¯¹æ–¹çš„æ“ä½œï¼ˆæ ¹æ®éš”ç¦»çº§åˆ«ä¸åŒï¼Œè¿™ç‚¹ä¹Ÿä¼šæœ‰åŒºåˆ«ï¼‰ï¼›</p><p>æ­£å¦‚ä¸Šé¢çš„ä¸¤ä¸ªåœºæ™¯æ‰€æåˆ°çš„æ“ä½œï¼ŒåŒä¸€ä¸ªæ—¶åˆ»å¯¹äºMySQLçš„ä¸€ä¸ªæ•°æ®åº“æ¥è¯´ï¼Œå…¶å¯èƒ½æœ‰å¤šä¸ªå®¢æˆ·ç«¯è¿›è¡Œä¸åŒä¸šåŠ¡çš„æ“ä½œï¼Œå¦‚æœéƒ½åœ¨è®¿é—®åŒä¸€ä¸ªè¡¨ï¼Œåœ¨ä¸åŠ è®¿é—®æ§åˆ¶çš„æƒ…å†µä¸‹ï¼Œä¸€å®šä¼šå‡ºç°è®¿é—®ä¸´ç•Œèµ„æºçš„æ•°æ®äºŒä¹‰æ€§é—®é¢˜ã€‚</p><blockquote><p>äº‹åŠ¡çš„å‡ºç°ï¼Œæ˜¯å®¢æˆ·ç«¯åœ¨å®é™…åº”ç”¨åœºæ™¯ä¸‹çš„éœ€è¦ï¼Œ</p></blockquote><p>æ‰€ä»¥ï¼Œä¸€ä¸ªå®Œæ•´çš„äº‹åŠ¡ï¼Œé™¤äº†æ˜¯å¤šæ¡DMLè¯­å¥çš„é›†åˆï¼Œè¿˜éœ€è¦æ»¡è¶³ä¸‹é¢4ä¸ªç‰¹æ€§</p><ul><li>åŸå­æ€§ï¼šä¸€ä¸ªäº‹åŠ¡ä¸­çš„æ‰€æœ‰æ“ä½œï¼Œè¦ä¹ˆå…¨éƒ¨å®Œæˆï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥ï¼›å¦‚æœäº‹åŠ¡åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å‘ç°é”™è¯¯ï¼Œé‚£å°±éœ€è¦å›æ»šï¼ˆRollbackï¼‰åˆ°äº‹åŠ¡å¼€å§‹ä¹‹å‰çš„çŠ¶æ€ï¼Œå°±å¥½æ¯”è¿™ä¸ªäº‹åŠ¡å¹¶æ²¡æœ‰æ‰§è¡Œè¿‡ä¸€èˆ¬</li><li>ä¸€è‡´æ€§ï¼šäº‹åŠ¡å¼€å§‹ä¹‹å‰å’Œç»“æŸåï¼Œæ•°æ®åº“çš„å®Œæ•´æ€§æ²¡æœ‰è¢«ç ´åã€‚è¿›è¡Œçš„æ“ä½œå¤åˆæˆ‘ä»¬é¢„è®¾çš„è¦æ±‚ï¼›è¿™åŒ…å«æ•°æ®çš„å‡†ç¡®åº¦ã€ä¸²è”æ€§ä»¥åŠåç»­æ•°æ®åº“å¯ä»¥è‡ªå‘å®Œæˆé¢„å®šçš„å·¥ä½œï¼›</li><li>éš”ç¦»æ€§ï¼šæ•°æ®åº“å…è®¸å¤šä¸ªå¹¶å‘äº‹åŠ¡åŒæ—¶å¯¹æ•°æ®åº“ä¸­çš„æ•°æ®è¿›è¡ŒCURDæ“ä½œï¼Œéš”ç¦»æ€§ä¿è¯è¿™äº›äº‹åŠ¡ä¹‹é—´çš„æ“ä½œå¹¶ä¸ä¼šç”±äºå¹¶å‘çš„äº¤å‰è¿è¡Œè€Œå‡ºç°ä¸ä¸€è‡´çš„æƒ…å†µã€‚äº‹åŠ¡éš”ç¦»æ€§åˆ†ä¸ºä¸åŒçº§åˆ«ï¼Œå…·ä½“çš„åŒºåˆ«ä¼šåœ¨åæ–‡è¯¦è§£<ul><li>è¯»æœªæäº¤ï¼ˆRead Uncommittedï¼‰</li><li>è¯»å·²æäº¤ï¼ˆRead Committedï¼‰</li><li>å¯é‡å¤è¯»ï¼ˆRepeatble Readï¼‰</li><li>ä¸²è¡ŒåŒ–ï¼ˆSerializableï¼‰</li></ul></li><li>æŒä¹…æ€§ï¼šäº‹åŠ¡å¤„ç†å®Œæ¯•åï¼Œå¯¹äº‹åŠ¡çš„ä¿®æ”¹æ˜¯æ°¸ä¹…çš„ï¼Œå³ä¾¿ç³»ç»Ÿå®•æœºäº†ä¹Ÿä¸ä¼šä¸¢å¤±ï¼ˆé™¤éç¡¬ç›˜åäº†ï¼‰</li></ul><p>ä¸Šé¢çš„å››ä¸ªå±æ€§ï¼Œç®€ç§°ä¸ºACIDï¼›</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">åŸå­æ€§ï¼ˆAtomicityï¼Œæˆ–ç§°ä¸å¯åˆ†å‰²æ€§ï¼‰</span><br><span class="line">ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰</span><br><span class="line">éš”ç¦»æ€§ï¼ˆIsolationï¼Œåˆç§°ç‹¬ç«‹æ€§ï¼‰</span><br><span class="line">æŒä¹…æ€§ï¼ˆDurabilityï¼‰</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œä¸€è‡´æ€§æ˜¯ç”±åŸå­æ€§ã€éš”ç¦»æ€§ã€æŒä¹…æ€§æ¥ä¿è¯çš„ï¼Œåªè¦æ»¡è¶³äº†è¿™ä¸‰ä¸ªæ€§è´¨ï¼Œè‡ªç„¶èƒ½å®ç°ä¸€è‡´æ€§ã€‚ç®€å•è®°å¿†ï¼ŒAIDæ¥ä¿è¯Cï¼›</p><h2 id="1-3-äº‹åŠ¡çš„å­˜å‚¨å¼•æ“æ”¯æŒ"><a href="#1-3-äº‹åŠ¡çš„å­˜å‚¨å¼•æ“æ”¯æŒ" class="headerlink" title="1.3 äº‹åŠ¡çš„å­˜å‚¨å¼•æ“æ”¯æŒ"></a>1.3 äº‹åŠ¡çš„å­˜å‚¨å¼•æ“æ”¯æŒ</h2><p>åœ¨MySQLä¸­ï¼Œåªæœ‰<code>Innodb</code>æ”¯æŒäº‹åŠ¡ï¼Œ<code>MyISAM</code>æ˜¯ä¸æ”¯æŒäº‹åŠ¡çš„ï¼›</p><p>æˆ‘ä»¬å¯ä»¥ç”¨å¦‚ä¸‹è¯­å¥æ¥æŸ¥è¯¢MySQLçš„å¼•æ“å’Œæ”¯æŒçš„ç‰¹æ€§</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]<span class="operator">&gt;</span> <span class="keyword">show</span> engines \G</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">      Engine: MEMORY</span><br><span class="line">     Support: YES</span><br><span class="line">     Comment: Hash based, stored <span class="keyword">in</span> memory, useful <span class="keyword">for</span> temporary tables</span><br><span class="line">Transactions: <span class="keyword">NO</span></span><br><span class="line">          XA: <span class="keyword">NO</span></span><br><span class="line">  Savepoints: <span class="keyword">NO</span></span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">2.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">      Engine: MRG_MyISAM</span><br><span class="line">     Support: YES</span><br><span class="line">     Comment: Collection <span class="keyword">of</span> identical MyISAM tables</span><br><span class="line">Transactions: <span class="keyword">NO</span></span><br><span class="line">          XA: <span class="keyword">NO</span></span><br><span class="line">  Savepoints: <span class="keyword">NO</span></span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">3.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">      Engine: CSV</span><br><span class="line">     Support: YES</span><br><span class="line">     Comment: Stores tables <span class="keyword">as</span> CSV files</span><br><span class="line">Transactions: <span class="keyword">NO</span></span><br><span class="line">          XA: <span class="keyword">NO</span></span><br><span class="line">  Savepoints: <span class="keyword">NO</span></span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">4.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">      Engine: BLACKHOLE</span><br><span class="line">     Support: YES</span><br><span class="line">     Comment: <span class="operator">/</span>dev<span class="operator">/</span><span class="keyword">null</span> storage engine (anything you write <span class="keyword">to</span> it disappears)</span><br><span class="line">Transactions: <span class="keyword">NO</span></span><br><span class="line">          XA: <span class="keyword">NO</span></span><br><span class="line">  Savepoints: <span class="keyword">NO</span></span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">5.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">      Engine: MyISAM</span><br><span class="line">     Support: YES</span><br><span class="line">     Comment: Non<span class="operator">-</span>transactional engine <span class="keyword">with</span> good performance <span class="keyword">and</span> small data footprint</span><br><span class="line">Transactions: <span class="keyword">NO</span></span><br><span class="line">          XA: <span class="keyword">NO</span></span><br><span class="line">  Savepoints: <span class="keyword">NO</span></span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">6.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">      Engine: ARCHIVE</span><br><span class="line">     Support: YES</span><br><span class="line">     Comment: gzip<span class="operator">-</span>compresses tables <span class="keyword">for</span> a low storage footprint</span><br><span class="line">Transactions: <span class="keyword">NO</span></span><br><span class="line">          XA: <span class="keyword">NO</span></span><br><span class="line">  Savepoints: <span class="keyword">NO</span></span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">7.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">      Engine: FEDERATED</span><br><span class="line">     Support: YES</span><br><span class="line">     Comment: Allows <span class="keyword">to</span> access tables <span class="keyword">on</span> other MariaDB servers, supports transactions <span class="keyword">and</span> more</span><br><span class="line">Transactions: YES</span><br><span class="line">          XA: <span class="keyword">NO</span></span><br><span class="line">  Savepoints: YES</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">8.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">      Engine: PERFORMANCE_SCHEMA</span><br><span class="line">     Support: YES</span><br><span class="line">     Comment: Performance Schema</span><br><span class="line">Transactions: <span class="keyword">NO</span></span><br><span class="line">          XA: <span class="keyword">NO</span></span><br><span class="line">  Savepoints: <span class="keyword">NO</span></span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">9.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">      Engine: SEQUENCE</span><br><span class="line">     Support: YES</span><br><span class="line">     Comment: Generated tables filled <span class="keyword">with</span> sequential <span class="keyword">values</span></span><br><span class="line">Transactions: YES</span><br><span class="line">          XA: <span class="keyword">NO</span></span><br><span class="line">  Savepoints: YES</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">10.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">      Engine: InnoDB</span><br><span class="line">     Support: <span class="keyword">DEFAULT</span> <span class="comment">-- é»˜è®¤å¼•æ“</span></span><br><span class="line">     Comment: Supports transactions, <span class="type">row</span><span class="operator">-</span>level locking, <span class="keyword">foreign</span> keys <span class="keyword">and</span> encryption <span class="keyword">for</span> tables <span class="comment">-- æè¿°</span></span><br><span class="line">Transactions: YES  <span class="comment">-- æ”¯æŒäº‹åŠ¡</span></span><br><span class="line">          XA: YES  </span><br><span class="line">  Savepoints: YES  <span class="comment">-- æ”¯æŒäº‹åŠ¡ä¸­çš„ä¿å­˜ç‚¹</span></span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">11.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">      Engine: Aria</span><br><span class="line">     Support: YES</span><br><span class="line">     Comment: Crash<span class="operator">-</span>safe tables <span class="keyword">with</span> MyISAM heritage</span><br><span class="line">Transactions: <span class="keyword">NO</span></span><br><span class="line">          XA: <span class="keyword">NO</span></span><br><span class="line">  Savepoints: <span class="keyword">NO</span></span><br><span class="line"><span class="number">11</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.000</span> sec)</span><br></pre></td></tr></table></figure><h2 id="1-4-ä¿å­˜ç‚¹"><a href="#1-4-ä¿å­˜ç‚¹" class="headerlink" title="1.4 ä¿å­˜ç‚¹"></a>1.4 ä¿å­˜ç‚¹</h2><p>æ‰€è°“ä¿å­˜ç‚¹ï¼Œå°±æ˜¯åœ¨äº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œç»™å½“å‰çš„æ•°æ®è®¾ç½®ä¸€ä¸ªsavepointï¼Œè¿™æ ·åœ¨å‡ºç°é—®é¢˜çš„æ—¶å€™ï¼Œå¯ä»¥å›é€€åˆ°å½“å‰çš„æ•°æ®ä¸­ï¼›å°±å¥½æ¯”ä¹‹åçš„æ“ä½œæ²¡æœ‰è¿›è¡Œä¸€æ ·ï¼›</p><p>æ¸¸æˆä¸­çš„ä¿å­˜ç‚¹å…¶å®ä¹Ÿæ˜¯è¿™æ ·çš„åŠŸèƒ½ï¼Œè®©ç©å®¶å›é€€åˆ°æ‰“æŸä¸ªBOSSä¹‹å‰ï¼ŒåŒ…æ‹¬å½“æ—¶ä½ æ”¶é›†çš„ææ–™ï¼Œéƒ½ä¼šå›é€€åˆ°æ‰“è¿™ä¸ªBOSSä¹‹å‰çš„çŠ¶æ€ï¼›</p><p>ä½ å¯ä»¥ç†è§£ä¸ºï¼Œæ˜¯ç»™å½“å‰çš„æ•°æ®æ‹äº†å¼ ç…§ç‰‡ï¼Œå‡ºç°é—®é¢˜çš„æ—¶å€™ï¼Œç”¨è¿™ä¸ªç…§ç‰‡é‡Œé¢çš„ä¸œè¥¿å¤å†™æ‰æ–°çš„ä¸œè¥¿ã€‚è¿™ä¾¿æ˜¯ä¿å­˜ç‚¹çš„ä½œç”¨ï¼›</p><h2 id="1-5-åŸºç¡€å‘½ä»¤æ“ä½œ"><a href="#1-5-åŸºç¡€å‘½ä»¤æ“ä½œ" class="headerlink" title="1.5 åŸºç¡€å‘½ä»¤æ“ä½œ"></a>1.5 åŸºç¡€å‘½ä»¤æ“ä½œ</h2><p>å…ˆæä¸€ä¸‹äº‹åŠ¡çš„å¼€å¯å’Œç»“æŸæ–¹å¼ï¼Œä»¥åŠå¦‚ä½•è®¾ç½®ä¿å­˜ç‚¹å’Œå›æ»šå§</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- å¼€å¯ï¼Œè¿™ä¸¤ç§æ–¹å¼æ˜¯ä¸€æ ·çš„</span></span><br><span class="line"><span class="keyword">begin</span>;</span><br><span class="line"><span class="keyword">start</span> transaction;</span><br><span class="line"><span class="comment">-- è®¾ç½®ä¿å­˜ç‚¹ï¼ˆåå­—å¯ä»¥è‡ªç”±æ›´æ”¹ï¼Œä½†ä¸èƒ½æœ‰é‡å¤ï¼‰</span></span><br><span class="line"><span class="keyword">savepoint</span> save1; <span class="comment">-- åˆ›å»ºä¸€ä¸ªä¿å­˜ç‚¹save1</span></span><br><span class="line"><span class="keyword">rollback</span> <span class="keyword">to</span> save1; <span class="comment">-- å›æ»šåˆ°ä¿å­˜ç‚¹save1</span></span><br><span class="line"><span class="keyword">rollback</span>; <span class="comment">-- å›æ»šåˆ°äº‹åŠ¡å¼€å§‹</span></span><br><span class="line"><span class="comment">-- ç»“æŸ</span></span><br><span class="line"><span class="keyword">commit</span>; <span class="comment">-- æäº¤äº‹åŠ¡</span></span><br></pre></td></tr></table></figure><h1 id="2-ä½¿ç”¨"><a href="#2-ä½¿ç”¨" class="headerlink" title="2.ä½¿ç”¨"></a>2.ä½¿ç”¨</h1><p>äº†è§£äº†äº‹åŠ¡ä¸ºä»€ä¹ˆå­˜åœ¨ï¼Œä¸‹é¢å°±æ˜¯æ¥ä½¿ç”¨ä¸€ä¸‹äº‹åŠ¡äº†ï¼›</p><h2 id="2-1-æäº¤æ–¹å¼"><a href="#2-1-æäº¤æ–¹å¼" class="headerlink" title="2.1 æäº¤æ–¹å¼"></a>2.1 æäº¤æ–¹å¼</h2><p>äº‹åŠ¡çš„æäº¤æ–¹å¼æœ‰ä¸¤ç§æ–¹å¼</p><ul><li>è‡ªåŠ¨æäº¤</li><li>æ‰‹åŠ¨æäº¤</li></ul><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒMySQLçš„è‡ªåŠ¨æäº¤æ˜¯å¤„äºå¼€å¯çŠ¶æ€çš„</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; show variables like &#x27;autocommit&#x27;;</span><br><span class="line">+---------------+-------+</span><br><span class="line">| Variable_name | Value |</span><br><span class="line">+---------------+-------+</span><br><span class="line">| autocommit    | ON    |</span><br><span class="line">+---------------+-------+</span><br><span class="line">1 row in set (0.001 sec)</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢çš„è¯­å¥æ¥è®¾ç½®æ˜¯å¦å¼€å¯è‡ªåŠ¨æäº¤ï¼ˆåªå¯¹å½“å‰ä¼šè¯ç”Ÿæ•ˆï¼‰</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> autocommit <span class="operator">=</span> <span class="number">0</span>; <span class="comment">-- å…³é—­è‡ªåŠ¨æäº¤</span></span><br><span class="line"><span class="keyword">set</span> autocommit <span class="operator">=</span> <span class="number">1</span>; <span class="comment">-- å¼€å¯</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸¤ä¸ªæäº¤æ–¹å¼æœ‰å•¥åŒºåˆ«å‘¢ï¼Ÿæ˜¯ä¸æ˜¯å¼€äº†è‡ªåŠ¨æäº¤å°±ä»€ä¹ˆéƒ½ä¸ç”¨ç®¡äº†ï¼Ÿåæ–‡æˆ‘ä»¬å†é€šè¿‡å®æµ‹æ¥è¯´æ˜ï¼›</p><h2 id="2-2-åœºæ™¯æ¼”ç¤º"><a href="#2-2-åœºæ™¯æ¼”ç¤º" class="headerlink" title="2.2 åœºæ™¯æ¼”ç¤º"></a>2.2 åœºæ™¯æ¼”ç¤º</h2><p>æœ€å¼€å§‹æµ‹è¯•çš„æ—¶å€™ï¼Œå…ˆå°†äº‹åŠ¡éš”ç¦»çº§åˆ«è®¾ç½®ä¸ºè¯»æœªæäº¤ï¼›è¯·æ³¨æ„ï¼Œä¸è¦åœ¨æœ‰ç”Ÿäº§ç¯å¢ƒçš„MySQLä¸­è¿›è¡Œæ­¤é¡¹æ“ä½œï¼›</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- è®¾ç½®å…¨å±€éš”ç¦»çº§åˆ«ä¸ºè¯»æœªæäº¤</span></span><br><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> transaction isolation level READ UNCOMMITTED; </span><br><span class="line"><span class="comment">-- é‡å¯mysqlç»ˆç«¯åæŸ¥çœ‹éš”ç¦»çº§åˆ«</span></span><br><span class="line"><span class="keyword">select</span> @<span class="variable">@tx</span>_isolation; </span><br><span class="line"><span class="operator">+</span><span class="comment">------------------+</span></span><br><span class="line"><span class="operator">|</span> @<span class="variable">@tx</span>_isolation   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------------+</span></span><br><span class="line"><span class="operator">|</span> READ<span class="operator">-</span>UNCOMMITTED <span class="operator">|</span>   <span class="comment">-- æˆåŠŸè®¾ç½®è¯»æœªæäº¤çš„éš”ç¦»çº§çº§åˆ«</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.000</span> sec)</span><br></pre></td></tr></table></figure><h3 id="2-2-1-æ•°æ®å›æ»šæ¼”ç¤º"><a href="#2-2-1-æ•°æ®å›æ»šæ¼”ç¤º" class="headerlink" title="2.2.1 æ•°æ®å›æ»šæ¼”ç¤º"></a>2.2.1 æ•°æ®å›æ»šæ¼”ç¤º</h3><p>è®¾ç½®å®Œæ¯•åï¼Œè¿›å…¥æµ‹è¯•æ•°æ®åº“ï¼Œåˆ›å»ºå¦‚ä¸‹æµ‹è¯•è¡¨</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> test_ruc(</span><br><span class="line">id <span class="type">int</span> unsigned <span class="keyword">primary</span> key,</span><br><span class="line">user_id <span class="type">int</span> unsigned <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">30</span>) <span class="keyword">not</span> <span class="keyword">null</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>å…ˆç»™è¡¨é‡Œé¢æ’å…¥å‡ ä¸ªåŸºæœ¬çš„æ•°æ®ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> test_ruc <span class="keyword">values</span> (<span class="number">1</span>,<span class="number">10</span>,<span class="string">&#x27;æå&#x27;</span>),(<span class="number">2</span>,<span class="number">20</span>,<span class="string">&#x27;ç‹äº”&#x27;</span>);</span><br></pre></td></tr></table></figure><p>æ’å…¥åï¼Œæˆ‘ä»¬åœ¨ä¸¤ä¾§çš„ç»ˆç«¯ä¸­éƒ½å¯ä»¥çœ‹åˆ°å·²æœ‰çš„æ•°æ®</p><p><img src="https://img.musnow.top/i/2023/09/319fbe3f23373d34fb0eff4a249ef16b.png" alt="image-20230910163833837"></p><p>éšååœ¨ä¸¤ä¸ªç»ˆç«¯ä¸­éƒ½å¼€å¯ä¸€ä¸ªäº‹åŠ¡ï¼Œå·¦ä¾§ç»ˆç«¯æ’å…¥ä¸€ä¸ªæ•°æ®ï¼Œå³ä¾§ç»ˆç«¯æŸ¥çœ‹</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> test_ruc <span class="keyword">values</span> (<span class="number">3</span>,<span class="number">30</span>,<span class="string">&#x27;å·¦ä¾§ç»ˆç«¯æ’å…¥&#x27;</span>);</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œä¸¤ä¾§çš„ç»ˆç«¯éƒ½å¯ä»¥çœ‹åˆ°è¿™ä»½æ•°æ®</p><p><img src="https://img.musnow.top/i/2023/09/8021cf95d4fa8a29c24771161f17cf52.png" alt="image-20230910164315360"></p><p>æ­¤æ—¶å°†å·¦ä¾§ç»ˆç«¯å¼ºåˆ¶é€€å‡ºï¼ˆä½¿ç”¨<code>CTRL+\</code>ï¼‰ï¼Œå³ä¾§å†æ¬¡æŸ¥è¯¢ï¼Œä¼šå‘ç°æ–°æ’å…¥çš„æ•°æ®æ²¡æœ‰äº†ï¼›è¿™é‡Œä¾¿æ˜¯äº‹åŠ¡çš„<strong>åŸå­æ€§</strong>çš„ä½“ç°ï¼Œå·¦ä¾§çš„ç»ˆç«¯æ‰€æ‰§è¡Œçš„äº‹åŠ¡æ²¡æœ‰<code>commit</code>å°±å› ä¸ºå¼‚å¸¸é€€å‡ºäº†ï¼ŒMySQLè‡ªåŠ¨å°†æ•°æ®å›æ»šåˆ°äº†è¿™ä¸ªäº‹åŠ¡æ‰§è¡Œä¹‹å‰ï¼Œå³æ²¡æœ‰æ’å…¥è¿™ä»½æ–°æ•°æ®ï¼›</p><p><img src="https://img.musnow.top/i/2023/09/db2ea78350e2fe7927f8367f7aecf2db.png" alt="image-20230910164414488"></p><p>å·¦ä¾§é‡æ–°é“¾æ¥MySQLï¼Œå¼€å¯ä¸€ä¸ªäº‹åŠ¡ï¼›åœ¨å³ä¾§æ’å…¥ä¸€ä¸ªæ•°æ®ï¼Œéšååˆ›å»ºä¿å­˜ç‚¹<code>save1</code>ï¼›æ’å…¥ç¬¬äºŒä¸ªæ•°æ®ï¼Œåˆ›å»ºä¿å­˜ç‚¹<code>save2</code>ï¼›</p><p>åœ¨å·¦ä¾§æŸ¥è¯¢ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å³ä¾§æ’å…¥çš„ä¸¤æ¡æ–°æ•°æ®ï¼›</p><p><img src="https://img.musnow.top/i/2023/09/cf012a62e99049bc5b41b66583e7b49a.png" alt="image-20230910165426916"></p><p>åœ¨å³ä¾§å›æ»šåˆ°ä¿å­˜ç‚¹save1ï¼Œä¼šå‘ç°æ’å…¥çš„æ•°æ®2æ²¡æœ‰äº†ï¼›è¿™ä¸ä¿å­˜ç‚¹çš„é¢„æœŸæ“ä½œç›¸ç¬¦åˆï¼›</p><p><img src="https://img.musnow.top/i/2023/09/99e569e2c4fde9770594fc1176aa52ec.png" alt="image-20230910165719357"></p><p>å°†å³ä¾§ç»ˆç«¯å¼ºåˆ¶é€€å‡ºï¼Œå†æ¬¡æŸ¥è¯¢æ•°æ®ï¼Œå¯ä»¥çœ‹åˆ°ç¬¬ä¸€æ¬¡æ’å…¥çš„æ•°æ®ä¹Ÿæ²¡æœ‰äº†ï¼Œæ•°æ®åˆå›åˆ°äº†å³ä¾§ç»ˆç«¯äº‹åŠ¡å¼€å§‹ä¹‹å‰çš„æ ·å­ã€‚</p><p><img src="https://img.musnow.top/i/2023/09/60cb747da1ac4756bce1c6e6ff12ace0.png" alt="image-20230910171826318"></p><p>è¿™é‡Œèƒ½å¾—å‡ºä¸€ä¸ªç»“è®ºï¼šå¦‚æœç»ˆç«¯å¼‚å¸¸é€€å‡ºï¼ŒMySQLä¼šå°†æ•°æ®å›æ»šåˆ°äº‹åŠ¡å¼€å§‹æ—¶ï¼›ä½ å¯ä»¥ç†è§£ä¸ºï¼Œæˆ‘ä»¬ä½¿ç”¨<code>begin;</code>çš„æ—¶å€™å°±å·²ç»åˆ›å»ºäº†ä¸€ä¸ªéšè—çš„ä¿å­˜ç‚¹ï¼ŒMySQLåœ¨å¼‚å¸¸çš„æ—¶å€™åªä¼šå°†æ•°æ®å›é€€åˆ°è¿™ä¸ª<strong>äº‹åŠ¡å¼€å§‹ä¹‹æ—¶</strong>çš„éšè—ä¿å­˜ç‚¹ï¼Œæ— è®ºä¸­é€”ç”¨æˆ·æœ‰æ²¡æœ‰è®¾ç½®å…¶ä»–ä¿å­˜ç‚¹ï¼</p><p>å³ï¼šåœ¨å¼‚å¸¸é€€å‡ºçš„æ—¶å€™ï¼ŒMySQLä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬æ‰§è¡Œ<code>rollback</code>å‘½ä»¤å›é€€åˆ°äº‹åŠ¡å¼€å¤´ï¼</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">rollback</span>; <span class="comment">-- å›é€€åˆ°äº‹åŠ¡å¼€å¤´</span></span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±èƒ½é¿å…æœ€å¼€å§‹æåˆ°çš„ï¼Œè½¬è´¦ç³»ç»Ÿä¸­ç»™Aæ‰£äº†é’±ä½†æ˜¯æ²¡æœ‰ç»™BåŠ é’±çš„é—®é¢˜ï¼</p><h3 id="2-2-2-æ•°æ®æŒä¹…åŒ–æ¼”ç¤º"><a href="#2-2-2-æ•°æ®æŒä¹…åŒ–æ¼”ç¤º" class="headerlink" title="2.2.2 æ•°æ®æŒä¹…åŒ–æ¼”ç¤º"></a>2.2.2 æ•°æ®æŒä¹…åŒ–æ¼”ç¤º</h3><p>æ¥ç€æˆ‘ä»¬å†æ¥çœ‹çœ‹ï¼Œå¦‚æœæ‰§è¡Œäº†commitä¹‹ååˆä¼šæ˜¯ä»€ä¹ˆæƒ…å†µï¼›</p><p>å³ä¾§æäº¤äº†äº‹åŠ¡åé€€å‡ºï¼Œå·¦ä¾§ä¾æ—§èƒ½æŸ¥è¯¢å€’å·²ç»æäº¤çš„æ•°æ®ã€‚ä»£è¡¨æ•°æ®å·²ç»è¢«æŒä¹…åŒ–å†™å…¥åˆ°äº†ç£ç›˜ï¼ˆå½“ç„¶è¿™ä¸ªæ—¶å€™ä¹Ÿä¸ä¸€å®šç«‹åˆ»åˆ·ç›˜äº†ï¼Œä½†æ˜¯è¿™å·²ç»èƒ½ä»£è¡¨MySQLå°†æˆ‘ä»¬çš„æ•°æ®åŠ å…¥åˆ°äº†æŒä¹…åŒ–ç­–ç•¥ä¸­ï¼Œå¹¶ä¸éœ€è¦æˆ‘ä»¬ç®¡å•¥æ—¶å€™åˆ·ç›˜çš„é—®é¢˜ï¼ï¼‰</p><p><img src="https://img.musnow.top/i/2023/09/e04e7e3b782a176b62e140c1143b1695.png" alt="image-20230910213252764"></p><h3 id="2-2-3-è‡ªåŠ¨æäº¤"><a href="#2-2-3-è‡ªåŠ¨æäº¤" class="headerlink" title="2.2.3 è‡ªåŠ¨æäº¤"></a>2.2.3 è‡ªåŠ¨æäº¤</h3><p>å‰é¢æåˆ°äº†ï¼ŒMySQLçš„è‡ªåŠ¨æäº¤é»˜è®¤æ˜¯å¼€å¯çš„ï¼›é‚£ä¹ˆè¿™ä¸ªè‡ªåŠ¨æäº¤æœ‰ä»€ä¹ˆä½œç”¨å‘¢ï¼Ÿæ˜¯ä¸æ˜¯å¼€å¯äº†è‡ªåŠ¨æäº¤ï¼Œå°±ä¸éœ€è¦æ‰‹åŠ¨åˆ›å»ºäº‹åŠ¡äº†ï¼Ÿ</p><p><strong>å¹¶ä¸æ˜¯</strong>ï¼åœ¨ä¹‹å‰çš„æµ‹è¯•ä¸­ï¼Œ<code>autocommit</code>æ˜¯å¼€å¯çš„ï¼›æˆ‘ä»¬å·²ç»è¯æ˜äº†ï¼Œæ‰‹åŠ¨<code>begin</code>åˆ›å»ºçš„äº‹åŠ¡ï¼Œåœ¨æ²¡æœ‰æ‰‹åŠ¨<code>commit</code>çš„æ—¶å€™ä¸ä¼šè¢«å†™å…¥ç£ç›˜ï¼ˆä¸è¿›è¡ŒæŒä¹…åŒ–ï¼‰ï¼›è¿™ä»£è¡¨æˆ‘ä»¬æ‰‹åŠ¨åˆ›å»ºçš„äº‹åŠ¡ï¼Œä¸ä¼šå—åˆ°<code>autocommit</code>æ˜¯å¦å¼€å…³çš„å½±å“ï¼›ï¼ˆå¼€ç€çš„æ—¶å€™éƒ½æ²¡æœ‰è‡ªåŠ¨æäº¤ï¼Œå…³é—­çš„æ—¶å€™è‚¯å®šæ›´ä¸ä¼šè‡ªåŠ¨æäº¤äº†ï¼‰</p><ul><li>é‚£ä¹ˆè¿™ä¸ª<code>autocommit</code>ä¼šå½±å“è°å‘¢ï¼Ÿ</li></ul><p>å¼€å¯ä¸¤ä¸ªç»ˆç«¯ï¼Œå·¦ä¾§å°†è‡ªåŠ¨æäº¤å…³é—­ï¼Œéšåæ’å…¥ä¸€ä¸ªæ•°æ®ï¼›æ’å…¥åä¼šå‘ç°å³ä¾§çœ‹ä¸åˆ°å·¦ä¾§æ–°æ’å…¥çš„æ•°æ®ï¼</p><blockquote><p>å¤‡æ³¨ï¼š<code>set autocommit = 0;</code>è¯­å¥åªä¼šå½±å“å½“å‰ç»ˆç«¯ï¼Œä¸ä¼šå½±å“å¦å¤–çš„ç»ˆç«¯ã€‚</p></blockquote><p><img src="https://img.musnow.top/i/2023/09/05a473c988222c4e9f669040110ce010.png" alt="image-20230911081342217"></p><p>æ­¤æ—¶æ‰‹åŠ¨è¿›è¡Œ<code>commit</code>ï¼Œå³ä¾§å°±çœ‹å¾—åˆ°æ•°æ®äº†ï¼</p><p><img src="https://img.musnow.top/i/2023/09/b0c20ecfa43ae1ba23143c78abea5a3d.png" alt="image-20230911081509985"></p><p>è€Œå¦‚æœæˆ‘ä»¬ä¸æ‰‹åŠ¨æ‰§è¡Œ<code>commit</code>å°±æŠŠå·¦ä¾§ç»ˆç«¯<code>CTRL+\</code>é€€å‡ºï¼Œé‚£ä¹ˆæ–°æ’å…¥çš„è¿™ä¸€æ¡æ•°æ®ä¼šä¸¢å¤±ï¼</p><h3 id="2-2-4-å•æ¡SQLå’Œäº‹åŠ¡çš„å…³ç³»"><a href="#2-2-4-å•æ¡SQLå’Œäº‹åŠ¡çš„å…³ç³»" class="headerlink" title="2.2.4 å•æ¡SQLå’Œäº‹åŠ¡çš„å…³ç³»"></a>2.2.4 å•æ¡SQLå’Œäº‹åŠ¡çš„å…³ç³»</h3><p>æ¬¸ï¼Ÿæˆ‘ä»¬æ˜æ˜æ²¡æœ‰<code>begin</code>å¼€å¯äº‹åŠ¡ï¼Œä¸ºä»€ä¹ˆå¯ä»¥æ‰§è¡Œ<code>commit</code>å‘¢ï¼Ÿ</p><p>è¿™æ˜¯å› ä¸ºï¼Œåœ¨MySQLä¸­ï¼Œæ¯ä¸€ä¸ªä¸ä¸»åŠ¨ä½¿ç”¨äº‹åŠ¡çš„å•æ¡SQLè¯­å¥ï¼Œéƒ½ä¼šè§†ä½œä¸€ä¸ªäº‹åŠ¡è¿›è¡Œæ“ä½œï¼æ—¢æˆ‘ä»¬ä¹‹å‰æ²¡å­¦ä¹ äº‹åŠ¡æ—¶ï¼Œæ‰§è¡Œçš„æ‰€æœ‰å•æ¡SQLä¹Ÿæ˜¯ä¸€ä¸ªä¸ªå„è‡ªç‹¬ç«‹çš„äº‹åŠ¡ï¼</p><p>çŸ¥é“äº†è¿™ä¸€ç‚¹ï¼Œä½ å°±èƒ½ç†è§£<strong>è‡ªåŠ¨æäº¤çš„ä½œç”¨</strong>äº†ï¼šåœ¨æ‰§è¡Œå•æ¡SQLçš„æ—¶å€™ï¼Œæ˜¯å¦è‡ªåŠ¨æäº¤è¯¥SQLè¯­å¥çš„äº‹åŠ¡ã€‚</p><p>å°†<code>autocommit</code>é‡æ–°å¼€å¯ï¼Œå†è¿›è¡Œæµ‹è¯•ï¼›ä¼šå‘ç°å·¦ä¾§æ’å…¥çš„æ•°æ®å³ä¾§å¯ä»¥ç«‹é©¬çœ‹åˆ°ï¼Œæ— éœ€æ‰‹åŠ¨<code>commit</code>ã€‚è¿™ä¾¿æ˜¯è‡ªåŠ¨æäº¤çš„ä½œç”¨çš„ä½“ç°ï¼</p><p><img src="https://img.musnow.top/i/2023/09/2fa8f41ee1644efb200d2fdbe65677ac.png" alt="image-20230911082134863"></p><h2 id="2-3-ç»“è®º"><a href="#2-3-ç»“è®º" class="headerlink" title="2.3 ç»“è®º"></a>2.3 ç»“è®º</h2><p>ç»è¿‡ä¸Šé¢çš„è¿™äº›ç®€å•æµ‹è¯•ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°äº‹åŠ¡çš„åŸå­æ€§å’ŒæŒä¹…æ€§ï¼Œåšä¸€ä¸ªæ€»ç»“</p><ul><li>è¾“å…¥äº†<code>begin/start transaction</code>æ‰‹åŠ¨åˆ›å»ºçš„äº‹åŠ¡ï¼Œå¿…é¡»é€šè¿‡<code>commit</code>æ‰‹åŠ¨æŒ¡æäº¤ï¼Œæ‰ä¼šæŒä¹…åŒ–ï¼›è¿™ä¸€ç‚¹å’Œ<code>autocommit</code>æ— å…³ï¼</li><li>äº‹åŠ¡å¯ä»¥è®¾ç½®ä¿å­˜ç‚¹å’Œæ‰‹åŠ¨å›æ»šï¼Œå‡ºç°å¼‚å¸¸çš„æ—¶å€™ï¼ŒMySQLä¼šè‡ªåŠ¨å›é€€åˆ°äº‹åŠ¡å¼€å¤´ï¼›</li><li>å¯¹äº<code>InnoDB</code>å­˜å‚¨å¼•æ“è€Œè¨€ï¼Œæ‰€æœ‰çš„å•æ¡SQLè¯­å¥éƒ½ä¼šè¢«è§†ä½œä¸€ä¸ªäº‹åŠ¡ï¼Œè‡ªåŠ¨æäº¤ï¼›</li><li><code>select</code>è¯­å¥ä¼šæœ‰ä¸€äº›å·®åˆ«ï¼Œå› ä¸ºMySQLæœ‰MVCCè®¿é—®æ§åˆ¶ï¼ˆåæ–‡è®²è§£ï¼‰</li></ul><p>æ“ä½œäº‹åŠ¡çš„ä¸€äº›æ³¨æ„äº‹é¡¹</p><ul><li>åªæœ‰<code>InnoDB</code>æ‰æ”¯æŒäº‹åŠ¡ï¼Œ<code>MyISAM</code>ä¸æ”¯æŒ;</li><li>ä¸€ä¸ªäº‹åŠ¡è¢«æäº¤äº†ä¹‹åï¼Œä¸å¯ä»¥æ‰§è¡Œ<code>rollback</code>;</li><li>åˆ›å»ºäº†ä¿å­˜ç‚¹åï¼Œå¯ä»¥é€‰æ‹©å›é€€åˆ°å“ªä¸€ä¸ªä¿å­˜ç‚¹ï¼Œäº¦æˆ–è€…æ˜¯å›é€€åˆ°äº‹åŠ¡å¼€å¤´ï¼›</li></ul><h1 id="3-äº‹åŠ¡éš”ç¦»çº§åˆ«"><a href="#3-äº‹åŠ¡éš”ç¦»çº§åˆ«" class="headerlink" title="3.äº‹åŠ¡éš”ç¦»çº§åˆ«"></a>3.äº‹åŠ¡éš”ç¦»çº§åˆ«</h1><h2 id="3-1-åŸºæœ¬è¯´æ˜"><a href="#3-1-åŸºæœ¬è¯´æ˜" class="headerlink" title="3.1 åŸºæœ¬è¯´æ˜"></a>3.1 åŸºæœ¬è¯´æ˜</h2><p>äº‹åŠ¡çš„éš”ç¦»çº§åˆ«å’Œäº‹åŠ¡çš„éš”ç¦»æ€§æ¯æ¯ç›¸å…³</p><ul><li>MySQLçš„å•ä¸ªæ•°æ®åº“å¯èƒ½è¢«å¤šä¸ªè¿›ç¨‹&#x2F;çº¿ç¨‹åŒæ—¶è¿›è¡Œè®¿é—®å’Œäº‹åŠ¡æ“ä½œï¼›</li><li>ä¸€ä¸ªäº‹åŠ¡æ˜¯ç”±å¤šä¸ªSQLè¯­å¥ç»„æˆçš„ï¼Œä»»ä½•ä¸€ä¸ªäº‹åŠ¡ï¼Œéƒ½ä¼šå­˜åœ¨æ‰§è¡Œå‰&#x2F;ä¸­&#x2F;åçš„é˜¶æ®µã€‚æ‰€è°“åŸå­æ€§ï¼Œå°±æ˜¯MySQLè¦ä¿è¯å„ä¸ªå®¢æˆ·ç«¯è¦ä¹ˆåªèƒ½çœ‹åˆ°äº‹åŠ¡æ‰§è¡Œå‰æˆ–è€…æ‰§è¡Œåçš„æ•°æ®ï¼›æ‰§è¡Œä¸­çš„äº‹åŠ¡ï¼Œå¯¹äºå…¶ä»–ç”¨æˆ·æ¥çœ‹æ˜¯åŸå­çš„ï¼Œå‡ºç°å¼‚å¸¸ä¼šè¢«è‡ªåŠ¨å›æ»šï¼›</li><li>ä½†äº‹åŠ¡æ¯•ç«Ÿè¿˜æ˜¯å­˜åœ¨æ‰§è¡Œä¸­çš„æ¦‚å¿µï¼Œå…¶ä»–å®¢æˆ·ç«¯æ˜¯æœ‰å¯èƒ½çœ‹åˆ°æŸä¸ªäº‹ç‰©æ‰§è¡Œä¸­çš„çŠ¶æ€çš„ï¼Œè¿™å°±éœ€è¦éš”ç¦»æ€§æ¥ä»‹å…¥äº†ï¼›</li><li>éš”ç¦»æ€§ï¼šä¿è¯äº‹åŠ¡åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å°½é‡ä¸å—å¹²æ‰°ï¼›</li><li>éš”ç¦»çº§åˆ«ï¼šå…è®¸äº‹åŠ¡å—ä¸åŒç¨‹åº¦çš„å¹²æ‰°ï¼›</li></ul><p>å¼€å¤´å°±æåˆ°äº†ï¼ŒMySQLçš„äº‹åŠ¡æœ‰4ç§éš”ç¦»çº§åˆ«</p><ul><li>è¯»æœªæäº¤ï¼ˆRead Uncommittedï¼‰ï¼šåœ¨è¿™ä¸ªéš”ç¦»çº§åˆ«ä¸­ï¼Œæ‰€æœ‰äº‹åŠ¡éƒ½å¯ä»¥çœ‹åˆ°å…¶ä»–äº‹ç‰©è¿˜æ²¡æœ‰æäº¤çš„å†…å®¹ï¼ˆä½ å¯ä»¥ç†è§£ä¸ºå‹æ ¹æ²¡æœ‰éš”ç¦»æ€§ï¼Œä¹‹å‰çš„æµ‹è¯•ä½¿ç”¨çš„å°±æ˜¯è¿™ä¸ªéš”ç¦»çº§åˆ«ï¼‰è¿™ç§æƒ…å†µä¸‹å°±å®¹æ˜“å¼•èµ·å¹¶å‘å’Œè¯»å–æ•°æ®çš„ä¸ä¸€è‡´é—®é¢˜ï¼Œè¿˜æœ‰<strong>è„è¯»</strong>é—®é¢˜ï¼ˆå¯¹æ–¹æ²¡æœ‰commitçš„æ•°æ®å°±å«åšè„æ•°æ®ï¼‰ï¼Œç”Ÿäº§ç¯å¢ƒä¸­æ˜¯æ‰“æ­»ä¸èƒ½ç”¨è¿™ä¸ªéš”ç¦»çº§åˆ«çš„ï¼</li><li>è¯»å·²æäº¤ï¼ˆRead Committedï¼‰ï¼šåœ¨è¿™ä¸ªéš”ç¦»çº§åˆ«ä¸­ï¼Œäº‹åŠ¡åªå¯ä»¥çœ‹åˆ°å…¶ä»–äº‹åŠ¡å·²ç»æäº¤äº†çš„å†…å®¹ã€‚è¿™å·²ç»æ»¡è¶³äº†éš”ç¦»çš„åŸºæœ¬å®šä¹‰ï¼šåªèƒ½çœ‹åˆ°å…¶ä»–äº‹åŠ¡å¼€å§‹å‰æˆ–è€…å¼€å§‹åçš„å†…å®¹ï¼›ä½†æ˜¯è¿™ç§éš”ç¦»æ¨¡å¼ä¼šäº§ç”Ÿ<strong>ä¸å¯é‡å¤è¯»</strong>çš„é—®é¢˜ï¼ˆç›¸åŒ<code>select</code>ä¼šå‡ºç°ä¸åŒç»“æœï¼‰ï¼›</li><li>å¯é‡å¤è¯»ï¼ˆRepeatable Readï¼‰ï¼šä¸ºäº†è§£å†³ä¸å¯é‡å¤è¯»çš„é—®é¢˜ï¼Œè¿™ä¸ªéš”ç¦»çº§åˆ«ä¿è¯äº†äº‹åŠ¡åœ¨è¿è¡Œè¿‡ç¨‹ä¸­å¤šæ¬¡è¯»å–ç›¸åŒæ•°æ®æ—¶ä¼šå¾—åˆ°ç›¸åŒç»“æœï¼›ä½†æ˜¯è¿™ä¸ªéš”ç¦»çº§åˆ«åœ¨æŸäº›æ•°æ®åº“ä¸­å¯èƒ½ä¼šå‡ºç°<strong>å¹»è¯»</strong>é—®é¢˜ï¼›MySQLé»˜è®¤é‡‡ç”¨æ­¤éš”ç¦»çº§åˆ«ï¼›</li><li>ä¸²è¡ŒåŒ–ï¼ˆSerializableï¼‰ï¼šæ‰€è°“ä¸²è¡ŒåŒ–ï¼Œå°±æ˜¯MySQLç»™æ•°æ®åº“çš„æ‰€æœ‰æ“ä½œéƒ½ä¸Šé”ï¼Œå¿…é¡»è¦æ’é˜Ÿè¿è¡Œã€‚ä¸€ä¸ªäº‹åŠ¡åœ¨è¿è¡Œæ—¶ï¼Œå¦å¤–ä¸€ä¸ªäº‹åŠ¡å¾—ç­‰å®ƒè¿è¡Œå®Œæ¯•äº†æ‰èƒ½è¿›æ¥è¿è¡Œï¼Œè¿™æ ·èƒ½æœ€å¤§ç¨‹åº¦ä¿è¯éš”ç¦»æ€§ï¼›ä½†æ˜¯ä¼šé™ä½æ•ˆç‡ï¼›</li></ul><p>éš”ç¦»çº§åˆ«æ˜¯ç”±MySQLè¿›è¡Œå„ç§ç±»å‹çš„åŠ é”æ¥å®ç°çš„ï¼Œæ¯”å¦‚è¡¨é”ã€è¡Œé”ã€è¯»å†™é”ã€é—´éš™é”ï¼ˆGAPï¼‰ã€NEXT-KEYé”ï¼ˆGAP+è¡Œé”ï¼‰ç­‰ç­‰ï¼›</p><blockquote><p>è¿™é‡Œè¿˜éœ€è¦éªŒè¯å¦å¤–ä¸€ä»¶äº‹ï¼ŒMySQLå¦‚æœå¼€å¯äº†ä¸²è¡ŒåŒ–ï¼Œå®¢æˆ·ç«¯c&#x2F;cppæ“ä½œè¿˜éœ€è¦åŠ é”å—ï¼Ÿ<code>mysqlquery</code>çš„æ“ä½œæ˜¯ä¼šé˜»å¡è¿˜æ˜¯ç›´æ¥é”™è¯¯é€€å‡ºï¼Ÿ</p></blockquote><p>åœ¨MySQLä¸­ï¼Œäº‹åŠ¡çš„éš”ç¦»çº§åˆ«å¯ä»¥åˆ†åˆ«è®¾ç½®å…¨å±€çš„éš”ç¦»çº§åˆ«å’Œå½“å‰å®¢æˆ·ç«¯çš„éš”ç¦»çº§åˆ«ï¼›å¦‚æœæ²¡æœ‰ä¸»åŠ¨è®¾ç½®å®¢æˆ·ç«¯çš„éš”ç¦»çº§åˆ«ï¼Œåˆ™ä¼šç»§æ‰¿å…¨å±€çš„éš”ç¦»çº§åˆ«ã€‚é¡¾åæ€ä¹‰ï¼Œä¼šè¯éš”ç¦»çº§åˆ«åªä¼šå½±å“å½“å‰çš„ä¼šè¯ï¼Œä¸ä¼šå½±å“å¦å¤–çš„å®¢æˆ·ç«¯ï¼›</p><p>å¦å¤–ï¼Œå…¨å±€çš„éš”ç¦»çº§åˆ«ä¼šåœ¨æ•°æ®åº“æœåŠ¡é‡å¯åï¼Œè¢«é‡ç½®ä¸ºé…ç½®æ–‡ä»¶ä¸­é»˜è®¤çš„éš”ç¦»çº§åˆ«ï¼ˆä¸€èˆ¬æ˜¯RRï¼‰</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- è®¾ç½® ä¼šè¯/å…¨å±€ éš”ç¦»çº§åˆ«</span></span><br><span class="line"><span class="keyword">set</span> [session <span class="operator">|</span> <span class="keyword">global</span>] transaction isolation level [read uncommitted <span class="operator">|</span> read committed <span class="operator">|</span> repeatable read <span class="operator">|</span> serializable ]</span><br><span class="line"><span class="comment">-- æŸ¥çœ‹å½“å‰ä¼šè¯çš„éš”ç¦»çº§åˆ«</span></span><br><span class="line"><span class="keyword">select</span> @<span class="variable">@session</span>.tx_isolation;</span><br><span class="line"><span class="comment">-- æŸ¥çœ‹å…¨å±€çš„éš”ç¦»çº§åˆ«</span></span><br><span class="line"><span class="keyword">select</span> @<span class="variable">@tx</span>_isolation;</span><br></pre></td></tr></table></figure><h2 id="3-2-è¯»æœªæäº¤"><a href="#3-2-è¯»æœªæäº¤" class="headerlink" title="3.2 è¯»æœªæäº¤"></a>3.2 è¯»æœªæäº¤</h2><p>è¿™ä¸ªéš”ç¦»çº§åˆ«åœ¨ç¬¬äºŒå¤§ç‚¹é‡Œé¢å°±å·²ç»æµ‹è¯•è¿‡äº†ï¼Œå·¦ä¾§ç»ˆç«¯æ’å…¥çš„æ•°æ®ï¼Œå³ä¾¿æ²¡æœ‰commitï¼Œåœ¨å³ä¾§ç»ˆç«¯ä¸­ä¹Ÿèƒ½çœ‹å¾—åˆ°ï¼Œè¿™é‡Œå°±ä¸äºŒæ¬¡æ¼”ç¤ºäº†</p><p><img src="https://img.musnow.top/i/2023/09/8021cf95d4fa8a29c24771161f17cf52.png" alt="image-20230910164315360"></p><p>æ¸…æ¥šå·²æœ‰çš„æ•°æ®ï¼Œæ¥æµ‹è¯•ä¸€ä¸‹ä¼šè¯éš”ç¦»çº§åˆ«çš„ä½œç”¨ï¼›é»˜è®¤æƒ…å†µä¸‹ï¼Œå…¨å±€å’Œä¼šè¯çš„éš”ç¦»çº§åˆ«éƒ½æ˜¯RRï¼›</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; select @@tx_isolation;</span><br><span class="line">+-----------------+</span><br><span class="line">| @@tx_isolation  |</span><br><span class="line">+-----------------+</span><br><span class="line">| REPEATABLE-READ |</span><br><span class="line">+-----------------+</span><br><span class="line">1 row in set (0.000 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [hello_mysql]&gt; select @@session.tx_isolation;</span><br><span class="line">+------------------------+</span><br><span class="line">| @@session.tx_isolation |</span><br><span class="line">+------------------------+</span><br><span class="line">| REPEATABLE-READ        |</span><br><span class="line">+------------------------+</span><br><span class="line">1 row in set (0.000 sec)</span><br></pre></td></tr></table></figure><p>å°†å·¦ä¾§çš„ç»ˆç«¯ä¸­çš„ä¼šè¯éš”ç¦»çº§åˆ«è®¾ç½®ä¸ºè¯»æœªæäº¤</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> session transaction isolation level read uncommitted;</span><br></pre></td></tr></table></figure><p><strong>æ’å…¥æ•°æ®ä¹‹å‰</strong>ï¼Œæ‰§è¡Œä¸€æ¬¡<code>select</code>å…¨åˆ—æŸ¥è¯¢ï¼Œä¸¤ä¾§éƒ½æ˜¯ç©ºï¼›</p><p>åœ¨å·¦ä¾§æ’å…¥æ•°æ®åï¼Œå³ä¾§æŸ¥çœ‹ä¼šå‘ç°ä¾æ—§æ˜¯<code>empty set</code>æ²¡æœ‰ç»“æœï¼›åªæœ‰å·¦ä¾§<code>commit</code>ä¹‹åï¼Œå³ä¾§æ‰èƒ½çœ‹åˆ°æ•°æ®ï¼›è¿™æ˜¯å› ä¸ºåœ¨ä¹‹å‰æµ‹è¯•çš„æ—¶å€™ï¼Œ<strong>æˆ‘ä»¬å°†è‡ªåŠ¨æäº¤å…³é—­äº†</strong>ï¼›å³ä¾§çœ‹ä¸åˆ°æˆ‘ä»¬è¿˜æ²¡æœ‰æäº¤çš„äº‹åŠ¡ï¼›</p><p><img src="https://img.musnow.top/i/2023/09/9c76acac8deca528d4226b226146de13.png" alt="image-20230911100829407"></p><p>å³ä¾§æ‰‹åŠ¨å¼€å¯äº‹åŠ¡åï¼Œå³ä¾¿æ²¡æœ‰è¿›è¡Œ<code>commit</code>ï¼Œä½†æ˜¯å·¦ä¾§å› ä¸ºè®¾ç½®äº†è¯»æœªæäº¤ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥çœ‹åˆ°å³ä¾§è¿˜æ²¡æœ‰æäº¤çš„äº‹åŠ¡ä¸­çš„ä¿®æ”¹ã€‚è¿™ä¾¿æ˜¯è¿™ä¸ªéš”ç¦»çº§åˆ«çš„ç‰¹æ€§ï¼›</p><p><img src="https://img.musnow.top/i/2023/09/6ba51b47e8c05b4171645e423f1ad6a2.png" alt="image-20230911101100927"></p><h2 id="3-3-è¯»å·²æäº¤"><a href="#3-3-è¯»å·²æäº¤" class="headerlink" title="3.3 è¯»å·²æäº¤"></a>3.3 è¯»å·²æäº¤</h2><p>æ¥ä¸‹æ¥å†å°†å…¨å±€éš”ç¦»çº§åˆ«è®¾ç½®ä¸ºè¯»å·²æäº¤ï¼Œé‡æ–°å¼€å¯ä¸¤ä¸ªç»ˆç«¯è¿›è¡Œæµ‹è¯•ï¼›</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set global transaction isolation level read committed;</span><br></pre></td></tr></table></figure><p>è®¾ç½®å®Œæ¯•ï¼Œé‡å¯ç»ˆç«¯åï¼Œå¯ä»¥çœ‹åˆ°ä¸¤ä¾§çš„éš”ç¦»çº§åˆ«éƒ½æ˜¯è¯»å·²æäº¤ï¼Œè‡ªåŠ¨æäº¤éƒ½æ˜¯å¼€å¯çš„ï¼›</p><p><img src="https://img.musnow.top/i/2023/09/bc6c1464a3c9331191aee2a24f9273e4.png" alt="image-20230911102633596"></p><p>ä¸¤ä¾§éƒ½å¼€å¯ä¸€ä¸ªäº‹åŠ¡ï¼Œå·¦ä¾§æ’å…¥æ•°æ®ï¼Œå³ä¾§æŸ¥çœ‹ï¼Œå‘ç°æ²¡æœ‰å†…å®¹ï¼›</p><p><img src="https://img.musnow.top/i/2023/09/8e60ab3a2b5b4bff70b80ed22bce706b.png" alt="image-20230911103402950"></p><p>å·¦ä¾§commitä¹‹åï¼Œå³ä¾§æ‰å¯ä»¥çœ‹åˆ°è¿™ä¸ªæ•°æ®ï¼›</p><p><img src="https://img.musnow.top/i/2023/09/9ec9807c381ccebd42a77a741151c422.png" alt="image-20230911103432740"></p><p>è¿™ç¬¦åˆæˆ‘ä»¬å¯¹<strong>è¯»å·²æäº¤</strong>è¿™ä¸ªéš”ç¦»çº§åˆ«çš„å­—é¢ç†è§£ï¼Œä½†æ˜¯è¿™å¹¶ä¸ä»£è¡¨è¿™ä¸ªéš”ç¦»çº§åˆ«æ²¡æœ‰é—®é¢˜ï¼</p><h3 id="3-3-1-å‡ºé—®é¢˜çš„åœºæ™¯"><a href="#3-3-1-å‡ºé—®é¢˜çš„åœºæ™¯" class="headerlink" title="3.3.1 å‡ºé—®é¢˜çš„åœºæ™¯"></a>3.3.1 å‡ºé—®é¢˜çš„åœºæ™¯</h3><p>æ¥çœ‹çœ‹ä¸‹é¢è¿™ä¸ªåœºæ™¯ï¼š</p><ul><li>å…¬å¸éœ€è¦æ ¹æ®å‘˜å·¥å·¥èµ„ï¼Œåˆ†å‘ä¸åŒçº§åˆ«çš„å¥–é‡‘ï¼š<ul><li>2000-4000 çº§åˆ«ä¸€</li><li>4001-8000 çº§åˆ«äºŒ</li><li>8001-15000 çº§åˆ«ä¸‰</li></ul></li><li>ç”²å¼€å¯äº†ä¸€ä¸ªå®¢æˆ·ç«¯ï¼Œå¼€å§‹ç”¨MySQLç­›é€‰ä¸åŒå·¥èµ„åŒºé—´çš„å‘˜å·¥ï¼Œè®°å½•ä¸‹æ¥ï¼›</li><li>ä¹™å¼€å¯äº†ä¸€ä¸ªå®¢æˆ·ç«¯ï¼Œæƒ³è¦ç»™å‘˜å·¥ä¸åŠ å·¥èµ„<ul><li>ä¸åŸæœ¬çš„å·¥èµ„æ˜¯3000</li><li>ä¹™ç»™ä¸åŠ äº†2000å·¥èµ„ï¼Œä¸çš„å·¥èµ„å˜æˆäº†5000ï¼Œè·³åˆ°äº†å·¥èµ„çº§åˆ«äºŒï¼›</li><li>ä¹™æäº¤ä¿®æ”¹ï¼ˆcommitï¼‰</li></ul></li><li>å‡è®¾ç”²å·²ç»å®Œæˆäº†å¯¹2000-4000çº§åˆ«å·¥èµ„çš„å‘˜å·¥ç­›é€‰ï¼Œæ­¤æ—¶ä¹™è¿‡æ¥ç»™ä¸åŠ äº†å·¥èµ„ï¼Œä¸è·³åˆ°äº†å·¥èµ„çº§åˆ«äºŒï¼›</li><li>å› ä¸ºéš”ç¦»çº§åˆ«æ˜¯è¯»å·²æäº¤ï¼Œç”²åœ¨ç­›é€‰å·¥èµ„çº§åˆ«äºŒçš„äººå‘˜æ—¶ï¼Œä¼šæŠŠåˆšåˆšè¢«ä¿®æ”¹è¿‡çš„ä¸ä¹Ÿç»™çº³å…¥è¿›å»ï¼›</li><li>è¿™æ—¶å€™ï¼Œå¯¹äºç”²è€Œè¨€ï¼Œ<strong>ä¸å°±åŒæ—¶å‡ºç°åœ¨äº†å·¥èµ„çº§åˆ«ä¸€å’ŒäºŒçš„äººå‘˜ä¸­ï¼Œè¿™æ˜æ˜¾æ˜¯ä¸åˆç†çš„</strong>ï¼</li></ul><p>è¿™ä¸ªåœºæ™¯è¢«ç§°ä¸º<code>ä¸å¯é‡å¤è¯»</code>ï¼Œå³åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­ï¼ŒåŒä¸€ä¸ªæŸ¥è¯¢è¯­å¥ï¼Œå¯èƒ½ä¼šå› ä¸ºå…¶ä»–äº‹åŠ¡çš„æäº¤è€Œäº§ç”Ÿä¸åŒçš„ç»“æœï¼›æ¢åšSQLè¯­å¥æ¥æè¿°ï¼Œåœ¨è¯»å·²æäº¤çš„éš”ç¦»çº§åˆ«ä¸­ï¼ŒåŒä¸€ä¸ªselectè¯­å¥åªèƒ½æ‰§è¡Œä¸€æ¬¡ï¼Œç¬¬äºŒæ¬¡æ‰§è¡Œçš„æ—¶å€™ï¼Œå¯èƒ½ä¼šè·å–åˆ°å’Œç¬¬ä¸€æ¬¡ä¸åŒçš„ç»“æœï¼Œæ‰€ä»¥è¿™ä¸ªé—®é¢˜æ‰è¢«ç§°ä½œ<code>ä¸å¯é‡å¤è¯»</code>ï¼ˆä¸å¯ä»¥é‡å¤æ‰§è¡Œselectï¼‰é—®é¢˜ï¼›</p><hr><p>æ¥å®é™…æ¼”ç¤ºä¸€ä¸‹ï¼Œä¸¤ä¾§éƒ½å¼€å¯ä¸€ä¸ªæ–°çš„äº‹åŠ¡ï¼Œå·¦ä¾§ç»ˆç«¯æ›´æ–°è¡¨ä¸­çš„ç”¨æˆ·idï¼Œåªè¦å®ƒä¸æäº¤ï¼Œå³ä¾§å°±çœ‹ä¸åˆ°ä¿®æ”¹ã€‚</p><p><img src="https://img.musnow.top/i/2023/09/8789693271635e5d27c7ad0873937af8.png" alt="image-20230911105147039"></p><p>ä½†æ˜¯æäº¤äº†ä¹‹åï¼Œå³ä¾§å°±èƒ½çœ‹åˆ°è¿™ä¸ªç”¨æˆ·idçš„æ”¹å˜ï¼Œåœ¨è¿›è¡Œæ•°æ®ç­›é€‰çš„æ—¶å€™ï¼Œè¿™ç§æƒ…å½¢å°±ä¼šå‡ºç°é—®é¢˜ï¼</p><p><img src="https://img.musnow.top/i/2023/09/c9f4f3c119361dfcfab135c9e4342921.png" alt="image-20230911105214340"></p><h2 id="3-4-å¯é‡å¤è¯»"><a href="#3-4-å¯é‡å¤è¯»" class="headerlink" title="3.4 å¯é‡å¤è¯»"></a>3.4 å¯é‡å¤è¯»</h2><p>æ‰€ä»¥ï¼Œä¸ºäº†é¿å…ä¸Šé¢æåˆ°çš„è¿™ä¸ªé—®é¢˜ï¼ŒMySQLè¿˜æä¾›äº†ä¸€ä¸ªå¯é‡å¤è¯»çš„éš”ç¦»çº§åˆ«ï¼Œä¸”é»˜è®¤é‡‡ç”¨çš„å°±æ˜¯è¿™ä¸ªéš”ç¦»çº§åˆ«ï¼›</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> transaction isolation level  repeatable read;</span><br></pre></td></tr></table></figure><p>å¯é‡å¤è¯»å°±è§£å†³äº†ä¸Šé¢æåˆ°çš„é—®é¢˜ï¼Œå³ä¾¿å…¶ä»–äº‹åŠ¡æäº¤äº†ä¿®æ”¹ï¼Œå½“å‰äº‹åŠ¡ä¹Ÿçœ‹ä¸åˆ°è¿™ä»½ä¿®æ”¹ï¼Œåªæœ‰å½“å‰äº‹åŠ¡ç»“æŸåï¼Œæ‰èƒ½çœ‹åˆ°æœ€æ–°çš„æ•°æ®ï¼›</p><p>çœ‹ä¸‹å›¾ï¼Œä¸¤ä¾§éƒ½å¼€å¯ä¸€ä¸ªäº‹åŠ¡ï¼Œä¸ç®¡å·¦ä¾§æ˜¯å¦æœ‰æäº¤äº‹åŠ¡ï¼Œå³ä¾§éƒ½çœ‹ä¸åˆ°å·¦ä¾§æ–°æ’å…¥çš„æ•°æ®ï¼›</p><p><img src="https://img.musnow.top/i/2023/09/c702bd94bb9b4f1b39da177aba23faf0.png" alt="image-20230911150201158"></p><p>åªæœ‰å³ä¾§ä¹Ÿæäº¤äº†è‡ªå·±çš„äº‹åŠ¡ï¼Œæ‰èƒ½çœ‹åˆ°å·¦ä¾§æ’å…¥çš„æ–°æ•°æ®ï¼›</p><p><img src="https://img.musnow.top/i/2023/09/8e5ce5e2e310cf65a10b003bb0036e3e.png" alt="image-20230911150323005"></p><p>è¿™å°±ä¿è¯äº†ï¼Œå³ä¾§è¿™ä¸ªäº‹åŠ¡åœ¨è¿è¡Œçš„å§‹ç»ˆï¼Œå®ƒæ‰§è¡Œçš„ç›¸åŒ<code>select</code>è¯­å¥çš„ç»“æœæ°¸è¿œéƒ½æ˜¯ä¸€æ ·çš„ï¼Œä¸ä¼šå‡ºç°ä¸å¯é‡å¤è¯»çš„é—®é¢˜ï¼</p><p>è€Œå¦‚æœåœ¨RRçº§åˆ«ä¸­ï¼ŒåŒæ—¶è®¿é—®ç›¸åŒæ•°æ®ï¼Œä¼šå‡ºç°<strong>åŠ é”</strong>çš„æƒ…å†µï¼Œä¸‹å›¾ä¸­ï¼Œå³ä¾§æ’å…¥äº†ä¸»é”®ä¸º6çš„æ•°æ®ï¼Œæ­¤æ—¶å·¦ä¾§å¦‚æœä¹Ÿå°è¯•æ’å…¥ä¸€ä¸ªä¸»é”®ä¸º6çš„æ•°æ®ï¼Œä¼šè¿›å…¥é˜»å¡çŠ¶æ€ï¼›</p><p><img src="https://img.musnow.top/i/2023/09/fa7dbb9ad31fd27e00307f37aac40a4e.png" alt="image-20230911151027879"></p><p>å¦‚æœå¾ˆä¹…éƒ½ä¸ç»§ç»­æ“ä½œï¼Œå°±ä¼šå› ä¸ºç­‰å¾…è¶…æ—¶ï¼Œè·³å‡ºç­‰å¾…</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; insert into test_ruc values (6,60,&#x27;å¤©æ•°&#x27;);</span><br><span class="line">ERROR 1205 (HY000): Lock wait timeout exceeded; try restarting transaction</span><br></pre></td></tr></table></figure><p>ä½†å½“å‰äº‹åŠ¡ä¸­æ’å…¥çš„æ•°æ®ä¾æ—§æ˜¯å­˜åœ¨çš„ï¼Œå½“å‰äº‹åŠ¡ä¹Ÿæ²¡æœ‰ç»“æŸ</p><p><img src="https://img.musnow.top/i/2023/09/d8de538b5a89adf04842efd2097239c6.png" alt="image-20230911151335335"></p><p>å†æ¬¡å°è¯•æ’å…¥è¿™ä¸ªä¸»é”®ä¸º6çš„æ•°æ®ï¼Œä¾æ—§ä¼šé™·å…¥é˜»å¡æ€ï¼Œåªæœ‰å³ä¾§çš„äº‹åŠ¡è¢«æäº¤äº†ä¹‹åï¼Œå·¦ä¾§æ‰ä¼šå‡ºç°ä¸»é”®å†²çªçš„æç¤ºï¼Œç¦æ­¢æ’å…¥ï¼›</p><p><img src="https://img.musnow.top/i/2023/09/be7f7f5c5a63329fbe574ba4ff22d085.png" alt="image-20230911151444595"></p><p>å·¦ä¾§commitäº†ä¹‹åï¼Œå³ä¾§æ‰èƒ½çœ‹åˆ°å·¦ä¾§æ–°æ’å…¥çš„ä¸»é”®ä¸º5çš„æ•°æ®ï¼›</p><p><img src="https://img.musnow.top/i/2023/09/0827a5499036b9e5b024b60f174ec44a.png" alt="image-20230911151710391"></p><h2 id="3-5-ä¸²è¡ŒåŒ–"><a href="#3-5-ä¸²è¡ŒåŒ–" class="headerlink" title="3.5 ä¸²è¡ŒåŒ–"></a>3.5 ä¸²è¡ŒåŒ–</h2><p>è¿™ä¸ªå°±æ¯”è¾ƒç®€å•äº†ï¼Œä¸€ä¸ªäº‹åŠ¡æ²¡ç»“æŸï¼Œå¦å¤–ä¸€ä¸ªå°±é˜»å¡ç­‰å¾…ï¼›</p><p>ä¸²è¡ŒåŒ–æ˜¯æœ€é«˜çš„éš”ç¦»çº§åˆ«ï¼Œä½†å…¶å¹¶å‘æ€§èƒ½å¾ˆä½ï¼Œå®é™…ä¸Šç”¨çš„ä¹Ÿä¸å¤šï¼›</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> transaction isolation level  serializable;</span><br></pre></td></tr></table></figure><p>ä¸¤ä¾§ç»ˆç«¯éƒ½å¼€å§‹äº‹åŠ¡ï¼ŒæŸ¥è¯¢çš„æ—¶å€™æ˜¯ä¸ä¼šåŠ é”çš„ï¼Œä½†æ˜¯å·¦ä¾§æ‰§è¡Œ<code>update</code>çš„æ—¶å€™ï¼Œé˜»å¡äº†ï¼ˆå¯ä»¥é€šè¿‡å·¦ä¾§updateçš„æ‰§è¡Œæ—¶é—´è§‚å¯Ÿåˆ°é˜»å¡ç°è±¡ï¼Œæˆªå›¾çœ‹çš„ä¸æ˜¯å¾ˆæ˜æ˜¾ï¼‰ï¼›å³ä¾§ä¹Ÿæ‰§è¡Œä¸€æ¬¡<code>update</code>ï¼Œå·¦ä¾§çš„updateå°±ç«‹é©¬æˆåŠŸäº†ï¼Œå³ä¾§æ˜¾ç¤ºæŠ¥é”™æ£€æµ‹åˆ°æ­»é”ï¼Œå»ºè®®å°è¯•é‡å¯äº‹åŠ¡ï¼›</p><p><img src="https://img.musnow.top/i/2023/09/d75f063fa7959ec6c7926eba70d25e35.png" alt="image-20230911110259760"></p><p>å†æ¥è¯•è¯•ï¼Œä¸¤ä¾§éƒ½å¼€å¯äº‹åŠ¡ï¼Œå·¦ä¾§å°è¯•æ’å…¥ä¸€ä¸ªæ•°æ®ï¼Œ<strong>ä¼šé˜»å¡</strong>ï¼›å³ä¾§<code>commit</code>ä¹‹åï¼Œå·¦ä¾§çš„æ’å…¥å°±ç«‹é©¬æˆåŠŸäº†ï¼</p><p><img src="https://img.musnow.top/i/2023/09/8f8ed448629e2b9a842eb819c91f6cea.png" alt="image-20230911110525989"></p><p>è¿™ä¾¿æ˜¯ä¸²è¡ŒåŒ–çš„è¡¨ç°ï¼šä¸¤ä¸ªäº‹åŠ¡å¦‚æœéƒ½æ˜¯åœ¨æ‰§è¡Œselectçš„è¯»å–æ“ä½œï¼Œåˆ™ä¸ä¼šè¢«é˜»å¡ï¼Œä½†å¦‚æœæœ‰ä¸€ä¸ªäº‹åŠ¡è¦æ‰§è¡Œ<strong>å¢åˆ æ”¹</strong>ï¼Œé‚£ä¹ˆå°±å¿…é¡»ç­‰å¾…å…¶ä»–äº‹åŠ¡éƒ½ç»“æŸäº†ï¼Œè¿™ä¸ªæ“ä½œæ‰èƒ½è¢«æ‰§è¡Œï¼›</p><h3 id="3-5-1-ä¸²è¡ŒåŒ–çš„é€‚ç”¨åœºæ™¯"><a href="#3-5-1-ä¸²è¡ŒåŒ–çš„é€‚ç”¨åœºæ™¯" class="headerlink" title="3.5.1 ä¸²è¡ŒåŒ–çš„é€‚ç”¨åœºæ™¯"></a>3.5.1 ä¸²è¡ŒåŒ–çš„é€‚ç”¨åœºæ™¯</h3><p>å›åˆ° <a href="#jump1">1.1.2 å–ç¥¨</a> çš„åœºæ™¯ï¼Œåœ¨è¿™ä¸ªåœºæ™¯ä¸‹ï¼Œå¦‚æœä½ éœ€è¦ä¿è¯å®¢æˆ·ç«¯Açš„å–ç¥¨é€»è¾‘å®Œå…¨æ‰§è¡Œå®Œæ¯•äº†ï¼Œå®¢æˆ·ç«¯Bæ‰èƒ½è¿‡æ¥æŸ¥è¯¢ç¥¨æ•°ï¼Œé‚£å°±éœ€è¦ä½¿ç”¨ä¸²è¡ŒåŒ–ï¼›</p><p>ä½†æ˜¯ï¼Œä¸²è¡ŒåŒ–ä¸­ï¼Œæˆ‘ä»¬æ˜¯å¯ä»¥æ‰§è¡ŒæŸ¥è¯¢æ“ä½œçš„ï¼é‚£ä¹ˆåœ¨Aæ²¡æœ‰ç»“æŸçš„æƒ…å†µä¸‹ï¼ŒBä¸è¿˜æ˜¯ä¼šæŸ¥è¯¢åˆ°æœ‰å‰©ä½™ç¥¨æ•°ï¼Ÿ</p><blockquote><p>å®é™…ä¸Šï¼Œæˆ‘ä»¬çš„å–ç¥¨æ“ä½œå¹¶ä¸æ˜¯ç›´è¿æ•°æ®åº“å®ç°çš„ï¼Œè€Œæ˜¯æœ‰ä¸€ä¸ªæœåŠ¡ç«¯è¿›ç¨‹æ¥æä¾›APIï¼Œä¾›å®¢æˆ·ç«¯æ¥æŸ¥è¯¢å‰©ä½™ç¥¨æ•°ï¼Œå‰©ä¸‹çš„å–ç¥¨æ“ä½œå…¶å®éƒ½æ˜¯æœåŠ¡ç«¯æ¥å®ç°çš„ï¼ˆè®©å®¢æˆ·ç«¯ç›´è¿MySQLæ¥æ‰§è¡ŒSQLæ˜¯éå¸¸ä¸å¯é çš„ï¼Œå¾ˆæœ‰å¯èƒ½å‡ºç°SQLæ³¨å…¥æ”»å‡»ï¼‰</p></blockquote><p>æ‰€ä»¥ï¼Œè¿™ä¸ªé—®é¢˜å¾—åœ¨æœåŠ¡ç«¯è¿›ç¨‹ä¸­åŠ é”è§£å†³ï¼MySQLæœ¬èº«å³ä¾¿ä½¿ç”¨ä¸²è¡ŒåŒ–ä¹Ÿæ˜¯æ²¡æœ‰åŠæ³•è§£å†³è¿™ä¸ªé—®é¢˜çš„ï¼›</p><p>ä½†æ˜¯ï¼Œåˆ«å¿˜äº†ï¼ŒMySQLè¿˜æœ‰å¦å¤–ä¸€ä¸ªä¸œè¥¿â€”â€”<strong>çº¦æŸ</strong>ï¼›ä½ å¯ä»¥è®¾ç½®ä¸€ä¸ªè§¦å‘å™¨ï¼Œæ›´æ–°å‰©ä½™ç¥¨æ•°çš„æ—¶å€™ï¼Œæ‹’ç»å°†ç¥¨æ•°è®¾ç½®ä¸ºè´Ÿæ•°ï¼›è¿™æ ·å®¢æˆ·ç«¯Bå³ä¾¿è¿›å…¥äº†å–ç¥¨ä¸šåŠ¡ï¼Œæœ€ç»ˆå°†å‰©ä½™ç¥¨æ•°çš„æ•°æ®è®¾ç½®ä¸ºè´Ÿæ•°çš„æ—¶å€™ï¼Œ<strong>ä¹Ÿä¼šè¢«MySQLé˜»æ­¢æ’å…¥</strong>ï¼Œè¿™ä¸ªå–ç¥¨çš„äº‹åŠ¡Bå°±ç›¸å½“äºé”™è¯¯é€€å‡ºäº†ï¼Œæ‰€æœ‰æ“ä½œéƒ½ä¼šè¢«å›æ»šï¼è€Œéš”ç¦»çº§åˆ«å°±æ˜¯é¿å…Aå’ŒBåŒæ—¶ä¿®æ”¹ä¸€ä¸ªæ•°æ®è€Œå¯¼è‡´çš„é”™è¯¯ï¼›</p><p>äºŒè€…ç›¸è¾…ç›¸æˆï¼Œå°±èƒ½è§£å†³è¿™ä¸ªé—®é¢˜ï¼›å½“ç„¶ï¼Œåœ¨æœåŠ¡ç«¯APIå¤„ç†é€»è¾‘ä¸­åŠ é”æ˜¯æ›´å¥½çš„è§£å†³åŠæ³•ï¼Œæ—¢å¯ä»¥ä¿è¯æ•°æ®ä¸€è‡´æ€§ï¼Œåˆèƒ½éš”ç¦»å®¢æˆ·ç«¯å’ŒMySQLæœåŠ¡ï¼›</p><blockquote><p>åæ–‡è®²åˆ°çš„å½“å‰è¯»ä¹Ÿèƒ½åœ¨æŸç§ç¨‹åº¦ä¸Šè§£å†³è¿™ä¸ªé—®é¢˜ï¼Œåæ­£è§£å†³çš„åŠæ³•å¤šå¤šï¼</p></blockquote><h3 id="3-5-2-ä¸²è¡ŒåŒ–å’ŒCPP"><a href="#3-5-2-ä¸²è¡ŒåŒ–å’ŒCPP" class="headerlink" title="3.5.2 ä¸²è¡ŒåŒ–å’ŒCPP"></a>3.5.2 ä¸²è¡ŒåŒ–å’ŒCPP</h3><p>å¦‚æœå°† MySQL çš„éš”ç¦»çº§åˆ«ï¼ˆisolation levelï¼‰è®¾ç½®ä¸ºæœ€é«˜çº§åˆ«çš„ä¸²è¡ŒåŒ–ï¼ˆSERIALIZABLEï¼‰ï¼Œé‚£ä¹ˆå¹¶å‘çš„å¤šçº¿ç¨‹æ“ä½œå¯èƒ½ä¼šé‡åˆ°ä»¥ä¸‹æƒ…å†µä¹‹ä¸€ï¼š</p><ol><li>é˜»å¡ï¼šå½“ä¸€ä¸ªçº¿ç¨‹æ­£åœ¨ä½¿ç”¨æŸä¸ªæ•°æ®æ—¶ï¼Œå…¶ä»–çº¿ç¨‹éœ€è¦ç­‰å¾…è¯¥çº¿ç¨‹é‡Šæ”¾é”æ‰èƒ½ç»§ç»­è¿›è¡Œæ“ä½œã€‚è¿™ä¼šå¯¼è‡´å…¶ä»–çº¿ç¨‹åœ¨è·å¾—æ‰€éœ€é”ä¹‹å‰è¢«é˜»å¡ã€‚</li><li>é”™è¯¯é€€å‡ºï¼šå¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶æ“ä½œç›¸åŒçš„æ•°æ®ï¼Œå¹¶ä¸”å®ƒä»¬æ— æ³•åŒæ—¶æŒæœ‰è®¿é—®è¯¥æ•°æ®çš„é”ï¼Œå°±ä¼šå¼•å‘æ­»é”ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒæŸäº›çº¿ç¨‹ä¼šè¢«ç³»ç»Ÿç»ˆæ­¢ï¼Œä»è€Œå¯¼è‡´é”™è¯¯é€€å‡ºã€‚</li></ol><p>æ‰€ä»¥ï¼Œå¹¶ä¸æ˜¯è¯´ä½ å°†MySQLçš„éš”ç¦»çº§åˆ«è®¾ç½®å¥½äº†ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯å°±å•¥äº‹ä¸ç”¨å¹²äº†ï¼›æœ€å¥½çš„æ“ä½œä¾æ—§æ˜¯åœ¨å®¢æˆ·ç«¯å°±åŠ é”è¿›è¡Œä¸€å®šçš„è®¿é—®æ§åˆ¶ï¼Œå› ä¸ºMySQL Queryå‡½æ•°çš„é”™è¯¯é€€å‡º+é€€å‡ºæƒ…å†µè¯†åˆ«ï¼Œç›¸æ¯”äºå®¢æˆ·ç«¯è¿›è¡Œè®¿é—®æ§åˆ¶æ›´éš¾ä»¥æ“ä½œï¼›</p><h2 id="3-6-æ€»ç»“"><a href="#3-6-æ€»ç»“" class="headerlink" title="3.6 æ€»ç»“"></a>3.6 æ€»ç»“</h2><ul><li>éš”ç¦»çº§åˆ«è¶Šé«˜ï¼Œå®‰å…¨æ€§è¶Šé«˜ï¼Œæ•°æ®åº“çš„å¹¶å‘æ€§èƒ½å°±è¶Šä½ï¼›æˆ‘ä»¬éœ€è¦æ ¹æ®ä¸šåŠ¡é€»è¾‘ï¼Œé€‰ç”¨åˆé€‚çš„éš”ç¦»çº§åˆ«ï¼›</li><li>ä¸å¯é‡å¤è¯»çš„é—®é¢˜åœ¨äºå…¶ä»–å®¢æˆ·ç«¯çš„ä¿®æ”¹å’Œåˆ é™¤ï¼ŒåŒæ ·çš„selectè¯­å¥ä¼šæŸ¥å‡ºä¸åŒçš„ç»“æœï¼Œæ˜¯ä¸åˆç†çš„ï¼›</li><li>å¹»è¯»çš„é‡ç‚¹åœ¨äºæ–°å¢ï¼Œå…¶ä»–å®¢æˆ·ç«¯æ–°å¢çš„è®°å½•å¯èƒ½è¢«æˆ‘ä»¬å½“å‰çš„å®¢æˆ·ç«¯æŸ¥è¯¢åˆ°ï¼›ä½†æ˜¯åœ¨MySQLä¸­ï¼Œè¿™ä¸ªé—®é¢˜æ˜¯ä¸å­˜åœ¨çš„ï¼Œå› ä¸º<code>InnoDB</code>é€šè¿‡NEXT-KEYé”è§£å†³äº†å¹»è¯»é—®é¢˜ï¼›</li><li>äº‹åŠ¡ä¹Ÿåˆ†ä¸ºé•¿çŸ­äº‹åŠ¡çš„æ¦‚å¿µï¼Œäº‹åŠ¡ä¹‹é—´äº’ç›¸å½±å“ï¼Œä¸»è¦æŒ‡çš„æ˜¯äº‹åŠ¡åœ¨å¹¶è¡Œé˜¶æ®µï¼ˆéƒ½æ²¡æœ‰<code>commit</code>çš„æ—¶å€™ï¼‰äº§ç”Ÿçš„å½±å“ï¼›</li><li>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨MySQLé»˜è®¤çš„RRçš„äº‹åŠ¡çº§åˆ«å°±å¯ä»¥äº†ï¼›</li></ul><p>ä¸‹é¢ç»™å‡ºä¸€ä¸ªä¸åŒäº‹åŠ¡çº§åˆ«ä¹‹é—´çš„åŒºåˆ«çš„è¡¨æ ¼ï¼ŒYä»£è¡¨ä¼šå‡ºç°è¿™ä¸ªé—®é¢˜ï¼ŒNä»£è¡¨ä¸ä¼šå‡ºç°è¿™ä¸ªé—®é¢˜</p><table><thead><tr><th>éš”ç¦»çº§åˆ«</th><th>è„è¯»</th><th>ä¸å¯é‡å¤è¯»</th><th>å¹»è¯»</th><th>åŠ é”è¯»</th></tr></thead><tbody><tr><td>è¯»æœªæäº¤</td><td>Y</td><td>Y</td><td>Y</td><td>ä¸åŠ é”</td></tr><tr><td>è¯»å·²æäº¤</td><td>N</td><td>Y</td><td>Y</td><td>ä¸åŠ é”</td></tr><tr><td>å¯é‡å¤è¯»</td><td>N</td><td>N</td><td>N</td><td>ä¸åŠ é”</td></tr><tr><td>ä¸²è¡ŒåŒ–</td><td>N</td><td>N</td><td>N</td><td>åŠ é”</td></tr></tbody></table><h2 id="3-7-ä¸€è‡´æ€§"><a href="#3-7-ä¸€è‡´æ€§" class="headerlink" title="3.7 ä¸€è‡´æ€§"></a>3.7 ä¸€è‡´æ€§</h2><ul><li>äº‹åŠ¡æ‰§è¡Œçš„ç»“æœï¼Œå¿…é¡»ä½¿æ•°æ®åº“ä»ä¸€ä¸ªä¸€è‡´æ€§çŠ¶æ€ï¼Œå˜åˆ°å¦ä¸€ä¸ªä¸€è‡´æ€§çŠ¶æ€ã€‚å½“æ•°æ®åº“åªåŒ…å«äº‹åŠ¡ æˆåŠŸæäº¤çš„ç»“æœæ—¶ï¼Œæ•°æ®åº“å¤„äºä¸€è‡´æ€§çŠ¶æ€ã€‚</li><li>å¦‚æœç³»ç»Ÿè¿è¡Œå‘ç”Ÿä¸­æ–­ï¼ŒæŸä¸ªäº‹åŠ¡å°šæœªå®Œæˆè€Œè¢«è¿«ä¸­ æ–­ï¼Œè€Œæ”¹æœªå®Œæˆçš„äº‹åŠ¡å¯¹æ•°æ®åº“æ‰€åšçš„ä¿®æ”¹å·²è¢«å†™å…¥æ•°æ®åº“ï¼Œæ­¤æ—¶æ•°æ®åº“å°±å¤„äºä¸€ç§ä¸æ­£ç¡®ï¼ˆä¸ä¸€è‡´ï¼‰çš„çŠ¶æ€ã€‚å› æ­¤ä¸€è‡´æ€§æ˜¯é€šè¿‡<strong>åŸå­æ€§</strong>æ¥ä¿è¯çš„ã€‚</li><li>å…¶å®ä¸€è‡´æ€§å’Œç”¨æˆ·çš„ä¸šåŠ¡é€»è¾‘å¼ºç›¸å…³ï¼Œä¸€èˆ¬MySQLæä¾›æŠ€æœ¯æ”¯æŒï¼Œä½†æ˜¯ä¸€è‡´æ€§è¿˜æ˜¯è¦ç”¨æˆ·ä¸šåŠ¡é€»è¾‘åšæ”¯æ’‘ï¼ˆæ¯”å¦‚å®¢æˆ·ç«¯å¦‚æœä¸ä½¿ç”¨äº‹åŠ¡ï¼Œé‚£MySQLä¹Ÿæ²¡æœ‰åŠæ³•å¸®åŠ©ç»´æŠ¤ï¼‰ï¼Œæ‰€ä»¥è¯´ï¼Œä¸€è‡´æ€§æ˜¯ç”±ç”¨æˆ·å†³å®šæ˜¯å¦ç»´æŠ¤çš„ã€‚ </li><li>æŠ€æœ¯ä¸Šï¼Œé€šè¿‡AIDä¿è¯C</li></ul><h1 id="4-éš”ç¦»æ€§çš„ç†è§£"><a href="#4-éš”ç¦»æ€§çš„ç†è§£" class="headerlink" title="4.éš”ç¦»æ€§çš„ç†è§£"></a>4.éš”ç¦»æ€§çš„ç†è§£</h1><p>è¯´å®Œäº†éš”ç¦»çº§åˆ«ï¼Œæ¥ä¸‹æ¥å†æ·±å…¥ç†è§£ä¸€ä¸‹éš”ç¦»æ€§</p><h2 id="4-1-MVCC"><a href="#4-1-MVCC" class="headerlink" title="4.1 MVCC"></a>4.1 MVCC</h2><p>æ•°æ®åº“å¹¶å‘çš„åœºæ™¯ä¸€å…±æœ‰ä¸‹é¢ä¸‰ç§</p><ul><li><code>è¯»-è¯»</code>ï¼šä¸å­˜åœ¨ä»»ä½•é—®é¢˜ï¼Œä¸éœ€è¦è®¿é—®æ§åˆ¶</li><li><code>è¯»-å†™</code>ï¼šæœ‰çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œå¯èƒ½ä¼šé‡åˆ°éš”ç¦»æ€§ä¸­çš„è„è¯»ã€å¹»è¯»ã€ä¸å¯é‡å¤è¯»é—®é¢˜ï¼›</li><li><code>å†™-å†™</code>ï¼šæœ‰çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œè¿˜æœ‰å¯èƒ½å‡ºç°æ›´æ–°ä¸¢å¤±é—®é¢˜ï¼›</li></ul><p>æˆ‘ä»¬ä¸»è¦å…³æ³¨çš„æ˜¯è¯»å†™å¹¶å‘çš„æƒ…å†µï¼Œè¿™ä¹Ÿæ˜¯æ•°æ®åº“æœ€å¸¸é‡åˆ°çš„å¤„ç†åœºæ™¯ï¼›</p><p>å†MySQLä¸­ï¼Œé‡‡ç”¨äº†MVCCï¼ˆå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼‰æ¥è§£å†³è¯»å†™å†²çªï¼Œè¿™æ˜¯ä¸€ç§æ— é”çš„å¹¶å‘æ§åˆ¶æœºåˆ¶ï¼›</p><p>åœ¨äº†è§£MVCCä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£å‡ ä¸ªå‰ç½®çŸ¥è¯†ï¼š</p><ul><li>ä¸‰ä¸ªéšè—åˆ—å­—æ®µ</li><li>UNDOæ—¥å¿—</li><li>READ VIEW</li></ul><h3 id="4-1-1-éšè—åˆ—å­—æ®µ"><a href="#4-1-1-éšè—åˆ—å­—æ®µ" class="headerlink" title="4.1.1 éšè—åˆ—å­—æ®µ"></a>4.1.1 éšè—åˆ—å­—æ®µ</h3><p>åœ¨MySQLä¸­ï¼Œæ¯ä¸€ä¸ªè¡¨éƒ½å­˜åœ¨ä¸‰ä¸ªéšè—çš„åˆ—å­—æ®µ</p><ul><li>DB_TRX_IDï¼š6 byteï¼Œæœ€è¿‘ä¿®æ”¹(ä¿®æ”¹&#x2F;æ’å…¥)äº‹åŠ¡IDï¼Œè®°å½•åˆ›å»ºè¿™æ¡è®°å½•&#x2F;æœ€åä¸€æ¬¡ä¿®æ”¹è¯¥è®°å½•çš„äº‹åŠ¡IDï¼›</li><li>DB_ROLL_PTR: 7 byteï¼Œå›æ»šæŒ‡é’ˆï¼ŒæŒ‡å‘è¿™æ¡è®°å½•çš„ä¸Šä¸€ä¸ªç‰ˆæœ¬ï¼ˆç®€å•ç†è§£æˆï¼ŒæŒ‡å‘å†å²ç‰ˆæœ¬å°± è¡Œï¼Œè¿™äº›æ•°æ®ä¸€èˆ¬åœ¨ <code>undo log</code> ä¸­ï¼‰ </li><li>DB_ROW_ID: 6 byteï¼Œéšå«çš„è‡ªå¢IDï¼ˆéšè—ä¸»é”®ï¼‰ï¼Œå¦‚æœæ•°æ®è¡¨æ²¡æœ‰ä¸»é”®ï¼Œ InnoDB ä¼šè‡ªåŠ¨ä»¥ DB_ROW_ID äº§ç”Ÿä¸€ä¸ª<strong>èšç°‡ç´¢å¼•</strong>ï¼›</li><li>è¡¥å……ï¼šå®é™…è¿˜æœ‰ä¸€ä¸ªåˆ é™¤flagéšè—å­—æ®µï¼Œæ—¢è®°å½•è¢«æ›´æ–°æˆ–åˆ é™¤å¹¶ä¸ä»£è¡¨çœŸçš„åˆ é™¤ï¼Œè€Œæ˜¯åˆ é™¤flagå˜äº†ï¼›</li></ul><p>å‡è®¾æœ‰å¦‚ä¸‹è¡¨ç»“æ„</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> if <span class="keyword">not</span> <span class="keyword">exists</span> student(</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">11</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">    age <span class="type">int</span> <span class="keyword">not</span> <span class="keyword">null</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">-- æ’å…¥ä¸€æ¡è®°å½•</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> student (name, age) <span class="keyword">values</span> (<span class="string">&#x27;å¼ ä¸‰&#x27;</span>, <span class="number">19</span>);</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆè¿™ä¸ªè¡¨ä¸­çš„å®é™…æ•°æ®æ˜¯è¿™æ ·çš„</p><table><thead><tr><th>name</th><th>age</th><th>DB_TRX_ID(åˆ›å»ºè¿™ä¸ªè®°å½•çš„äº‹åŠ¡ID)</th><th>DB_ROW_IDï¼ˆéšè—ä¸»é”®ï¼‰</th><th>DB_ROLL_PTRï¼ˆå›æ»šæŒ‡é’ˆï¼‰</th></tr></thead><tbody><tr><td>å¼ ä¸‰</td><td>19</td><td>NULL</td><td>1</td><td>NULL</td></tr></tbody></table><p>æˆ‘ä»¬å¹¶ä¸çŸ¥é“åˆ›å»ºè¿™ä¸ªè®°å½•çš„äº‹åŠ¡IDï¼Œæ‰€ä»¥è®¾ç½®ä¸ºNULLï¼›å› ä¸ºæ˜¯ç¬¬ä¸€æ¡è®°å½•ï¼Œæ‰€ä»¥éšè—ä¸»é”®æ˜¯1ï¼›å› ä¸ºæ˜¯ç¬¬ä¸€æ¡è®°å½•ï¼Œæ‰€ä»¥æ²¡æœ‰å›æ»šçš„åœ°æ–¹ï¼Œå›æ»šæŒ‡é’ˆä¹Ÿæ˜¯NULLï¼ˆæ¢å¥è¯è¯´ï¼Œå¦‚æœå›æ»šæŒ‡é’ˆä¸ºNULLï¼Œä»£è¡¨è¿™ä¸ªå°±æ˜¯è¿™ä¸ªè¡¨ä¸­çš„ç¬¬ä¸€æ¡è®°å½•äº†ï¼‰</p><h3 id="4-1-2-undoæ—¥å¿—"><a href="#4-1-2-undoæ—¥å¿—" class="headerlink" title="4.1.2 undoæ—¥å¿—"></a>4.1.2 undoæ—¥å¿—</h3><p>MySQLæ˜¯ä»¥æœåŠ¡è¿›ç¨‹çš„æ–¹å¼åœ¨å†…å­˜ä¸­è¿è¡Œçš„ï¼Œæˆ‘ä»¬å¯¹æ•°æ®çš„CURDæ“ä½œï¼Œéƒ½éœ€è¦é€šè¿‡MySQLå°†å…¶åˆ·å…¥åˆ°ç¡¬ç›˜ä¸Šè¿›è¡ŒæŒä¹…åŒ–ï¼ŒMySQLä¸ºè¿™äº›æ“ä½œä¼šæä¾›ä¸€ä¸ªä¸“é—¨çš„<code>buffer pool</code>å†…å­˜ç¼“å†²åŒºï¼›è€Œ<code>undo log/redo log</code>ä¹Ÿæ˜¯å†…å­˜ä¸­çš„ä¸€å—åŒºåŸŸï¼Œå¯¹äºMySQLè€Œè¨€</p><ul><li>æ—¥å¿—éœ€è¦ç«‹åˆ»åˆ·ç›˜ï¼ˆæœ‰ä¸€ä¸ªä¸“é—¨çš„çº¿ç¨‹æ¥ç®¡ç†æ—¥å¿—ï¼‰</li><li>æ•°æ®æ ¹æ®è¿è¡Œç­–ç•¥ï¼Œé€‰æ‹©åˆé€‚çš„æ—¶é—´åˆ·ç›˜ï¼ˆå› ä¸ºæ•°æ®é‡ä¸€èˆ¬æ¯”è¾ƒå¤§ï¼Œå¦‚æœå®æ—¶åˆ·ç›˜ä¼šé€ æˆè¾ƒå¤§IOè´Ÿè½½ï¼Œå½±å“è¿›ç¨‹è¿è¡Œï¼‰</li></ul><p>å…ˆæ¥è¯´è¯´<code>redo log</code>ï¼Œè¿™é‡ŒåŒ…å«äº†MySQLä¸­çš„æ‰€æœ‰å°šæœªè½ç›˜çš„CURDæ“ä½œï¼›å¦‚æœMySQLè¿˜æ²¡æœ‰å†™å…¥æ•°æ®çš„æ—¶å€™å°±æŒ‚äº†ï¼Œé‚£ä¹ˆä¸‹æ¬¡å¯åŠ¨çš„æ—¶å€™å°±ä¼šä»<code>redo log</code>é‡Œé¢æ¢å¤æ•°æ®ï¼Œæ¥ç¡®ä¿æ•°æ®çš„ä¸€è‡´æ€§å’Œå®Œæ•´æ€§ï¼›</p><p>åœ¨MySQLå­˜å‚¨è·¯å¾„<code>/var/lib/mysql</code>ä¸­çš„<code>ib_logfile0/ib_logfile1</code>å°±æ˜¯<code>redo log</code>ï¼›</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-rw-rw----. 1 mysql mysql  50331648 Sep 11 03:16 ib_logfile0</span><br><span class="line">-rw-rw----. 1 mysql mysql  50331648 Sep  9 21:03 ib_logfile1</span><br></pre></td></tr></table></figure><p>è€Œ<code>undo log</code>ä¸»è¦ç”¨äºä»¥ä¸‹åŠŸèƒ½</p><ol><li>å›æ»šäº‹åŠ¡</li><li>MVCCï¼ˆå¤šç‰ˆæœ¬æ§åˆ¶&#x2F;éš”ç¦»æ€§å’Œéš”ç¦»çº§åˆ«ï¼‰</li></ol><p>å‡è®¾æˆ‘ä»¬æ¥äº†ä¸€ä¸ªupdateæ“ä½œï¼Œå°†åˆšåˆšæ’å…¥çš„å¼ ä¸‰çš„å¹´é¾„æ”¹æˆ30å²ï¼Œå¯¹äºMySQLè€Œè¨€å°±ä¼šåœ¨<code>undo log</code>é‡Œé¢åšå¦‚ä¸‹å¤„ç†ï¼›</p><ul><li>è¯¥updateæ“ä½œå¯¹åº”çš„äº‹åŠ¡<code>DB_TRX_ID</code>æ˜¯10ï¼›</li><li>å°†æ—§æ•°æ®æ”¾å…¥<code>undo log</code>ä¸­ï¼Œå¹¶å°†å½“å‰æ•°æ®çš„<code>DB_ROLL_PTR</code>æŒ‡å‘æ—§æ•°æ®çš„åœ°å€ï¼›</li><li>å¦‚æœéœ€è¦å›æ»šï¼Œé‚£ä¹ˆå°±é€šè¿‡<code>DB_ROLL_PTR</code>æ‰¾åˆ°æ—§æ•°æ®ï¼Œå¤å†™å›å»ï¼›</li></ul><p><img src="https://img.musnow.top/i/2023/09/6f386ba45e0c26e72de76bff973c4a4f.png" alt="image-20230911172501941"></p><p>å¦‚æœå†æ¥ä¸€æ¬¡ä¿®æ”¹ï¼Œå°†å¼ ä¸‰çš„åå­—æ”¹æˆæå››ï¼Œä¹Ÿæ˜¯ä¾ç…§è¿™ä¸ªé€»è¾‘åœ¨<code>undo log</code>ä¸­æ–°å¢æ—§æ•°æ®ï¼Œå¹¶é“¾æ¥<code>DB_ROLL_PTR</code>æŒ‡é’ˆï¼›</p><ul><li>äº‹åŠ¡11ä¿®æ”¹è¿™æ¡æ•°æ®ï¼Œå…ˆç”³è¯·é”ï¼›</li><li>å°†ç°æœ‰æ•°æ®å¤åˆ¶åˆ°<code>undo log</code>ä¸­ï¼ˆå¤´æ’ï¼‰ï¼Œå¹¶å°†<code>DB_ROLL_PTR</code>æŒ‡é’ˆæŒ‡å‘æ—§æ•°æ®çš„åœ°å€ï¼›</li><li>ä¿®æ”¹è®°å½•ä¸­çš„nameï¼Œå¹¶ä¸”å°†<code>DB_TRX_ID</code>æ”¹æˆå½“å‰äº‹åŠ¡çš„ID 11ï¼›</li><li>äº‹åŠ¡11æäº¤ï¼Œé‡Šæ”¾é”ï¼›</li></ul><p><img src="https://img.musnow.top/i/2023/09/d4a9aca8bdd9c3e38daa5b07896e7684.png" alt="image-20230911173024425"></p><p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±æœ‰äº†ä¸€ä¸ªç±»ä¼¼äºé“¾è¡¨çš„å†å²ç‰ˆæœ¬é“¾ï¼›æ¯æ¬¡å›é€€çš„æ—¶å€™ï¼Œéƒ½å¯ä»¥æ‰¾åˆ°å†å²æ•°æ®ï¼Œè¦†ç›–å½“å‰çš„æ•°æ®ã€‚è¿™äº›ç‰ˆæœ¬æˆ‘ä»¬ç§°ä¹‹ä¸º<code>å¿«ç…§</code>ï¼›</p><p>è€Œæ’å…¥å’Œåˆ é™¤éƒ½å¯ä»¥å†™å…¥<code>undo log</code>ï¼Œä½†æ˜¯åªæœ‰æ›´æ–°å’Œåˆ é™¤èƒ½å½¢æˆå†å²ç‰ˆæœ¬é“¾ï¼›</p><ul><li>åˆ é™¤æ˜¯å°†åˆ é™¤flagç½®ä¸ºçœŸï¼Œæ—§æ•°æ®ä¾æ—§å¯ä»¥å†™å…¥åˆ°<code>undo log</code>ä¸­ï¼Œå¦‚æœéœ€è¦å›æ»šï¼Œå°†è¿™è¡Œè®°å½•æ¢å¤ï¼›</li><li>æ’å…¥å¹¶æ²¡æœ‰å†å²ç‰ˆæœ¬ï¼Œä½†ä¹Ÿéœ€è¦å°†å…¶æ”¾å…¥<code>undo log</code>ä¸­ï¼Œäº‹åŠ¡å›æ»šçš„æ—¶å€™éœ€è¦å°†æ–°æ’å…¥çš„æ•°æ®åˆ é™¤ï¼›</li><li>äº‹åŠ¡æäº¤äº†ä¹‹åï¼Œå·²æœ‰çš„å†å²è®°å½•å¯ä»¥è¢«åˆ é™¤ï¼›</li></ul><p>å¢åˆ æ”¹éƒ½è¯´äº†ï¼Œé‚£ä¹ˆ<code>select</code>å‘¢ï¼Ÿ</p><p>ä¸€èˆ¬è€Œè¨€ï¼ŒæŸ¥è¯¢ä¸ä¼šäº§ç”Ÿæ•°æ®å†™å…¥æ“ä½œï¼Œä¹Ÿä¸éœ€è¦è®¾ç½®å†å²ç‰ˆæœ¬é“¾ï¼›</p><p>ä½†æ˜¯åœ¨ä¹‹å‰å…³äºRRçº§åˆ«éš”ç¦»æ€§çš„éªŒè¯ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†<code>select</code>æ— æ³•çœ‹åˆ°å¦å¤–ä¸€ä¸ªäº‹åŠ¡å·²ç»æäº¤äº†çš„æ•°æ®ï¼Œè¿™è¯´æ˜<code>select</code>æœ‰æ—¶å€™è¯»å–çš„æ˜¯<strong>å†å²ç‰ˆæœ¬</strong>çš„æ•°æ®ï¼Œè€Œå¹¶éå½“å‰æœ€æ–°çš„æ•°æ®ï¼</p><p>è¯»å–å†å²æ•°æ®æˆ‘ä»¬ç§°ä¹‹ä¸º<code>å¿«ç…§è¯»</code>ï¼Œåœ¨RRçº§åˆ«ä¸­é»˜è®¤é‡‡ç”¨çš„å°±æ˜¯å¿«ç…§è¯»ï¼›è¯»å–æœ€æ–°æ•°æ®å«åšå½“å‰è¯»ï¼ˆå¢åˆ æ”¹éƒ½æ˜¯å½“å‰è¯»ï¼‰ï¼›è¿˜æœ‰ä¸€ç§è¯»å–æ˜¯ä¸ºäº†æ›´æ–°è€ŒæŸ¥è¯¢ï¼›</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ... <span class="comment">-- åœ¨RRçº§åˆ«ä¸‹ï¼Œé»˜è®¤æ˜¯å¿«ç…§è¯»</span></span><br><span class="line"><span class="keyword">select</span> ... <span class="keyword">for</span> <span class="keyword">update</span>; <span class="comment">-- ä¸ºäº†æ›´æ–°è€ŒæŸ¥è¯¢</span></span><br><span class="line"><span class="comment">-- MySQLä¼šå°†å½“å‰è¡Œä¸Šæ’ä»–é”ï¼Œä¸Šé”äº†ä¹‹åï¼Œå…¶ä»–å®¢æˆ·ç«¯åªèƒ½æŸ¥è¯¢è¯¥è¡Œï¼Œæ— æ³•ä¿®æ”¹</span></span><br><span class="line"><span class="keyword">select</span> ... lock <span class="keyword">in</span> share mode; <span class="comment">-- æŸ¥è¯¢æœ€æ–°æ•°æ®ï¼ˆå½“å‰è¯»ï¼‰</span></span><br><span class="line"><span class="comment">-- æ˜¯ä¸²è¡ŒåŒ–çš„ï¼Œåªæœ‰å…¶ä»–äº‹åŠ¡å®Œæˆäº†ï¼Œæ‰èƒ½æŸ¥è¯¢åˆ°æœ€æ–°ç»“æœï¼›</span></span><br></pre></td></tr></table></figure><p>é™¤äº†æ‰‹åŠ¨æŒ‡å®š<code>select</code>çš„æŸ¥è¯¢æ–¹å¼ä»¥å¤–ï¼Œéš”ç¦»çº§åˆ«ä¼šå½±å“<code>select</code>çš„é»˜è®¤è¡Œä¸ºï¼Œæ¯”å¦‚åœ¨ä¸²è¡ŒåŒ–éš”ç¦»çº§åˆ«çš„åœºæ™¯ä¸‹ï¼Œé»˜è®¤æ‰§è¡Œçš„å°±æ˜¯<strong>å½“å‰è¯»</strong>ï¼›</p><p>åœ¨RRæ¨¡å¼ä¸‹è¿›è¡Œæµ‹è¯•ï¼Œä¼šå‘ç°å½“å‰è¯»ä¼šé˜»å¡å½“å‰çš„å®¢æˆ·ç«¯ï¼ˆå³ä¾§å®¢æˆ·ç«¯é˜»å¡ï¼‰ï¼›</p><p><img src="https://img.musnow.top/i/2023/09/4025f787fda333689872e3295712df1b.png" alt="image-20230911200703608"></p><p>åªæœ‰å·¦ä¾§çš„äº‹åŠ¡åœ¨æäº¤äº†ä¹‹åï¼Œå³ä¾§çš„æŸ¥è¯¢æ‰ä¼šè¿”å›æœ€æ–°çš„ç»“æœï¼›</p><p><img src="https://img.musnow.top/i/2023/09/1675840504edd0a5689e3a6ec052a4dd.png" alt="image-20230911201033979"></p><p>è¿™æ˜¯å› ä¸º<strong>å½“å‰è¯»</strong>ï¼ŒåŒ…æ‹¬å¢åˆ æ”¹æ“ä½œï¼Œæ˜¯éœ€è¦åŠ é”çš„ï¼›å¦‚æœè¦åœ¨RRæ¨¡å¼ä¸‹å®ç°å½“å‰è¯»ï¼Œé‚£ä¹ˆæ•´ä¸ªç³»ç»Ÿå°±éœ€è¦<strong>ä¸²è¡ŒåŒ–</strong>æ‰§è¡Œï¼›</p><p>è€Œå¿«ç…§è¯»ä¸éœ€è¦åŠ é”ï¼Œå› ä¸ºå®ƒå¯ä»¥è¯»å–å†å²ç‰ˆæœ¬ï¼Œè€Œå†å²ç‰ˆæœ¬æ˜¯ä¸ä¼šè¢«å…¶ä»–çº¿ç¨‹ä¿®æ”¹çš„ï¼Œä¹Ÿå°±ä¸éœ€è¦ç»´æŠ¤è®¿é—®æ§åˆ¶ï¼Œæé«˜äº†å¹¶å‘æ•ˆç‡ï¼›</p><p>é‚£ä¹ˆï¼ŒMySQLæ˜¯å¦‚ä½•å®ç°å¿«ç…§è¯»çš„å‘¢ï¼Ÿ</p><h3 id="4-1-3-Read-View"><a href="#4-1-3-Read-View" class="headerlink" title="4.1.3 Read View"></a>4.1.3 Read View</h3><p><code>Read View</code>å°±æ˜¯MySQLä¸ºå¿«ç…§è¯»ç”Ÿæˆçš„ä¸€ä¸ª<strong>è¯»è§†å›¾</strong>ï¼›åœ¨äº‹åŠ¡æ‰§è¡Œå¿«ç…§è¯»çš„æ—¶å€™ï¼ˆå³æ‰§è¡Œ<code>select</code>çš„æ—¶å€™ï¼‰å°†å½“å‰æ•°æ®æ‹ä¸€å¼ ç…§ï¼Œè¿™æ ·åœ¨è¿™ä¸ªäº‹åŠ¡ä¸­ï¼Œåç»­çš„æ‰€æœ‰<code>select</code>éƒ½åªä¼šçœ‹åˆ°è¿™ä¸ªç…§ç‰‡é‡Œé¢çš„ç»“æœï¼Œçœ‹ä¸åˆ°å…¶ä»–äº‹åŠ¡æœ€æ–°çš„ä¿®æ”¹ï¼ˆä¸ç®¡å…¶ä»–äº‹åŠ¡æ˜¯å¦commitï¼‰ã€‚</p><blockquote><p>å¿«ç…§è¯»çš„ç°è±¡æˆ‘ä»¬å·²ç»åœ¨æœ¬æ–‡ <code>3.4 å¯é‡å¤è¯»</code> ä¸­æ¼”ç¤ºè¿‡äº†ï¼Œè¿™é‡Œå°±ä¸å†äºŒæ¬¡æ¼”ç¤ºäº†ï¼›</p></blockquote><p><code>Read View</code>åœ¨MySQLçš„æºç ä¸­å…¶å®å°±æ˜¯ä¸€ä¸ªç±»ï¼Œè¯¥ç±»ä¸­åŒ…å«ä¸€äº›å¯è¯»æ€§åˆ¤æ–­çš„ä¿¡æ¯ï¼Œå†…éƒ¨æœ‰æ¡ä»¶ï¼Œæ¥æ ‡æ˜å½“å‰äº‹åŠ¡èƒ½å¤Ÿçœ‹åˆ°é‚£ä¸ªç‰ˆæœ¬çš„æ•°æ®ï¼Œå³æœ‰å¯èƒ½æ˜¯å½“å‰æœ€æ–°çš„æ•°æ®ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯<code>undo log</code>ä¸­çš„æŸä¸ªå†å²ç‰ˆæœ¬ï¼›</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ReadView</span> &#123;</span><br><span class="line"><span class="comment">// çœç•¥...</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="comment">/** é«˜æ°´ä½ï¼Œå¤§äºç­‰äºè¿™ä¸ªIDçš„äº‹åŠ¡å‡ä¸å¯è§*/</span></span><br><span class="line">    <span class="type">trx_id_t</span> m_low_limit_id</span><br><span class="line">    <span class="comment">/** ä½æ°´ä½ï¼šå°äºè¿™ä¸ªIDçš„äº‹åŠ¡å‡å¯è§ */</span></span><br><span class="line">    <span class="type">trx_id_t</span> m_up_limit_id;</span><br><span class="line">    <span class="comment">/** åˆ›å»ºè¯¥ Read View çš„äº‹åŠ¡ID*/</span></span><br><span class="line">    <span class="type">trx_id_t</span> m_creator_trx_id;</span><br><span class="line">    <span class="comment">/** åˆ›å»ºè§†å›¾æ—¶çš„æ´»è·ƒäº‹åŠ¡idåˆ—è¡¨ï¼Œæ˜¯ä¸€ä¸ªä½å›¾ */</span></span><br><span class="line">    <span class="type">ids_t</span> m_ids;</span><br><span class="line">    <span class="comment">/** é…åˆpurgeï¼Œæ ‡è¯†è¯¥è§†å›¾ä¸éœ€è¦å°äºm_low_limit_noçš„UNDO LOGï¼Œ</span></span><br><span class="line"><span class="comment">    * å¦‚æœå…¶ä»–è§†å›¾ä¹Ÿä¸éœ€è¦ï¼Œåˆ™å¯ä»¥åˆ é™¤å°äºm_low_limit_noçš„UNDO LOG*/</span></span><br><span class="line">    <span class="type">trx_id_t</span> m_low_limit_no;</span><br><span class="line">    <span class="comment">/** æ ‡è®°è§†å›¾æ˜¯å¦è¢«å…³é—­*/</span></span><br><span class="line">    <span class="type">bool</span> m_closed;</span><br><span class="line">    <span class="comment">// çœç•¥...</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>å•ç‹¬è¯´æ˜ä¸€ä¸‹è¿™é‡Œçš„4ä¸ªé‡è¦çš„å˜é‡ï¼›å…¶ä¸­éœ€è¦æ³¨æ„ï¼Œåœ¨è¿™é‡Œé¢<strong>upæ˜¯ä½æ°´ä½ï¼Œlowæ˜¯é«˜æ°´ä½</strong>ï¼Œè¿™æ˜¯ç”±ä»–ä»¬ä¿å­˜çš„æ•°æ®çš„æ€§è´¨å†³å®šçš„ï¼Œè¯·ä¸è¦å’Œè¿™ä¸¤ä¸ªå•è¯çš„æœ¬æ„æ··æ·†ï¼</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">m_ids; <span class="comment">// ä¸€å¼ ä½å›¾ï¼Œç”¨æ¥ä¿å­˜Read Viewç”Ÿæˆæ—¶ï¼Œç³»ç»Ÿæ­£æ´»è·ƒï¼ˆæ²¡æœ‰ç»“æŸçš„ï¼‰çš„äº‹åŠ¡ID</span></span><br><span class="line">up_limit_id; <span class="comment">// è®°å½•m_idsåˆ—è¡¨ä¸­äº‹åŠ¡IDæœ€å°çš„ID </span></span><br><span class="line">low_limit_id; <span class="comment">// ReadViewç”Ÿæˆæ—¶åˆ»ç³»ç»Ÿå°šæœªåˆ†é…çš„ä¸‹ä¸€ä¸ªäº‹åŠ¡IDï¼Œä¹Ÿå°±æ˜¯ç›®å‰å·²å‡ºç°è¿‡çš„äº‹åŠ¡IDçš„æœ€å¤§å€¼+1</span></span><br><span class="line">creator_trx_id <span class="comment">// åˆ›å»ºè¯¥ReadViewçš„äº‹åŠ¡ID</span></span><br></pre></td></tr></table></figure><p>è¦çŸ¥é“ï¼Œå½“å‰äº‹åŠ¡æ˜¯çŸ¥é“è‡ªå·±çš„äº‹åŠ¡IDçš„ï¼ˆ<code>DB_TRX_ID</code>ï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ‰‹ä¸­å°±æœ‰å¿«ç…§è¯»ä¸­æœ€å¤§æœ€å°çš„äº‹åŠ¡IDï¼Œä»¥åŠå½“å‰æ´»è·ƒä¸­çš„äº‹åŠ¡IDï¼›é‚£ä¹ˆåœ¨è¯»å–ç‰ˆæœ¬é“¾çš„æ—¶å€™ï¼Œå°±è¿›è¡Œå¦‚ä¸‹åŒ¹é…ï¼Œè®¾å½“å‰å¼€å¯çš„è¿™ä¸ª<strong>äº‹åŠ¡ä¸ºA</strong>:</p><ul><li>ç‰ˆæœ¬é“¾ä¸­çš„äº‹åŠ¡IDä¸å­˜åœ¨äº<code>m_ids</code>ä¸­ï¼Œä»£è¡¨<strong>äº‹åŠ¡Aå¼€å¯</strong>çš„æ—¶å€™ï¼Œè¿™ä¸ªäº‹åŠ¡å·²ç»æäº¤äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¯»å–è¿™ä¸ªäº‹åŠ¡æ“ä½œçš„ç»“æœï¼›</li><li>ç‰ˆæœ¬é“¾ä¸­çš„äº‹åŠ¡IDå­˜åœ¨äº<code>m_ids</code>ä¸­ï¼Œä»£è¡¨äº‹åŠ¡Aå¼€å¯çš„æ—¶å€™ï¼Œè¿™ä¸ªäº‹åŠ¡æ˜¯<strong>æ´»è·ƒçŠ¶æ€</strong>ï¼Œé‚£ä¹ˆæˆ‘å°±ä¸åº”è¯¥è¯»åˆ°è¿™ä¸ªäº‹åŠ¡çš„æ“ä½œç»“æœï¼›</li><li>ç‰ˆæœ¬é“¾çš„ä¸­çš„äº‹åŠ¡IDå¤§äº<code>low_limit_id</code>ï¼Œä»£è¡¨äº‹åŠ¡Aå¼€å¯çš„æ—¶å€™ï¼Œè¿™ä¸ªäº‹åŠ¡è¿˜ä¸å­˜åœ¨ï¼Œæ‰€ä»¥ä¹Ÿä¸åº”è¯¥çœ‹åˆ°è¿™ä¸ªåœ¨Aä¹‹åæ¥çš„äº‹åŠ¡çš„æ“ä½œç»“æœï¼›ï¼ˆAè¿˜æ²¡æ“ä½œå®Œæ¯•ï¼Œè¿™ä¸ªæ–°äº‹åŠ¡å°±æ¥äº†ï¼‰</li><li>ç‰ˆæœ¬é“¾ä¸­çš„äº‹ç‰©IDå°äº<code>up_limit_id</code>ï¼Œä»£è¡¨äº‹ç‰©Aå¼€å¯çš„æ—¶å€™ï¼Œè¿™ä¸ªäº‹ç‰©éƒ½ä¸çŸ¥é“æ˜¯æ˜¯å®ƒçš„çˆ¶äº²è¾ˆè¿˜æ˜¯çˆ·çˆ·è¾ˆäº†ï¼Œ<strong>é•¿è¾ˆç»™ä½ ç•™ä¸‹çš„ä¸œè¥¿è‚¯å®šå¾—å¥½å¥½æ”¶ç€</strong>ï¼›è¯´äººè¯ï¼šè¿™ä¸ªæ˜¯Aæ¥ä¹‹å‰çš„ä¹‹å‰å°±å·²ç»ç»“æŸäº†çš„äº‹ç‰©ï¼Œè‚¯å®šæ˜¯å¯ä»¥è¯»å–å…¶ç»“æœçš„ï¼›</li></ul><p>åœ¨MySQLä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¦‚ä¸‹æºç ï¼Œé“¾æ¥ä¹Ÿè´´å‡ºæ¥äº†ï¼Œgithubä¸Šå¯ä»¥æŸ¥çœ‹æºç ï¼›è¿™ä¸ªå‡½æ•°å°±æ˜¯ç”¨æ¥åˆ¤æ–­å½“å‰äº‹åŠ¡åº”è¯¥èƒ½çœ‹åˆ°é‚£äº›ç‰ˆæœ¬é“¾çš„ï¼Œå…·ä½“çš„åˆ¤æ–­é€»è¾‘å‚è€ƒä¸­æ–‡æ³¨é‡Šï¼ˆè‹±æ–‡æ³¨é‡Šæ˜¯å®˜æ–¹ç•™çš„ï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¿™ä¸ªå‡½æ•°æ˜¯ReadViewç±»çš„æˆå‘˜å‡½æ•° ReadView::changes_visible </span></span><br><span class="line"><span class="comment">// æºç é“¾æ¥ https://github.com/mysql/mysql-server/blob/ea1efa9822d81044b726aab20c857d5e1b7e046a/storage/innobase/include/read0types.h#L162  </span></span><br><span class="line"></span><br><span class="line"><span class="comment">// [[nodiscard]] ä»£è¡¨è¿™ä¸ªå‡½æ•°çš„è¿”å›å€¼ä¸èƒ½è¢«å¿½ç•¥ï¼Œä¸€å®šéœ€è¦ä½¿ç”¨è¯¥è¿”å›å€¼ï¼›å¦åˆ™ç¼–è¯‘å™¨ä¼šçˆ†è­¦å‘Šï¼›å³å‘ŠçŸ¥ç¨‹åºå‘˜å¿…é¡»å…³æ³¨è¿™ä¸ªå‡½æ•°çš„è¿”å›å€¼ï¼</span></span><br><span class="line"><span class="comment">// å‡½æ•°çš„è¿”å›å€¼æ˜¯å½“å‰äº‹åŠ¡èƒ½å¦çœ‹åˆ°æŸä¸€ä¸ªäº‹åŠ¡idå€¼çš„ç‰ˆæœ¬é“¾ï¼Œå…¥å‚æ˜¯ç›®æ ‡äº‹åŠ¡id</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/** Check whether the changes by id are visible.</span></span><br><span class="line"><span class="comment">  @param[in]    id      transaction id to check against the view</span></span><br><span class="line"><span class="comment">  @param[in]    name    table name</span></span><br><span class="line"><span class="comment">  @return whether the view sees the modifications of id. */</span></span><br><span class="line">  [[nodiscard]] <span class="function"><span class="type">bool</span> <span class="title">changes_visible</span><span class="params">(<span class="type">trx_id_t</span> id,</span></span></span><br><span class="line"><span class="params"><span class="function">                                     <span class="type">const</span> <span class="type">table_name_t</span> &amp;name)</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">    <span class="built_in">ut_ad</span>(id &gt; <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°äºæœ€å°çš„äº‹åŠ¡idæˆ–è€…ç­‰äºå½“å‰äº‹åŠ¡idï¼Œåˆ™ä»£è¡¨è¿™ä¸ªäº‹åŠ¡æˆ‘ä»¬å¯ä»¥çœ‹åˆ° </span></span><br><span class="line">    <span class="keyword">if</span> (id &lt; m_up_limit_id || id == m_creator_trx_id) &#123;</span><br><span class="line">      <span class="keyword">return</span> (<span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">check_trx_id_sanity</span>(id, name);</span><br><span class="line"><span class="comment">// å¦‚æœè¿™ä¸ªidæ¯”å½“å‰äº‹åŠ¡ä¸­çš„é«˜æ°´ä½è¿˜å¤§ï¼Œè¯´æ˜è¿™ä¸ªidæ˜¯åæ¥è€…ï¼Œä¸åº”è¯¥çœ‹åˆ°</span></span><br><span class="line">    <span class="keyword">if</span> (id &gt;= m_low_limit_id) &#123;</span><br><span class="line">      <span class="keyword">return</span> (<span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// å¦‚æœå½“å‰äº‹åŠ¡åˆ›å»ºæ—¶ï¼Œæ²¡æœ‰æ´»è·ƒäº‹åŠ¡</span></span><br><span class="line">    <span class="comment">// ä¸” m_up_limit_id &lt;= id &lt; m_low_limit_id </span></span><br><span class="line">    <span class="comment">// é‚£ä¹ˆè¿™ä¸ªäº‹åŠ¡IDå°±å¯ä»¥è¢«çœ‹åˆ°ï¼Œè¿”å›çœŸ</span></span><br><span class="line">     <span class="keyword">else</span> <span class="keyword">if</span> (m_ids.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">      <span class="built_in">return</span> (<span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">const</span> <span class="type">ids_t</span>::value_type *p = m_ids.<span class="built_in">data</span>();</span><br><span class="line"><span class="comment">// å¦‚æœä¸Šé¢éƒ½æ²¡æœ‰åŒ¹é…åˆ°ï¼Œé‚£å°±æ£€æŸ¥è¿™ä¸ªidæ˜¯å¦åœ¨æ´»è·ƒåˆ—è¡¨m_idsä¸­</span></span><br><span class="line">    <span class="comment">// std::binary_searchçš„è¿”å›å€¼ï¼šæ˜¯å¦åœ¨ä½å›¾ä¸­ï¼Œtrueä»£è¡¨åœ¨ï¼Œfalseä»£è¡¨ä¸åœ¨</span></span><br><span class="line">    <span class="comment">// å¦‚æœåœ¨ï¼Œé‚£ä¹ˆè¿™ä¸ªäº‹åŠ¡æ˜¯æ´»è·ƒçŠ¶æ€ï¼Œä¸èƒ½è¢«çœ‹åˆ°</span></span><br><span class="line">    <span class="comment">// å¦‚æœä¸åœ¨ï¼Œé‚£ä¹ˆè¿™ä¸ªäº‹åŠ¡æ˜¯å·²ç»æäº¤äº†ï¼Œå¯ä»¥è¢«çœ‹åˆ°</span></span><br><span class="line">    <span class="keyword">return</span> (!std::<span class="built_in">binary_search</span>(p, p + m_ids.<span class="built_in">size</span>(), id));</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœæŸ¥åˆ°ä¸åº”è¯¥çœ‹åˆ°å½“å‰ç‰ˆæœ¬ï¼Œæ¥ä¸‹æ¥å°±æ˜¯éå†ä¸‹ä¸€ä¸ªç‰ˆæœ¬ï¼Œç›´åˆ°ç¬¦åˆæ¡ä»¶ï¼Œå³å¯ä»¥çœ‹åˆ°ã€‚è¿™ä¾¿æ˜¯æˆ‘ä»¬selectå½“å‰è¯»çš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨äº§ç”Ÿçš„<code>ReadView</code>ç»“æ„ä½“çš„ä½œç”¨ï¼›</p><p>æ ¹æ®è¿™ä»½æºç ï¼Œæˆ‘ä»¬ä¹Ÿèƒ½çŸ¥é“<code>m_ids</code>ä½å›¾ä¸­ï¼Œå¹¶ä¸éœ€è¦å­˜æ”¾å½“å‰äº‹åŠ¡IDï¼Œå› ä¸ºä¼šæœ‰é¢å¤–çš„åˆ¤æ–­æ¥å¤„ç†å½“å‰äº‹åŠ¡IDï¼</p><h2 id="4-2-å¿«ç…§è¯»å®æ“"><a href="#4-2-å¿«ç…§è¯»å®æ“" class="headerlink" title="4.2 å¿«ç…§è¯»å®æ“"></a>4.2 å¿«ç…§è¯»å®æ“</h2><h3 id="4-2-1-å¿«ç…§æ˜¯ä»€ä¹ˆæ—¶å€™ç”Ÿæˆçš„ï¼Ÿ"><a href="#4-2-1-å¿«ç…§æ˜¯ä»€ä¹ˆæ—¶å€™ç”Ÿæˆçš„ï¼Ÿ" class="headerlink" title="4.2.1 å¿«ç…§æ˜¯ä»€ä¹ˆæ—¶å€™ç”Ÿæˆçš„ï¼Ÿ"></a>4.2.1 å¿«ç…§æ˜¯ä»€ä¹ˆæ—¶å€™ç”Ÿæˆçš„ï¼Ÿ</h3><p>å‡è®¾å½“å‰çš„äº‹åŠ¡æµç¨‹å¦‚ä¸‹ï¼Œäº‹åŠ¡2èƒ½çœ‹åˆ°äº‹åŠ¡1çš„æ“ä½œç»“æœå—ï¼Ÿ</p><table><thead><tr><th>äº‹åŠ¡1</th><th>äº‹åŠ¡2</th></tr></thead><tbody><tr><td>äº‹åŠ¡å¼€å§‹</td><td>äº‹åŠ¡å¼€å§‹</td></tr><tr><td>æ’å…¥æ•°æ®1å¹¶æäº¤äº‹åŠ¡</td><td></td></tr><tr><td></td><td>ç¬¬ä¸€æ¬¡æŸ¥è¯¢</td></tr><tr><td>é‡å¼€ä¸€ä¸ªæ–°äº‹åŠ¡ï¼Œæ’å…¥æ•°æ®2å¹¶æäº¤</td><td></td></tr><tr><td></td><td>ç¬¬äºŒæ¬¡æŸ¥è¯¢</td></tr></tbody></table><p>æ¥å®æ“ä¸€ä¸‹ï¼Œå¼€ä¸¤ä¸ªMySQLç»ˆç«¯ï¼Œéš”ç¦»çº§åˆ«è®¾ç½®ä¸ºRRï¼›å›¾ä¸­é»„å­—æ ‡å‡ºäº†æ¯ä¸€ä¸ªSQLçš„æ‰§è¡Œé¡ºåºï¼›æˆ‘ä»¬ä¼šå‘ç°ï¼Œå½“å·¦ä¾§ç»ˆç«¯æäº¤äº†ç¬¬ä¸€ä¸ªæ’å…¥çš„æ•°æ®åï¼Œå³ä¾§æ‰æŸ¥è¯¢ï¼Œ<strong>æ˜¯å¯ä»¥çœ‹åˆ°è¿™æ¡æ–°æ’å…¥çš„æ•°æ®çš„</strong>ï¼</p><p>è€Œå·¦ä¾§æ’å…¥çš„ç¬¬äºŒæ¡æ•°æ®å³ä¾§å°±çœ‹ä¸åˆ°äº†ï¼Œå¾ˆæ˜æ˜¾ï¼Œæ­¤æ—¶è®¿é—®çš„å°±æ˜¯å¿«ç…§ä¸­çš„æ—§æ•°æ®ï¼Œè€Œä¸æ˜¯æ–°æ•°æ®äº†ï¼›</p><p><img src="https://img.musnow.top/i/2023/09/c8def576b68454081f60029cfa781b5a.png" alt="image-20230912094327001"></p><p>è¿™å°±å‘Šè¯‰æˆ‘ä»¬ï¼šå¿«ç…§è¯»çš„<strong>å¿«ç…§</strong>æ˜¯åœ¨äº‹åŠ¡ä¸­ç¬¬ä¸€æ¬¡æ‰§è¡Œ<code>select</code>è¯­å¥çš„æ—¶å€™ç”Ÿæˆçš„ï¼å¹¶ä¸æ˜¯äº‹åŠ¡å¼€å§‹çš„æ—¶å€™ç”Ÿæˆçš„ï¼</p><p>è¿™ä¹Ÿéå¸¸åˆç†ï¼Œå¦‚æœä½ çš„å½“å‰äº‹åŠ¡å‹æ ¹æ²¡æœ‰è¿›è¡Œ<code>select</code>è¯­å¥ï¼Œé‚£æˆ‘ä¹Ÿå°±æ²¡æœ‰å¿…è¦ç”Ÿæˆå¿«ç…§äº†ï¼Œæ¯•ç«Ÿå¿«ç…§çš„åº•å±‚æ˜¯<code>ReadView</code>å¯¹è±¡ï¼Œä¹Ÿæ˜¯ä¼šå ç”¨å†…å­˜ç©ºé—´çš„ï¼è€Œå¢åˆ æ”¹æ“ä½œæœ¬èº«å°±æ˜¯å½“å‰è¯»ï¼Œæ— éœ€ç”Ÿæˆå¿«ç…§ï¼</p><h3 id="4-2-2-å®ä¾‹è§£é‡ŠReadViewçš„æˆå‘˜å˜é‡"><a href="#4-2-2-å®ä¾‹è§£é‡ŠReadViewçš„æˆå‘˜å˜é‡" class="headerlink" title="4.2.2 å®ä¾‹è§£é‡ŠReadViewçš„æˆå‘˜å˜é‡"></a>4.2.2 å®ä¾‹è§£é‡ŠReadViewçš„æˆå‘˜å˜é‡</h3><p>ç”¨å®é™…ä¾‹å­æ¥è§£é‡Šä¸€ä¸‹ReadViewé‡Œé¢çš„4ä¸ªæˆå‘˜å˜é‡åˆ°åº•åº”è¯¥å­˜æ”¾ä»€ä¹ˆå€¼ï¼›</p><p>å‡è®¾æœ‰ä¸‹é¢è¿™ä¸ªæ•°æ®</p><table><thead><tr><th>name</th><th>age</th><th>DB_TRX_ID(åˆ›å»ºè¿™ä¸ªè®°å½•çš„äº‹åŠ¡ID)</th><th>DB_ROW_IDï¼ˆéšè—ä¸»é”®ï¼‰</th><th>DB_ROLL_PTRï¼ˆå›æ»šæŒ‡é’ˆï¼‰</th></tr></thead><tbody><tr><td>å¼ ä¸‰</td><td>19</td><td>NULL</td><td>1</td><td>NULL</td></tr></tbody></table><p>ä¸€å…±æœ‰4ä¸ªäº‹åŠ¡åŒæ—¶è¿è¡Œï¼Œäº‹åŠ¡åºå·å°±æ˜¯äº‹åŠ¡ID</p><table><thead><tr><th>äº‹åŠ¡2</th><th>äº‹åŠ¡3</th><th>äº‹åŠ¡4</th><th>äº‹åŠ¡5</th></tr></thead><tbody><tr><td>äº‹åŠ¡å¼€å§‹</td><td>äº‹åŠ¡å¼€å§‹</td><td>äº‹åŠ¡å¼€å§‹</td><td>äº‹åŠ¡å¼€å§‹</td></tr><tr><td>â€¦â€¦</td><td>â€¦â€¦</td><td>â€¦â€¦</td><td>ä¿®æ”¹å¼ ä¸‰çš„å¹´é¾„å¹¶æäº¤</td></tr><tr><td>è¿è¡Œ</td><td>å¿«ç…§è¯»</td><td>è¿è¡Œ</td><td>â€¦â€¦</td></tr><tr><td>â€¦â€¦</td><td>â€¦â€¦</td><td>â€¦â€¦</td><td>â€¦â€¦</td></tr></tbody></table><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œäº‹åŠ¡3å¯¹æŸè¡Œæ•°æ®è¿›è¡Œäº†å¿«ç…§è¯»ï¼ŒMySQLå°±ä¼šåœ¨è¿™æ—¶å€™ç”Ÿæˆä¸€ä¸ª<code>ReadView</code>ï¼Œå†…éƒ¨å˜é‡èµ‹å€¼å¦‚ä¸‹</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">m_ids; <span class="comment">// 2,4 (å½“å‰äº‹åŠ¡5å·²ç»æäº¤äº†ï¼Œæ‰€ä»¥é™¤äº†è‡ªå·±å°±åªæœ‰2å’Œ4æ´»è·ƒä¸­)</span></span><br><span class="line">up_limit_id; <span class="comment">// 2 (m_idsä¸­æœ€å°äº‹åŠ¡ID)</span></span><br><span class="line">low_limit_id; <span class="comment">// 5 + 1 = 6 (å½“å‰å·²ç»å‡ºç°çš„æœ€å¤§äº‹åŠ¡ID+1)</span></span><br><span class="line">creator_trx_id <span class="comment">// 3 (å½“å‰äº‹åŠ¡ID)</span></span><br></pre></td></tr></table></figure><p>å½“äº‹åŠ¡3è¿›è¡Œå¿«ç…§è¯»çš„æ—¶å€™ï¼Œå°±ä¼šæ‹¿äº‹åŠ¡5çš„è¿™ä»½æ•°æ®è¿›è¡Œæ¯”è¾ƒï¼Œæœ€ç»ˆå¾—åˆ°çš„ç»“æœæ˜¯ï¼Œäº‹åŠ¡3çš„å¿«ç…§æ˜¯<strong>å¯ä»¥</strong>çœ‹åˆ°äº‹åŠ¡5å¯¹æ•°æ®è¿›è¡Œçš„ä¿®æ”¹çš„ï¼</p><p>è€Œä¸”å¯¹äºå…¨å±€æ¥è¯´ï¼Œäº‹åŠ¡5æäº¤çš„è¿™ä»½æ•°æ®ä¹Ÿæ˜¯å½“å‰æœ€æ–°çš„æ•°æ®ï¼</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ¯”è¾ƒæµç¨‹ï¼ˆä¾ç…§ä¸Šæ–¹MySQLçš„æºç ï¼‰</span></span><br><span class="line"><span class="number">5</span> &lt; up_limit_id || <span class="number">5</span> == <span class="number">3</span>; <span class="comment">// ä¸å°äºæœ€å°çš„ï¼Œä¸”ä¹Ÿä¸ç­‰äºå½“å‰çš„äº‹åŠ¡ID 3</span></span><br><span class="line"><span class="number">5</span> &gt; low_limit_id; <span class="comment">// ä¸å¤§äºæœ€å¤§çš„</span></span><br><span class="line"><span class="comment">// åˆ¤æ–­5æ˜¯å¦åœ¨m_idsé‡Œé¢</span></span><br><span class="line">m_ids.<span class="built_in">contains</span>(<span class="number">5</span>); <span class="comment">// ä¸åœ¨</span></span><br><span class="line"><span class="comment">// ç»“è®ºï¼šreturn true;</span></span><br></pre></td></tr></table></figure><h2 id="4-3-å½“å‰è¯»å®æ“"><a href="#4-3-å½“å‰è¯»å®æ“" class="headerlink" title="4.3 å½“å‰è¯»å®æ“"></a>4.3 å½“å‰è¯»å®æ“</h2><p>å¿«ç…§è¯»çš„åœºæ™¯åŸºæœ¬ææ˜ç™½äº†ï¼Œå†æ¥è¯•è¯•å½“å‰è¯»ï¼ˆè¿™é‡Œå°æä¸€å˜´ï¼Œ<strong>å†™-å†™å¹¶å‘</strong>å¯ä»¥ç†è§£ä¸ºæ‰€æœ‰æ“ä½œéƒ½æ˜¯å½“å‰è¯»ï¼Œéœ€è¦ä¸²è¡ŒåŒ–ï¼‰</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ... lock <span class="keyword">in</span> share mode;</span><br></pre></td></tr></table></figure><p>ä¸‹é¢æ˜¯ä¸¤ä¸ªä¸åŒçš„æ“ä½œæµç¨‹ï¼Œæœ€ç»ˆä¼šå¾—åˆ°ä¸åŒçš„ç»“æœï¼›æ“ä½œä¹‹å‰ï¼Œå…ˆæ‰§è¡Œå¦‚ä¸‹ä¸¤ä¸ªsql</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> test_ruc;</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> test_ruc <span class="keyword">values</span> (<span class="number">1</span>,<span class="number">20</span>,<span class="string">&#x27;å¼ ä¸‰&#x27;</span>);</span><br></pre></td></tr></table></figure><p>åœ¨ç¬¬ä¸€æ¬¡æµ‹è¯•ä¸­ï¼Œæˆ‘ä»¬åœ¨å·¦ä¾§ç»ˆç«¯æ›´æ–°æ•°æ®ä¹‹å‰å°±æ‰§è¡Œäº†ä¸€æ¬¡å¿«ç…§è¯»ï¼Œæ­¤æ—¶MySQLä¼šç”Ÿæˆå¿«ç…§ï¼Œå³ä¾¿åœ¨å·¦ä¾§ç»ˆç«¯çš„äº‹åŠ¡commitäº†ä¹‹åï¼Œå³ä¾§ä¹Ÿæ— æ³•çœ‹åˆ°æœ€æ–°çš„<code>user_id=18</code>çš„æ•°æ®ï¼›<strong>æ­¤æ—¶ä½¿ç”¨å½“å‰è¯»ï¼Œå°±å¯ä»¥è¯»å–åˆ°æœ€æ–°çš„æ•°æ®</strong>ï¼</p><p><img src="https://img.musnow.top/i/2023/09/c7088a7f3657cc02ea436a8bfd30cb88.png" alt="image-20230912103634717"></p><p>è€Œåœ¨ç¬¬äºŒæ¬¡æµ‹è¯•ä¸­ï¼Œæˆ‘ä»¬è®©å·¦ä¾§ç»ˆç«¯å®Œæˆæ‰€æœ‰æ“ä½œï¼Œå³ä¾§ç»ˆç«¯å†å»æŸ¥è¯¢ï¼Œä¼šå‘ç°å¿«ç…§è¯»å’Œå½“å‰è¯»éƒ½èƒ½æŸ¥è¯¢åˆ°æœ€æ–°çš„ä¿®æ”¹ï¼›</p><p><img src="https://img.musnow.top/i/2023/09/615e7b7cfb64f9d8f4020469bd669cf3.png" alt="image-20230912103902180"></p><p>ç”±æ­¤å¯è§</p><ul><li>å¿«ç…§è¯»çš„å¿«ç…§æ˜¯ç¬¬ä¸€æ¬¡selectæŸ¥è¯¢çš„æ—¶å€™ç”Ÿæˆçš„</li><li>å½“å‰è¯»èƒ½ç»•è¿‡å¿«ç…§æŸ¥çœ‹åˆ°æœ€æ–°æ•°æ®ï¼</li></ul><h2 id="4-4-RRå’ŒRCçš„åŒºåˆ«"><a href="#4-4-RRå’ŒRCçš„åŒºåˆ«" class="headerlink" title="4.4 RRå’ŒRCçš„åŒºåˆ«"></a>4.4 RRå’ŒRCçš„åŒºåˆ«</h2><ul><li>æ­£æ˜¯Read Viewç”Ÿæˆæ—¶æœºçš„ä¸åŒï¼Œä»è€Œé€ æˆRC,RRçº§åˆ«ä¸‹å¿«ç…§è¯»çš„ç»“æœçš„ä¸åŒ</li><li>åœ¨RRçº§åˆ«ä¸‹çš„æŸä¸ªäº‹åŠ¡çš„å¯¹æŸæ¡è®°å½•çš„ç¬¬ä¸€æ¬¡å¿«ç…§è¯»ä¼šåˆ›å»ºä¸€ä¸ªå¿«ç…§åŠRead View, å°†å½“å‰ç³»ç»Ÿæ´» è·ƒçš„å…¶ä»–äº‹åŠ¡è®°å½•èµ·æ¥</li><li>æ­¤ååœ¨è°ƒç”¨å¿«ç…§è¯»çš„æ—¶å€™ï¼Œè¿˜æ˜¯ä½¿ç”¨çš„æ˜¯åŒä¸€ä¸ªRead Viewï¼Œæ‰€ä»¥åªè¦å½“å‰äº‹åŠ¡åœ¨å…¶ä»–äº‹åŠ¡æäº¤æ›´æ–°ä¹‹å‰ä½¿ç”¨è¿‡å¿«ç…§è¯»ï¼Œé‚£ä¹ˆä¹‹åçš„å¿«ç…§è¯»ä½¿ç”¨çš„éƒ½æ˜¯åŒä¸€ä¸ªRead Viewï¼Œæ‰€ä»¥å¯¹ä¹‹åçš„ä¿®æ”¹ä¸å¯è§ï¼›</li><li>å³RRçº§åˆ«ä¸‹ï¼Œå¿«ç…§è¯»ç”ŸæˆRead Viewæ—¶ï¼ŒRead Viewä¼šè®°å½•æ­¤æ—¶æ‰€æœ‰å…¶ä»–æ´»åŠ¨äº‹åŠ¡çš„å¿«ç…§ï¼Œè¿™äº›äº‹åŠ¡çš„ä¿®æ”¹å¯¹äºå½“å‰äº‹åŠ¡éƒ½æ˜¯ä¸å¯è§çš„ã€‚è€Œæ—©äºRead Viewåˆ›å»ºçš„äº‹åŠ¡æ‰€åšçš„ä¿®æ”¹å‡æ˜¯å¯è§ï¼›</li><li>è€Œåœ¨RCçº§åˆ«ä¸‹çš„ï¼Œäº‹åŠ¡ä¸­ï¼Œæ¯æ¬¡å¿«ç…§è¯»éƒ½ä¼š<strong>æ–°ç”Ÿæˆä¸€ä¸ªå¿«ç…§</strong>å’ŒRead View, è¿™å°±æ˜¯æˆ‘ä»¬åœ¨RCçº§åˆ«ä¸‹çš„äº‹åŠ¡ä¸­å¯ä»¥çœ‹åˆ°åˆ«çš„äº‹åŠ¡æäº¤çš„æ›´æ–°çš„åŸå› ï¼›</li><li>æ€»ä¹‹åœ¨RCéš”ç¦»çº§åˆ«ä¸‹ï¼Œæ˜¯æ¯ä¸ªå¿«ç…§è¯»éƒ½ä¼šç”Ÿæˆå¹¶è·å–æœ€æ–°çš„Read Viewï¼›è€Œåœ¨RRéš”ç¦»çº§åˆ«ä¸‹ï¼Œåˆ™æ˜¯åŒä¸€ä¸ªäº‹åŠ¡ä¸­çš„ç¬¬ä¸€ä¸ªå¿«ç…§è¯»æ‰ä¼šåˆ›å»ºRead Viewï¼Œä¹‹åçš„å¿«ç…§è¯»è·å–çš„éƒ½æ˜¯åŒä¸€ä¸ªRead Viewã€‚ </li><li>æ­£æ˜¯RCæ¯æ¬¡å¿«ç…§è¯»ï¼Œéƒ½ä¼šå½¢æˆRead Viewï¼Œæ‰€ä»¥ï¼ŒRCæ‰ä¼šæœ‰ä¸å¯é‡å¤è¯»é—®é¢˜ã€‚</li></ul><h1 id="The-end"><a href="#The-end" class="headerlink" title="The end"></a>The end</h1><p>å…³äºMySQLäº‹åŠ¡çš„å†…å®¹åˆ°è¿™é‡ŒåŸºæœ¬å°±OVERäº†ï¼Œå†…å®¹å¤šå¤šï¼Œä¹Ÿéœ€è¦å¤šå¤šç†è§£å’Œå¤ä¹ ï¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">å¯ä»¥æ·±å…¥é˜…è¯»å¦‚ä¸‹æ–‡ç« </span><br><span class="line">https://blog.csdn.net/SnailMann/article/details/94724197</span><br><span class="line">https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html</span><br><span class="line">https://blog.csdn.net/chenghan_yang/article/details/97630626</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">äº‹åŠ¡çš„å­¦ä¹ </summary>
    
    
    
    <category term="å­¦ä¹ sql" scheme="https://blog.musnow.top/categories/%E5%AD%A6%E4%B9%A0sql/"/>
    
    
    <category term="Linux" scheme="https://blog.musnow.top/tags/Linux/"/>
    
    <category term="mysql" scheme="https://blog.musnow.top/tags/mysql/"/>
    
  </entry>
  
  <entry>
    <title>ã€MySQLã€‘ç´¢å¼•</title>
    <link href="https://blog.musnow.top/posts/3474107655/"/>
    <id>https://blog.musnow.top/posts/3474107655/</id>
    <published>2023-09-07T09:52:14.000Z</published>
    <updated>2023-09-07T09:52:30.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1-ç´¢å¼•"><a href="#1-ç´¢å¼•" class="headerlink" title="1.ç´¢å¼•"></a>1.ç´¢å¼•</h1><h2 id="1-1-ä¸ºå•¥éœ€è¦ç´¢å¼•ï¼Ÿ"><a href="#1-1-ä¸ºå•¥éœ€è¦ç´¢å¼•ï¼Ÿ" class="headerlink" title="1.1 ä¸ºå•¥éœ€è¦ç´¢å¼•ï¼Ÿ"></a>1.1 ä¸ºå•¥éœ€è¦ç´¢å¼•ï¼Ÿ</h2><p>å¯¹äºæ•°æ®åº“è€Œè¨€ï¼ŒæŸ¥è¯¢å§‹ç»ˆæ˜¯ä¸€ä¸ªé«˜é¢‘çš„æ“ä½œï¼›å‡è®¾åœ¨æ•°æ®é‡åˆ°ç™¾ä¸‡çº§çš„æ—¶å€™ï¼ŒæŸ¥è¯¢ä¸€ä¸ªç”¨æˆ·ä¿¡æ¯å°±è¦èŠ±5ç§’ä¸­ï¼Œé‚£ç”¨æˆ·è‚¯å®šä¸æ„¿æ„ç­‰å¾…ä½ çš„ç³»ç»Ÿå“åº”ï¼Œè¿™å°±é€ æˆäº†ç”¨æˆ·æµå¤±ã€‚</p><p>æ‰€ä»¥ï¼ŒMySQLå¿…é¡»ä½¿ç”¨æŸç§æ–¹å¼æ¥ä¿è¯æŸ¥è¯¢çš„é«˜é€Ÿå¯é ï¼Œç´¢å¼•å°±è¯ç”Ÿäº†ï¼›</p><p>å¯¹äºä½¿ç”¨è€…è€Œè¨€ï¼Œç´¢å¼•æ˜¯å¾ˆé¦™çš„ï¼Œå› ä¸ºä½ åªéœ€è¦æ‰§è¡Œ<code>create index</code>ç»™æŒ‡å®šçš„åˆ—ï¼Œé‚£ä¹ˆMySQLå°±ä¼šè‡ªåŠ¨å¸®ä½ ç»´æŠ¤ä¸€ç³»åˆ—ç´¢å¼•åˆ›å»ºçš„æ“ä½œï¼ŒæŸ¥è¯¢å˜å˜å¿«ï¼</p><p>ä½†ï¼ŒæŸ¥è¯¢é€Ÿåº¦çš„æé«˜æ˜¯ä»¥æ’å…¥ã€æ›´æ–°ã€åˆ é™¤ç­‰æ“ä½œçš„é€Ÿåº¦ä¸ºä»£ä»·çš„ï¼Œè¿™äº›å†™æ“ä½œä¼šå¢åŠ å¤§é‡çš„IOï¼›ç´¢å¼•çš„ä»·å€¼åœ¨äºæé«˜æµ·é‡æ•°æ®çš„æŸ¥è¯¢é€Ÿåº¦ï¼›</p><p>å¸¸è§çš„ç´¢å¼•</p><ul><li>ä¸»é”®ç´¢å¼•</li><li>å”¯ä¸€é”®ç´¢å¼•</li><li>æ™®é€šç´¢å¼•</li><li>å¤åˆç´¢å¼•</li><li>å…¨æ–‡ç´¢å¼•</li></ul><h2 id="1-2-ç´¢å¼•çš„æ•ˆæœ"><a href="#1-2-ç´¢å¼•çš„æ•ˆæœ" class="headerlink" title="1.2 ç´¢å¼•çš„æ•ˆæœ"></a>1.2 ç´¢å¼•çš„æ•ˆæœ</h2><p>é€šè¿‡å¦‚ä¸‹çš„å¤§æ•°æ®ç”¨ä¾‹ï¼Œæˆ‘ä»¬èƒ½çœ‹åˆ°ç´¢å¼•çš„æ•ˆæœå‡ ä½•</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> database if <span class="keyword">exists</span> `bit_index`;</span><br><span class="line"><span class="keyword">create</span> database if <span class="keyword">not</span> <span class="keyword">exists</span> `bit_index` <span class="keyword">default</span> <span class="type">character</span> <span class="keyword">set</span> utf8;</span><br><span class="line">use `bit_index`;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ„å»ºä¸€ä¸ª8000000æ¡è®°å½•çš„æ•°æ®</span></span><br><span class="line"><span class="comment">-- æ„å»ºçš„æµ·é‡è¡¨æ•°æ®éœ€è¦æœ‰å·®å¼‚æ€§ï¼Œæ‰€ä»¥ä½¿ç”¨å­˜å‚¨è¿‡ç¨‹æ¥åˆ›å»ºï¼Œ æ‹·è´ä¸‹é¢ä»£ç å°±å¯ä»¥äº†ï¼Œæš‚æ—¶ä¸ç”¨ç†è§£</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- äº§ç”Ÿéšæœºå­—ç¬¦ä¸²</span></span><br><span class="line">delimiter $$</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">function</span> rand_string(n <span class="type">INT</span>)</span><br><span class="line"><span class="keyword">returns</span> <span class="type">varchar</span>(<span class="number">255</span>)</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="keyword">declare</span> chars_str <span class="type">varchar</span>(<span class="number">100</span>) <span class="keyword">default</span></span><br><span class="line"><span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFJHIJKLMNOPQRSTUVWXYZ&#x27;</span>;</span><br><span class="line"><span class="keyword">declare</span> return_str <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">default</span> <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="keyword">declare</span> i <span class="type">int</span> <span class="keyword">default</span> <span class="number">0</span>;</span><br><span class="line">while i <span class="operator">&lt;</span> n do</span><br><span class="line"><span class="keyword">set</span> return_str <span class="operator">=</span>concat(return_str,<span class="built_in">substring</span>(chars_str,<span class="built_in">floor</span>(<span class="number">1</span><span class="operator">+</span>rand()<span class="operator">*</span><span class="number">52</span>),<span class="number">1</span>));</span><br><span class="line"><span class="keyword">set</span> i <span class="operator">=</span> i <span class="operator">+</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">end</span> while;</span><br><span class="line"><span class="keyword">return</span> return_str;</span><br><span class="line"><span class="keyword">end</span> $$</span><br><span class="line">delimiter ;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- äº§ç”Ÿéšæœºæ•°å­—</span></span><br><span class="line">delimiter $$</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">function</span> rand_num( )</span><br><span class="line"><span class="keyword">returns</span> <span class="type">int</span>(<span class="number">5</span>)</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="keyword">declare</span> i <span class="type">int</span> <span class="keyword">default</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">set</span> i <span class="operator">=</span> <span class="built_in">floor</span>(<span class="number">10</span><span class="operator">+</span>rand()<span class="operator">*</span><span class="number">500</span>);</span><br><span class="line"><span class="keyword">return</span> i;</span><br><span class="line"><span class="keyword">end</span> $$</span><br><span class="line">delimiter ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- åˆ›å»ºå­˜å‚¨è¿‡ç¨‹ï¼Œå‘é›‡å‘˜è¡¨æ·»åŠ æµ·é‡æ•°æ®</span></span><br><span class="line">delimiter $$</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> insert_emp(<span class="keyword">in</span> <span class="keyword">start</span> <span class="type">int</span>(<span class="number">10</span>),<span class="keyword">in</span> max_num <span class="type">int</span>(<span class="number">10</span>))</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="keyword">declare</span> i <span class="type">int</span> <span class="keyword">default</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">set</span> autocommit <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">repeat</span><br><span class="line"><span class="keyword">set</span> i <span class="operator">=</span> i <span class="operator">+</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> EMP <span class="keyword">values</span> ((<span class="keyword">start</span><span class="operator">+</span>i)</span><br><span class="line">,rand_string(<span class="number">6</span>),<span class="string">&#x27;SALESMAN&#x27;</span>,<span class="number">0001</span>,curdate(),<span class="number">2000</span>,<span class="number">400</span>,rand_num());</span><br><span class="line">until i <span class="operator">=</span> max_num</span><br><span class="line"><span class="keyword">end</span> repeat;</span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"><span class="keyword">end</span> $$</span><br><span class="line">delimiter ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- é›‡å‘˜è¡¨</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `EMP` (</span><br><span class="line">  `empno` <span class="type">int</span>(<span class="number">6</span>) unsigned zerofill <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;é›‡å‘˜ç¼–å·&#x27;</span>,</span><br><span class="line">  `ename` <span class="type">varchar</span>(<span class="number">10</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;é›‡å‘˜å§“å&#x27;</span>,</span><br><span class="line">  `job` <span class="type">varchar</span>(<span class="number">9</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;é›‡å‘˜èŒä½&#x27;</span>,</span><br><span class="line">  `mgr` <span class="type">int</span>(<span class="number">4</span>) unsigned zerofill <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;é›‡å‘˜é¢†å¯¼ç¼–å·&#x27;</span>,</span><br><span class="line">  `hiredate` datetime <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;é›‡ä½£æ—¶é—´&#x27;</span>,</span><br><span class="line">  `sal` <span class="type">decimal</span>(<span class="number">7</span>,<span class="number">2</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å·¥èµ„æœˆè–ª&#x27;</span>,</span><br><span class="line">  `comm` <span class="type">decimal</span>(<span class="number">7</span>,<span class="number">2</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å¥–é‡‘&#x27;</span>,</span><br><span class="line">  `deptno` <span class="type">int</span>(<span class="number">2</span>) unsigned zerofill <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;éƒ¨é—¨ç¼–å·&#x27;</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ‰§è¡Œå­˜å‚¨è¿‡ç¨‹ï¼Œæ·»åŠ 8000000æ¡è®°å½•</span></span><br><span class="line"><span class="keyword">call</span> insert_emp(<span class="number">100001</span>, <span class="number">8000000</span>);</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªè¡¨é‡Œé¢ï¼Œæœ‰å¤§é‡çš„æ•°æ®ï¼Œå…¶é»˜è®¤çŠ¶æ€ä¸‹ï¼Œå¹¶æ²¡æœ‰é…ç½®ç´¢å¼•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [bit_index]&gt; desc EMP;</span><br><span class="line">+----------+--------------------------+------+-----+---------+-------+</span><br><span class="line">| Field    | Type                     | Null | Key | Default | Extra |</span><br><span class="line">+----------+--------------------------+------+-----+---------+-------+</span><br><span class="line">| empno    | int(6) unsigned zerofill | NO   |     | NULL    |       |</span><br><span class="line">| ename    | varchar(10)              | YES  |     | NULL    |       |</span><br><span class="line">| job      | varchar(9)               | YES  |     | NULL    |       |</span><br><span class="line">| mgr      | int(4) unsigned zerofill | YES  |     | NULL    |       |</span><br><span class="line">| hiredate | datetime                 | YES  |     | NULL    |       |</span><br><span class="line">| sal      | decimal(7,2)             | YES  |     | NULL    |       |</span><br><span class="line">| comm     | decimal(7,2)             | YES  |     | NULL    |       |</span><br><span class="line">| deptno   | int(2) unsigned zerofill | YES  |     | NULL    |       |</span><br><span class="line">+----------+--------------------------+------+-----+---------+-------+</span><br><span class="line">8 rows in set (0.001 sec)</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶å¦‚æœä½ ç›´æ¥å…¨åˆ—æŸ¥è¯¢ï¼Œè¿›ç¨‹å°±ä¼šé˜»å¡åœ¨è¿™é‡Œ</p><p><img src="https://img.musnow.top/i/2023/09/bd7ed9436789f27dec4d4ba2ab40ea5b.png" alt="image-20230907172052198"></p><p>è¿›MySQLçš„æ–‡ä»¶è·¯å¾„çœ‹çœ‹ï¼Œä¼šå‘ç°è¿™å¼ è¡¨çš„å¤§å°å·²ç»åˆ°äº†æƒŠäººçš„564mbï¼Œè™½ç„¶æˆ‘ä»¬çš„å†…å­˜ä¹Ÿè®¸èƒ½å­˜çš„ä¸‹è¿™ä¹ˆå¤§çš„æ•°æ®ï¼Œä½†å®é™…IOè¯»å†™è¿™ä¹ˆå¤§é‡çš„æ•°æ®æ˜¯éå¸¸è€—æ—¶çš„</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@vm-cnt8:/var/lib/mysql/bit_index]# ll -h</span><br><span class="line">total 565M</span><br><span class="line">-rw-rw----. 1 mysql mysql   61 Sep  6 05:36 db.opt</span><br><span class="line">-rw-rw----. 1 mysql mysql  770 Sep  6 05:36 EMP.frm</span><br><span class="line">-rw-rw----. 1 mysql mysql 564M Sep  6 05:39 EMP.ibd</span><br></pre></td></tr></table></figure><p>åœ¨ä¹‹å‰çš„æŸ¥è¯¢æ“ä½œä¸­æåˆ°è¿‡ï¼Œå¯¹äºè¿™ç§å¤§æ•°æ®è¡¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬åº”è¯¥é¿å…ä½¿ç”¨å…¨åˆ—æŸ¥è¯¢ï¼Œè€Œåº”è¯¥è®¾ç½®<code>limit</code>åªæŸ¥è¯¢å‡ºå°‘é‡ç”¨ä¾‹æ•°æ®ï¼Œæ¥åˆ¤æ–­è¿™ä¸ªè¡¨çš„æ•°æ®ç»“æ„å’Œä½œç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [bit_index]&gt; select * from EMP limit 3;</span><br><span class="line">+--------+--------+----------+------+---------------------+---------+--------+--------+</span><br><span class="line">| empno  | ename  | job      | mgr  | hiredate            | sal     | comm   | deptno |</span><br><span class="line">+--------+--------+----------+------+---------------------+---------+--------+--------+</span><br><span class="line">| 100002 | FNXAKX | SALESMAN | 0001 | 2023-09-06 00:00:00 | 2000.00 | 400.00 |    327 |</span><br><span class="line">| 100003 | rQbLBy | SALESMAN | 0001 | 2023-09-06 00:00:00 | 2000.00 | 400.00 |    394 |</span><br><span class="line">| 100004 | wRVdDF | SALESMAN | 0001 | 2023-09-06 00:00:00 | 2000.00 | 400.00 |    195 |</span><br><span class="line">+--------+--------+----------+------+---------------------+---------+--------+--------+</span><br><span class="line">3 rows in set (0.001 sec)</span><br></pre></td></tr></table></figure><p>åœ¨æ²¡æœ‰ç´¢å¼•çš„æƒ…å†µä¸‹è¿›è¡Œä¸€ä¸ªæŸ¥è¯¢ï¼Œç”¨æ—¶å¤§çº¦åœ¨1.6ç§’å·¦å³</p><p><img src="https://img.musnow.top/i/2023/09/cec2caa51179f05f7309b5c968a539df.png" alt="image-20230907172357990"></p><p>è¿™æ—¶å€™æˆ‘ä»¬æ¥å¯¹empnoåˆ—åˆ›å»ºä¸€ä¸ªä¸»é”®ç´¢å¼•</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> EMP <span class="keyword">add</span> <span class="keyword">primary</span> key(empno);</span><br></pre></td></tr></table></figure><p>å› ä¸ºè¡¨ä¸­çš„æ•°æ®å¾ˆå¤šï¼Œæ‰€ä»¥è®¾ç½®ä¸»é”®ç´¢å¼•ä¹Ÿéœ€è¦è€—è´¹ä¸€å®šæ—¶é—´ï¼Œè¿™ä¸ªæ—¶é—´å†…ï¼Œå…¶å®å°±æ˜¯MySQLåœ¨åå°å¸®æˆ‘ä»¬åˆ›å»ºç´¢å¼•æ‰€éœ€è¦çš„æ•°æ®ç»“æ„çš„è¿‡ç¨‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [bit_index]&gt; alter table EMP add primary key(empno);</span><br><span class="line">Query OK, 0 rows affected (17.184 sec)              </span><br><span class="line">Records: 0  Duplicates: 0  Warnings: 0</span><br></pre></td></tr></table></figure><p>å†æ¥æŸ¥è¯¢ä¸€ä¸‹åˆšåˆšæŸ¥è¯¢çš„æ•°æ®ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œç”¨æ—¶åªæœ‰<code>0.000 sec</code>ï¼Œç›´æ¥ç§’å›ï¼</p><p><img src="https://img.musnow.top/i/2023/09/0a7e44f14cf052534721da8beca3a073.png" alt="image-20230907172541115"></p><p>è¿™ä¾¿æ˜¯ç´¢å¼•åœ¨æå‡æ€§èƒ½æ–¹é¢çš„é‡å¤§ä½œç”¨ï¼</p><h2 id="1-3-MySQLå’Œæ–‡ä»¶ç³»ç»Ÿ"><a href="#1-3-MySQLå’Œæ–‡ä»¶ç³»ç»Ÿ" class="headerlink" title="1.3 MySQLå’Œæ–‡ä»¶ç³»ç»Ÿ"></a>1.3 MySQLå’Œæ–‡ä»¶ç³»ç»Ÿ</h2><h3 id="1-3-1-Linuxæ–‡ä»¶ç³»ç»Ÿ"><a href="#1-3-1-Linuxæ–‡ä»¶ç³»ç»Ÿ" class="headerlink" title="1.3.1 Linuxæ–‡ä»¶ç³»ç»Ÿ"></a>1.3.1 Linuxæ–‡ä»¶ç³»ç»Ÿ</h3><p>åœ¨ä¹‹å‰å¯¹<a href="https://blog.musnow.top/posts/2864480005/">Linuxæ–‡ä»¶ç³»ç»Ÿ</a>çš„å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“åœ¨ç£ç›˜ä¸­ï¼Œä¸€ä¸ªåŒºå—æ˜¯512KBï¼Œåœ¨Linuxç³»ç»Ÿä¸­ï¼Œä¸ºäº†æé«˜æ•ˆç‡ï¼Œä¼šé‡‡ç”¨4KBçš„åˆ†å—å¯¹æ•°æ®è¿›è¡Œè¯»å–ã€‚å“ªæ€•ä½ åªæ˜¯ä¿®æ”¹1KBï¼Œä¹Ÿæ˜¯éœ€è¦å°†4KBå®Œæ•´è¯»å–ï¼Œå†å†™å…¥å›å»çš„ã€‚</p><p><img src="https://img.musnow.top/i/2023/09/cda9058519a11abeed3a167eb6690d0c.png" alt="image-20230907174710578"></p><p>å› ä¸ºæœºæ¢°ç¡¬ç›˜ç‰©ç†ç»“æ„çš„é™åˆ¶ï¼Œ<strong>éšæœºè¯»å–çš„æ€§èƒ½ä¸ä½³</strong>ï¼Œä¸€æ¬¡æ€§è¯»å–100KBæ•°æ®ï¼Œè¿œè¿œä¼˜äº100æ¬¡è¯»å–1KBã€‚å› ä¸ºä¸€æ¬¡æ€§è¯»å–çš„æ—¶å€™ï¼Œåªéœ€è¦ä¸€æ¬¡å¯»é“å°±èƒ½å°†ç£å¤´æ‘†åˆ°æ­£ç¡®çš„ä½ç½®ï¼Œå¾€é‡Œé¢å†™æ•°æ®å°±å®Œäº‹äº†ã€‚ä½†å¤šæ¬¡è¯»å–å°æ•°æ®çš„æ—¶å€™ï¼Œå°½ç®¡ç›¸é‚»çš„ä¸¤æ¬¡IOæ“ä½œåœ¨åŒä¸€æ—¶åˆ»å‘å‡ºï¼Œä½†å¦‚æœå®ƒä»¬çš„è¯·æ±‚çš„æ‰‡åŒºåœ°å€ç›¸å·®å¾ˆå¤§çš„è¯ä¹Ÿåªèƒ½ç§°ä¸ºéšæœºè®¿é—®ï¼Œè€Œéè¿ç»­è®¿é—®ã€‚</p><p>éšæœºè®¿é—®å°±è¦å¤šæ¬¡å¯»é“ï¼Œæ¯æ¬¡å†™å…¥çš„é‡åˆå¾ˆå°‘ï¼Œå¤§å¤§å¢åŠ äº†IOçš„è´Ÿæ‹…ã€‚</p><h3 id="1-3-2-MySQLå’Œç£ç›˜äº¤äº’åŸºæœ¬å•ä½-16KB"><a href="#1-3-2-MySQLå’Œç£ç›˜äº¤äº’åŸºæœ¬å•ä½-16KB" class="headerlink" title="1.3.2 MySQLå’Œç£ç›˜äº¤äº’åŸºæœ¬å•ä½ 16KB"></a>1.3.2 MySQLå’Œç£ç›˜äº¤äº’åŸºæœ¬å•ä½ 16KB</h3><p>è€ŒMySQLä¸­ï¼Œä¸ºäº†æ›´å¥½çš„å®ç°å¯¹æ•°æ®IOé‡çš„ç¼©å‡å’Œæ§åˆ¶ï¼Œå…¶å†…éƒ¨å°†16KBä½œä¸ºä¸€æ¬¡IOçš„åŸºæœ¬å•ä½ï¼Œè¿™ä¸ªå¤§å°æˆ‘ä»¬å«åšMySQLçš„æ–‡ä»¶Pageï¼›</p><ul><li>MySQLä¸­çš„æ•°æ®æ–‡ä»¶ï¼Œéƒ½æ˜¯ä»¥Pageä¸ºåŸºæœ¬å•ä½ä¿å­˜è‡³ç£ç›˜é‡Œé¢çš„ï¼›</li><li>MySQLä¸­çš„CURDæ“ä½œï¼Œéƒ½éœ€è¦é€šè¿‡è®¡ç®—æ¥å®šä½åˆ°éœ€è¦ä¿®æ”¹å’Œè®¿é—®çš„æ•°æ®çš„ä½ç½®ï¼›</li><li>æ¶‰åŠåˆ°è®¡ç®—çš„æ“ä½œéƒ½éœ€è¦CPUå‚ä¸ï¼ŒCPUåªèƒ½å¤„ç†å†…å­˜ä¸­çš„æ•°æ®ï¼Œè¿™å°±è¦æ±‚MySQLéœ€è¦æå‰å°†ä¸€éƒ¨åˆ†æ•°æ®åŠ è½½åˆ°å†…å­˜ä¸­ï¼›</li><li>æ‰€ä»¥åœ¨MySQLè¿è¡Œçš„è¿™æ®µæ—¶é—´å†…ï¼Œå…¶æ“ä½œçš„æ•°æ®ä¼šåŒæ—¶å­˜åœ¨äºå†…å­˜å’Œç£ç›˜ä¸­ï¼Œéœ€è¦ä»¥ç‰¹å®šçš„ç­–ç•¥å°†å†…å­˜ä¸­çš„æ•°æ®åˆ·æ–°åˆ°ç£ç›˜ä¸­ï¼›è¿™ä¸ªæ“ä½œå°±æ˜¯IOï¼ŒåŸºæœ¬å•ä½æ˜¯Pageï¼›</li><li>ä¸ºäº†æ›´å¥½çš„ç®¡ç†è¿™äº›æ“ä½œï¼ŒMySQLä¼šè‡ªå·±ç»´æŠ¤ä¸€ä¸ª<code>buffer pool</code>çš„å†…å­˜ç©ºé—´ï¼Œæ¥è¿›è¡Œç¼“å­˜ã€‚</li><li>MySQLæ˜¯ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œå®ƒçš„æ‰€æœ‰æ–‡ä»¶IOæ“ä½œéƒ½éœ€è¦é€šè¿‡æ“ä½œç³»ç»Ÿæä¾›çš„æ¥å£æ¥å®ç°ï¼ä½†å†…éƒ¨çš„åˆ·ç›˜é€»è¾‘æ˜¯å¯ä»¥ç”±MySQLæ¥è°ƒç”¨ç³»ç»Ÿæ¥å£æ¥è‡ªä¸»æ§åˆ¶çš„ï¼Œè€Œä¸éœ€è¦å‘†æ¿åœ°éµå®ˆæ“ä½œç³»ç»Ÿçš„è‡ªåŠ¨ç­–ç•¥ï¼›ï¼ˆMySQLåˆ›å»º<code>buffer pool</code>ä¹Ÿæ˜¯åŸºäºæ›´é«˜çš„è‡ªä¸»æ€§æ¥è€ƒè™‘çš„ï¼‰</li><li>æœ€ç»ˆç›®æ ‡æ˜¯å°½å¯èƒ½åœ°å‡å°‘IOæ“ä½œï¼Œæé«˜è¿è¡Œæ•ˆç‡ï¼›</li></ul><p>è¿è¡Œå¦‚ä¸‹å‘½ä»¤å¯ä»¥çœ‹åˆ°MySQLä¸­å…³äºPageè®¾ç½®çš„å…¨å±€å˜é‡ï¼Œå³16KB</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [bit_index]&gt; SHOW GLOBAL STATUS LIKE &#x27;innodb_page_size&#x27;;</span><br><span class="line">+------------------+-------+</span><br><span class="line">| Variable_name    | Value |</span><br><span class="line">+------------------+-------+</span><br><span class="line">| Innodb_page_size | 16384 |</span><br><span class="line">+------------------+-------+</span><br><span class="line">1 row in set (0.001 sec)</span><br></pre></td></tr></table></figure><h3 id="1-3-3-ä¸ºä»€ä¹ˆè¦ç”¨Pageä¸ºå•ä½è¿›è¡Œäº¤äº’ï¼Ÿ"><a href="#1-3-3-ä¸ºä»€ä¹ˆè¦ç”¨Pageä¸ºå•ä½è¿›è¡Œäº¤äº’ï¼Ÿ" class="headerlink" title="1.3.3 ä¸ºä»€ä¹ˆè¦ç”¨Pageä¸ºå•ä½è¿›è¡Œäº¤äº’ï¼Ÿ"></a>1.3.3 ä¸ºä»€ä¹ˆè¦ç”¨Pageä¸ºå•ä½è¿›è¡Œäº¤äº’ï¼Ÿ</h3><p>ä¸ºä½•MySQLå’Œç£ç›˜è¿›è¡ŒIOäº¤äº’çš„æ—¶å€™ï¼Œè¦é‡‡ç”¨Pageçš„æ–¹æ¡ˆè¿›è¡Œäº¤äº’å‘¢ï¼Ÿç”¨å¤šå°‘ï¼ŒåŠ è½½å¤šå°‘ä¸é¦™å—ï¼Ÿ</p><p>å…ˆæ¥ä¸ªæµ‹è¯•ç”¨ä¾‹çœ‹çœ‹å§ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„ç”¨æˆ·è¡¨</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- ä¸»é”®é»˜è®¤ç”Ÿæˆä¸»é”®ç´¢å¼•</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> if <span class="keyword">not</span> <span class="keyword">exists</span> <span class="keyword">user</span> (</span><br><span class="line">    id <span class="type">int</span> <span class="keyword">primary</span> key, </span><br><span class="line">    age <span class="type">int</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">16</span>) <span class="keyword">not</span> <span class="keyword">null</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">-- æ’å…¥å¤šæ¡è®°å½•ï¼Œä¸»é”®æ²¡æœ‰æŒ‰é¡ºåºæ’å…¥</span></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">user</span> (id, age, name) <span class="keyword">values</span>(<span class="number">3</span>, <span class="number">18</span>, <span class="string">&#x27;æ¨è¿‡&#x27;</span>);</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">user</span> (id, age, name) <span class="keyword">values</span>(<span class="number">4</span>, <span class="number">16</span>, <span class="string">&#x27;å°é¾™å¥³&#x27;</span>);</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.00</span> sec)</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">user</span> (id, age, name) <span class="keyword">values</span>(<span class="number">2</span>, <span class="number">26</span>, <span class="string">&#x27;é»„è“‰&#x27;</span>);</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">user</span> (id, age, name) <span class="keyword">values</span>(<span class="number">5</span>, <span class="number">36</span>, <span class="string">&#x27;éƒ­é–&#x27;</span>);</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.00</span> sec)</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">user</span> (id, age, name) <span class="keyword">values</span>(<span class="number">1</span>, <span class="number">56</span>, <span class="string">&#x27;æ¬§é˜³é”‹&#x27;</span>);</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.00</span> sec)</span><br><span class="line"><span class="comment">-- æœ€ç»ˆå‘ç°æ•°æ®æ˜¯æœ‰åºçš„</span></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span>; </span><br><span class="line"><span class="operator">+</span><span class="comment">----+-----+-----------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> age <span class="operator">|</span> name      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-----+-----------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1</span>  <span class="operator">|</span> <span class="number">56</span>  <span class="operator">|</span> æ¬§é˜³é”‹     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2</span>  <span class="operator">|</span> <span class="number">26</span>  <span class="operator">|</span> é»„è“‰       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">3</span>  <span class="operator">|</span> <span class="number">18</span>  <span class="operator">|</span> æ¨è¿‡       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">4</span>  <span class="operator">|</span> <span class="number">16</span>  <span class="operator">|</span> å°é¾™å¥³     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">5</span>  <span class="operator">|</span> <span class="number">36</span>  <span class="operator">|</span> éƒ­é–       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-----+-----------+</span></span><br><span class="line"><span class="number">5</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„5æ¡è®°å½•ä¸­ï¼Œå¦‚æœMySQLè¦æŸ¥æ‰¾id&#x3D;2çš„è®°å½•ï¼Œç¬¬ä¸€æ¬¡åŠ è½½id&#x3D;1ï¼Œç¬¬äºŒæ¬¡åŠ è½½id&#x3D;2ï¼Œä¸€æ¬¡ä¸€æ¡è®°å½•ï¼Œ<strong>é‚£ä¹ˆå°±éœ€è¦2æ¬¡IO</strong>ã€‚å¦‚æœè¦æ‰¾id&#x3D;5ï¼Œé‚£ä¹ˆå°±éœ€è¦5æ¬¡IOã€‚</p><p>ä½†ï¼Œå¦‚æœè¿™5æ¡(æˆ–è€…æ›´å¤š)éƒ½è¢«ä¿å­˜åœ¨ä¸€ä¸ªPageä¸­(16KBï¼Œèƒ½ä¿å­˜å¾ˆå¤šè®°å½•)ï¼Œé‚£ä¹ˆç¬¬ä¸€æ¬¡IOæŸ¥æ‰¾id&#x3D;2çš„æ—¶å€™ï¼Œæ•´ä¸ªPageä¼šè¢«åŠ è½½åˆ°MySQLçš„<code>Buffer Pool</code>ä¸­ï¼Œè¿™é‡Œå®Œæˆäº†ä¸€æ¬¡IOã€‚ä½†æ˜¯å¾€åå¦‚æœåœ¨æŸ¥æ‰¾id&#x3D;1,3,4,5ç­‰ï¼Œå®Œå…¨ä¸éœ€è¦è¿›è¡ŒIOäº†ï¼Œè€Œæ˜¯ç›´æ¥åœ¨å†…å­˜ä¸­è¿›è¡Œäº†ã€‚æ‰€ä»¥ï¼Œå°±åœ¨å•Pageé‡Œé¢ï¼Œå¤§å¤§å‡å°‘äº†IOçš„æ¬¡æ•°ï¼</p><p>è™½ç„¶æˆ‘ä»¬ä¸èƒ½ä¿è¯åç»­çš„å‡ æ¬¡IOä¸€å®šåœ¨è¿™æ¬¡åŠ è½½çš„Pageä¸­ï¼Œä½†æ ¹æ®<code>å±€éƒ¨æ€§åŸç†</code>ï¼Œå…¶è®¿é—®ç›¸è¿‘çš„å‡ æ¡æ•°æ®çš„æ¦‚ç‡æ˜¯å¾ˆå¤§çš„ï¼æ‰€ä»¥è¿™æ ·æœ€ç»ˆæ˜¯èƒ½æå‡IOæ•ˆç‡çš„ï¼</p><p>å¾€å¾€IOæ•ˆç‡ä½ä¸‹çš„æœ€ä¸»è¦çŸ›ç›¾ä¸æ˜¯IOå•æ¬¡æ•°æ®é‡çš„å¤§å°ï¼Œ<strong>è€Œæ˜¯IOçš„æ¬¡æ•°</strong>ã€‚</p><h2 id="1-4-B-æ ‘å’ŒPage"><a href="#1-4-B-æ ‘å’ŒPage" class="headerlink" title="1.4 B+æ ‘å’ŒPage"></a>1.4 B+æ ‘å’ŒPage</h2><p>æœ‰äº†å¯¹Pageçš„è®¤è¯†ï¼Œæ¥ä¸‹æ¥å°±éœ€è¦ç”¨ä¸€ä¸ªæ•°æ®ç»“æ„æ¥ç»´æŠ¤è¿™äº›åŠ è½½åˆ°<code>Buffer Pool</code>å½“ä¸­çš„Pageäº†ã€‚è¿™æ—¶å€™ï¼Œæˆ‘ä»¬çš„B+æ ‘å°±ç™»åœºäº†ã€‚</p><h3 id="1-4-1-å•ä¸ªPage"><a href="#1-4-1-å•ä¸ªPage" class="headerlink" title="1.4.1 å•ä¸ªPage"></a>1.4.1 å•ä¸ªPage</h3><p>å•ä¸ªPageé‡Œé¢å­˜æ”¾çš„è‚¯å®šæ˜¯ä¸€éƒ¨åˆ†çš„æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥åŠ ä¸Šå‰åæŒ‡é’ˆï¼Œä»¥åŒé“¾è¡¨çš„å½¢å¼å°†æ‰€æœ‰Pageè¿èµ·æ¥ï¼Œè¿™æ ·å°±èƒ½å®ç°æ•°æ®çš„éå†ï¼›åœ¨MySQLä¸­ï¼Œå°±æ˜¯è¿™ä¹ˆæ“ä½œçš„ã€‚</p><p><img src="https://img.musnow.top/i/2023/09/fafa9750da8082ecdf3927663eb49941.png" alt="image-20230907182425023"></p><p>å› ä¸ºå­˜åœ¨ä¸»é”®ï¼ŒMySQLè¿˜ä¼šç»™å•ä¸ªPageä¸­çš„æ•°æ®ä¾ç…§ä¸»é”®è¿›è¡Œæ’åºï¼Œä»ä¸Šå›¾å°±èƒ½çœ‹å‡ºé˜¿é‡Œï¼Œå•ä¸ªPageä¸­æ•°æ®æ˜¯ä¾ç…§ä¸»é”®æŒ‰åºæ’åˆ—çš„ï¼›ä¸”æ¯ä¸€ä¸ªæ•°æ®éƒ½ä¼šé“¾æ¥åˆ°ä¸‹ä¸€ä¸ªæ•°æ®ä¸Šï¼›</p><p>è¿™æ ·æ’åºåï¼Œæ•°æ®åº“åœ¨è¿›è¡Œæ•°æ®ç­›é€‰çš„æ—¶å€™ï¼Œå°±èƒ½æ›´å¥½çš„å®šä½åˆ°æ•°æ®çš„ä½ç½®ï¼Œå‡å°‘æŸ¥è¯¢è€—æ—¶ã€‚æ’å…¥æ—¶æ’åºä¹Ÿèƒ½è®©åç»­åœ¨è¿›è¡Œæ•°æ®é™åº&#x2F;å‡åºè¾“å‡ºçš„æ—¶å€™ï¼Œæ— éœ€äºŒæ¬¡å¯¹æ•°æ®è¿›è¡Œæ’åºäº†ï¼›</p><h3 id="1-4-2-å¤šä¸ªPage"><a href="#1-4-2-å¤šä¸ªPage" class="headerlink" title="1.4.2 å¤šä¸ªPage"></a>1.4.2 å¤šä¸ªPage</h3><p>æ—¢ç„¶ä¸€ä¸ªPageæ˜¯å¦‚æ­¤ï¼Œé‚£å¤šä¸ªPageå‘¢ï¼Ÿ</p><ul><li>å‰é¢æåˆ°äº†ï¼Œå½“MySQLéœ€è¦åŠ è½½æ•°æ®çš„æ—¶å€™ï¼Œä¼šå°†å’Œè¿™ä¸ªæ•°æ®ç›¸é‚»è¿‘çš„å…¶ä»–æ•°æ®ï¼Œä»¥16KBä¸ºå•ä½ä¸€èµ·åŠ è½½åˆ°ä¸€ä¸ªPageé‡Œé¢ï¼Œå¹¶è¿æ¥åˆ°è¿™ä¸ªåŒå‘é“¾è¡¨ä¸Šï¼›</li><li>è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡å¤šä¸ªPageçš„éå†æ¥è¿›è¡Œæ•°æ®çš„å®šä½</li><li>å¯é“¾è¡¨æ˜¯ä¸€ä¸ªçº¿æ€§ç»“æ„ï¼ŒMySQLè‚¯å®šä¸å¯èƒ½ç”¨çº¿æ€§ç»“æ„æ¥ç»´æŠ¤æ•°æ®å§ï¼Ÿé‚£æ ·æŸ¥è¯¢çš„æ•ˆç‡ä¹Ÿå¤ªä½äº†ï¼Œæ¯æ¬¡éƒ½éœ€è¦O(N)çš„éå†ï¼Œæ•°æ®ä¸€å¤šå°±æ…¢æ…¢æ…¢ï¼</li></ul><p><img src="https://img.musnow.top/i/2023/09/12d3385dee351703d07d0104f014b80a.png" alt="image-20230907183025895"></p><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬è‚¯å®šè¦åœ¨åŒå‘é“¾è¡¨çš„åŸºç¡€ä¸Šæ·»åŠ å…¶ä»–çš„ç»“æ„æ¥è¿›è¡ŒæŸ¥æ‰¾çš„ä¼˜åŒ–ï¼è¿™æ—¶å€™å°±å¯ä»¥å¼•å…¥<strong>ç›®å½•</strong>äº†</p><h4 id="é¡µç›®å½•"><a href="#é¡µç›®å½•" class="headerlink" title="é¡µç›®å½•"></a>é¡µç›®å½•</h4><p>åœ¨æˆ‘ä»¬çœ‹ä¹¦çš„æ—¶å€™ï¼Œå°±ä¼šæœ‰ç›®å½•æ¥å¸®åŠ©æˆ‘ä»¬å¿«é€ŸæŸ¥æ‰¾åˆ°æŸä¸€ä¸ªç« èŠ‚ã€‚æ¯”å¦‚æˆ‘ä»¬æƒ³çœ‹ç¬¬ä¹ç« çš„å†…å®¹ï¼Œé‚£å°±å¯ä»¥å…ˆçœ‹ç›®å½•ï¼Œæ‰¾åˆ°ç¬¬ä¹ç« çš„é¡µç ï¼Œå†è¿›è¡Œé˜…è¯»ã€‚</p><p>å¯¹äºMySQLä¸­çš„æ•°æ®ï¼Œè¿™ä¸ªæƒ…æ™¯ä¹Ÿæ˜¯é€‚ç”¨çš„ï¼Œæˆ‘ä»¬ç»™æ•°æ®ä¸Šä¸€ä¸ªç›®å½•ï¼ŒæŸ¥è¯¢çš„æ—¶å€™å…ˆæ ¹æ®ç›®å½•å®šä½åˆ°å…·ä½“çš„pageï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“1-10å·æ•°æ®éƒ½åœ¨è¿™ä¸ªpageé‡Œé¢ï¼Œé‚£å°±ç›´æ¥å»é‡Œé¢æ‰¾å°±è¡Œäº†ï¼›è¿™æ—¶å€™æŸ¥æ‰¾çš„æ•ˆç‡å°±æ¯”å•çº¯çš„ä»é“¾è¡¨å¼€å¤´è¿›è¡Œéå†å¿«å¤šäº†ï¼</p><p>å½“ç„¶ï¼Œå’Œä¹¦ç±çš„ç›®å½•éœ€è¦æ¶ˆè€—çº¸å¼ ä¸€æ ·ï¼Œåœ¨MySQLä¸­å¯¹æ•°æ®è®¾ç½®ç›®å½•ä¹Ÿæ˜¯éœ€è¦æ¶ˆè€—ç©ºé—´çš„ï¼Œè¿™å°±æ˜¯ä¸€ç§ç”¨ç©ºé—´æ¢æ—¶é—´çš„åšæ³•ï¼Œè€Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œæ—¶é—´æ˜¾ç„¶æ›´åŠ å®è´µï¼</p><h4 id="å•é¡µç›®å½•"><a href="#å•é¡µç›®å½•" class="headerlink" title="å•é¡µç›®å½•"></a>å•é¡µç›®å½•</h4><p>åœ¨å•ä¸ªPageé‡Œé¢ï¼Œæˆ‘ä»¬å¯ä»¥å®‰å¦‚ä¸‹çš„æ–¹å¼è®¾å®šä¸€ä¸ªç›®å½•ï¼Œå—ä¸€å®šé—´éš”å°±è®¾ç½®ä¸€ä¸ªæ–°çš„èŠ‚ç‚¹ä½œä¸ºç›®å½•ã€‚åœ¨æ•°æ®é‡å°çš„æ—¶å€™ï¼Œè¿™ä¸ªç›®å½•çš„ä½œç”¨ä¸ç®—å¤§ï¼Œä½†æ•°æ®é‡ä¸€å¤§ï¼Œç›®å½•å¯¹æœç´¢æ•ˆç‡çš„æå‡æ˜¯éå¸¸å¯è§‚çš„ï¼</p><blockquote><p>æ¯”å¦‚ï¼Œæˆ‘ä»¬è¦æŸ¥æ‰¾id&#x3D;4è®°å½•ï¼Œä¹‹å‰å¿…é¡»çº¿æ€§éå†4æ¬¡ï¼Œæ‰èƒ½æ‹¿åˆ°ç»“æœã€‚ç°åœ¨ç›´æ¥é€šè¿‡ç›®å½•2[3]ï¼Œç›´æ¥è¿›è¡Œå®šä½æ–°çš„èµ·å§‹ä½ç½®ï¼Œåªéœ€è¦éå†3æ¬¡å°±èƒ½æ‰¾åˆ°ç»“æœï¼Œæé«˜äº†æ•ˆç‡ã€‚</p></blockquote><p>å³ä¾¿åœ¨å•ä¸ªPageä¸­æ·»åŠ ç›®å½•ä¼šå¯¼è‡´è¿™ä¸ªPageå®é™…å­˜æ”¾çš„æ•°æ®å˜å°‘ï¼Œä½†è¿™æ˜¯å¿…è¦çš„ç‰ºç‰²ï¼</p><p><img src="https://img.musnow.top/i/2023/09/052c18b6ad7065a68f008d8234f08dfc.png" alt="image-20230907191523912"></p><h4 id="å¤šé¡µç›®å½•"><a href="#å¤šé¡µç›®å½•" class="headerlink" title="å¤šé¡µç›®å½•"></a>å¤šé¡µç›®å½•</h4><p>å‰é¢æåˆ°ï¼ŒMySQLä¼šè‡ªåŠ¨æŠŠæ–°çš„æ•°æ®åŠ è½½åˆ°ä¸€ä¸ªPageä¸­ï¼Œå¹¶é“¾æ¥åˆ°å·²æœ‰é“¾è¡¨ä¸Šï¼›ä½†æ˜¯çº¿æ€§éå†éœ€è¦å¤§é‡çš„IOï¼Œæ¯æ¬¡é‡åˆ°æ–°çš„Pageçš„æ—¶å€™ï¼Œå°±éœ€è¦å°†å…¶åŠ è½½åˆ°å†…å­˜é‡Œé¢ï¼Œè¿›è¡Œéå†ï¼Œè¿™å°±ä½¿å¾—å•ä¸ªPageä¸­çš„ç›®å½•ä¸é‚£ä¹ˆå®ç”¨äº†ï¼›</p><ul><li>å•ä¸ªPageçš„ç›®å½•æ˜¯å°èŠ‚ç›®å½•</li><li>å¤šä¸ªPageçš„ç›®å½•æ˜¯ç« èŠ‚ç›®å½•</li></ul><p>æ‰€ä»¥æˆ‘ä»¬å¿…é¡»ç»™å¤šä¸ªPageä¹ŸåŠ ä¸Šä¸€ä¸ªé¡¶å±‚çš„ç« èŠ‚ç›®å½•ï¼Œè¿›ä¸€æ­¥ä¼˜åŒ–æ•ˆç‡ï¼</p><ul><li>ä½¿ç”¨ä¸€ä¸ªPageæ¥æŒ‡å‘å¤šä¸ªPageï¼Œå­˜æ”¾æ¯ä¸ªPageçš„èµ·å§‹keyå€¼ï¼ˆå‡è®¾æ¯ä¸ªPageä¸­çš„keyéƒ½æœ‰åºä¸”ä¸ºå‡åºï¼‰ï¼›è¿™ä¸ªPageä¸­ä¸å­˜æ”¾å®é™…çš„æ•°æ®ï¼Œåªæœ‰ç›®å½•å€¼ï¼›</li><li>éå†çš„æ—¶å€™ï¼Œå…ˆé€šè¿‡å¤šPageçš„ç›®å½•æ‰¾åˆ°æˆ‘ä»¬è¦å»çš„Pageï¼Œå†å»è®¿é—®è¯¥å®é™…å­˜å‚¨æ•°æ®çš„Pageä¸­çš„å•Pageç›®å½•ï¼Œæœ€ç»ˆæŸ¥æ‰¾åˆ°ç›®æ ‡æ•°æ®ï¼›</li><li>æ‰€ä»¥ï¼Œæ¯ä¸ªå¤šPageçš„ç›®å½•é¡¹ä¸­å°±æ˜¯ä¸€ä¸ªé”®å€¼+å¯¹åº”æ™®é€šPageçš„æŒ‡é’ˆ</li></ul><p><img src="https://img.musnow.top/i/2023/09/f14ce259e947e2cc699ae2341e3e83cd.png" alt="image-20230907192840730"></p><p>ä¸€å±‚ç›®å½•Pageä¸å¤Ÿï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å†åŠ ä¸€å±‚ã€‚è¿™æ ·å°±å®ç°äº†ä¸€ä¸ªç±»ä¼¼äºäºŒå‰æ ‘çš„ç»“æ„ï¼Œåªä¸è¿‡æ¯ä¸€ä¸ªèŠ‚ç‚¹Pageä¸­éƒ½åŒ…å«å¤šä¸ªPageçš„key+æŒ‡é’ˆï¼Œæœ€ç»ˆåªæœ‰å¶å­èŠ‚ç‚¹æ˜¯å®é™…å­˜å‚¨æ•°æ®çš„ï¼</p><p><img src="https://img.musnow.top/i/2023/09/485204263a90e86428707dd92244878b.png" alt="image-20230907193042036"></p><p>è¿™ä¸ªæ•°æ®ç»“æ„å°±å«åšB+æ ‘ï¼ˆæ³¨æ„ï¼Œä¸æ˜¯Bæ ‘ï¼ï¼‰è€Œæ•´ä¸ªä¸Šå›¾ä¸­çš„æ•°æ®æ¥å°±æ˜¯MySQLä¸­å¯¹userè¡¨åšçš„ç´¢å¼•ï¼</p><p>æ­¤æ—¶çš„æŸ¥è¯¢ï¼Œéœ€è¦ç»è¿‡çš„èŠ‚ç‚¹è‚¯å®šå˜å°‘äº†ï¼Œæ¯”å¦‚æˆ‘ä»¬éœ€è¦æŸ¥è¯¢<code>id=12</code>çš„ç”¨æˆ·ï¼š</p><ul><li>é¡¶å±‚åˆ¤æ–­ï¼Œ12&gt;11&gt;1ï¼Œå‘å³èµ°ã€2æ¬¡æ¯”è¾ƒã€‘</li><li>ç¬¬äºŒå±‚åˆ¤æ–­ï¼Œ12&gt;11ä¸”12&lt;16ï¼Œå‘å·¦èµ°ï¼Œæ¥åˆ°å…·ä½“çš„Pageã€2æ¬¡æ¯”è¾ƒã€‘</li><li>æŸ¥æ‰¾å•é¡µç›®å½•ï¼Œ12&gt;11ä¸”12&lt;13ï¼›ã€2æ¬¡æ¯”è¾ƒã€‘</li><li>ä»11å¼€å§‹éå†ï¼Œèµ°ä¸€æ­¥å°±èƒ½æ‰¾åˆ°ã€1æ¬¡æ¯”è¾ƒã€‘</li></ul><p>æœ€ç»ˆï¼Œæˆ‘ä»¬æŸ¥æ‰¾12çš„æ“ä½œåªç”¨äº†7æ¬¡å°±æˆåŠŸäº†ã€‚è€Œä»æŠ•å¼€å§‹éå†éœ€è¦12æ¬¡æ‰èƒ½æ‰¾åˆ°å®ƒï¼›</p><p>éå†æ¬¡æ•°çš„å‡å°‘ï¼Œå°±ç­‰åŒäºIOæ¬¡æ•°çš„å‡å°‘ï¼Œæœ€ç»ˆæŸ¥è¯¢çš„æ•ˆç‡å°±å˜é«˜äº†ï¼</p><blockquote><p>è¿™é‡Œçš„åˆ†æå¯èƒ½æœ‰è¯¯ï¼Œä¸è¿‡ç»“è®ºæ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œåˆ†é¡µè‚¯å®šèƒ½å¢åŠ æŸ¥æ‰¾çš„æ•ˆç‡ï¼</p></blockquote><p>å¦å¤–ï¼ŒMySQLè¿˜å¯ä»¥æ ¹æ®è®¿é—®çš„é¢‘ç‡ï¼Œå®šæœŸçš„é‡Šæ”¾ä¸€äº›Pageï¼›æ¯”å¦‚åœ¨B+æ ‘ä¸­ï¼Œå¯èƒ½æ ‘çš„å³åŠéƒ¨åˆ†å¾ˆå°‘è¢«è®¿é—®ï¼Œé‚£å°±å¯ä»¥æš‚æ—¶é‡Šæ”¾è¿™éƒ¨åˆ†Pageçš„ç©ºé—´ï¼Œç»™å…¶ä»–è¡¨ä½¿ç”¨ï¼ŒçœŸåˆ°é‡åˆ°è®¿é—®çš„æ—¶å€™ï¼Œå†å»è¯»ç›˜å»é™¤è¿™éƒ¨åˆ†æ•°æ®ã€‚<strong>è¿™æ˜¯ç”±MySQLçš„ç¼“å­˜ç­–ç•¥æ¥è‡ªä¸»å†³å®šçš„</strong>ï¼›</p><p>æ¯•ç«Ÿå½“ä¸€ä¸ªè¡¨éå¸¸å¤§çš„æ—¶å€™ï¼Œå°†å…¶å…¨éƒ¨åŠ è½½åˆ°å†…å­˜é‡Œé¢æ˜¯ä¸å¯è¡Œçš„ï¼å¿…é¡»è¦ç”¨ç¼“å­˜ç­–ç•¥å’Œå±€éƒ¨æ€§åŸç†æ¥åŠ è½½é¢‘ç¹ä½¿ç”¨çš„æ•°æ®åˆ°å†…å­˜ä¸­ï¼Œæ‰èƒ½åœ¨æ•ˆç‡å’Œè´Ÿè½½ä¸Šè¾¾åˆ°å¹³è¡¡ï¼›</p><p>ä¸ç„¶ä½ çš„MySQLæ— è„‘ç¼“å­˜Pageå¯¼è‡´å ç”¨è¿‡å¤šå†…å­˜ï¼Œæ“ä½œç³»ç»Ÿçœ‹ä¸ä¸‹å»ç›´æ¥ç»™ä½ KILLäº†ï¼Œé‚£ä¸šåŠ¡å°±å®Œè›‹äº†ï¼ğŸ¤£</p><h3 id="1-4-3-å°ç»“"><a href="#1-4-3-å°ç»“" class="headerlink" title="1.4.3 å°ç»“"></a>1.4.3 å°ç»“</h3><ul><li>Pageåˆ†ä¸ºç›®å½•é¡µå’Œæ•°æ®é¡µã€‚ç›®å½•é¡µåªæ”¾å„ä¸ªä¸‹çº§Pageçš„æœ€å°é”®å€¼å’Œè¯¥Pageçš„æŒ‡é’ˆã€‚</li><li>æŸ¥æ‰¾çš„æ—¶å€™ï¼Œè‡ªé¡¶å‘ä¸‹æ‰¾ï¼Œåªéœ€è¦åŠ è½½éƒ¨åˆ†ç›®å½•é¡µåˆ°å†…å­˜ï¼Œå³å¯å®Œæˆç®—æ³•çš„æ•´ä¸ªæŸ¥æ‰¾è¿‡ç¨‹ï¼Œå¤§å¤§å‡å°‘äº†IOæ¬¡æ•°</li><li>èŒƒå›´æŸ¥è¯¢çš„æ—¶å€™ï¼Œå¯ä»¥æ‰¾åˆ°åŒºé—´è¾¹ç•Œçš„ä¸¤ä¸ªèŠ‚ç‚¹çš„ä½ç½®ï¼Œç„¶åç›´æ¥é€šè¿‡å¶å­èŠ‚ç‚¹çš„é“¾è¡¨è¿›è¡Œéå†ï¼Œå–å‡ºæ•°æ®å³å¯ï¼</li><li>MySQLå¯ä»¥æ ¹æ®è®¿é—®é¢‘ç‡ï¼Œé€‚å½“åœ°é¢„å…ˆåŠ è½½æˆ–è€…é‡Šæ”¾ä¸€äº›Pageçš„ç©ºé—´ï¼Œå¹¶ä¸æ˜¯è¯´ä¸€å¼ è¡¨çš„æ‰€æœ‰æ•°æ®éƒ½å¿…é¡»å…¨éƒ¨åŠ è½½åˆ°å†…å­˜é‡Œé¢ï¼›</li></ul><p>åç»­æˆ‘è¿˜ä¼šå­¦ä¹ Bæ ‘å’ŒB+æ ‘æ•°æ®ç»“æ„åœ¨CPPä¸­çš„å®ç°ï¼Œæ•¬è¯·å…³æ³¨æˆ‘çš„åšå®¢ï¼</p><h2 id="1-5-ä¸ºä»€ä¹ˆå…¶ä»–æ•°æ®ç»“æ„ä¸é€‚åˆç´¢å¼•ï¼Ÿ"><a href="#1-5-ä¸ºä»€ä¹ˆå…¶ä»–æ•°æ®ç»“æ„ä¸é€‚åˆç´¢å¼•ï¼Ÿ" class="headerlink" title="1.5 ä¸ºä»€ä¹ˆå…¶ä»–æ•°æ®ç»“æ„ä¸é€‚åˆç´¢å¼•ï¼Ÿ"></a>1.5 ä¸ºä»€ä¹ˆå…¶ä»–æ•°æ®ç»“æ„ä¸é€‚åˆç´¢å¼•ï¼Ÿ</h2><p>åœ¨è®¤è¯†è¿™ä¸ªé—®é¢˜ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆè¦è®°ä½ä¸Šæ–‡æåˆ°çš„ä¸€ä¸ªç»“è®ºï¼šçœŸæ­£å½±å“ç´¢å¼•æ€§èƒ½çš„ï¼Œæ˜¯å’Œç¡¬ç›˜IOçš„æ¬¡æ•°ï¼ŒIOæ¬¡æ•°è¶Šå°‘ï¼Œæ€§èƒ½è¶Šé«˜ï¼›</p><ul><li>é“¾è¡¨ã€çº¿æ€§è¡¨ï¼šéƒ½æ˜¯çº¿æ€§éå†ï¼Œå‹æ ¹æ²¡æœ‰ç´¢å¼•çš„åŠŸèƒ½</li><li>äºŒå‰æœç´¢æ ‘ï¼šåœ¨æç«¯åœºæ™¯ä¸‹ä¼šé€€åŒ–æˆæ™®é€šäºŒå‰æ ‘ï¼Œè¿˜æ˜¯çº¿æ€§éå†</li><li><code>AVLTree/RBTree</code>ï¼šè™½ç„¶ç›¸å¯¹å¹³è¡¡ï¼Œä½†äºŒå‰ç»“æ„ä¼šå¯¼è‡´æ ‘çš„æ•´ä½“è¿‡é«˜ï¼Œè‡ªé¡¶å‘ä¸‹æŸ¥è¯¢çš„æ—¶å€™ï¼Œéœ€è¦ç»è¿‡å¤šå±‚çš„å¤šæ¬¡IOï¼Œæ‰èƒ½æ‰¾åˆ°ç›®æ ‡æ•°æ®ï¼ˆB+æ ‘çš„å±‚æ•°æ›´å°‘ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹B+æ ‘æ›´ä¼˜ç§€ï¼‰</li><li>HASHï¼šè™½ç„¶æŸ¥æ‰¾çš„æ—¶å€™å¾ˆå¿«ï¼ŒåŸºæœ¬èƒ½åšåˆ°O(1)ï¼Œä½†èŒƒå›´æŸ¥è¯¢çš„æ•ˆæœä¸ä½³ï¼›åœ¨MySQLä¸­ä¹Ÿæ˜¯æ”¯æŒHASHç´¢å¼•çš„ï¼Œæ¯”å¦‚<code>MEMOY/HEAP/NDB</code>å­˜å‚¨å¼•æ“ï¼›</li></ul><p><img src="https://img.musnow.top/i/2023/09/ab7bb4e2660ff869b45d61974beb6ed7.png" alt="image-20230907193621724"></p><p>é‚£Bæ ‘ä¸ºä»€ä¹ˆä¸é€‚åˆå‘¢ï¼Ÿä½œä¸ºä¸€ä¸ªå¤šå‰æ ‘ç»“æ„ï¼ŒBæ ‘çš„åŒå±‚èƒ½æ¯”çº¢é»‘æ ‘å­˜å‚¨æ›´å¤šä¿¡æ¯ï¼Œçœ‹ä¸Šå»ä¹Ÿæ˜¯å¯ä»¥åšç´¢å¼•çš„å‘€ï¼Ÿ</p><p>ç‰µæ‰¯åˆ°Bæ ‘å’ŒB+æ ‘çš„åŒºåˆ«äº†ï¼Œæ¥çœ‹çœ‹äºŒè€…çš„ç»“æ„å›¾</p><p><img src="https://img.musnow.top/i/2023/09/d485930385b11585cdb3c15e87e2b2df.png" alt="image-20230907145442565"></p><p>æ–‡å­—è¯´æ˜å¦‚ä¸‹ï¼š</p><ul><li>Bæ ‘çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½ä¼šå­˜æ”¾ä¸€å®šçš„æ•°æ®å’ŒpageæŒ‡é’ˆï¼›</li><li>B+æ ‘åªæœ‰å¶å­èŠ‚ç‚¹ä¼šå­˜æ”¾æ•°æ®ï¼Œéå¶å­èŠ‚ç‚¹åªæœ‰pageçš„ç›®å½•ï¼›</li><li>B+æ ‘çš„å¶å­èŠ‚ç‚¹å…¨éƒ¨ç›¸è¿ï¼›</li></ul><p>è¿™å°±å¼•å‡ºäº†B+æ ‘çš„ä¸¤ä¸ªä¼˜ç‚¹ï¼š</p><ul><li>å› ä¸ºB+æ ‘çš„éå¶å­èŠ‚ç‚¹åªéœ€è¦å­˜å‚¨pageç›®å½•ï¼Œæ‰€ä»¥åœ¨ä¸€ä¸ªéå¶å­èŠ‚ç‚¹ä¸­å°±èƒ½å­˜æ”¾è¾ƒå¤šçš„ç›®å½•ç´¢å¼•ï¼Œä½¿å¾—æ ‘æ•´ä½“æ›´çŸ®ï¼›</li><li>B+æ ‘çš„å¶å­èŠ‚ç‚¹å…¨éƒ¨ç›¸è¿ï¼Œæ–¹ä¾¿è¿›è¡ŒèŒƒå›´éå†ï¼Œæ¯”å¦‚<code>where sal&gt;100 and sal &lt; 300</code>çš„è¿™ç§èŒƒå›´æ¡ä»¶ï¼Œå°±å¯ä»¥ç›´æ¥é€šè¿‡å¶å­èŠ‚ç‚¹çš„é“¾è¡¨å‘åéå†æ¥è§£å†³ï¼›</li></ul><p>æœ€ç»ˆçš„æ•ˆç‡é—®é¢˜ä¾æ—§è½åˆ°äº†å¦‚ä½•è®©æ ‘æ›´çŸ®æ¥<strong>å‡å°‘IOæ¬¡æ•°</strong>ï¼Œå› ä¸ºåœ¨æ•´ä½“ä¸ŠB+æ ‘éƒ½èƒ½åšåˆ°è¾ƒçŸ®ï¼ŒæŸ¥è¯¢æ•ˆç‡ä¼˜ç§€ï¼Œæ–¹ä¾¿èŒƒå›´æŸ¥è¯¢ï¼›æ‰€ä»¥MySQLä¸»è¦é€‰ç”¨äº†B+æ ‘ä½œä¸ºç´¢å¼•ç»“æ„ã€‚</p><h2 id="1-6-èšç°‡-x2F-éèšç°‡ç´¢å¼•"><a href="#1-6-èšç°‡-x2F-éèšç°‡ç´¢å¼•" class="headerlink" title="1.6 èšç°‡&#x2F;éèšç°‡ç´¢å¼•"></a>1.6 èšç°‡&#x2F;éèšç°‡ç´¢å¼•</h2><h3 id="1-6-1-è¯´æ˜"><a href="#1-6-1-è¯´æ˜" class="headerlink" title="1.6.1 è¯´æ˜"></a>1.6.1 è¯´æ˜</h3><p>InnoDBçš„æ•°æ®æ˜¯å’ŒB+æ ‘ä¸€èµ·å­˜æ”¾çš„ï¼Œå¶å­èŠ‚ç‚¹é‡Œé¢æœ‰æ•°æ®ï¼›è¿™ç§æ•°æ®å’Œç´¢å¼•åœ¨ä¸€èµ·çš„å½¢å¼ï¼Œå«åš<strong>èšç°‡ç´¢å¼•</strong>ã€‚</p><p><img src="https://img.musnow.top/i/2023/09/c569f1a484e8f61b916751b6d6305a2b.png" alt="image-20230907145652553"></p><p>MyISAMçš„å¶å­ä¸­æ²¡æœ‰æ•°æ®ï¼Œè€Œæ˜¯å­˜æ”¾çš„æŒ‡å‘æ•°æ®è¡¨å¯¹åº”ä½ç½®çš„æŒ‡é’ˆï¼Œæœ‰é¢å¤–çš„ä¸€å¼ è¡¨æ¥å­˜æ”¾æ‰€æœ‰æ•°æ®ï¼›è¿™ç§æ•°æ®å’Œç´¢å¼•åˆ†ç¦»çš„å½¢å¼ï¼Œå«åš<strong>éèšç°‡ç´¢å¼•</strong>ï¼›</p><p><img src="https://img.musnow.top/i/2023/09/6be83a012b547b33adf2f8e9cab5252d.png" alt="image-20230907145704130"></p><p>å¯¹äºMyISAMå­˜å‚¨å¼•æ“æ¥è¯´ï¼Œ<strong>å…¶å¾ˆé€‚åˆè¿›è¡ŒæŸ¥è¯¢</strong>ï¼Œç‰¹åˆ«æ˜¯å¤§æ–‡æœ¬æŸ¥æ‰¾å’Œå…¨æ–‡ç´¢å¼•ï¼ˆåæ–‡ä¼šæåˆ°ï¼‰ï¼›</p><h3 id="1-6-2-å®æœºæ¼”ç¤º"><a href="#1-6-2-å®æœºæ¼”ç¤º" class="headerlink" title="1.6.2 å®æœºæ¼”ç¤º"></a>1.6.2 å®æœºæ¼”ç¤º</h3><blockquote><p>åœ¨MySQLä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å®é™…æ–‡ä»¶çš„æ•°é‡çœ‹å‡ºInnoDBå’ŒMyISAMå­˜å‚¨å¼•æ“çš„åŒºåˆ«ï¼›å…¶ä¹Ÿåæ˜ äº†èšç°‡&#x2F;éèšç°‡ç´¢å¼•çš„æ€§è´¨ã€‚</p></blockquote><p>è¿™é‡Œæˆ‘ä»¬æ–°å»ºä¸€ä¸ªæ•°æ®åº“ï¼Œåˆ›å»ºuser1è¡¨ï¼Œé»˜è®¤é‡‡ç”¨çš„æ˜¯InnoDBä½œä¸ºå­˜å‚¨å¼•æ“</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; create table user1( id int unsigned primary key, name varchar(200) NOT NULL );</span><br><span class="line">Query OK, 0 rows affected (0.008 sec)</span><br></pre></td></tr></table></figure><p>åœ¨MySQLçš„æ–‡ä»¶å­˜å‚¨è·¯å¾„ä¸­ï¼Œå¯ä»¥æŸ¥çœ‹åˆ°user1è¡¨å¯¹åº”äº†ä¸¤ä¸ªæ–‡ä»¶ï¼Œå…¶ä¸­<code>.ibd</code>åç¼€æŒ‡çš„å°±æ˜¯InnoDBï¼Œå…¶å†…éƒ¨åŒæ—¶åŒ…å«äº†è¯¥è¡¨ä¸­çš„æ•°æ®å’Œç´¢å¼•å€¼ï¼›</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@vm-cnt8:/var/lib/mysql/hello_mysql]# ll</span><br><span class="line">total 104</span><br><span class="line">-rw-rw----. 1 mysql mysql    61 Sep  7 02:59 db.opt</span><br><span class="line">-rw-rw----. 1 mysql mysql  1545 Sep  7 03:00 user1.frm</span><br><span class="line">-rw-rw----. 1 mysql mysql 98304 Sep  7 03:00 user1.ibd</span><br></pre></td></tr></table></figure><p>å†æ¥åˆ›å»ºä¸€ä¸ªå±æ€§å®Œå…¨ç›¸åŒçš„user2è¡¨ï¼Œä½†é‡‡ç”¨MyISAMå­˜å‚¨å¼•æ“</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; create table user2( id int unsigned primary key, name varchar(200) NOT NULL ) engine=MyISAM;</span><br><span class="line">Query OK, 0 rows affected (0.002 sec)</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶èƒ½çœ‹åˆ°ï¼ŒMyISAMå¯¹åº”çš„å­˜å‚¨æ–‡ä»¶æœ‰3ä¸ªï¼Œ<code>.MYI</code>åŒ…å«çš„æ˜¯ç´¢å¼•ï¼Œ<code>.MYD</code>åŒ…å«çš„æ˜¯å®é™…æ•°æ®ï¼›</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@vm-cnt8:/var/lib/mysql/hello_mysql]# ll</span><br><span class="line">total 112</span><br><span class="line">-rw-rw----. 1 mysql mysql    61 Sep  7 02:59 db.opt</span><br><span class="line">-rw-rw----. 1 mysql mysql  1545 Sep  7 03:00 user1.frm</span><br><span class="line">-rw-rw----. 1 mysql mysql 98304 Sep  7 03:00 user1.ibd</span><br><span class="line">-rw-rw----. 1 mysql mysql  1545 Sep  7 03:03 user2.frm</span><br><span class="line">-rw-rw----. 1 mysql mysql     0 Sep  7 03:03 user2.MYD</span><br><span class="line">-rw-rw----. 1 mysql mysql  1024 Sep  7 03:03 user2.MYI</span><br></pre></td></tr></table></figure><p>ä¸¤è¡¨éƒ½æœ‰ä¸€ä¸ªå ç”¨ç©ºé—´å®Œå…¨ç›¸åŒçš„<code>.frm</code>æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶ä¸­å­˜å‚¨çš„å°±æ˜¯è¯¥è¡¨çš„ç»“æ„å±æ€§ä¿¡æ¯ï¼Œå› ä¸ºä¸¤ä¸ªè¡¨çš„ç»“æ„å®Œå…¨ç›¸åŒï¼Œæ‰€ä»¥è¿™ä¸ªæ–‡ä»¶çš„å¤§å°ä¹Ÿç›¸åŒï¼›</p><h2 id="1-7-å›è¡¨æŸ¥æ‰¾"><a href="#1-7-å›è¡¨æŸ¥æ‰¾" class="headerlink" title="1.7 å›è¡¨æŸ¥æ‰¾"></a>1.7 å›è¡¨æŸ¥æ‰¾</h2><p>åˆ›å»º<strong>è¾…åŠ©ç´¢å¼•</strong>çš„æ—¶å€™ï¼ŒMyISAMä¾æ—§åˆ›å»ºä¸€ä¸ªB+æ ‘ï¼Œå¶å­èŠ‚ç‚¹ä¹Ÿæ˜¯æŒ‡å‘å¯¹åº”ä½ç½®çš„æŒ‡é’ˆï¼›æ‰€ä»¥åœ¨MyISAMä¸­ï¼Œä¸»é”®&#x2F;éä¸»é”®ç´¢å¼•åŒºåˆ«ä¸å¤§ï¼Œæ— éæ˜¯æ˜¯å¦å…è®¸å†—ä½™æ•°æ®çš„é—®é¢˜ã€‚</p><p><img src="https://img.musnow.top/i/2023/09/2540a3c70fb29ad3e861374ef8a0cbe1.png" alt="image-20230907145845574"></p><p>InnoDBçš„è¾…åŠ©ç´¢å¼•ä¸­ï¼Œä¸å†ç›´æ¥å­˜æ”¾èŠ‚ç‚¹æ•°æ®ï¼Œè€Œæ˜¯å­˜æ”¾<strong>ä¸»é”®keyå€¼</strong>ï¼ŒæŸ¥è¯¢çš„æ—¶å€™æ ¹æ®keyå€¼å›åˆ°<strong>ä¸»é”®ç´¢å¼•è¡¨</strong>ä¸­è¿›è¡ŒæŸ¥è¯¢ï¼Œéœ€è¦<strong>æŸ¥è¯¢ä¸¤æ¬¡</strong>æ‰èƒ½è·å–åˆ°ç»“æœã€‚</p><blockquote><p>å¦‚æœè¾…åŠ©ç´¢å¼•ä¸­è¿˜ä¿å­˜æ•°æ®ï¼Œå°±ä¼šé€ æˆæå¤§çš„ç©ºé—´æµªè´¹ï¼Œä¸€ä»½æ•°æ®è¢«ä¿å­˜ä¸¤æ¬¡ç”šè‡³æ›´å¤šæ¬¡ï¼Œæ˜¾ç„¶æ˜¯ä¸åˆç†çš„ã€‚</p></blockquote><p>InnoDBè¿™ä¸ªå…ˆæŸ¥è¾…åŠ©ç´¢å¼•è¡¨ï¼Œå†å›åˆ°ä¸»é”®è¡¨ä¸­æŸ¥è¯¢çš„åŠ¨ä½œï¼Œå«åš<code>å›è¡¨æŸ¥è¯¢</code>ï¼›</p><p>è¯è™½æ˜¯è¿™ä¹ˆè¯´ï¼Œä½†ä¹Ÿå¹¶ä¸æ˜¯æ¯æ¬¡æŸ¥è¯¢æˆ‘ä»¬éƒ½éœ€è¦å›è¡¨çš„ã€‚æ¯”å¦‚ä¸‹å›¾æ˜¯ä¸€ä¸ªå¤åˆé”®çš„ç´¢å¼•è¡¨ï¼Œå‡è®¾æ•°å­—æ˜¯ç”¨æˆ·IDï¼ˆä¸»é”®ï¼‰ï¼Œæ–‡å­—æ˜¯ç”¨æˆ·å§“åï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬é€šè¿‡ç”¨æˆ·å§“åæŸ¥è¯¢ç”¨æˆ·IDçš„æ—¶å€™ï¼Œå°±ä¸éœ€è¦å›åˆ°ä¸»é”®è¡¨ä¹Ÿèƒ½è·å–åˆ°ç»“æœã€‚</p><p><img src="https://img.musnow.top/i/2023/09/6004dda4aa0dd67277e214f2fa4497db.png" alt="image-20230907144213435"></p><p>å¦å¤–ï¼Œåœ¨ä¸€èˆ¬çš„æ•°æ®åº“ä¸­ï¼ŒB+æ ‘å¹¶ä¸ä¼šå¾ˆæ·±ï¼Œæ‰€ä»¥å³ä¾¿éœ€è¦è¿›è¡Œå›è¡¨çš„ä¸¤æ¬¡æŸ¥è¯¢ï¼Œæ•ˆç‡ä¹Ÿä¸ä¼šå—åˆ°è¾ƒå¤§å½±å“ï¼›ï¼ˆä½†è‚¯å®šä¼šæœ‰ä¸€å®šæŸå¤±ï¼‰</p><h1 id="2-ç´¢å¼•æ“ä½œ"><a href="#2-ç´¢å¼•æ“ä½œ" class="headerlink" title="2.ç´¢å¼•æ“ä½œ"></a>2.ç´¢å¼•æ“ä½œ</h1><h2 id="2-1-åˆ›å»ºç´¢å¼•çš„åŸåˆ™"><a href="#2-1-åˆ›å»ºç´¢å¼•çš„åŸåˆ™" class="headerlink" title="2.1 åˆ›å»ºç´¢å¼•çš„åŸåˆ™"></a>2.1 åˆ›å»ºç´¢å¼•çš„åŸåˆ™</h2><ul><li>æ¯”è¾ƒé¢‘ç¹ä½œä¸ºæŸ¥è¯¢æ¡ä»¶çš„å­—æ®µåº”è¯¥åˆ›å»ºç´¢å¼•</li><li>å”¯ä¸€æ€§å¤ªå·®çš„å­—æ®µä¸é€‚åˆå•ç‹¬åˆ›å»ºç´¢å¼•ï¼Œå³ä½¿é¢‘ç¹ä½œä¸ºæŸ¥è¯¢æ¡ä»¶</li><li>æ›´æ–°éå¸¸é¢‘ç¹çš„å­—æ®µä¸é€‚åˆä½œåˆ›å»ºç´¢å¼•ï¼ˆå› ä¸ºæ¯æ¬¡æ›´æ–°éƒ½å¾—é‡ç½®ç´¢å¼•ï¼Œå¢åŠ IOå‹åŠ›ï¼‰</li><li>ä¸ä¼šå‡ºç°åœ¨whereå­å¥ä¸­çš„å­—æ®µä¸è¯¥åˆ›å»ºç´¢å¼•ï¼ˆä¸ä½œä¸ºæŸ¥è¯¢æ¡ä»¶çš„å­—æ®µï¼‰</li></ul><p>å¦å¤–ï¼Œå¦‚æœåœ¨åˆ›å»ºè¡¨çš„æ—¶å€™ä¹ˆæœ‰æŒ‡å®šä¸»é”®ï¼Œé‚£ä¹ˆMySQLä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªéšè—çš„è‡ªå¢ä¸»é”®IDï¼ˆä¸ç„¶å°±æ²¡åŠæ³•æ”¯æŒå…¶ä»–ç´¢å¼•å’Œå…¶æœ¬èº«çš„å¿«é€ŸæŸ¥æ‰¾äº†ï¼‰</p><h2 id="2-2-åˆ›å»ºä¸»é”®ç´¢å¼•"><a href="#2-2-åˆ›å»ºä¸»é”®ç´¢å¼•" class="headerlink" title="2.2 åˆ›å»ºä¸»é”®ç´¢å¼•"></a>2.2 åˆ›å»ºä¸»é”®ç´¢å¼•</h2><p>åˆ›å»ºè¡¨çš„æ—¶å€™æŒ‡å®š<code>primary key</code>ï¼Œé»˜è®¤å°±ä¼šåˆ›å»ºä¸»é”®ç´¢å¼•</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> user1( id <span class="type">int</span> unsigned <span class="keyword">primary</span> key, name <span class="type">varchar</span>(<span class="number">200</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> );</span><br></pre></td></tr></table></figure><p>åˆ›å»ºè¡¨çš„æœ€åï¼ŒæŒ‡å®šæŸåˆ—ä¸ºä¸»é”®ç´¢å¼•ï¼Œè¿™ä¸ªå’Œç¬¬ä¸€ç§æ–¹å¼æœ¬è´¨ä¸Šæ²¡åŒºåˆ«</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> user1( id <span class="type">int</span> unsigned , name <span class="type">varchar</span>(<span class="number">200</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>, <span class="keyword">primary</span> key(id) );</span><br></pre></td></tr></table></figure><p>åˆ›å»ºè¡¨äº†ä¹‹åå†æ·»åŠ ä¸»é”®</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- åˆ›å»ºè¡¨</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> user1( id <span class="type">int</span> unsigned , name <span class="type">varchar</span>(<span class="number">200</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>);</span><br><span class="line"><span class="comment">-- æ·»åŠ ä¸»é”®</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> user1 <span class="keyword">add</span> <span class="keyword">primary</span> key(id);</span><br></pre></td></tr></table></figure><p>ä¸»é”®ç´¢å¼•çš„ç‰¹ç‚¹ï¼š</p><ul><li>ä¸€ä¸ªè¡¨é‡Œé¢æœ¬æ¥å°±åªèƒ½æœ‰ä¸€ä¸ªä¸»é”®ï¼Œæ‰€ä»¥ä¸»é”®ç´¢å¼•ä¹Ÿåªæœ‰ä¸€ä¸ªï¼ˆå¤åˆä¸»é”®ä¹Ÿåªç®—ä¸€ä¸ªä¸»é”®ï¼‰</li><li>ä¸»é”®ç´¢å¼•çš„æ•ˆç‡é«˜ï¼ˆä¸»é”®åˆ—ä¸å¯é‡å¤ï¼‰</li><li>ä¸»é”®åˆ—ä¸èƒ½ä¸ºNULLï¼Œæ‰€ä»¥ä¹Ÿä¸å­˜åœ¨æ— æ³•è¢«ç´¢å¼•çš„å€¼</li><li>ä¸€èˆ¬éƒ½ä¼šç”¨æ•°å­—æ¥ä½œä¸ºä¸»é”®ï¼Œåœ¨ç´¢å¼•ä¸­æ–¹ä¾¿æ•°æ®æ¯”è¾ƒ</li></ul><h2 id="2-3-å”¯ä¸€é”®ç´¢å¼•"><a href="#2-3-å”¯ä¸€é”®ç´¢å¼•" class="headerlink" title="2.3 å”¯ä¸€é”®ç´¢å¼•"></a>2.3 å”¯ä¸€é”®ç´¢å¼•</h2><p>å½“ä½ ç»™æŸä¸€åˆ—è®¾ç½®ä¸ºå”¯ä¸€é”®çš„æ—¶å€™ï¼ŒMySQLå°±ä¼šè‡ªåŠ¨åˆ›å»ºå”¯ä¸€é”®ç´¢å¼•ï¼›å”¯ä¸€é”®ç´¢å¼•å…¶å®å°±æ˜¯æ™®é€šçš„è¾…åŠ©ç´¢å¼•ï¼Œåªä¸è¿‡å…¶å’Œä¸»é”®ä¸€æ ·éƒ½åŒ…å«å”¯ä¸€çš„é”®å€¼çº¦æŸï¼›</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- ç›´æ¥æŒ‡å®šå”¯ä¸€é”®</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> user2(id <span class="type">int</span> <span class="keyword">primary</span> key, name <span class="type">varchar</span>(<span class="number">200</span>) <span class="keyword">unique</span>);</span><br><span class="line"><span class="comment">-- åˆ›å»ºè¯­å¥æœ«å°¾æŒ‡å®šå”¯ä¸€é”®</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> user2(id <span class="type">int</span> <span class="keyword">primary</span> key, name <span class="type">varchar</span>(<span class="number">200</span>),<span class="keyword">unique</span>(name));</span><br><span class="line"><span class="comment">-- åˆ›å»ºåå†æ·»åŠ å”¯ä¸€é”®</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> user2(id <span class="type">int</span> <span class="keyword">primary</span> key, name <span class="type">varchar</span>(<span class="number">200</span>));</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> user2 <span class="keyword">add</span> <span class="keyword">unique</span>(name);</span><br></pre></td></tr></table></figure><p>å”¯ä¸€ç´¢å¼•çš„ç‰¹ç‚¹ï¼š</p><ul><li>ä¸€ä¸ªè¡¨ä¸­ï¼Œå¯ä»¥æœ‰å¤šä¸ªå”¯ä¸€ç´¢å¼•ï¼ŒåŒ…æ‹¬å¤åˆå”¯ä¸€é”®çš„ç´¢å¼•ï¼›</li><li>æŸ¥è¯¢æ•ˆç‡é«˜ï¼›</li><li>å¦‚æœåœ¨æŸä¸€åˆ—å»ºç«‹å”¯ä¸€ç´¢å¼•ï¼Œå¿…é¡»ä¿è¯è¿™åˆ—ä¸èƒ½æœ‰é‡å¤æ•°æ®ï¼›</li><li>å¦‚æœä¸€ä¸ªå”¯ä¸€ç´¢å¼•ä¸ŠæŒ‡å®š<code>not null</code>ï¼Œç­‰ä»·äºä¸»é”®ç´¢å¼•ï¼›</li><li>å¦‚æœåˆ é™¤å”¯ä¸€é”®ç´¢å¼•ï¼Œä¹Ÿä¼šåŒæ—¶åˆ é™¤å”¯ä¸€çš„çº¦æŸå±æ€§ï¼›</li></ul><h2 id="2-4-æ™®é€šé”®ç´¢å¼•"><a href="#2-4-æ™®é€šé”®ç´¢å¼•" class="headerlink" title="2.4 æ™®é€šé”®ç´¢å¼•"></a>2.4 æ™®é€šé”®ç´¢å¼•</h2><p>åˆ›å»ºæ™®é€šç´¢å¼•ä¾æ—§æœ‰3ç§æ–¹å¼</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- åœ¨è¡¨çš„å®šä¹‰æœ€åï¼ŒæŒ‡å®šæŸåˆ—ä¸ºç´¢å¼•</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> user3(id <span class="type">int</span> <span class="keyword">primary</span> key,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">20</span>),</span><br><span class="line">    email <span class="type">varchar</span>(<span class="number">30</span>),</span><br><span class="line">    index(name)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- åˆ›å»ºå®Œè¡¨ä»¥åæŒ‡å®šæŸåˆ—ä¸ºæ™®é€šç´¢å¼•</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> user3(id <span class="type">int</span> <span class="keyword">primary</span> key, name <span class="type">varchar</span>(<span class="number">20</span>), email</span><br><span class="line"><span class="type">varchar</span>(<span class="number">30</span>));</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> user3 <span class="keyword">add</span> index(name);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- åˆ›å»ºç´¢å¼•çš„æ—¶å€™æŒ‡å®šåå­—</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> user3(id <span class="type">int</span> <span class="keyword">primary</span> key, name <span class="type">varchar</span>(<span class="number">20</span>), email</span><br><span class="line"><span class="type">varchar</span>(<span class="number">30</span>));</span><br><span class="line"><span class="keyword">create</span> index idx_name <span class="keyword">on</span> user3(name); <span class="comment">-- åˆ›å»ºä¸€ä¸ªç´¢å¼•åä¸º idx_name çš„ç´¢å¼•</span></span><br></pre></td></tr></table></figure><p>æ™®é€šç´¢å¼•çš„ç‰¹ç‚¹ï¼š</p><ul><li>ä¸€ä¸ªè¡¨ä¸­å¯ä»¥æœ‰å¤šä¸ªæ™®é€šç´¢å¼•</li><li>æ™®é€šç´¢å¼•ä¸­çš„é”®å€¼å¯ä»¥é‡å¤ï¼Œä½†ä¸è¦åœ¨å¤§é‡é‡å¤çš„é”®å€¼ä¸Šå»ºç«‹ç´¢å¼•ï¼ˆæ¯”å¦‚æ€§åˆ«ï¼‰</li></ul><h2 id="2-5-å¤åˆ-x2F-è”åˆç´¢å¼•"><a href="#2-5-å¤åˆ-x2F-è”åˆç´¢å¼•" class="headerlink" title="2.5 å¤åˆ&#x2F;è”åˆç´¢å¼•"></a>2.5 å¤åˆ&#x2F;è”åˆç´¢å¼•</h2><p>ç»™å¤šä¸ªé”®å€¼åˆ›å»ºç´¢å¼•ï¼Œæ“ä½œå¦‚ä¸‹</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> index ç´¢å¼•åå­— <span class="keyword">on</span> è¡¨å(å­—æ®µ<span class="number">1</span>,å­—æ®µ<span class="number">2</span>);</span><br><span class="line"><span class="comment">-- å¦‚æœéœ€è¦ç´¢å¼•æŒ‰ä¸åŒçš„è§„åˆ™æ’åºï¼Œå¯ä»¥åœ¨å­—æ®µååŠ DESCå’ŒASC</span></span><br><span class="line"><span class="keyword">create</span> index ç´¢å¼•åå­— <span class="keyword">on</span> è¡¨å(å­—æ®µ<span class="number">1</span> <span class="keyword">DESC</span>,å­—æ®µ<span class="number">2</span> <span class="keyword">ASC</span>);</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶æˆ‘ä»¬åˆ›å»ºçš„ç´¢å¼•ï¼Œåœ¨å­—æ®µ1å’Œå­—æ®µ2ä¸Šä¼šå…±ç”¨ä¸€ä¸ªç´¢å¼•çš„<code>Key_name</code>ï¼Œç´¢å¼•åå­—æ˜¯ç›¸åŒçš„ã€‚</p><p>å¤åˆç´¢å¼•æœ‰ä¸€ä¸ªå¥½å¤„ï¼Œå¦‚æœä½¿ç”¨InnoDBæ—¶ï¼Œ<strong>éœ€è¦æŸ¥è¯¢çš„ç»“æœåŒ…å«åœ¨ç´¢å¼•å­—æ®µä¸­</strong>ï¼Œé‚£å°±å¯ä»¥èŠ‚çœä¸€æ¬¡è¿”è¿˜åˆ°ä¸»é”®ç´¢å¼•ä¸­æŸ¥è¯¢çš„å›è¡¨æ­¥éª¤ï¼Œå¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šæé«˜æ•ˆç‡ï¼ˆåœ¨ä¸Šæ–‡ä¸­å·²ç»æåŠæ­¤äº‹ï¼‰</p><ul><li>ä¸Šé¢è¿™ç§æ“ä½œå«åš<strong>ç´¢å¼•è¦†ç›–</strong>ï¼ˆè¦†ç›–ç´¢å¼•ï¼‰ï¼Œç›´æ¥ä»æ™®é€šç´¢å¼•è¡¨ä¸­æŸ¥è¯¢åˆ°ç»“æœï¼›</li><li>å»ºç«‹å¤åˆç´¢å¼•ç›¸æ¯”äºå»ºç«‹å¤šä¸ªå•åˆ—ç´¢å¼•ï¼Œè¿˜èƒ½åœ¨ä¸€å®šç¨‹åº¦ä¸Šå‡å°‘ç©ºé—´æ¶ˆè€—ï¼Œæé«˜æ•ˆç‡ï¼›</li></ul><p>å¦å¤–ï¼Œåœ¨è¿›è¡Œå¤åˆç´¢å¼•çš„æŸ¥è¯¢çš„æ—¶å€™ï¼Œ<strong>æˆ‘ä»¬åªèƒ½ä½¿ç”¨ç”¨æˆ·åæ¥æŸ¥è¯¢ç”¨æˆ·ID</strong>ï¼Œè¿”è¿‡æ¥æ˜¯ä¸è¡Œçš„ï¼ˆä¸ä¼šä½¿ç”¨ç´¢å¼•ï¼‰ã€‚å› ä¸ºåœ¨MySQLå¯¹ç´¢å¼•è¿›è¡ŒåŒ¹é…çš„æ—¶å€™ï¼Œåªä¼šåŒ¹é…æœ€å·¦ä¾§çš„ç´¢å¼•å€¼ï¼›</p><p>æ¯”å¦‚ä¸‹å›¾ä¸­ï¼Œå……å½“åˆ¤æ–­æ¡ä»¶çš„æ˜¯ç”¨æˆ·åå­—ï¼Œé€šè¿‡ç”¨æˆ·åå­—æŸ¥ç”¨æˆ·IDæ˜¯OKçš„ï¼Œåè¿‡æ¥å°±ä¸è¡Œï¼›è¿™ç§æƒ…å†µä¸‹MySQLä¸ä¼šä½¿ç”¨ç´¢å¼•ï¼Œä¾æ—§æ˜¯å…¨è¡¨éå†ï¼›</p><p><img src="https://img.musnow.top/i/2023/09/6004dda4aa0dd67277e214f2fa4497db.png" alt="image-20230907144213435"></p><p>è¿™ç§å«åšMySQLç´¢å¼•çš„<strong>æœ€å·¦åŒ¹é…åŸåˆ™</strong></p><blockquote><p>è¯¦è§£ï¼š<a href="https://blog.csdn.net/weixin_47162914/article/details/123793589">è”åˆç´¢å¼•-æœ€å·¦åŒ¹é…åŸåˆ™</a></p></blockquote><p>MySQLåœ¨åˆ›å»ºå¤åˆç´¢å¼•çš„æ—¶å€™ï¼Œé¦–å…ˆä¼š<strong>å¯¹æœ€å·¦è¾¹å­—æ®µæ’åº</strong>ï¼Œä¹Ÿå°±æ˜¯ç¬¬ä¸€ä¸ªå­—æ®µï¼Œç„¶åå†åœ¨ä¿è¯ç¬¬ä¸€ä¸ªå­—æ®µæœ‰åºçš„æƒ…å†µä¸‹ï¼Œå†æ’åºç¬¬äºŒä¸ªå­—æ®µï¼Œä»¥æ­¤ç±»æ¨ã€‚æ‰€ä»¥è”åˆç´¢å¼•æœ€å·¦åˆ—æ˜¯ç»å¯¹æœ‰åºçš„ï¼Œå…¶ä»–å­—æ®µæ— åºã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼šå¯ä»¥æŠŠè”åˆç´¢å¼•çœ‹æˆâ€œç”µè¯ç°¿â€ï¼Œå§“åä½œä¸ºè”åˆç´¢å¼•ï¼Œå§“æ˜¯ç¬¬ä¸€åˆ—ï¼Œåæ˜¯ç¬¬äºŒåˆ—ï¼Œå½“æŸ¥æ‰¾äººåæ—¶ï¼Œæ˜¯å…ˆç¡®å®šè¿™ä¸ªäººå§“å†æ ¹æ®åç¡®å®šäººã€‚åªæœ‰åæ²¡æœ‰å§“å°±æŸ¥ä¸åˆ°ã€‚</p><h2 id="2-6-å…¨æ–‡ç´¢å¼•"><a href="#2-6-å…¨æ–‡ç´¢å¼•" class="headerlink" title="2.6 å…¨æ–‡ç´¢å¼•"></a>2.6 å…¨æ–‡ç´¢å¼•</h2><p>å¦‚æœå¯¹æ–‡ç« æˆ–è€…å¤§é‡æ–‡å­—çš„å­—æ®µè¿›è¡Œæ£€ç´¢çš„æ—¶å€™ï¼Œå°±ä¼šä½¿ç”¨åˆ°å…¨æ–‡ç´¢å¼•ã€‚MySQLæä¾›å…¨æ–‡ç´¢å¼•æœºåˆ¶ï¼Œä½†æ˜¯è¦æ±‚è¡¨çš„å­˜å‚¨å¼•æ“å¿…é¡»æ˜¯<code>MyISAM</code>ï¼›è€Œä¸”é»˜è®¤çš„å…¨æ–‡ç´¢å¼•åªæ”¯æŒè‹±æ–‡ï¼Œä¸æ”¯æŒä¸­æ–‡ã€‚å¦‚æœå¯¹ä¸­æ–‡è¿›è¡Œå…¨æ–‡æ£€ç´¢ï¼Œå¯ä»¥ä½¿ç”¨sphinxçš„ä¸­æ–‡ç‰ˆ(coreseek)ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- åˆ›å»ºè¡¨ï¼ŒFULLTEXTè®¾ç½®å…¨æ–‡ç´¢å¼•</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> articles (</span><br><span class="line">    id <span class="type">INT</span> UNSIGNED AUTO_INCREMENT <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    title <span class="type">VARCHAR</span>(<span class="number">200</span>),</span><br><span class="line">    body TEXT,</span><br><span class="line">    FULLTEXT (title,body) </span><br><span class="line">)engine<span class="operator">=</span>MyISAM;</span><br><span class="line"><span class="comment">-- æ’å…¥æµ‹è¯•æ•°æ®</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> articles (title,body) <span class="keyword">VALUES</span></span><br><span class="line">    (<span class="string">&#x27;MySQL Tutorial&#x27;</span>,<span class="string">&#x27;DBMS stands for DataBase ...&#x27;</span>),</span><br><span class="line">    (<span class="string">&#x27;How To Use MySQL Well&#x27;</span>,<span class="string">&#x27;After you went through a ...&#x27;</span>),</span><br><span class="line">    (<span class="string">&#x27;Optimizing MySQL&#x27;</span>,<span class="string">&#x27;In this tutorial we will show ...&#x27;</span>),</span><br><span class="line">    (<span class="string">&#x27;1001 MySQL Tricks&#x27;</span>,<span class="string">&#x27;1. Never run mysqld as root. 2. ...&#x27;</span>),</span><br><span class="line">    (<span class="string">&#x27;MySQL vs. YourSQL&#x27;</span>,<span class="string">&#x27;In the following database comparison ...&#x27;</span>),</span><br><span class="line">    (<span class="string">&#x27;MySQL Security&#x27;</span>,<span class="string">&#x27;When configured properly, MySQL ...&#x27;</span>);</span><br></pre></td></tr></table></figure><p>åˆ›å»ºå¥½è¡¨ä¹‹åï¼ŒæŸ¥è¯¢è¡¨ä¸­ç´¢å¼•ä¿¡æ¯ï¼Œå¯ä»¥çœ‹åˆ°titleå’Œbodyå­—æ®µéƒ½ç”¨ä¸Šäº†ç´¢å¼•åå­—ä¸º<code>title</code>çš„å…¨æ–‡ç´¢å¼•</p><p><img src="https://img.musnow.top/i/2023/09/f0c396d35a81e6ab863f7bec84174f48.png" alt="image-20230907155913783"></p><p>å‡è®¾æˆ‘ä»¬æŸ¥è¯¢è¿™ä¸ªè¡¨ä¸­æœ‰æ²¡æœ‰åŒ…å«databaseçš„æ–‡å­—æ•°æ®ï¼Œè™½ç„¶æˆåŠŸæŸ¥è¯¢äº†ç»“æœï¼Œä½†æ˜¯å¹¶æ²¡æœ‰ä½¿ç”¨åˆ°å…¨æ–‡ç´¢å¼•</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> articles <span class="keyword">where</span> body <span class="keyword">like</span> <span class="string">&#x27;%database%&#x27;</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------------------+------------------------------------------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> title             <span class="operator">|</span> body                                     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------------------+------------------------------------------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> MySQL Tutorial    <span class="operator">|</span> DBMS stands <span class="keyword">for</span> DataBase ...             <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">5</span> <span class="operator">|</span> MySQL vs. YourSQL <span class="operator">|</span> <span class="keyword">In</span> the following database comparison ... <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------------------+------------------------------------------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.000</span> sec)</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨explainè¯­å¥å¯ä»¥çœ‹å‡ºæ˜¯å¦æœ‰ä½¿ç”¨å…¨æ–‡ç´¢å¼•ï¼Œè¿™é‡Œçš„keyä¸ºNULLå°±ä»£è¡¨ä¹ˆæœ‰ä½¿ç”¨ä¸Šç´¢å¼•ï¼›è¿™ä¸ªå·¥å…·çš„ä½œç”¨æ˜¯<strong>é¢„æ‰§è¡Œ</strong>ï¼Œå¹¶ä¸ä¼šå®é™…ä¸Šè¿è¡Œè¿™ä¸ªè¯­å¥ï¼Œä½†æ˜¯ä¼šå‘Šè¯‰ä½ æˆ‘æƒ³<strong>æ€ä¹ˆè¿è¡Œå®ƒ</strong>ï¼›</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">explain select * from articles where body like &#x27;%database%&#x27;\G</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">           id: 1</span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        table: articles</span><br><span class="line">         type: ALL</span><br><span class="line">possible_keys: NULL</span><br><span class="line">          key: NULL</span><br><span class="line">      key_len: NULL</span><br><span class="line">          ref: NULL</span><br><span class="line">         rows: 6</span><br><span class="line">        Extra: Using where</span><br><span class="line">1 row in set (0.000 sec)</span><br></pre></td></tr></table></figure><p>è¦æƒ³ä½¿ç”¨å…¨æ–‡ç´¢å¼•ï¼Œå¾—è¿™ä¹ˆå†™</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> articles <span class="keyword">WHERE</span> <span class="keyword">MATCH</span> (title,body) AGAINST (<span class="string">&#x27;database&#x27;</span>);</span><br></pre></td></tr></table></figure><p>å†ç”¨explainå·¥å…·çœ‹çœ‹ï¼Œæ­¤æ—¶å°±å¯ä»¥çœ‹åˆ°keyé‡Œé¢æ˜¾ç¤ºçš„æ˜¯titleï¼ŒæˆåŠŸä½¿ç”¨ä¸Šäº†å…¨æ–‡ç´¢å¼•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">explain SELECT * FROM articles WHERE MATCH (title,body) AGAINST</span><br><span class="line">    -&gt; (&#x27;database&#x27;)\G</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">           id: 1</span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        table: articles</span><br><span class="line">         type: fulltext</span><br><span class="line">possible_keys: title</span><br><span class="line">          key: title</span><br><span class="line">      key_len: 0</span><br><span class="line">          ref: </span><br><span class="line">         rows: 1</span><br><span class="line">        Extra: Using where</span><br><span class="line">1 row in set (0.000 sec)</span><br></pre></td></tr></table></figure><h3 id="explainå·¥å…·"><a href="#explainå·¥å…·" class="headerlink" title="explainå·¥å…·"></a>explainå·¥å…·</h3><p>è¿™é‡Œå¯¹explainå·¥å…·æ˜¾ç¤ºçš„åˆ—ä½œä¸€ä¸ªè¯´æ˜ã€‚è¿™ä¸ªå·¥å…·çš„ä½œç”¨æ˜¯<strong>é¢„æ‰§è¡Œ</strong>ï¼Œå¹¶ä¸ä¼šå®é™…ä¸Šè¿è¡Œè¿™ä¸ªè¯­å¥ï¼Œä½†æ˜¯ä¼šå‘Šè¯‰ä½ æˆ‘æƒ³<strong>æ€ä¹ˆè¿è¡Œå®ƒ</strong>ï¼›è¾“å‡ºç»“æœåŒ…å«å¦‚ä¸‹åˆ—ï¼š</p><ul><li>id â€” é€‰æ‹©æ ‡è¯†ç¬¦ï¼Œid è¶Šå¤§ä¼˜å…ˆçº§è¶Šé«˜ï¼Œè¶Šå…ˆè¢«æ‰§è¡Œï¼›</li><li>select_type â€” è¡¨ç¤ºæŸ¥è¯¢çš„ç±»å‹ï¼›</li><li>table â€” è¾“å‡ºç»“æœé›†çš„è¡¨ï¼›</li><li>partitions â€” åŒ¹é…çš„åˆ†åŒºï¼›</li><li>type â€” è¡¨ç¤ºè¡¨çš„è¿æ¥ç±»å‹ï¼›</li><li>possible_keys â€” è¡¨ç¤ºæŸ¥è¯¢æ—¶ï¼Œå¯èƒ½ä½¿ç”¨çš„ç´¢å¼•ï¼›</li><li><strong>key â€” è¡¨ç¤ºå®é™…ä½¿ç”¨çš„ç´¢å¼•ï¼›</strong></li><li>key_len â€” ç´¢å¼•å­—æ®µçš„é•¿åº¦ï¼›</li><li>refâ€”  åˆ—ä¸ç´¢å¼•çš„æ¯”è¾ƒï¼›</li><li>rows â€” å¤§æ¦‚ä¼°ç®—çš„è¡Œæ•°ï¼›</li><li>filtered â€” æŒ‰è¡¨æ¡ä»¶è¿‡æ»¤çš„è¡Œç™¾åˆ†æ¯”ï¼›</li><li>Extra â€” æ‰§è¡Œæƒ…å†µçš„æè¿°å’Œè¯´æ˜ã€‚</li></ul><h2 id="2-7-æŸ¥è¯¢-x2F-åˆ é™¤ç´¢å¼•"><a href="#2-7-æŸ¥è¯¢-x2F-åˆ é™¤ç´¢å¼•" class="headerlink" title="2.7 æŸ¥è¯¢&#x2F;åˆ é™¤ç´¢å¼•"></a>2.7 æŸ¥è¯¢&#x2F;åˆ é™¤ç´¢å¼•</h2><p>å¦‚æœéœ€è¦åˆ é™¤ä¸»é”®ç´¢å¼•ï¼Œç›´æ¥æŠŠä¸»é”®åˆ äº†å°±è¡Œäº†</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> è¡¨å <span class="keyword">drop</span> <span class="keyword">primary</span> key;</span><br></pre></td></tr></table></figure><p>åˆ é™¤æ™®é€šç´¢å¼•è¯­å¥å¦‚ä¸‹</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> è¡¨å <span class="keyword">drop</span> index ç´¢å¼•åå­—;</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼Œç´¢å¼•çš„åå­—ä¸ä¸€å®šå’Œå­—æ®µåç›¸åŒï¼ˆåœ¨åˆ›å»ºç´¢å¼•çš„æ—¶å€™å¯ä»¥æŒ‡å®šç´¢å¼•åå­—ï¼‰ï¼Œéœ€è¦ä½¿ç”¨å¦‚ä¸‹è¯­å¥æŸ¥çœ‹</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> keys <span class="keyword">from</span> è¡¨å;</span><br></pre></td></tr></table></figure><p>æ¯”å¦‚user2è¡¨ä¸­åŒ…å«idä¸»é”®ç´¢å¼•å’Œnameçš„ä¸»é”®ç´¢å¼•ï¼Œå…¶ç»“æœæŸ¥è¯¢å¦‚ä¸‹ï¼›å…¶ä¸­çš„<code>Key_name</code>æ‰æ˜¯ç´¢å¼•çš„åå­—ï¼Œä¸ä¸€å®šå’Œå­—æ®µåç›¸åŒï¼åˆ é™¤ç´¢å¼•çš„æ—¶å€™éœ€è¦ä½¿ç”¨ç´¢å¼•åå­—ï¼</p><p><img src="https://img.musnow.top/i/2023/09/e01d3842d22be7c1f41568ef3802d1e0.png" alt="image-20230907153259042"></p><p>è¿˜å¯ä»¥ç”¨å¦‚ä¸‹è¯­å¥æ¥æ›´åŠ æ¸…æ¥šçš„çœ‹åˆ°æ¯ä¸ªç´¢å¼•çš„ç›¸å…³å±æ€§</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> index <span class="keyword">from</span> è¡¨å\G;</span><br></pre></td></tr></table></figure><p>æˆ‘ç»™user2è¡¨æ·»åŠ ä¸€ä¸ªé”®å€¼ï¼Œå¹¶è®¾ç½®æ™®é€šç´¢å¼•</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> user2 <span class="keyword">add</span> qq <span class="type">varchar</span>(<span class="number">40</span>); <span class="comment">-- æ·»åŠ ä¸€ä¸ªé”®å€¼</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> user2 <span class="keyword">add</span> index(qq); <span class="comment">-- æ·»åŠ æ™®é€šç´¢å¼•</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨<code>show index from è¡¨å\G;</code>è¯­å¥æŸ¥çœ‹user2è¡¨çš„ç´¢å¼•å±æ€§ï¼›åœ¨è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œå”¯ä¸€é”®ç´¢å¼•çš„å±æ€§å’Œæ™®é€šç´¢å¼•æ˜¯å®Œå…¨ç›¸åŒçš„ï¼Œ<strong>æ‰€ä»¥æ‰è¯´å”¯ä¸€é”®çš„ç´¢å¼•æœ¬è´¨ä¸Šè¿˜æ˜¯æ™®é€šç´¢å¼•</strong>ã€‚</p><p>è¿™é‡Œè¿˜å†™æ˜äº†ç´¢å¼•çš„ç±»å‹æ˜¯BTREEï¼Œå…¶å°±æ˜¯B+æ ‘ï¼›</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; desc user2;</span><br><span class="line">+-------+------------------+------+-----+---------+-------+</span><br><span class="line">| Field | Type             | Null | Key | Default | Extra |</span><br><span class="line">+-------+------------------+------+-----+---------+-------+</span><br><span class="line">| id    | int(10) unsigned | NO   | PRI | NULL    |       |</span><br><span class="line">| name  | varchar(200)     | NO   | UNI | NULL    |       |</span><br><span class="line">| qq    | varchar(40)      | YES  | MUL | NULL    |       |</span><br><span class="line">+-------+------------------+------+-----+---------+-------+</span><br><span class="line">3 rows in set (0.001 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [hello_mysql]&gt; show index from user2\G;</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">        Table: user2</span><br><span class="line">   Non_unique: 0</span><br><span class="line">     Key_name: PRIMARY</span><br><span class="line"> Seq_in_index: 1</span><br><span class="line">  Column_name: id</span><br><span class="line">    Collation: A</span><br><span class="line">  Cardinality: 0</span><br><span class="line">     Sub_part: NULL</span><br><span class="line">       Packed: NULL</span><br><span class="line">         Null: </span><br><span class="line">   Index_type: BTREE</span><br><span class="line">      Comment: </span><br><span class="line">Index_comment: </span><br><span class="line">*************************** 2. row ***************************</span><br><span class="line">        Table: user2</span><br><span class="line">   Non_unique: 0</span><br><span class="line">     Key_name: name</span><br><span class="line"> Seq_in_index: 1</span><br><span class="line">  Column_name: name</span><br><span class="line">    Collation: A</span><br><span class="line">  Cardinality: 0</span><br><span class="line">     Sub_part: NULL</span><br><span class="line">       Packed: NULL</span><br><span class="line">         Null: </span><br><span class="line">   Index_type: BTREE</span><br><span class="line">      Comment: </span><br><span class="line">Index_comment: </span><br><span class="line">*************************** 3. row ***************************</span><br><span class="line">        Table: user2</span><br><span class="line">   Non_unique: 1</span><br><span class="line">     Key_name: qq</span><br><span class="line"> Seq_in_index: 1</span><br><span class="line">  Column_name: qq</span><br><span class="line">    Collation: A</span><br><span class="line">  Cardinality: NULL</span><br><span class="line">     Sub_part: NULL</span><br><span class="line">       Packed: NULL</span><br><span class="line">         Null: YES</span><br><span class="line">   Index_type: BTREE</span><br><span class="line">      Comment: </span><br><span class="line">Index_comment: </span><br><span class="line">3 rows in set (0.000 sec)</span><br><span class="line"></span><br><span class="line">ERROR: No query specified</span><br></pre></td></tr></table></figure><h2 id="2-8-ä»€ä¹ˆæ—¶å€™ç´¢å¼•ä¼šå¤±æ•ˆï¼Ÿ"><a href="#2-8-ä»€ä¹ˆæ—¶å€™ç´¢å¼•ä¼šå¤±æ•ˆï¼Ÿ" class="headerlink" title="2.8 ä»€ä¹ˆæ—¶å€™ç´¢å¼•ä¼šå¤±æ•ˆï¼Ÿ"></a>2.8 ä»€ä¹ˆæ—¶å€™ç´¢å¼•ä¼šå¤±æ•ˆï¼Ÿ</h2><blockquote><p><a href="https://cloud.tencent.com/developer/article/2035778">https://cloud.tencent.com/developer/article/2035778</a></p><p><a href="https://zhuanlan.zhihu.com/p/361172794">https://zhuanlan.zhihu.com/p/361172794</a></p></blockquote><h3 id="2-8-1-å¦‚æœæ¡ä»¶ä¸­æœ‰or-x2F-and"><a href="#2-8-1-å¦‚æœæ¡ä»¶ä¸­æœ‰or-x2F-and" class="headerlink" title="2.8.1 å¦‚æœæ¡ä»¶ä¸­æœ‰or&#x2F;and"></a>2.8.1 å¦‚æœæ¡ä»¶ä¸­æœ‰or&#x2F;and</h3><p>å¦‚æœæ¡ä»¶ä¸­æœ‰or&#x2F;andï¼Œå³ä½¿å…¶ä¸­<strong>æœ‰éƒ¨åˆ†æ¡ä»¶å¸¦ç´¢å¼•</strong>ä¹Ÿä¸ä¼šä½¿ç”¨ï¼›</p><p>å…ˆè¯´ç»“è®ºï¼šå¦‚æœåœ¨ä½¿ç”¨andå’Œorè¿›è¡ŒæŸ¥è¯¢çš„æ—¶å€™ï¼Œåªæœ‰ä¸¤åˆ—éƒ½åŒ…å«äº†ç´¢å¼•æ‰ä¼šä½¿ç”¨ï¼›</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- åˆ›å»ºç¤ºä¾‹è¡¨ï¼Œå…¶ä¸­idæ˜¯ä¸»é”®ï¼Œuser_idæ²¡æœ‰åˆ›å»ºç´¢å¼•</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> user3(</span><br><span class="line">id <span class="type">int</span> unsigned <span class="keyword">primary</span> key,</span><br><span class="line">user_id <span class="type">int</span> unsigned <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">30</span>) <span class="keyword">not</span> <span class="keyword">null</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">-- æ’å…¥ç¤ºä¾‹æ•°æ®</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> user3 <span class="keyword">values</span> </span><br><span class="line">(<span class="number">1</span>,<span class="number">10</span>,<span class="string">&#x27;ç”²&#x27;</span>),(<span class="number">2</span>,<span class="number">20</span>,<span class="string">&#x27;ä¸™&#x27;</span>),(<span class="number">3</span>,<span class="number">30</span>,<span class="string">&#x27;ä¹™&#x27;</span>),(<span class="number">4</span>,<span class="number">40</span>,<span class="string">&#x27;ä¸&#x27;</span>),</span><br><span class="line">(<span class="number">5</span>,<span class="number">50</span>,<span class="string">&#x27;å°¼æ–¯&#x27;</span>),(<span class="number">6</span>,<span class="number">23</span>,<span class="string">&#x27;ä¼é¹…&#x27;</span>),(<span class="number">7</span>,<span class="number">14</span>,<span class="string">&#x27;å€ªæµ©&#x27;</span>),(<span class="number">9</span>,<span class="number">21</span>,<span class="string">&#x27;test&#x27;</span>);</span><br></pre></td></tr></table></figure><p>è¿™æ—¶å€™å¦‚æœç”¨å¦‚ä¸‹è¯­å¥è¿›è¡ŒæŸ¥è¯¢ï¼Œé‚£å°±ä¸ä¼šä½¿ç”¨ç´¢å¼•</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> user3 <span class="keyword">where</span> id<span class="operator">=</span><span class="number">3</span> <span class="keyword">or</span> user_id<span class="operator">=</span><span class="number">40</span>;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨<code>explain</code>å‘½ä»¤æ¥æŸ¥çœ‹è¿è¡Œè¿‡ç¨‹ï¼Œå¯ä»¥çœ‹åˆ°keyä¸€åˆ—ä¸ºç©ºï¼Œä»£è¡¨æ²¡æœ‰ä½¿ç”¨ç´¢å¼•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; explain select * from user3 where id=3 or user_id=40\G;</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">           id: 1</span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        table: user3</span><br><span class="line">         type: ALL</span><br><span class="line">possible_keys: PRIMARY</span><br><span class="line">          key: NULL</span><br><span class="line">      key_len: NULL</span><br><span class="line">          ref: NULL</span><br><span class="line">         rows: 4</span><br><span class="line">        Extra: Using where</span><br><span class="line">1 row in set (0.000 sec)</span><br><span class="line"></span><br><span class="line">ERROR: No query specified</span><br><span class="line"></span><br><span class="line">MariaDB [hello_mysql]&gt; explain select * from user3 where id=2 and user_id=30\G;</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">           id: 1</span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        table: NULL</span><br><span class="line">         type: NULL</span><br><span class="line">possible_keys: NULL</span><br><span class="line">          key: NULL</span><br><span class="line">      key_len: NULL</span><br><span class="line">          ref: NULL</span><br><span class="line">         rows: NULL</span><br><span class="line">        Extra: Impossible WHERE noticed after reading const tables</span><br><span class="line">1 row in set (0.001 sec)</span><br><span class="line"></span><br><span class="line">ERROR: No query specified</span><br></pre></td></tr></table></figure><p>ç›´æ¥æŸ¥è¯¢idï¼Œæœ‰ä½¿ç”¨ç´¢å¼•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; explain select * from user3 where id=2\G;</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">           id: 1</span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        table: user3</span><br><span class="line">         type: const</span><br><span class="line">possible_keys: PRIMARY</span><br><span class="line">          key: PRIMARY</span><br><span class="line">      key_len: 4</span><br><span class="line">          ref: const</span><br><span class="line">         rows: 1</span><br><span class="line">        Extra: </span><br><span class="line">1 row in set (0.000 sec)</span><br><span class="line"></span><br><span class="line">ERROR: No query specified</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶å¦‚æœç»™<code>user_id</code>åˆ—åŠ ä¸Šç´¢å¼•åé‡æ–°æ“ä½œï¼Œé‚£ç»“æœå°±ä¸ä¸€æ ·äº†</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> user3 <span class="keyword">add</span> <span class="keyword">unique</span>(user_id); <span class="comment">-- å”¯ä¸€é”®ç´¢å¼•</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œæœ‰ä½¿ç”¨ç´¢å¼•ï¼ˆåœ¨æˆ‘çš„æµ‹è¯•ä¸­ï¼Œå¹¶ä¸æ˜¯æ¯æ¬¡éƒ½ä¼šä½¿ç”¨ç´¢å¼•ï¼Œè¿™å¤§æ¦‚æ˜¯å› ä¸ºæˆ‘çš„å†…å®¹åˆ—å¤ªå°‘äº†ï¼Œä¸å¦‚ç›´æ¥éå†ï¼Ÿï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; explain select * from user3 where id=2 and user_id=20\G;</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">           id: 1</span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        table: user3</span><br><span class="line">         type: const</span><br><span class="line">possible_keys: PRIMARY,user_id</span><br><span class="line">          key: PRIMARY</span><br><span class="line">      key_len: 4</span><br><span class="line">          ref: const</span><br><span class="line">         rows: 1</span><br><span class="line">        Extra: </span><br><span class="line">1 row in set (0.000 sec)</span><br><span class="line"></span><br><span class="line">ERROR: No query specified</span><br></pre></td></tr></table></figure><h3 id="2-8-2-å¤åˆç´¢å¼•æ²¡æœ‰ä½¿ç”¨æœ€å·¦åˆ—"><a href="#2-8-2-å¤åˆç´¢å¼•æ²¡æœ‰ä½¿ç”¨æœ€å·¦åˆ—" class="headerlink" title="2.8.2 å¤åˆç´¢å¼•æ²¡æœ‰ä½¿ç”¨æœ€å·¦åˆ—"></a>2.8.2 å¤åˆç´¢å¼•æ²¡æœ‰ä½¿ç”¨æœ€å·¦åˆ—</h3><p>ä½¿ç”¨sn + name + ageåˆ›å»ºå¤åˆç´¢å¼•ï¼Œæˆ‘ä»¬å‡è®¾å®ƒä»¬çš„é¡ºåºæ˜¯ A + B + Cï¼Œä»¥ä¸‹è”åˆç´¢å¼•çš„ä½¿ç”¨æƒ…å†µå¦‚ä¸‹ï¼š</p><p><img src="https://img.musnow.top/i/2023/09/d5285b42e3341a5dda532dfdaf6fc7dc.png" alt="image"></p><p>ä»ç»“æœå¯ä»¥çœ‹å‡ºï¼Œåªæœ‰A+B+Cæˆ–è€…A+B&#x2F;A+Cæ‰èƒ½è§¦å‘ç´¢å¼•ï¼Œè€Œä½¿ç”¨B+Cæ— æ³•è§¦å‘ç´¢å¼•ï¼Œå› ä¸ºæ²¡æœ‰ä½¿ç”¨æœ€å·¦åˆ—ï¼›</p><h3 id="2-8-3-é”™è¯¯æ¨¡ç³ŠæŸ¥è¯¢"><a href="#2-8-3-é”™è¯¯æ¨¡ç³ŠæŸ¥è¯¢" class="headerlink" title="2.8.3  é”™è¯¯æ¨¡ç³ŠæŸ¥è¯¢"></a>2.8.3  é”™è¯¯æ¨¡ç³ŠæŸ¥è¯¢</h3><p>æ¨¡ç³ŠæŸ¥è¯¢çš„æ—¶å€™ï¼Œåªæœ‰<code>å…³é”®å­—%</code>æ‰èƒ½ç”¨åˆ°ç´¢å¼•ï¼Œä½¿ç”¨<code>%å…³é”®å­—</code>æˆ–è€…<code>%å…³é”®å­—%</code>éƒ½æ˜¯æ— æ³•ä½¿ç”¨ç´¢å¼•çš„ï¼›</p><p>æµ‹è¯•è¡¨ç»“æ„å¦‚ä¸‹ï¼Œå…¶ä¸­enameæ˜¯ç”¨æˆ·åï¼Œæˆ‘ç»™ä»–æ·»åŠ äº†ä¸€ä¸ªæ™®é€šç´¢å¼•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [bit_index]&gt; desc EMP;</span><br><span class="line">+----------+--------------------------+------+-----+---------+-------+</span><br><span class="line">| Field    | Type                     | Null | Key | Default | Extra |</span><br><span class="line">+----------+--------------------------+------+-----+---------+-------+</span><br><span class="line">| empno    | int(6) unsigned zerofill | NO   | PRI | NULL    |       |</span><br><span class="line">| ename    | varchar(10)              | YES  |     | NULL    |       |</span><br><span class="line">| job      | varchar(9)               | YES  |     | NULL    |       |</span><br><span class="line">| mgr      | int(4) unsigned zerofill | YES  |     | NULL    |       |</span><br><span class="line">| hiredate | datetime                 | YES  |     | NULL    |       |</span><br><span class="line">| sal      | decimal(7,2)             | YES  |     | NULL    |       |</span><br><span class="line">| comm     | decimal(7,2)             | YES  |     | NULL    |       |</span><br><span class="line">| deptno   | int(2) unsigned zerofill | YES  |     | NULL    |       |</span><br><span class="line">+----------+--------------------------+------+-----+---------+-------+</span><br><span class="line">8 rows in set (0.001 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [bit_index]&gt; alter table EMP add index(ename);</span><br><span class="line">Query OK, 0 rows affected (11.911 sec)              </span><br><span class="line">Records: 0  Duplicates: 0  Warnings: 0</span><br></pre></td></tr></table></figure><p>ç„¶åè¿›è¡Œæµ‹è¯•ã€‚æ³¨æ„çœ‹ä¸‹æ–¹3æ¬¡æŸ¥è¯¢çš„likeæ¡ä»¶åŒºåˆ«ï¼Œä»¥åŠæ˜¯å¦ä½¿ç”¨äº†ç´¢å¼•ï¼›å¯ä»¥çœ‹åˆ°ï¼Œåªæœ‰ç¬¬ä¸€æ¬¡ä½¿ç”¨<code>FN%</code>ä½œä¸ºæŸ¥è¯¢æ¡ä»¶çš„æ—¶å€™ï¼Œæ‰ä½¿ç”¨äº†ç´¢å¼•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [bit_index]&gt; explain select * from EMP where ename like &#x27;FN%&#x27;\G;</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">           id: 1</span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        table: EMP</span><br><span class="line">         type: range</span><br><span class="line">possible_keys: ename</span><br><span class="line">          key: ename</span><br><span class="line">      key_len: 33</span><br><span class="line">          ref: NULL</span><br><span class="line">         rows: 22000</span><br><span class="line">        Extra: Using index condition</span><br><span class="line">1 row in set (0.000 sec)</span><br><span class="line"></span><br><span class="line">ERROR: No query specified</span><br><span class="line"></span><br><span class="line">MariaDB [bit_index]&gt; explain select * from EMP where ename like &#x27;%FN%&#x27;\G;</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">           id: 1</span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        table: EMP</span><br><span class="line">         type: ALL</span><br><span class="line">possible_keys: NULL</span><br><span class="line">          key: NULL</span><br><span class="line">      key_len: NULL</span><br><span class="line">          ref: NULL</span><br><span class="line">         rows: 7968250</span><br><span class="line">        Extra: Using where</span><br><span class="line">1 row in set (0.000 sec)</span><br><span class="line"></span><br><span class="line">ERROR: No query specified</span><br><span class="line"></span><br><span class="line">MariaDB [bit_index]&gt; explain select * from EMP where ename like &#x27;%FN&#x27;\G;</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">           id: 1</span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        table: EMP</span><br><span class="line">         type: ALL</span><br><span class="line">possible_keys: NULL</span><br><span class="line">          key: NULL</span><br><span class="line">      key_len: NULL</span><br><span class="line">          ref: NULL</span><br><span class="line">         rows: 7968250</span><br><span class="line">        Extra: Using where</span><br><span class="line">1 row in set (0.000 sec)</span><br><span class="line"></span><br><span class="line">ERROR: No query specified</span><br></pre></td></tr></table></figure><h3 id="2-8-4-åˆ—è¿ç®—"><a href="#2-8-4-åˆ—è¿ç®—" class="headerlink" title="2.8.4 åˆ—è¿ç®—"></a>2.8.4 åˆ—è¿ç®—</h3><p>å¦‚æœåŒ…å«ç´¢å¼•çš„åˆ—è¿›è¡Œäº†è¿ç®—ï¼Œä¹Ÿä¸ä¼šä½¿ç”¨ç´¢å¼•ï¼›</p><p>æ¯”å¦‚ä¸‹æ–¹ï¼Œç›´æ¥è¿›è¡Œ<code>id=5</code>æŸ¥è¯¢çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨ç´¢å¼•ï¼Œä½†ç”¨<code>id+2=5</code>è¿›è¡ŒæŸ¥è¯¢çš„æ—¶å€™æ— æ³•ä½¿ç”¨ç´¢å¼•ï¼›</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; explain select * from user3 where id=5\G;</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">           id: 1</span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        table: user3</span><br><span class="line">         type: const</span><br><span class="line">possible_keys: PRIMARY</span><br><span class="line">          key: PRIMARY</span><br><span class="line">      key_len: 4</span><br><span class="line">          ref: const</span><br><span class="line">         rows: 1</span><br><span class="line">        Extra: </span><br><span class="line">1 row in set (0.000 sec)</span><br><span class="line"></span><br><span class="line">ERROR: No query specified</span><br><span class="line"></span><br><span class="line">MariaDB [hello_mysql]&gt; explain select * from user3 where id+2=5\G;</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">           id: 1</span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        table: user3</span><br><span class="line">         type: ALL</span><br><span class="line">possible_keys: NULL</span><br><span class="line">          key: NULL</span><br><span class="line">      key_len: NULL</span><br><span class="line">          ref: NULL</span><br><span class="line">         rows: 8</span><br><span class="line">        Extra: Using where</span><br><span class="line">1 row in set (0.000 sec)</span><br><span class="line"></span><br><span class="line">ERROR: No query specified</span><br></pre></td></tr></table></figure><h3 id="2-8-5-ä½¿ç”¨å‡½æ•°"><a href="#2-8-5-ä½¿ç”¨å‡½æ•°" class="headerlink" title="2.8.5 ä½¿ç”¨å‡½æ•°"></a>2.8.5 ä½¿ç”¨å‡½æ•°</h3><p>æŸ¥è¯¢åˆ—å¦‚æœä½¿ç”¨ä»»æ„ MySQL æä¾›çš„å‡½æ•°å°±ä¼šå¯¼è‡´ç´¢å¼•å¤±æ•ˆï¼Œè¿™ä¸€ç‚¹çš„æƒ…å†µå’Œä¸Šä¸€ç‚¹è¿›è¡Œè¿ç®—å…¶å®æ˜¯ç±»ä¼¼çš„ï¼Œæ¯•ç«Ÿå‡½æ•°ä¹Ÿæ˜¯ä¸€ç§å†…ç½®çš„è¿ç®—ï¼›</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; explain select * from user3 where ifnull(id,0)=5\G;</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">           id: 1</span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        table: user3</span><br><span class="line">         type: ALL</span><br><span class="line">possible_keys: NULL</span><br><span class="line">          key: NULL</span><br><span class="line">      key_len: NULL</span><br><span class="line">          ref: NULL</span><br><span class="line">         rows: 8</span><br><span class="line">        Extra: Using where</span><br><span class="line">1 row in set (0.001 sec)</span><br><span class="line"></span><br><span class="line">ERROR: No query specified</span><br></pre></td></tr></table></figure><h3 id="2-8-6-ç±»å‹è½¬æ¢"><a href="#2-8-6-ç±»å‹è½¬æ¢" class="headerlink" title="2.8.6 ç±»å‹è½¬æ¢"></a>2.8.6 ç±»å‹è½¬æ¢</h3><p>å½“æŸ¥è¯¢çš„æ¡ä»¶å’Œå…¶æœ¬èº«çš„æ•°æ®ç±»å‹ä¸åŒæ—¶ï¼Œä¸ä¼šè§¦å‘ç´¢å¼•ï¼›</p><p>æ¯”å¦‚ address ä¸ºå­—ç¬¦ä¸²ç±»å‹ï¼Œè€ŒæŸ¥è¯¢çš„æ—¶å€™è®¾ç½®äº† int ç±»å‹çš„å€¼å°±ä¼šå¯¼è‡´ç´¢å¼•å¤±æ•ˆï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://img.musnow.top/i/2023/09/fb421f166c9d97c932ad6c579ea55f10.png" alt="image"></p><h3 id="2-8-7-ä½¿ç”¨is-not-null"><a href="#2-8-7-ä½¿ç”¨is-not-null" class="headerlink" title="2.8.7 ä½¿ç”¨is not null"></a>2.8.7 ä½¿ç”¨is not null</h3><p>å½“åœ¨æŸ¥è¯¢ä¸­ä½¿ç”¨äº† is not null ä¹Ÿä¼šå¯¼è‡´ç´¢å¼•å¤±æ•ˆï¼Œè€Œ is null åˆ™ä¼šæ­£å¸¸è§¦å‘ç´¢å¼•çš„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://img.musnow.top/i/2023/09/87c89678b12c5b3a0fbb33686e46c6ec.png" alt="image.png"></p><h1 id="3-ç´¢å¼•ä¼˜åŒ–"><a href="#3-ç´¢å¼•ä¼˜åŒ–" class="headerlink" title="3.ç´¢å¼•ä¼˜åŒ–"></a>3.ç´¢å¼•ä¼˜åŒ–</h1><h2 id="3-1-å…³è”æŸ¥è¯¢ä¼˜åŒ–"><a href="#3-1-å…³è”æŸ¥è¯¢ä¼˜åŒ–" class="headerlink" title="3.1 å…³è”æŸ¥è¯¢ä¼˜åŒ–"></a>3.1 å…³è”æŸ¥è¯¢ä¼˜åŒ–</h2><p>ä¿è¯è¢«é©±åŠ¨è¡¨çš„JOINå­—æ®µå·²ç»åˆ›å»ºäº†ç´¢å¼•ï¼Œéœ€è¦ JOIN çš„å­—æ®µï¼Œæ•°æ®ç±»å‹ä¿æŒç»å¯¹ä¸€è‡´ã€‚</p><ul><li>LEFT JOIN æ—¶ï¼Œ<strong>é€‰æ‹©å°è¡¨ä½œä¸ºé©±åŠ¨è¡¨ï¼Œ å¤§è¡¨ä½œä¸ºè¢«é©±åŠ¨è¡¨</strong> ã€‚å‡å°‘å¤–å±‚å¾ªç¯çš„æ¬¡æ•°ã€‚</li><li>INNER JOIN æ—¶ï¼ŒMySQLä¼šè‡ªåŠ¨å°†å°ç»“æœé›†çš„è¡¨é€‰ä¸ºé©±åŠ¨è¡¨ ã€‚</li></ul><p><strong>é€‰æ‹©ç›¸ä¿¡MySQLä¼˜åŒ–ç­–ç•¥</strong>ã€‚èƒ½å¤Ÿç›´æ¥å¤šè¡¨å…³è”çš„å°½é‡ç›´æ¥å…³è”ï¼Œä¸ç”¨å­æŸ¥è¯¢ã€‚(å‡å°‘æŸ¥è¯¢çš„è¶Ÿæ•°ï¼‰</p><blockquote><p>ä¸å»ºè®®ä½¿ç”¨å­æŸ¥è¯¢ï¼Œå»ºè®®å°†å­æŸ¥è¯¢SQLæ‹†å¼€ç»“åˆç¨‹åºå¤šæ¬¡æŸ¥è¯¢ï¼Œæˆ–ä½¿ç”¨ JOIN æ¥ä»£æ›¿å­æŸ¥è¯¢ï¼Œå‚è€ƒç¬¬äºŒç‚¹ï¼›</p></blockquote><p>å¦å¤–ï¼Œè¡ç”Ÿè¡¨å»ºä¸äº†ç´¢å¼•ã€‚è¿™ç‚¹ä¹Ÿéœ€è¦æ³¨æ„</p><h2 id="3-2-å­æŸ¥è¯¢ä¼˜åŒ–"><a href="#3-2-å­æŸ¥è¯¢ä¼˜åŒ–" class="headerlink" title="3.2 å­æŸ¥è¯¢ä¼˜åŒ–"></a>3.2 å­æŸ¥è¯¢ä¼˜åŒ–</h2><p>MySQLä»4.1ç‰ˆæœ¬å¼€å§‹æ”¯æŒå­æŸ¥è¯¢ï¼Œä½¿ç”¨å­æŸ¥è¯¢å¯ä»¥è¿›è¡ŒSELECTè¯­å¥çš„åµŒå¥—æŸ¥è¯¢ï¼Œå³ä¸€ä¸ªSELECTæŸ¥è¯¢çš„ç»“æœä½œä¸ºå¦ä¸€ä¸ªSELECTè¯­å¥çš„æ¡ä»¶ã€‚ </p><p>å­æŸ¥è¯¢å¯ä»¥ä¸€æ¬¡æ€§å®Œæˆå¾ˆå¤šé€»è¾‘ä¸Šéœ€è¦å¤šä¸ªæ­¥éª¤æ‰èƒ½å®Œæˆçš„SQLæ“ä½œï¼Œå­æŸ¥è¯¢æ˜¯ MySQL çš„ä¸€é¡¹é‡è¦çš„åŠŸèƒ½ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ª SQL è¯­å¥å®ç°æ¯”è¾ƒå¤æ‚çš„æŸ¥è¯¢ã€‚</p><p>ä½†æ˜¯ï¼Œ<strong>å­æŸ¥è¯¢çš„æ‰§è¡Œæ•ˆç‡ä¸é«˜</strong>ã€‚åŸå› ï¼š </p><ul><li>æ‰§è¡Œå­æŸ¥è¯¢æ—¶ï¼ŒMySQLéœ€è¦ä¸ºå†…å±‚æŸ¥è¯¢è¯­å¥çš„æŸ¥è¯¢ç»“æœ å»ºç«‹ä¸€ä¸ªä¸´æ—¶è¡¨ ï¼Œç„¶åå¤–å±‚æŸ¥è¯¢è¯­å¥ä»ä¸´æ—¶è¡¨ä¸­æŸ¥è¯¢è®°å½•ã€‚æŸ¥è¯¢å®Œæ¯•åï¼Œå†æ’¤é”€è¿™äº›ä¸´æ—¶è¡¨ã€‚è¿™æ ·ä¼šæ¶ˆè€—è¿‡å¤šçš„CPUå’ŒIOèµ„æºï¼Œäº§ç”Ÿå¤§é‡çš„æ…¢æŸ¥è¯¢ã€‚ </li><li>å­æŸ¥è¯¢çš„ç»“æœé›†å­˜å‚¨çš„<strong>ä¸´æ—¶è¡¨</strong>ï¼Œä¸è®ºæ˜¯å†…å­˜ä¸´æ—¶è¡¨è¿˜æ˜¯ç£ç›˜ä¸´æ—¶è¡¨éƒ½<strong>ä¸ä¼šå­˜åœ¨ç´¢å¼•</strong> ï¼Œæ‰€ä»¥æŸ¥è¯¢æ€§èƒ½ä¼šå—åˆ°ä¸€å®šçš„å½±å“ã€‚</li><li>å¯¹äºè¿”å›ç»“æœé›†æ¯”è¾ƒå¤§çš„å­æŸ¥è¯¢ï¼Œå…¶å¯¹æŸ¥è¯¢æ€§èƒ½çš„å½±å“ä¹Ÿå°±è¶Šå¤§ã€‚ åœ¨MySQLä¸­ï¼Œå¯ä»¥ä½¿ç”¨è¿æ¥ï¼ˆJOINï¼‰æŸ¥è¯¢æ¥æ›¿ä»£å­æŸ¥è¯¢ã€‚è¿æ¥æŸ¥è¯¢ä¸éœ€è¦å»ºç«‹ä¸´æ—¶è¡¨ ï¼Œå…¶é€Ÿåº¦æ¯”å­æŸ¥è¯¢è¦å¿« ï¼Œå¦‚æœæŸ¥è¯¢ä¸­ä½¿ç”¨ç´¢å¼•çš„è¯ï¼Œæ€§èƒ½å°±ä¼šæ›´å¥½ã€‚</li></ul><p>ç»“è®ºï¼šå°½é‡ä¸è¦ä½¿ç”¨ NOT IN æˆ–è€… NOT EXISTSï¼Œç”¨<code>LEFT JOIN xxx ON xx WHERE xx IS NULL</code>æ›¿ä»£ï¼›</p><h2 id="3-3-æ’åºä¼˜åŒ–"><a href="#3-3-æ’åºä¼˜åŒ–" class="headerlink" title="3.3 æ’åºä¼˜åŒ–"></a>3.3 æ’åºä¼˜åŒ–</h2><ul><li>SQL ä¸­ï¼Œå¯ä»¥åœ¨ WHERE å­å¥å’Œ ORDER BY å­å¥ä¸­ä½¿ç”¨ç´¢å¼•ï¼Œç›®çš„æ˜¯åœ¨ WHERE å­å¥ä¸­ é¿å…å…¨è¡¨æ‰« æ ï¼Œåœ¨ ORDER BY å­å¥ é¿å…ä½¿ç”¨ FileSort æ’åº ã€‚å½“ç„¶ï¼ŒæŸäº›æƒ…å†µä¸‹å…¨è¡¨æ‰«æï¼Œæˆ–è€… FileSort æ’ åºä¸ä¸€å®šæ¯”ç´¢å¼•æ…¢ã€‚ä½†æ€»çš„æ¥è¯´ï¼Œæˆ‘ä»¬è¿˜æ˜¯è¦é¿å…ï¼Œä»¥æé«˜æŸ¥è¯¢æ•ˆç‡ã€‚</li><li>å°½é‡ä½¿ç”¨ Index å®Œæˆ ORDER BY æ’åºã€‚å¦‚æœ WHERE å’Œ ORDER BY åé¢æ˜¯ç›¸åŒçš„åˆ—å°±ä½¿ç”¨å•ç´¢å¼•åˆ—ï¼› å¦‚æœä¸åŒå°±ä½¿ç”¨è”åˆç´¢å¼•ã€‚</li><li>æ— æ³•ä½¿ç”¨ Index æ—¶ï¼Œéœ€è¦å¯¹ FileSort æ–¹å¼è¿›è¡Œè°ƒä¼˜ã€‚</li></ul><h2 id="3-4-GROUP-BYä¼˜åŒ–"><a href="#3-4-GROUP-BYä¼˜åŒ–" class="headerlink" title="3.4 GROUP BYä¼˜åŒ–"></a>3.4 GROUP BYä¼˜åŒ–</h2><p>group byä½¿ç”¨ç´¢å¼•çš„åŸåˆ™å‡ ä¹è·Ÿ<code>order by</code>ä¸€è‡´ ï¼Œgroup byå³ä½¿æ²¡æœ‰è¿‡æ»¤æ¡ä»¶ç”¨åˆ°ç´¢å¼•ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ç´¢å¼•ã€‚</p><ul><li>group by å…ˆæ’åºå†åˆ†ç»„ï¼Œéµç…§ç´¢å¼•å»ºçš„<strong>æœ€ä½³å·¦å‰ç¼€æ³•åˆ™</strong>ï¼›</li><li>å½“æ— æ³•ä½¿ç”¨ç´¢å¼•åˆ—äº‹ï¼Œå¢å¤§ <code>max_length_for_sort_data</code> å’Œ <code>sort_buffer_size</code> å‚æ•°çš„è®¾ç½®ï¼›</li><li>whereæ•ˆç‡é«˜äºhavingï¼Œèƒ½å†™åœ¨whereé™å®šçš„æ¡ä»¶å°±ä¸è¦å†™åœ¨havingä¸­äº†ï¼</li><li>å‡å°‘ä½¿ç”¨order byï¼Œå’Œä¸šåŠ¡æ²Ÿé€šèƒ½ä¸æ’åºå°±ä¸æ’åºï¼Œæˆ–å°†æ’åºæ”¾åˆ°ç¨‹åºç«¯å»åšã€‚Order byã€group byã€distinctè¿™äº›è¯­å¥è¾ƒä¸ºè€—è´¹CPUï¼Œæ•°æ®åº“çš„CPUèµ„æºæ˜¯æå…¶å®è´µçš„ã€‚</li><li>åŒ…å«äº†order byã€group byã€distinctè¿™äº›æŸ¥è¯¢çš„è¯­å¥ï¼Œwhereæ¡ä»¶è¿‡æ»¤å‡ºæ¥çš„ç»“æœé›†è¯·ä¿æŒåœ¨1000è¡Œ ä»¥å†…ï¼Œå¦åˆ™SQLä¼šå¾ˆæ…¢ã€‚</li></ul><h2 id="3-5-ç´¢å¼•è¦†ç›–"><a href="#3-5-ç´¢å¼•è¦†ç›–" class="headerlink" title="3.5 ç´¢å¼•è¦†ç›–"></a>3.5 ç´¢å¼•è¦†ç›–</h2><p>è¿™ä¸€ç‚¹åœ¨ä¸Šæ–‡çš„å›è¡¨æŸ¥æ‰¾ä¸­å·²ç»æåŠäº†ï¼Œå³ä½¿ç”¨å¤åˆç´¢å¼•ï¼Œå¹¶å°†ä½ éœ€è¦æŸ¥è¯¢çš„ç›®æ ‡å­—æ®µä»¥æœ€å·¦åŒ¹é…åŸåˆ™è®¾ç½®åˆ°å¤åˆç´¢å¼•ä¸­ï¼Œå‡å°‘å›è¡¨æ“ä½œã€‚</p><p>å½“ç„¶ï¼Œè¿™ä¾æ—§éœ€è¦éµå¾ªç´¢å¼•åˆ›å»ºçš„åŸåˆ™ï¼Œå³å¦‚æœæŸåˆ—æ•°æ®é‡å¤é‡è¿‡å¤šï¼Œåˆ™ä¸åº”è¯¥ä½œä¸ºç´¢å¼•åˆ—ï¼ˆå¦‚æœçœŸçš„éœ€è¦ï¼Œå¯ä»¥æ”¾åœ¨å¤åˆç´¢å¼•çš„æœ€åé¢ï¼Œè¿™æ ·èƒ½å‡å°‘ä»¥ä¹‹ä¸ºæŸ¥è¯¢åˆ¤æ®çš„åœºæ™¯ï¼‰</p>]]></content>
    
    
    <summary type="html">ç´¢å¼•çš„å­¦ä¹ </summary>
    
    
    
    <category term="å­¦ä¹ sql" scheme="https://blog.musnow.top/categories/%E5%AD%A6%E4%B9%A0sql/"/>
    
    
    <category term="Linux" scheme="https://blog.musnow.top/tags/Linux/"/>
    
    <category term="mysql" scheme="https://blog.musnow.top/tags/mysql/"/>
    
  </entry>
  
  <entry>
    <title>ã€MySQLã€‘å¤åˆæŸ¥è¯¢ | å†…å¤–é“¾æ¥ï¼ˆæœªå®Œæˆï¼‰</title>
    <link href="https://blog.musnow.top/posts/2529084145/"/>
    <id>https://blog.musnow.top/posts/2529084145/</id>
    <published>2023-09-06T23:52:14.000Z</published>
    <updated>2023-09-06T23:52:30.000Z</updated>
    
    <content type="html"><![CDATA[<p>å„ç±»å¤åˆæŸ¥è¯¢å’Œç¬›å¡å°”ç§¯ã€å†…å¤–é“¾æ¥çš„æ“ä½œ</p><span id="more"></span><h1 id="1-åŸºç¡€æŸ¥è¯¢"><a href="#1-åŸºç¡€æŸ¥è¯¢" class="headerlink" title="1.åŸºç¡€æŸ¥è¯¢"></a>1.åŸºç¡€æŸ¥è¯¢</h1><p>åœ¨ä¹‹å‰çš„MySQLçš„CURDåŸºæœ¬æ“ä½œåšå®¢ä¸­ï¼Œè®²è¿°äº†ä¸€éƒ¨åˆ†æŸ¥è¯¢çš„è¯­æ³•ï¼Œä½†æ˜¯åœ¨å®é™…çš„ç”Ÿäº§æ´»åŠ¨ä¸­ï¼Œé‚£ç§æœ€åŸºç¡€çš„æŸ¥è¯¢æ–¹å¼ä¸è¶³ä»¥æ»¡è¶³å¤æ‚æŸ¥è¯¢æ¡ä»¶æ—¶çš„è¦æ±‚ï¼Œæ‰€ä»¥åœ¨æ™®é€šæŸ¥è¯¢çš„åŸºç¡€ä¸Šï¼ŒMySQLè¿˜æä¾›äº†åŠŸèƒ½æ›´å¼ºå¤§çš„å¤åˆæŸ¥è¯¢ï¼Œæœ¬æ–‡å°±è®©æˆ‘ä»¬ä¸€èµ·æ¥å­¦å­¦å¤åˆæŸ¥è¯¢çš„æ“ä½œå§ï¼</p><blockquote><p>ä¾æ—§æ˜¯ä½¿ç”¨scottæä¾›çš„è¿™å¼ è¡¨ï¼Œæ¥è¿›è¡Œå¤åˆæŸ¥è¯¢çš„æ“ä½œã€‚</p></blockquote><p>åœ¨é‚£ä¹‹å‰ï¼Œå…ˆå¤ä¹ ä¸€ä¸‹æ™®é€šæŸ¥è¯¢çš„åŸºæœ¬æ“ä½œå§ï¼</p><ul><li>æŸ¥è¯¢å·¥èµ„é«˜äº500æˆ–è€…å²—ä½ä¸ºMANAGERçš„æˆå‘˜ï¼ŒåŒæ—¶ä»–ä»¬çš„å§“åé¦–å­—æ¯ä¸ºå¤§å†™J</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> (sal <span class="operator">&gt;</span> <span class="number">500</span> <span class="keyword">or</span> job <span class="operator">=</span> <span class="string">&#x27;MANAGER&#x27;</span>) <span class="keyword">and</span> ename <span class="keyword">like</span> <span class="string">&#x27;J%&#x27;</span>;</span><br></pre></td></tr></table></figure><ul><li>æŒ‰ç…§éƒ¨é—¨å·å‡åºã€é›‡å‘˜çš„å·¥èµ„é™åºæ’åº</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> deptno, sal <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure><ul><li>æ˜¾ç¤ºå·¥èµ„é«˜äºå¹³å‡å·¥èµ„çš„å‘˜å·¥ä¿¡æ¯</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> sal <span class="operator">&gt;</span> (<span class="keyword">select</span> <span class="built_in">avg</span>(sal) <span class="keyword">from</span> emp);</span><br></pre></td></tr></table></figure><ul><li>æ˜¾ç¤ºæ¯ä¸ªéƒ¨é—¨çš„å¹³å‡å·¥èµ„å’Œæœ€é«˜å·¥èµ„</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> deptno, <span class="built_in">avg</span>(sal), <span class="built_in">max</span>(sal) <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> deptno;</span><br></pre></td></tr></table></figure><ul><li>æ˜¾ç¤ºæ¯ç§å²—ä½çš„é›‡å‘˜æ•°é‡å’Œå¹³å‡å·¥èµ„</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> job,<span class="built_in">count</span>(<span class="operator">*</span>),<span class="built_in">avg</span>(sal) <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> job;</span><br><span class="line"><span class="comment">-- é»˜è®¤æƒ…å†µä¸‹ä¼šä¿ç•™6ä½å°æ•°ï¼Œå¯ä»¥ç”¨formatå‡½æ•°ä¿ç•™åˆ°2ä½</span></span><br><span class="line"><span class="keyword">select</span> job,<span class="built_in">count</span>(<span class="operator">*</span>),format(<span class="built_in">avg</span>(sal),<span class="number">2</span>) <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> job;</span><br><span class="line"><span class="comment">-- æ ¼å¼åŒ–åçš„è¾“å‡ºç»“æœå¦‚ä¸‹</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+----------+--------------------+</span></span><br><span class="line"><span class="operator">|</span> job       <span class="operator">|</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="operator">|</span> format(<span class="built_in">avg</span>(sal),<span class="number">2</span>) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+----------+--------------------+</span></span><br><span class="line"><span class="operator">|</span> ANALYST   <span class="operator">|</span>        <span class="number">2</span> <span class="operator">|</span> <span class="number">3</span>,<span class="number">000.00</span>           <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> CLERK     <span class="operator">|</span>        <span class="number">4</span> <span class="operator">|</span> <span class="number">1</span>,<span class="number">037.50</span>           <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> MANAGER   <span class="operator">|</span>        <span class="number">3</span> <span class="operator">|</span> <span class="number">2</span>,<span class="number">758.33</span>           <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> PRESIDENT <span class="operator">|</span>        <span class="number">1</span> <span class="operator">|</span> <span class="number">5</span>,<span class="number">000.00</span>           <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> SALESMAN  <span class="operator">|</span>        <span class="number">4</span> <span class="operator">|</span> <span class="number">1</span>,<span class="number">400.00</span>           <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+----------+--------------------+</span></span><br><span class="line"><span class="number">5</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.000</span> sec)</span><br></pre></td></tr></table></figure><h1 id="2-å¤šè¡¨æŸ¥è¯¢"><a href="#2-å¤šè¡¨æŸ¥è¯¢" class="headerlink" title="2.å¤šè¡¨æŸ¥è¯¢"></a>2.å¤šè¡¨æŸ¥è¯¢</h1><p>åŸºç¡€æŸ¥è¯¢çš„æ“ä½œå°±å¤ä¹ ä¸Šé¢å‡ ä¸ªå°±å·®ä¸å¤šäº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å…ˆçœ‹å¤åˆæŸ¥è¯¢çš„ç¬¬ä¸€ä¸ªå¤§ç‚¹ï¼Œå¤šè¡¨æŸ¥è¯¢ã€‚</p><p>æ‰€è°“å¤šè¡¨æŸ¥è¯¢ï¼Œå°±æ˜¯å°†ä¸€ä¸ªè¡¨å’Œå¦å¤–ä¸€ä¸ªè¡¨åˆå¹¶ï¼Œå†åœ¨è¿™ä¸ªåˆå¹¶äº†ä¹‹åçš„è¡¨é‡Œé¢è¿›è¡ŒæŸ¥è¯¢ï¼›</p><ul><li>æ¯”å¦‚ï¼šæ˜¾ç¤ºé›‡å‘˜åã€é›‡å‘˜å·¥èµ„ä»¥åŠæ‰€åœ¨éƒ¨é—¨çš„åå­—</li></ul><p>å› ä¸ºé›‡å‘˜åæ˜¯åœ¨empè¡¨é‡Œé¢ï¼Œéƒ¨é—¨åå­—æ˜¯åœ¨deptè¡¨é‡Œé¢ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±éœ€è¦è¿›è¡Œå¤šè¡¨çš„è”åˆæŸ¥è¯¢æ‰èƒ½ä¸€æ¬¡å–åˆ°ç»“æœï¼ˆä¸€æ¬¡æŸ¥è¯¢çš„æ•ˆç‡ä¼˜äºä¸¤æ¬¡ç‹¬ç«‹æŸ¥è¯¢ï¼‰</p><p>å…¶åŸºæœ¬è¯­å¥å°±æ˜¯åœ¨fromåé¢æ·»åŠ å¤šä¸ªè¡¨ï¼Œå¹¶ä½¿ç”¨<code>è¡¨å.è¡¨ä¸­å­—æ®µå</code>æ¥æŒ‡å®šæŸä¸€ä¸ªè¡¨ä¸­çš„å­—æ®µï¼›å¦‚æœè¿™ä¸ªå­—æ®µåªæœ‰ä¸€ä¸ªè¡¨ä¸­æœ‰ï¼Œé‚£å°±å¯ä»¥ä¸ç”¨æŒ‡å®šè¡¨åï¼ˆä½†ä¾æ—§å»ºè®®æŒ‡å®šè¡¨åé¿å…å‡ºé”™ï¼‰</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> è¡¨<span class="number">1</span>,è¡¨<span class="number">2</span>,...;</span><br></pre></td></tr></table></figure><h2 id="2-1-ç¬›å¡å°”ç§¯"><a href="#2-1-ç¬›å¡å°”ç§¯" class="headerlink" title="2.1 ç¬›å¡å°”ç§¯"></a>2.1 ç¬›å¡å°”ç§¯</h2><p>å…ˆæ¥ä¸€ä¸ªå…¨åˆ—æŸ¥è¯¢ï¼Œçœ‹çœ‹æ•ˆæœ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp,dept;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œdeptè¡¨ç›´æ¥æ‹¼æ¥åœ¨äº†empè¡¨ä¹‹åï¼Œè€Œä¸”empè¡¨ä¸­çš„æ¯ä¸€ä¸ªå€¼éƒ½è¢«æ ¹æ®deptä¸­ä¸åŒçš„éƒ¨é—¨IDé‡å¤äº†4æ¬¡ã€‚è¿™æ˜¯å› ä¸ºåœ¨MySQLä¸­ï¼Œä»–å¹¶ä¸çŸ¥é“ä½ éœ€è¦ä»€ä¹ˆæ•°æ®ï¼Œæ‰€ä»¥è¿›è¡Œæ•°æ®æ‹¼æ¥çš„æ—¶å€™ï¼Œæ˜¯é‡‡ç”¨ç©·ä¸¾çš„æ–¹å¼æ¥æ‹¼æ¥çš„ï¼</p><p>è¿™ä¸ªä¸åŠ ä»»ä½•è¿‡æ»¤æ¡ä»¶ï¼Œç©·ä¸¾æ‹¼æ¥å¾—åˆ°çš„ç»“æœè¢«ç§°ä¸º<code>ç¬›å¡å°”ç§¯</code>ï¼</p><p><img src="https://img.musnow.top/i/2023/09/3ab44ca912fdd37336acec9da9271b4e.png" alt="image-20230908082727650"></p><h2 id="2-2-æŒ‡å®šæ¡ä»¶"><a href="#2-2-æŒ‡å®šæ¡ä»¶" class="headerlink" title="2.2 æŒ‡å®šæ¡ä»¶"></a>2.2 æŒ‡å®šæ¡ä»¶</h2><p>æ¥ä¸‹æ¥å†å›åˆ°ä¸Šé¢æåˆ°çš„é—®é¢˜ï¼šæ˜¾ç¤ºé›‡å‘˜åã€é›‡å‘˜å·¥èµ„ä»¥åŠæ‰€åœ¨éƒ¨é—¨çš„åå­—ï¼›</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> emp.ename,emp.sal,dept.dname <span class="keyword">from</span> emp,dept;</span><br></pre></td></tr></table></figure><p>è™½ç„¶æˆ‘ä»¬é€‰ä¸­äº†æˆ‘ä»¬éœ€è¦çš„åˆ—æ¥æ˜¾ç¤ºï¼Œä½†ä¾æ—§æ²¡æœ‰è§£å†³ç¬›å¡å°”ç§¯ä¸­ç©·ä¸¾å‡ºæ¥çš„æ— æ•ˆæ•°æ®ï¼›</p><p><img src="https://img.musnow.top/i/2023/09/962f9b4daf49a81d8a0c1a5cedcff9ba.png" alt="image-20230908083214029"></p><p>è¿™æ—¶å€™å°±éœ€è¦æ·»åŠ ä¸Šç­›é€‰æ¡ä»¶ï¼Œæ¥å‰”é™¤æ‰æ— æ•ˆçš„æ•°æ®ã€‚</p><p>å’Œå½“å‰å‘˜å·¥çš„éƒ¨é—¨ç¼–å·ä¸åŒçš„éƒ¨é—¨æ•°æ®å°±æ˜¯æ— æ•ˆçš„ï¼Œæˆ‘ä»¬æ·»åŠ ä¸Šå‘˜å·¥éƒ¨é—¨ç¼–å·å’Œéƒ¨é—¨è¡¨ä¸­çš„éƒ¨é—¨ç¼–å·ç›¸åŒçš„æ¡ä»¶ï¼Œå°±å¯ä»¥å‰”é™¤æ‰æ— æ•ˆçš„æ•°æ®ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> emp.ename,emp.sal,dept.dname <span class="keyword">from</span> emp,dept <span class="keyword">where</span> emp.deptno <span class="operator">=</span> dept.deptno;</span><br></pre></td></tr></table></figure><p>è¿™æ—¶å€™ç­›é€‰å‡ºæ¥çš„æ•°æ®ï¼Œæ‰æ˜¯æ­£ç¡®çš„æ¯ä¸ªå‘˜å·¥å’Œå…¶å¯¹åº”çš„éƒ¨é—¨åå­—çš„æ•°æ®ï¼›æ¯ä¸ªå‘˜å·¥ä¹Ÿä¸åœ¨ä¼šé‡å¤4æ¬¡äº†ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [scott]&gt; select emp.ename,emp.sal,dept.dname from emp,dept where emp.deptno = dept.deptno;</span><br><span class="line">+--------+---------+------------+</span><br><span class="line">| ename  | sal     | dname      |</span><br><span class="line">+--------+---------+------------+</span><br><span class="line">| SMITH  |  800.00 | RESEARCH   |</span><br><span class="line">| ALLEN  | 1600.00 | SALES      |</span><br><span class="line">| WARD   | 1250.00 | SALES      |</span><br><span class="line">| JONES  | 2975.00 | RESEARCH   |</span><br><span class="line">| MARTIN | 1250.00 | SALES      |</span><br><span class="line">| BLAKE  | 2850.00 | SALES      |</span><br><span class="line">| CLARK  | 2450.00 | ACCOUNTING |</span><br><span class="line">| SCOTT  | 3000.00 | RESEARCH   |</span><br><span class="line">| KING   | 5000.00 | ACCOUNTING |</span><br><span class="line">| TURNER | 1500.00 | SALES      |</span><br><span class="line">| ADAMS  | 1100.00 | RESEARCH   |</span><br><span class="line">| JAMES  |  950.00 | SALES      |</span><br><span class="line">| FORD   | 3000.00 | RESEARCH   |</span><br><span class="line">| MILLER | 1300.00 | ACCOUNTING |</span><br><span class="line">+--------+---------+------------+</span><br><span class="line">14 rows in set (0.004 sec)</span><br></pre></td></tr></table></figure><p>å†æ¥åšä¸¤ä¸ªå°ç»ƒä¹ </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- æ˜¾ç¤ºéƒ¨é—¨å·ä¸º10çš„éƒ¨é—¨åå­—ï¼Œå‘˜å·¥åå­—å’Œå‘˜å·¥å·¥èµ„ï¼›</span></span><br><span class="line">MariaDB [scott]<span class="operator">&gt;</span> <span class="keyword">select</span> emp.ename,emp.sal,dept.dname <span class="keyword">from</span> emp,dept <span class="keyword">where</span> emp.deptno <span class="operator">=</span> dept.deptno <span class="keyword">and</span> dept.deptno <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+---------+------------+</span></span><br><span class="line"><span class="operator">|</span> ename  <span class="operator">|</span> sal     <span class="operator">|</span> dname      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+---------+------------+</span></span><br><span class="line"><span class="operator">|</span> CLARK  <span class="operator">|</span> <span class="number">2450.00</span> <span class="operator">|</span> ACCOUNTING <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> KING   <span class="operator">|</span> <span class="number">5000.00</span> <span class="operator">|</span> ACCOUNTING <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> MILLER <span class="operator">|</span> <span class="number">1300.00</span> <span class="operator">|</span> ACCOUNTING <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+---------+------------+</span></span><br><span class="line"><span class="number">3</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.001</span> sec)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ˜¾ç¤ºå„ä¸ªéƒ¨é—¨å‘˜å·¥çš„å§“åï¼Œå·¥èµ„ï¼Œå·¥èµ„çº§åˆ«</span></span><br><span class="line">MariaDB [scott]<span class="operator">&gt;</span> <span class="keyword">select</span> emp.ename,emp.sal,salgrade.grade <span class="keyword">from</span> emp,salgrade <span class="keyword">where</span> emp.sal <span class="keyword">between</span> losal <span class="keyword">and</span> hisal;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> ename  <span class="operator">|</span> sal     <span class="operator">|</span> grade <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> SMITH  <span class="operator">|</span>  <span class="number">800.00</span> <span class="operator">|</span>     <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> ALLEN  <span class="operator">|</span> <span class="number">1600.00</span> <span class="operator">|</span>     <span class="number">3</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> WARD   <span class="operator">|</span> <span class="number">1250.00</span> <span class="operator">|</span>     <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> JONES  <span class="operator">|</span> <span class="number">2975.00</span> <span class="operator">|</span>     <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> MARTIN <span class="operator">|</span> <span class="number">1250.00</span> <span class="operator">|</span>     <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> BLAKE  <span class="operator">|</span> <span class="number">2850.00</span> <span class="operator">|</span>     <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> CLARK  <span class="operator">|</span> <span class="number">2450.00</span> <span class="operator">|</span>     <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> SCOTT  <span class="operator">|</span> <span class="number">3000.00</span> <span class="operator">|</span>     <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> KING   <span class="operator">|</span> <span class="number">5000.00</span> <span class="operator">|</span>     <span class="number">5</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> TURNER <span class="operator">|</span> <span class="number">1500.00</span> <span class="operator">|</span>     <span class="number">3</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> ADAMS  <span class="operator">|</span> <span class="number">1100.00</span> <span class="operator">|</span>     <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> JAMES  <span class="operator">|</span>  <span class="number">950.00</span> <span class="operator">|</span>     <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> FORD   <span class="operator">|</span> <span class="number">3000.00</span> <span class="operator">|</span>     <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> MILLER <span class="operator">|</span> <span class="number">1300.00</span> <span class="operator">|</span>     <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+---------+-------+</span></span><br><span class="line"><span class="number">14</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.001</span> sec)</span><br></pre></td></tr></table></figure><h1 id="3-è‡ªé“¾æ¥"><a href="#3-è‡ªé“¾æ¥" class="headerlink" title="3.è‡ªé“¾æ¥"></a>3.è‡ªé“¾æ¥</h1><p>æ‰€è°“è‡ªè¿æ¥ï¼Œæ˜¯åœ¨åŒä¸€å¼ è¡¨ä¸­è¿›è¡Œé“¾æ¥å’ŒæŸ¥è¯¢</p><p>æ¯”å¦‚æ˜¾ç¤ºå‘˜å·¥FORDä¸Šçº§é¢†å¯¼çš„å‘˜å·¥ç¼–å·å’Œå§“å</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- ä½¿ç”¨å­æŸ¥è¯¢</span></span><br><span class="line"><span class="keyword">select</span> empno,ename <span class="keyword">from</span> emp <span class="keyword">where</span> emp.empno<span class="operator">=</span>(<span class="keyword">select</span> mgr <span class="keyword">from</span> emp <span class="keyword">where</span></span><br><span class="line">ename<span class="operator">=</span><span class="string">&#x27;FORD&#x27;</span>);</span><br><span class="line"><span class="comment">-- ä½¿ç”¨å¤šè¡¨æŸ¥è¯¢ï¼ˆå…¶å®æ˜¯ç»™empè¡¨èµ·ä¸¤ä¸ªä¸åŒçš„åˆ«åï¼‰</span></span><br><span class="line"><span class="keyword">select</span> leader.empno,leader.ename <span class="keyword">from</span> emp leader, emp worker <span class="keyword">where</span></span><br><span class="line">leader.empno <span class="operator">=</span> worker.mgr <span class="keyword">and</span> worker.ename<span class="operator">=</span><span class="string">&#x27;FORD&#x27;</span>;</span><br></pre></td></tr></table></figure><p>è¿™ç§åœ¨ä¸€å¼ è¡¨é‡Œé¢è¿›è¡Œç¬›å¡å„¿ç§¯çš„æŸ¥è¯¢æ“ä½œï¼Œå°±å«åšè‡ªé“¾æ¥ã€‚æœ€ç»ˆéƒ½å¯ä»¥è·å–åˆ°æ­£ç¡®ç»“æœ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">+--------+-------+</span><br><span class="line">| empno  | ename |</span><br><span class="line">+--------+-------+</span><br><span class="line">| 007566 | JONES |</span><br><span class="line">+--------+-------+</span><br><span class="line">1 row in set (0.001 sec)</span><br></pre></td></tr></table></figure><h1 id="4-å­æŸ¥è¯¢"><a href="#4-å­æŸ¥è¯¢" class="headerlink" title="4.å­æŸ¥è¯¢"></a>4.å­æŸ¥è¯¢</h1><p>å­æŸ¥è¯¢å€¼å¾—æ˜¯ï¼Œå°†ä¸€ä¸ªæŸ¥è¯¢è¯­å¥ä½œä¸ºå­æ“ä½œï¼ŒåµŒå…¥åˆ°ä¸€ä¸ªsqlè¯­å¥ä¸­ï¼›</p><p>æˆ‘ä»¬å¯ä»¥æŠŠå­æŸ¥è¯¢çš„ç»“æœä¹Ÿå½“ä½œæ˜¯ä¸€å¼ è¡¨æ¥è¿›è¡Œå¤„ç†ï¼Œè¿™æ ·ä¸€æƒ³å°±èƒ½ç†è§£å­æŸ¥è¯¢æ˜¯æ€ä¹ˆç©çš„äº†ã€‚</p><h2 id="4-1-å•è¡Œå­æŸ¥è¯¢"><a href="#4-1-å•è¡Œå­æŸ¥è¯¢" class="headerlink" title="4.1 å•è¡Œå­æŸ¥è¯¢"></a>4.1 å•è¡Œå­æŸ¥è¯¢</h2><p>æ˜¾ç¤ºå’ŒSMITHåŒä¸€ä¸ªéƒ¨é—¨çš„å‘˜å·¥</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> deptno <span class="operator">=</span> (<span class="keyword">select</span> deptno <span class="keyword">from</span> emp <span class="keyword">where</span> ename<span class="operator">=</span><span class="string">&#x27;smith&#x27;</span>);</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªæŸ¥è¯¢ä¸­ï¼Œå­æŸ¥è¯¢è¯­å¥æ˜¯<code>(select deptno from emp where ename=&#39;smith&#39;)</code>ï¼Œè¿™ä¸ªè¯­å¥è¿”å›çš„ç»“æœåªæœ‰ä¸€è¡Œï¼Œæ‰€ä»¥è¢«ç§°ä¸ºå•è¡Œå­æŸ¥è¯¢ï¼›</p><h2 id="4-2-å¤šè¡Œå­æŸ¥è¯¢"><a href="#4-2-å¤šè¡Œå­æŸ¥è¯¢" class="headerlink" title="4.2 å¤šè¡Œå­æŸ¥è¯¢"></a>4.2 å¤šè¡Œå­æŸ¥è¯¢</h2><p>æœ‰å•è¡ŒæŸ¥è¯¢ï¼Œè‡ªç„¶ä¹Ÿæœ‰å¤šè¡ŒæŸ¥è¯¢ã€‚ä½†æ˜¯å¦‚æœä¸€ä¸ªè¯­å¥è¿”å›äº†å¤šæ¡ç»“æœï¼Œå°†å…¶ç›´æ¥ä½œä¸ºåˆ¤æ®è‚¯å®šæ˜¯ä¸è¡Œçš„ï¼Œè¿™ä¼šå¯¼è‡´åˆ¤æ®ä¸å”¯ä¸€ï¼ŒMySQLä¸çŸ¥é“ä½ åˆ°åº•æƒ³è¦æ¯”è¾ƒçš„æ˜¯é‚£ä¸€éƒ¨åˆ†çš„æ•°æ®ã€‚è¿™æ—¶å€™å°±éœ€è¦ç”¨ä¸‹é¢å‡ ä¸ªå…³é”®å­—æ¥å¸®å¿™äº†</p><ul><li>inï¼šæŸ¥è¯¢å­˜åœ¨äºæŸæŸç»“æœé‡Œé¢çš„æ•°æ®</li><li>allï¼šæŸ¥è¯¢æ¯”è¿™ä¸ªç»“æœä¸­æ‰€æœ‰å€¼éƒ½å¤§&#x2F;å°çš„æ•°æ®</li><li>anyï¼šæŸ¥è¯¢æ¯”è¿™ä¸ªç»“æœä¸­æŸä¸€ä¸ªå€¼å¤§&#x2F;å°çš„æ•°æ®</li></ul><p>ä»¥ä¸‹æ˜¯å‡ ä¸ªç¤ºä¾‹</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- æŸ¥è¯¢å’Œ10å·éƒ¨é—¨å·¥ä½œå²—ä½ç›¸åŒçš„å‘˜å·¥åå­—ã€å²—ä½ã€å·¥èµ„ã€éƒ¨é—¨å·ï¼Œä½†æ˜¯ä¸åŒ…å«10å·éƒ¨é—¨è‡ªå·±çš„å‘˜å·¥</span></span><br><span class="line"><span class="keyword">select</span> ename,job,sal,deptno <span class="keyword">from</span> emp <span class="keyword">where</span> job <span class="keyword">in</span> (<span class="keyword">select</span> job <span class="keyword">from</span> emp <span class="keyword">where</span> deptno<span class="operator">=</span><span class="number">10</span>) <span class="keyword">and</span> deptno <span class="operator">&lt;&gt;</span> <span class="number">10</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+---------+---------+--------+</span></span><br><span class="line"><span class="operator">|</span> ename <span class="operator">|</span> job     <span class="operator">|</span> sal     <span class="operator">|</span> deptno <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+---------+---------+--------+</span></span><br><span class="line"><span class="operator">|</span> SMITH <span class="operator">|</span> CLERK   <span class="operator">|</span>  <span class="number">800.00</span> <span class="operator">|</span>     <span class="number">20</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> JONES <span class="operator">|</span> MANAGER <span class="operator">|</span> <span class="number">2975.00</span> <span class="operator">|</span>     <span class="number">20</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> BLAKE <span class="operator">|</span> MANAGER <span class="operator">|</span> <span class="number">2850.00</span> <span class="operator">|</span>     <span class="number">30</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> ADAMS <span class="operator">|</span> CLERK   <span class="operator">|</span> <span class="number">1100.00</span> <span class="operator">|</span>     <span class="number">20</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> JAMES <span class="operator">|</span> CLERK   <span class="operator">|</span>  <span class="number">950.00</span> <span class="operator">|</span>     <span class="number">30</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+---------+---------+--------+</span></span><br><span class="line"><span class="number">5</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.001</span> sec)</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- æ˜¾ç¤ºéƒ¨é—¨å·¥èµ„æ¯”30å·éƒ¨é—¨æ‰€æœ‰å‘˜å·¥å·¥èµ„éƒ½é«˜çš„å‘˜å·¥å§“åã€å·¥èµ„ã€éƒ¨é—¨å·</span></span><br><span class="line"><span class="keyword">select</span> ename,sal,deptno <span class="keyword">from</span> emp <span class="keyword">where</span> sal <span class="operator">&gt;</span> <span class="keyword">all</span>(<span class="keyword">select</span> sal <span class="keyword">from</span> emp <span class="keyword">where</span> deptno <span class="operator">=</span> <span class="number">30</span>);</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+---------+--------+</span></span><br><span class="line"><span class="operator">|</span> ename <span class="operator">|</span> sal     <span class="operator">|</span> deptno <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+---------+--------+</span></span><br><span class="line"><span class="operator">|</span> JONES <span class="operator">|</span> <span class="number">2975.00</span> <span class="operator">|</span>     <span class="number">20</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> SCOTT <span class="operator">|</span> <span class="number">3000.00</span> <span class="operator">|</span>     <span class="number">20</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> KING  <span class="operator">|</span> <span class="number">5000.00</span> <span class="operator">|</span>     <span class="number">10</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> FORD  <span class="operator">|</span> <span class="number">3000.00</span> <span class="operator">|</span>     <span class="number">20</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+---------+--------+</span></span><br><span class="line"><span class="number">4</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.001</span> sec)</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">å„ç±»å¤åˆæŸ¥è¯¢å’Œç¬›å¡å°”ç§¯ã€å†…å¤–é“¾æ¥çš„æ“ä½œ</summary>
    
    
    
    <category term="å­¦ä¹ sql" scheme="https://blog.musnow.top/categories/%E5%AD%A6%E4%B9%A0sql/"/>
    
    
    <category term="Linux" scheme="https://blog.musnow.top/tags/Linux/"/>
    
    <category term="mysql" scheme="https://blog.musnow.top/tags/mysql/"/>
    
  </entry>
  
</feed>
