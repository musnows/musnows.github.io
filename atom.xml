<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>æ…•é›ªçš„å¯’èˆ</title>
  
  <subtitle>é›ªä¸‹äº†ä¸€å¤œ</subtitle>
  <link href="https://blog.musnow.top/atom.xml" rel="self"/>
  
  <link href="https://blog.musnow.top/"/>
  <updated>2023-12-18T08:52:00.000Z</updated>
  <id>https://blog.musnow.top/</id>
  
  <author>
    <name>æ…•é›ªå¹´å</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>ã€Pythonã€‘Pythonå®ç°æ–‡ä»¶åˆ†ç‰‡åŠ å¯†å’Œä¸Šä¼ ï¼ˆæœªå®ç°ï¼‰</title>
    <link href="https://blog.musnow.top/posts/621478472/"/>
    <id>https://blog.musnow.top/posts/621478472/</id>
    <published>2023-12-18T08:52:00.000Z</published>
    <updated>2023-12-18T08:52:00.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="è¯´æ˜"><a href="#è¯´æ˜" class="headerlink" title="è¯´æ˜"></a>è¯´æ˜</h1><blockquote><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/musnows/encrypt2bdy">musnows&#x2F;encrypt2bdy</a></p></blockquote><p>ä¹‹å‰å†™çš„ä¸€ç¯‡åšå®¢æåˆ°äº†æˆ‘çš„encrypt2bdyé¡¹ç›®ä¸­ï¼Œæ–‡ä»¶ç›´æ¥æ•´ä¸ªè¢«è¯»å–åˆ°å†…å­˜é‡Œé¢å†è®¡ç®—md5ï¼Œå¯¼è‡´å†…å­˜å ç”¨å·¨å¤§çš„é—®é¢˜ã€‚åç»­è§£å†³æ–¹æ³•æ˜¯ç”¨åˆ†ç‰‡çš„æ–¹å¼æŒ¨ä¸ªè¯»å–æ–‡ä»¶å—å¹¶è®¡ç®—md5ã€‚</p><p>ä½†å…‰æ˜¯ä¿®æ”¹md5è®¡ç®—æ–¹å¼è¿˜ä¸å¤Ÿï¼Œå› ä¸ºé¡¹ç›®ä¸­è¿˜æ¶‰åŠåˆ°<strong>ä¸Šä¼ åŠ å¯†åæ–‡ä»¶</strong>çš„é—®é¢˜ï¼Œä¸”å¬æˆ‘ç»†ç»†é“æ¥ğŸ‘‡</p><h1 id="å…³äºæ–‡ä»¶åŠ å¯†åº“"><a href="#å…³äºæ–‡ä»¶åŠ å¯†åº“" class="headerlink" title="å…³äºæ–‡ä»¶åŠ å¯†åº“"></a>å…³äºæ–‡ä»¶åŠ å¯†åº“</h1><h2 id="cryptography-fernet"><a href="#cryptography-fernet" class="headerlink" title="cryptography.fernet"></a>cryptography.fernet</h2><p>æˆ‘çš„åŠ å¯†è§£å¯†æ“ä½œä½¿ç”¨çš„æ˜¯Fernetè¿™ä¸ªåº“ï¼Œå®ƒä¼šåˆ›å»ºä¸€ä¸ªå¯†é’¥æ–‡ä»¶ï¼Œå¹¶å€Ÿå¯†é’¥æ–‡ä»¶å¯¹å­—èŠ‚æµè¿›è¡ŒåŠ å¯†å’Œè§£å¯†æ“ä½œã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">from cryptography.fernet import Fernet</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯ï¼ŒFernetæ¡†æ¶ä¸é€‚åˆ<strong>è¿›è¡Œåˆ†ç‰‡åŠ å¯†å’Œè§£å¯†</strong>ã€‚åœ¨æˆ‘çš„å°è¯•ä¸­ï¼Œåˆ†ç‰‡åŠ å¯†æ–‡ä»¶æ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯<strong>è§£å¯†</strong>çš„æ—¶å€™ä¼šå› ä¸ºå¯†é’¥å¯¹ä¸ä¸Šè€Œå‡ºç°å¼‚å¸¸ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cryptography.fernet.InvalidToken â€“ If the token is in any way invalid, this exception is raised. A token may be invalid for a number of reasons: it is older than the ttl, it is malformed, or it does not have a valid signature.</span><br></pre></td></tr></table></figure><p><a href="https://cryptography.io/en/latest/fernet/">å®˜æ–¹æ–‡æ¡£</a>é‡Œé¢æåˆ°äº†ï¼ŒFernetåªé€‚åˆç”¨äºèƒ½<strong>å®Œå…¨åŠ è½½åˆ°å†…å­˜</strong>é‡Œé¢çš„æ•°æ®ï¼Œä¸é€‚åˆç”¨äºå¤„ç†å¤§æ–‡ä»¶ã€‚</p><blockquote><p>Limitations:<br>Fernet is ideal for encrypting data that easily fits in memory. As a design feature it does not expose unauthenticated bytes. This means that the complete message contents must be available in memory, making Fernet generally unsuitable for very large files at this time.</p></blockquote><p>åœ¨å½“å‰å¤‡ä»½æ–‡ä»¶çš„è¿™ä¸ªåœºæ™¯ä¸‹ï¼Œå°†æ–‡ä»¶å…¨éƒ¨åŠ è½½åˆ°å†…å­˜é‡Œé¢æ˜¯ä¸åˆç†çš„ã€‚æ‰€ä»¥éœ€è¦æ¢ä¸€ä¸ªåŠ å¯†&#x2F;è§£å¯†åº“</p><h2 id="pyAesCrypt"><a href="#pyAesCrypt" class="headerlink" title="pyAesCrypt"></a>pyAesCrypt</h2><p>æ”¹ç”¨pyAesCryptäº†ï¼ŒåŠ å¯†å’Œè§£å¯†çš„å¤„ç†éå¸¸ç®€å•ï¼Œä¹Ÿå¯ä»¥åˆ†ç‰‡åŠ è½½ã€‚å¦‚ä¸‹ä»£ç ç¤ºä¾‹ä¸­ï¼Œinput_fileæ˜¯å¾…åŠ å¯†æ–‡ä»¶ï¼Œoutput_fileæ˜¯åŠ å¯†åæ–‡ä»¶ï¼Œpasswordæ˜¯ç”¨æˆ·æä¾›çš„åŠ å¯†å¯†é’¥ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pyAesCrypt</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_file</span>(<span class="params">input_file, output_file, password, buffer_size=<span class="number">64</span> * <span class="number">1024</span></span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(input_file, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> file_in, <span class="built_in">open</span>(output_file, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> file_out:</span><br><span class="line">        pyAesCrypt.encryptStream(file_in, file_out, password, buffer_size)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_file</span>(<span class="params">input_file, output_file, password, buffer_size=<span class="number">64</span> * <span class="number">1024</span></span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(input_file, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> file_in, <span class="built_in">open</span>(output_file, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> file_out:</span><br><span class="line">        pyAesCrypt.decryptStream(file_in, file_out, password, buffer_size)</span><br></pre></td></tr></table></figure><p>åªè¦ç”¨æˆ·è¿˜è®°å¾—ä½è‡ªå·±çš„åŠ å¯†å¯†é’¥ï¼Œé‚£ä¹ˆä»–å°±å¯ä»¥ç”¨è§£å¯†å‡½æ•°å°†æ–‡ä»¶è§£å¯†å‡ºæ¥ã€‚</p><p>AESåŠ å¯†æ˜¯å½“å‰å¹¿æ³›ä½¿ç”¨çš„å¯¹ç§°åŠ å¯†æ–¹å¼ï¼Œè‡³äºå®ƒæ˜¯æ€ä¹ˆå®ç°çš„ï¼Œèƒ½å¦è¢«ç ´è§£éƒ½æ˜¯å¯†ç å­¦çš„èŒƒç•´äº†ã€‚æˆ‘äº†è§£åˆ°çš„ä¿¡æ¯æ˜¯ï¼Œç ´è§£AESåŠ å¯†ç®—æ³•æœ¬èº«çš„æ¶ˆè€—å·¨å¤§ï¼ŒçœŸè¦å»ç ´è§£ï¼Œä¸€èˆ¬éƒ½ä¼šé‡‡ç”¨çŒœæµ‹å¯†é’¥çš„æ–¹å¼ï¼ˆå³çŒœæµ‹ä½ æ˜¯ç”¨ä»€ä¹ˆå¯†é’¥åŠ å¯†çš„è¿™ä¸ªæ–‡ä»¶ï¼‰</p><p>æ‰€ä»¥å½“ä½ éœ€è¦ä½¿ç”¨AESå¯†é’¥æ¥åŠ å¯†æ–‡ä»¶çš„æ—¶å€™ï¼Œä¸€å®šè¦é€‰ç”¨ä¸€ä¸ªå¼ºå¯†é’¥ï¼Œä¿è¯æ•°æ®ä¸è¢«è½»æ˜“çªƒå–ã€‚</p><p>å½“ç„¶ï¼Œæˆ‘çš„é¡¹ç›®ä¸­ï¼ŒåŠ å¯†çš„ç›®çš„å¾ˆå•çº¯ï¼Œå°±æ˜¯ä¸ºäº†é¿<strong>å…ç™¾åº¦äº‘ç›˜æ‰«æˆ‘çš„ç›¸ç‰‡å’Œä¸ªäººæ–‡ä»¶</strong>ã€‚é˜²æ­¢æ–‡ä»¶è¢«çªƒå–åªæ˜¯ä¸ªé™„å¸¦çš„åŠŸèƒ½ã€‚</p><p>å®æµ‹ï¼Œencrypt2bdyé¡¹ç›®ä¸­é‡‡ç”¨pyAesCryptåº“åï¼Œå¤„ç†500MBæ–‡ä»¶çš„è¿‡ç¨‹ä¸­å†…å­˜å ç”¨éƒ½ä¸ä¼šè¶…è¿‡90MBï¼Œéå¸¸å®Œç¾ã€‚</p><h3 id="å¯†é’¥æ³„éœ²é—®é¢˜ï¼Ÿ"><a href="#å¯†é’¥æ³„éœ²é—®é¢˜ï¼Ÿ" class="headerlink" title="å¯†é’¥æ³„éœ²é—®é¢˜ï¼Ÿ"></a>å¯†é’¥æ³„éœ²é—®é¢˜ï¼Ÿ</h3><p>æ›´æ–°åçš„é¡¹ç›®è¿˜æ˜¯é‡‡ç”¨ç¯å¢ƒå˜é‡çš„æ–¹å¼æ¥åŠ è½½ç”¨æˆ·å¯†é’¥ï¼Œè‡³äºç¯å¢ƒå˜é‡æ–¹å¼æ˜¯å¦ä¼šå¯¼è‡´å¯†é’¥æ³„éœ²ï¼šåˆ«äººéƒ½èƒ½çœ‹åˆ°ä½ çš„dockeré…ç½®äº†ï¼Œä»–è¿˜å–ä½ çš„å¯†é’¥å¹²å˜›ï¼Œç›´æ¥æŠŠæœ¬åœ°æºæ–‡ä»¶å·èµ°äº†å¥½å§â€¦â€¦</p><p>å°±ç®—ä¸ç”¨ç¯å¢ƒå˜é‡ï¼Œåœ¨é…ç½®æ–‡ä»¶&#x2F;å‰ç«¯é‡Œé¢å¡«å¯†é’¥ï¼Œæœ€ç»ˆéƒ½è¿˜æ˜¯éœ€è¦ä¸€ä¸ªä½ç½®æ¥å­˜æ”¾è¿™ä¸ªå¯†é’¥ </p><p>é™¤éç›´æ¥æŠŠå¯†é’¥å­˜å†…å­˜é‡Œé¢ï¼Œä¸å†™å…¥ä»»ä½•æ–‡ä»¶ï¼Œä¸”æ¯æ¬¡é‡å¯dockeréƒ½<strong>è¦æ±‚ç”¨æˆ·é‡æ–°å¡«å¯†é’¥</strong>ã€‚ä½†æ˜¯è¿™æ ·ä¼šå¯¼è‡´å®¹å™¨å¯ç”¨æ€§å¾ˆå·®ï¼Œæ¯•ç«Ÿæ¯æ¬¡æ“ä½œdockerå®¹å™¨éƒ½å¾—é‡æ–°å¼„ä¸€ä¸‹é…ç½®ã€‚ä¸è¿‡åç»­ç»™æŸäº›å¯¹éšç§è¦æ±‚é«˜çš„è€å“¥æä¾›è¿™ä¸ªåŠŸèƒ½ä¹Ÿä¸æ˜¯ä¸è¡Œã€‚ï¼ˆè¿™ä¸ªåŠŸèƒ½å¿…é¡»è¦ç­‰å‰ç«¯å†™å‡ºæ¥äº†ä¹‹åæ‰æœ‰å¯èƒ½å®ç°ï¼‰</p><h1 id="åˆ†ç‰‡åŠ å¯†ä¸Šä¼ "><a href="#åˆ†ç‰‡åŠ å¯†ä¸Šä¼ " class="headerlink" title="åˆ†ç‰‡åŠ å¯†ä¸Šä¼ "></a>åˆ†ç‰‡åŠ å¯†ä¸Šä¼ </h1><p>ä¿®æ”¹äº†åŠ å¯†åº“è¿˜æ˜¯ä¸å¤Ÿã€‚æ¥å’Œæˆ‘ä¸€èµ·çœ‹çœ‹å½“å‰é¡¹ç›®ä¸Šä¼ æ–‡ä»¶çš„é€»è¾‘å§ï¼Œå‡è®¾ç”¨æˆ·é€‰æ‹©äº†åŠ å¯†ä¸Šä¼ </p><ul><li>åˆ†ç‰‡è¯»å–æ–‡ä»¶ï¼Œè®¡ç®—æ–‡ä»¶md5ç”¨äºæœ¬åœ°å…¥åº“</li><li>åˆ†ç‰‡è¯»å–å’ŒåŠ å¯†æ–‡ä»¶ï¼Œå¹¶å°†<strong>åŠ å¯†åæ–‡ä»¶</strong>æ·»åŠ <code>.e2bdy</code>åç¼€å†™å…¥æºç›®å½•</li><li><strong>åˆ†ç‰‡è¯»å–å’Œä¸Šä¼ </strong>åŠ å¯†åæ–‡ä»¶</li><li>ä¸Šä¼ å®Œæ¯•ï¼Œåˆ é™¤åŠ å¯†åæ–‡ä»¶ï¼ˆåªä¿ç•™æºæ–‡ä»¶ï¼‰</li><li>å¾ªç¯å¤„ç†ï¼Œç›´åˆ°é€‰å®šç›®å½•ä¸­æ‰€æœ‰æ–‡ä»¶éƒ½è¢«å¤„ç†å®Œæ¯•ã€‚</li></ul><p>æ•´ä¸ªç¨‹åºé€»è¾‘éƒ½é‡‡ç”¨äº†åˆ†ç‰‡è¯»å–æ–‡ä»¶ï¼Œå†…å­˜å ç”¨é—®é¢˜æ˜¯è§£å†³äº†ï¼Œä½†è¿˜æœ‰å¦å¤–ä¸€ä¸ªé—®é¢˜æ²¡æœ‰è§£å†³ï¼šåŠ å¯†åæ–‡ä»¶éœ€è¦å†™å…¥ç£ç›˜ï¼Œä¸Šä¼ ååˆè¢«åˆ é™¤ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå‡è®¾æˆ‘éœ€è¦å¤‡ä»½100GBçš„æ–‡ä»¶ï¼Œé‚£ä¹ˆç£ç›˜å°±ä¼šå¤šå‡º100GBçš„æ•°æ®æ“¦å†™â€¦â€¦ç¨‹åºä¹Ÿéœ€è¦ç´¯ç§¯ç­‰å¾…100GBçš„ç£ç›˜å†™å…¥ï¼Œå¦‚æœæ˜¯æœºæ¢°ç¡¬ç›˜â€¦â€¦</p><p>è€Œä¸”ï¼Œç£ç›˜è¿˜éœ€è¦<strong>ä¿ç•™æœ‰è¶³é‡ç©ºé—´</strong>æ¥å­˜æ”¾è¿™ä¸ªä¸´æ—¶çš„åŠ å¯†æ–‡ä»¶ï¼Œå‡è®¾æˆ‘æƒ³å¤‡ä»½ä¸€ä¸ª10GBçš„å•ä¸ªæ–‡ä»¶ï¼Œç£ç›˜å‰©ä½™å¯ç”¨ç©ºé—´åªå‰©5GBäº†ï¼Œæ­¤æ—¶ç¨‹åº<strong>å°±æ— æ³•å°†åŠ å¯†åçš„æ–‡ä»¶å†™å…¥ç£ç›˜</strong>ï¼ˆä¸€èˆ¬åŠ å¯†åçš„æ–‡ä»¶ä¼šæ¯”åŸå§‹æ–‡ä»¶ç•¥å¤§ä¸€äº›ï¼‰ï¼Œå¯¼è‡´æ— æ³•å¤„ç†è¿™ä¸ªæ–‡ä»¶äº†ã€‚</p><p>è¿™æ ·è‚¯å®šä¸è¡Œï¼æ‰€ä»¥æˆ‘æ¢äº†ä¸€ä¸ªæ€è·¯ï¼Œç™¾åº¦äº‘ç›˜è¦æ±‚æ•°æ®æŒ‰4MBçš„åˆ†ç‰‡è°ƒç”¨APIä¸Šä¼ ï¼Œ<strong>é‚£ä¹ˆæˆ‘ä»¬å¯å¦æ¯æ¬¡è¯»å–4MBçš„æ–‡ä»¶å†…å®¹ï¼ŒåŠ å¯†å®ƒå¹¶ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œéšåç›´æ¥ä¸Šä¼ è¿™ä¸ªåˆ†ç‰‡å‘¢</strong>ï¼Ÿè¿™æ ·æ•´ä¸ªçš„å¤„ç†æµç¨‹ä¸­ï¼Œéƒ½æ˜¯åˆ†ç‰‡ååœ¨å†…å­˜ä¸­å¤„ç†ï¼Œä¹Ÿä¸ä¼šå¤šå‡ºæ¥ä¸€ä¸ªä¸´æ—¶çš„åŠ å¯†æ–‡ä»¶å¯¼è‡´çš„æ•°æ®æ“¦å†™ï¼Œé¡¹ç›®å¯ç”¨æ€§æé«˜ï¼</p><p>é—®äº†GPTï¼Œå†™äº†ä¸ªè¿™æ ·çš„ç¤ºä¾‹ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> pyAesCrypt</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠ å¯†å‡½æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_chunk</span>(<span class="params">chunk_data, password</span>):</span><br><span class="line">    <span class="comment"># åŠ å¯†æ•°æ®å—</span></span><br><span class="line">    <span class="keyword">with</span> io.BytesIO() <span class="keyword">as</span> block_encrypted:</span><br><span class="line">        pyAesCrypt.encryptStream(</span><br><span class="line">            io.BytesIO(chunk_data),</span><br><span class="line">            block_encrypted,</span><br><span class="line">            password</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        <span class="comment"># è¿”å›åŠ å¯†åçš„æ•°æ®</span></span><br><span class="line">        <span class="keyword">return</span> block_encrypted.getvalue()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸Šä¼ å‡½æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upload_chunk_to_cloud</span>(<span class="params">chunk_data</span>):</span><br><span class="line">    <span class="comment"># å°†åŠ å¯†åçš„æ•°æ®å—ä¸Šä¼ åˆ°äº‘ç«¯</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸»ç¨‹åº</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    src_path = <span class="string">&#x27;path/to/source/file&#x27;</span></span><br><span class="line">    password = <span class="string">&#x27;your-password&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(src_path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> src_file:</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="comment"># è¯»å–ä¸€ä¸ªæ•°æ®å—</span></span><br><span class="line">            chunk = src_file.read(<span class="number">4</span> * <span class="number">1024</span> * <span class="number">1024</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> chunk:</span><br><span class="line">                <span class="comment"># æ•°æ®å—è¯»å–å®Œæ¯•ï¼Œé€€å‡ºå¾ªç¯</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># åŠ å¯†æ•°æ®å—</span></span><br><span class="line">            encrypted_chunk = encrypt_chunk(chunk, password)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># ä¸Šä¼ åŠ å¯†åçš„æ•°æ®å—åˆ°äº‘ç«¯</span></span><br><span class="line">            upload_chunk_to_cloud(encrypted_chunk)</span><br></pre></td></tr></table></figure><p>ç°åœ¨æˆ‘è¦åšçš„ï¼Œå°±æ˜¯éªŒè¯ä¸€ä¸‹è¿™æ ·æ“ä½œæ˜¯å¦èƒ½ä¸Šä¼ æˆåŠŸã€æ˜¯å¦èƒ½è§£å¯†ä¸Šä¼ åçš„æ–‡ä»¶ï¼Œç„¶åå†çœ‹çœ‹å†…å­˜å ç”¨å¤šå°‘ã€‚</p><h2 id="åˆ†ç‰‡åŠ å¯†å’Œç›´æ¥åŠ å¯†åŒºåˆ«"><a href="#åˆ†ç‰‡åŠ å¯†å’Œç›´æ¥åŠ å¯†åŒºåˆ«" class="headerlink" title="åˆ†ç‰‡åŠ å¯†å’Œç›´æ¥åŠ å¯†åŒºåˆ«"></a>åˆ†ç‰‡åŠ å¯†å’Œç›´æ¥åŠ å¯†åŒºåˆ«</h2><p>ç„¶è€Œç¬¬ä¸€éƒ¨æˆ‘å°±å¡ä½äº†ï¼šç™¾åº¦äº‘ç›˜çš„APIè¦æ±‚ä¸Šä¼ å‰å…ˆä¼ å…¥æ–‡ä»¶çš„å®Œæ•´md5ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong>æˆ‘å¾—æƒ³ä¸ªåŠæ³•æ‹¿åˆ°åŠ å¯†åæ–‡ä»¶çš„å®Œæ•´md5</strong>ï¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> pyAesCrypt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠ å¯†å‡½æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_chunk</span>(<span class="params">chunk_data, password</span>):</span><br><span class="line">    <span class="comment"># åŠ å¯†æ•°æ®å—</span></span><br><span class="line">    <span class="keyword">with</span> io.BytesIO() <span class="keyword">as</span> block_encrypted:</span><br><span class="line">        pyAesCrypt.encryptStream(io.BytesIO(chunk_data), block_encrypted,</span><br><span class="line">                                 password)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># è¿”å›åŠ å¯†åçš„æ•°æ®</span></span><br><span class="line">        <span class="keyword">return</span> block_encrypted.getvalue()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_file</span>(<span class="params">input_file_path: <span class="built_in">str</span>, passwd</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    åŠ å¯†æ–‡ä»¶ï¼Œé‡‡ç”¨åˆ†ç‰‡è¯»å–</span></span><br><span class="line"><span class="string">    :param input_file_pathï¼š éœ€è¦åŠ å¯†çš„æºæ–‡ä»¶</span></span><br><span class="line"><span class="string">    :return åŠ å¯†åçš„æ–‡ä»¶è·¯å¾„</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    encrypt_file_path = input_file_path + <span class="string">&quot;.ept&quot;</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(input_file_path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> file_in, <span class="built_in">open</span>(encrypt_file_path,</span><br><span class="line">                                                      <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> file_out:</span><br><span class="line">        pyAesCrypt.encryptStream(file_in, file_out, passwd, <span class="number">4</span> * <span class="number">1024</span> * <span class="number">1024</span>)</span><br><span class="line">    <span class="keyword">return</span> encrypt_file_path</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸»ç¨‹åº</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    src_path = <span class="string">&#x27;/home/mu/code-wsl/py-wsl/encrypt2bdy/test/CloudDrive2Setup-X64-0.5.14.exe&#x27;</span></span><br><span class="line">    password = <span class="string">&#x27;test&#x27;</span></span><br><span class="line">    ept_file_path = encrypt_file(src_path,password)</span><br><span class="line">    <span class="comment"># è¯»å–åŠ å¯†åæ–‡ä»¶è®¡ç®—md5</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(ept_file_path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        file_md5_str = hashlib.md5(f.read()).hexdigest()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;full encrypt&quot;</span>,file_md5_str)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># åˆ†ç‰‡åŠ å¯†å¹¶è®¡ç®—md5</span></span><br><span class="line">    file_md5_str = hashlib.md5()</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(src_path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> src_file:</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="comment"># è¯»å–ä¸€ä¸ªæ•°æ®å—</span></span><br><span class="line">            chunk = src_file.read(<span class="number">4</span> * <span class="number">1024</span> * <span class="number">1024</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> chunk:</span><br><span class="line">                <span class="comment"># æ•°æ®å—è¯»å–å®Œæ¯•ï¼Œé€€å‡ºå¾ªç¯</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># åŠ å¯†æ•°æ®å—</span></span><br><span class="line">            encrypted_chunk = encrypt_chunk(chunk, password)</span><br><span class="line">            file_md5_str.update(encrypted_chunk)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;chunk encrypt&quot;</span>,file_md5_str.hexdigest())</span><br></pre></td></tr></table></figure><p>åˆ†ç‰‡åŠ å¯†åçš„æ•´ä¸ªæ–‡ä»¶ï¼Œå’Œç›´æ¥åŠ å¯†çš„æ–‡ä»¶è‚¯å®šæ˜¯ä¸ä¸€æ ·çš„ï¼Œå³ä¾¿è¿™ä¸¤ä¸ªæ“ä½œéƒ½ç”¨äº†ç›¸åŒå¤§å°çš„åˆ†ç‰‡å—ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">â•°â”€ python3.10 test.py</span><br><span class="line">full encrypt e994f5c7244fa7d6e9577e2089a029bc</span><br><span class="line">chunk encrypt bdd05213bcafe4f87470c90633d7c2bc</span><br></pre></td></tr></table></figure><p>ä½†å¦‚æœæŠŠåˆ†ç‰‡åçš„æ–‡ä»¶å†™å…¥æœ¬åœ°ï¼Œå†è®¡ç®—md5ï¼Œä¼šå‘ç°äºŒè€…ç›¸åŒ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ†ç‰‡åŠ å¯†å¹¶è®¡ç®—md5</span></span><br><span class="line">file_md5_str = hashlib.md5()</span><br><span class="line">chunk_encrpy_file = src_path + <span class="string">&#x27;.test&#x27;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(chunk_encrpy_file,<span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> ef:</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(src_path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> src_file:</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="comment"># è¯»å–ä¸€ä¸ªæ•°æ®å—</span></span><br><span class="line">            chunk = src_file.read(<span class="number">4</span> * <span class="number">1024</span> * <span class="number">1024</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> chunk:</span><br><span class="line">                <span class="comment"># æ•°æ®å—è¯»å–å®Œæ¯•ï¼Œé€€å‡ºå¾ªç¯</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># åŠ å¯†æ•°æ®å—</span></span><br><span class="line">            encrypted_chunk = encrypt_chunk(chunk, password)</span><br><span class="line">            file_md5_str.update(encrypted_chunk)</span><br><span class="line">            ef.write(encrypted_chunk)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;chunk encrypt&quot;</span>,file_md5_str.hexdigest())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;chunk encrypt file:&quot;</span>,file_md5(chunk_encrpy_file))</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chunk encrypt 843ef6583227592da36e563c1700d0da</span><br><span class="line">chunk encrypt file: 843ef6583227592da36e563c1700d0da</span><br></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œè™½ç„¶è¿™ç§æ–¹å¼å’Œç›´æ¥åŠ å¯†æ•´ä¸ªæ–‡ä»¶ï¼Œ<strong>å¾—åˆ°çš„æœ€ç»ˆæ–‡ä»¶æ˜¯ä¸ä¸€æ ·çš„</strong>ï¼Œä½†æˆ‘ä»¬ä¾æ—§å¯ä»¥é€šè¿‡ç”¨ç›¸åŒåŠæ³•è¿›è¡ŒåŠ å¯†å’Œè§£å¯†æ“ä½œï¼Œæ¥è¿›è¡Œåˆ†ç‰‡åŠ å¯†ä¸Šä¼ å’Œåˆ†ç‰‡è§£å¯†æ–‡ä»¶ï¼ˆå—ï¼Ÿï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">raise ValueError(&quot;Bad HMAC (file is corrupted).&quot;)</span><br></pre></td></tr></table></figure><p>æ— æ³•è§£å¯†â€¦â€¦Gï¼</p><p>è¦æœŸæœ«äº†ï¼Œç­‰æ”¾å‡äº†å†ç»§ç»­ç ”ç©¶è¿™ä¸ªé—®é¢˜</p>]]></content>
    
    
    <summary type="html">Pythonå®ç°æ–‡ä»¶åˆ†ç‰‡åŠ å¯†å’Œä¸Šä¼ ï¼ˆæœªå®ç°ï¼‰</summary>
    
    
    
    <category term="é€Ÿé€šPython" scheme="https://blog.musnow.top/categories/%E9%80%9F%E9%80%9APython/"/>
    
    
    <category term="Python" scheme="https://blog.musnow.top/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>ã€Pythonã€‘Pythonåˆ†ç‰‡è®¡ç®—æ–‡ä»¶md5</title>
    <link href="https://blog.musnow.top/posts/1918073551/"/>
    <id>https://blog.musnow.top/posts/1918073551/</id>
    <published>2023-12-17T11:52:00.000Z</published>
    <updated>2023-12-17T11:52:00.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="é—®é¢˜è¯´æ˜"><a href="#é—®é¢˜è¯´æ˜" class="headerlink" title="é—®é¢˜è¯´æ˜"></a>é—®é¢˜è¯´æ˜</h1><blockquote><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/musnows/encrypt2bdy">musnows&#x2F;encrypt2bdy</a></p></blockquote><p>ä¹‹å‰è‡ªå·±çå†™äº†ä¸€ä¸ªä¸Šä¼ æ–‡ä»¶åˆ°ç™¾åº¦äº‘çš„pythonç¨‹åºï¼Œæä¾›äº†dockerå¹¶éƒ¨ç½²åœ¨äº†æˆ‘è‡ªå·±çš„nasä¸Šï¼Œä½†æ˜¯æˆ‘é™åˆ¶å®¹å™¨å¯ç”¨å†…å­˜å¤§å°ä¸º1GBåï¼Œæ€»æ˜¯ä¼šé‡åˆ°dockerå› ä¸º<strong>å†…å­˜çˆ†æ»¡</strong>ç›´æ¥è¢«ç³»ç»Ÿkilläº†çš„æƒ…å†µã€‚</p><p>ç°åœ¨æ€»ç®—æœ‰æ—¶é—´çœ‹çœ‹åˆ°åº•æ˜¯å•¥é—®é¢˜äº†ï¼Œå…¶å®æˆ‘å·²ç»èƒ½æƒ³åˆ°äº†ï¼Œä¸Šä¼ æ–‡ä»¶çš„éƒ¨åˆ†å·²ç»æ˜¯æŒ‰åˆ†ç‰‡ä¸Šä¼ çš„ï¼Œç†è®ºä¸Šä¸æ˜¯é‚£ä¸ªåœ°æ–¹çš„é—®é¢˜ï¼Œå¦å¤–ä¸€ä¸ªæ‰“å¼€æ–‡ä»¶çš„åœ°æ–¹åªæœ‰ä¸€å¤„ï¼Œå°±æ˜¯è®¡ç®—æ–‡ä»¶æ•´ä½“md5çš„æ“ä½œã€‚</p><p>å› ä¸ºå½“æ—¶æ²¡æƒ³æ˜ç™½é—®é¢˜åœ¨å“ªé‡Œï¼Œæˆ‘è¿˜åœ¨é¡¹ç›®çš„READMEé‡Œé¢å†™äº†ä¸€ä¸ªä¸å»ºè®®ç”¨äºå¤‡ä»½å¤§æ–‡ä»¶ï¼Œå› ä¸ºå†…å­˜ä¼šæ’‘çˆ†çš„æç¤ºï¼ˆ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">## å·²çŸ¥é”™è¯¯</span><br><span class="line"></span><br><span class="line">### 1.dockeré€€å‡ºç 137</span><br><span class="line"></span><br><span class="line">å†…å­˜ä¸è¶³æ—¶ï¼Œç³»ç»Ÿå°†å¯¹åº”dockerå®¹å™¨ç»ˆæ­¢ã€‚å‡ºç°æ­¤é—®é¢˜ï¼Œè¯·ç¡®è®¤æ‚¨è¦å¤‡ä»½çš„æ–‡ä»¶ä¸­ä¸ä¼šå‡ºç°å¤§äºæ‚¨ç³»ç»Ÿå†…å­˜æˆ–dockerå®¹å™¨å†…å­˜é™åˆ¶çš„æ–‡ä»¶ã€‚</span><br><span class="line"></span><br><span class="line">æ­£å¦‚å¼€å¤´æ‰€è¯´ï¼Œæœ¬é¡¹ç›®é€‚åˆäºå¤‡ä»½ç…§ç‰‡ã€å›¾ç‰‡ã€æ–‡æ¡£ç­‰å°æ–‡ä»¶ï¼Œå¹¶ä¸å»ºè®®ç”¨äºå¤‡ä»½å½•åƒã€ç”µå½±ç­‰èµ„æºã€‚</span><br></pre></td></tr></table></figure><h2 id="åŸæœ‰ä»£ç è¯»å–md5çš„æ–¹å¼"><a href="#åŸæœ‰ä»£ç è¯»å–md5çš„æ–¹å¼" class="headerlink" title="åŸæœ‰ä»£ç è¯»å–md5çš„æ–¹å¼"></a>åŸæœ‰ä»£ç è¯»å–md5çš„æ–¹å¼</h2><p>åœ¨ç¨‹åºä¸­ï¼Œæˆ‘è®¡ç®—æ–‡ä»¶æ•´ä½“md5çš„æ“ä½œæ˜¯è¿™æ ·å†™çš„</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ‰“å¼€æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">file_bytes = f.read()</span><br><span class="line"><span class="comment"># 1.è®¡ç®—æ–‡ä»¶md5ï¼Œåˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨äºæ•°æ®ä¸­</span></span><br><span class="line">file_name = os.path.basename(file_path)  <span class="comment"># æ–‡ä»¶å</span></span><br><span class="line">file_md5_str = hashlib.md5(file_bytes).hexdigest()</span><br><span class="line">_log.debug(<span class="string">f&quot;<span class="subst">&#123;file_path&#125;</span> | <span class="subst">&#123;file_md5_str&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>é—®é¢˜å…¶å®å¾ˆæ˜æœ—ï¼Œå°±æ˜¯è¿™é‡Œçš„<code>f.read()</code>æ“ä½œç›´æ¥å°†<strong>æ•´ä¸ªæ–‡ä»¶åŠ è½½åˆ°å†…å­˜é‡Œé¢</strong>äº†ï¼å¤‡ä»½çš„æ–‡ä»¶ç¨å¾®å¤§ä¸€ç‚¹ï¼ŒæŒ‡å®šè¦æŠŠå†…å­˜æ•´çˆ†çš„ï¼</p><h2 id="åˆ†ç‰‡è¯»å–md5"><a href="#åˆ†ç‰‡è¯»å–md5" class="headerlink" title="åˆ†ç‰‡è¯»å–md5"></a>åˆ†ç‰‡è¯»å–md5</h2><p>è¿™éƒ¨åˆ†ä»£ç åº”è¯¥æ›¿æ¢ä¸ºå¦‚ä¸‹å½¢å¼ï¼Œåˆ†ç‰‡è¯»å–æ–‡ä»¶ï¼Œå¹¶å°†è¯»å–çš„md5ç»™updateåˆ°<code>hashlib.md5()</code>å¯¹è±¡ä¸­</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">file_md5</span>(<span class="params">file_path: <span class="built_in">str</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ç»™å®šä¸€ä¸ªæ–‡ä»¶è·¯å¾„ï¼Œåˆ†ç‰‡åŠ è½½æ–‡ä»¶ï¼Œè®¡ç®—æ–‡ä»¶çš„md5&quot;&quot;&quot;</span></span><br><span class="line">    chunk_size = <span class="number">4096</span>  <span class="comment"># æ ¹æ®éœ€è¦è°ƒæ•´å•å—çš„å¤§å°</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        file_md5 = hashlib.md5()</span><br><span class="line">        <span class="keyword">while</span> chunk := f.read(chunk_size):</span><br><span class="line">            file_md5.update(chunk)</span><br><span class="line">    <span class="keyword">return</span> file_md5.hexdigest()</span><br></pre></td></tr></table></figure><p>ç»è¿‡æµ‹è¯•ï¼Œè¿™ç§åŠæ³•è®¡ç®—å‡ºæ¥çš„md5å’Œç›´æ¥<code>f.read()</code>å…¨éƒ¨è®¡ç®—å‡ºçš„md5å®Œå…¨ä¸€è‡´</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">â•°â”€ python3.10 test.py                 </span><br><span class="line">ca60e24bf4dde156a381c8b9d268faf5</span><br><span class="line">ca60e24bf4dde156a381c8b9d268faf5</span><br></pre></td></tr></table></figure><h1 id="å†…å­˜å ç”¨ç›‘æ§çº¿ç¨‹"><a href="#å†…å­˜å ç”¨ç›‘æ§çº¿ç¨‹" class="headerlink" title="å†…å­˜å ç”¨ç›‘æ§çº¿ç¨‹"></a>å†…å­˜å ç”¨ç›‘æ§çº¿ç¨‹</h1><p>ç”¨ä¸‹é¢çš„ä»£ç å¼„ä¸ªå†…å­˜å ç”¨çš„ç›‘æ§çº¿ç¨‹ï¼Œé€šè¿‡psutilåº“å®æ—¶æ‰“å°å†…å­˜å ç”¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> psutil</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">monitor_memory_usage</span>():</span><br><span class="line">    process = psutil.Process(os.getpid())</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        memory_info = process.memory_info()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Memory used: <span class="subst">&#123;memory_info.rss / (<span class="number">1024</span> * <span class="number">1024</span>):<span class="number">.2</span>f&#125;</span> MB&quot;</span>)</span><br><span class="line">        time.sleep(<span class="number">1</span>)  <span class="comment"># æ¯ç§’æ›´æ–°ä¸€æ¬¡å†…å­˜ä¿¡æ¯</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹æ¥ç›‘è§†å†…å­˜ä½¿ç”¨æƒ…å†µ</span></span><br><span class="line">memory_monitor_thread = threading.Thread(target=monitor_memory_usage)</span><br><span class="line">memory_monitor_thread.start()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸»çº¿ç¨‹ç»§ç»­æ‰§è¡Œå…¶ä»–ä»»åŠ¡</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç­‰å¾…ç›‘è§†çº¿ç¨‹ç»“æŸï¼ˆå¦‚æœéœ€è¦ï¼‰</span></span><br><span class="line">memory_monitor_thread.join()</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="å†…å­˜å ç”¨æµ‹è¯•"><a href="#å†…å­˜å ç”¨æµ‹è¯•" class="headerlink" title="å†…å­˜å ç”¨æµ‹è¯•"></a>å†…å­˜å ç”¨æµ‹è¯•</h2><p>å°†é¡¹ç›®ä¸­ä¸Šä¼ åˆ°ç™¾åº¦äº‘çš„éƒ¨åˆ†æ³¨é‡Šæ‰ï¼Œä¼‘çœ 10ç§’æ›¿ä»£ä¸Šä¼ æ“ä½œï¼Œæ¨¡æ‹ŸåŸæœ‰ä»£ç æ•´ä½“æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ï¼Œåˆåˆ†ç‰‡æ‰“å¼€æ–‡ä»¶ä¸Šä¼ åˆ°ç™¾åº¦äº‘çš„æµç¨‹ã€‚</p><p>ç”¨ä¸¤ä¸ª450MBå·¦å³çš„è§†é¢‘åšæµ‹è¯•ã€‚ç¨‹åºåŸæœ‰æ€è·¯æ˜¯éå†éœ€è¦å¤‡ä»½ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶ï¼Œåˆ†ç‰‡ä¸Šä¼ åˆ°ç™¾åº¦äº‘ã€‚è®¡ç®—æ•´ä¸ªæ–‡ä»¶çš„MD5çš„æ“ä½œå…¶å®æ˜¯ç”¨æ¥<strong>æœ¬åœ°å…¥åº“</strong>æ ‡å®šæ–‡ä»¶æ˜¯å¦æœ‰ä¿®æ”¹ã€æ˜¯å¦å·²ç»ä¸Šä¼ çš„ã€‚</p><p>ä¸è¿‡åç»­<strong>åŠ å¯†æ–‡ä»¶</strong>çš„æ“ä½œä¹Ÿæ˜¯æ— è„‘<code>f.read()</code>ï¼Œè¿™éƒ¨åˆ†ä¹Ÿéœ€è¦ä¿®æ”¹ã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/f053a510be9127854a6a2102cac8589f.png" alt="image.png"></p><p>æ—¥å¿—è¾“å‡ºå¦‚ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œå¼€å§‹å¤„ç†testç›®å½•ä¹‹åï¼Œç¨‹åºç›´æ¥æŠŠè§†é¢‘å®Œæ•´åŠ è½½åˆ°äº†å†…å­˜é‡Œé¢ï¼Œå ç”¨å†…å­˜çš„å¤§å°å’Œè§†é¢‘æ–‡ä»¶å¤§å°åŸºæœ¬ä¸€è‡´ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">â•°â”€ python3.10 main.py</span><br><span class="line">[23-12-17 20:01:22] INFO:confLoad.py:&lt;module&gt;:68 | [config] loaded config from &#x27;./config/config.yml&#x27;</span><br><span class="line">[23-12-17 20:01:22] INFO:confLoad.py:&lt;module&gt;:89 | [config] loaded config success</span><br><span class="line">[23-12-17 20:01:22] INFO:querySql.py:&lt;module&gt;:72 | [sqlite3] create all tables</span><br><span class="line">[23-12-17 20:01:23] INFO:main.py:&lt;module&gt;:294 | [start] start at 23-12-17 20:01:23</span><br><span class="line">[23-12-17 20:01:23] INFO:encrypt.py:__init__:24 | load key file from &#x27;./config/encrypt.key&#x27;</span><br><span class="line">Memory used: 39.18 MB</span><br><span class="line">[23-12-17 20:01:23] INFO:main.py:upload_task:132 | ä¸Šä¼ ä»»åŠ¡å¼€å§‹ï¼š23-12-17 20:01:23</span><br><span class="line">[23-12-17 20:01:23] INFO:main.py:upload_task:139 | å¼€å§‹å¤„ç†è·¯å¾„ &#x27;/home/mu/code-wsl/py-wsl/encrypt2bdy/test&#x27; | æ–‡ä»¶æ•°é‡ 2</span><br><span class="line">[23-12-17 20:01:23] INFO:main.py:upload_task:144 | [0] å¼€å§‹å¤„ç† &#x27;/home/mu/code-wsl/py-wsl/encrypt2bdy/test/ã€è¶…ä¸æ»‘60å¸§ã€‘4Kç²¾è£…å­—å¹•ç‰ˆã€ŠILLSHOWYOUã€‹KDAé˜¿ç‹¸.mp4&#x27;</span><br><span class="line">Memory used: 483.52 MB</span><br><span class="line">Memory used: 483.52 MB</span><br><span class="line">Memory used: 483.52 MB</span><br><span class="line">Memory used: 483.52 MB</span><br><span class="line">Memory used: 483.52 MB</span><br><span class="line">Memory used: 483.52 MB</span><br><span class="line">Memory used: 483.52 MB</span><br><span class="line">Memory used: 483.52 MB</span><br><span class="line">Memory used: 483.52 MB</span><br><span class="line">Memory used: 483.52 MB</span><br><span class="line">[23-12-17 20:01:33] INFO:main.py:upload_task:237 | [1] æˆåŠŸä¸Šä¼  &#x27;/home/mu/code-wsl/py-wsl/encrypt2bdy/test/ã€è¶…ä¸æ»‘60å¸§ã€‘4Kç²¾è£…å­—å¹•ç‰ˆã€ŠILLSHOWYOUã€‹KDAé˜¿ç‹¸.mp4&#x27; æ–‡ä»¶å“ˆå¸Œï¼š7d5735eba55a638a1290ab36e00530ca</span><br><span class="line">[23-12-17 20:01:33] INFO:main.py:upload_task:144 | [1] å¼€å§‹å¤„ç† &#x27;/home/mu/code-wsl/py-wsl/encrypt2bdy/test/ã€è¶…ä¸æ»‘60å¸§ã€‘4Kç²¾è£…å­—å¹•ç‰ˆã€ŠMOREã€‹KDA.mp4&#x27;</span><br><span class="line">Memory used: 517.39 MB</span><br><span class="line">Memory used: 517.39 MB</span><br><span class="line">Memory used: 517.39 MB</span><br><span class="line">Memory used: 517.39 MB</span><br><span class="line">Memory used: 517.39 MB</span><br><span class="line">Memory used: 517.39 MB</span><br><span class="line">Memory used: 517.39 MB</span><br><span class="line">Memory used: 517.39 MB</span><br><span class="line">Memory used: 517.39 MB</span><br><span class="line">Memory used: 517.39 MB</span><br><span class="line">Memory used: 517.39 MB</span><br><span class="line">[23-12-17 20:01:44] INFO:main.py:upload_task:237 | [2] æˆåŠŸä¸Šä¼  &#x27;/home/mu/code-wsl/py-wsl/encrypt2bdy/test/ã€è¶…ä¸æ»‘60å¸§ã€‘4Kç²¾è£…å­—å¹•ç‰ˆã€ŠMOREã€‹KDA.mp4&#x27; æ–‡ä»¶å“ˆå¸Œï¼šb7b0cd46e3ac7681a3644d9761ad3e71</span><br><span class="line">[23-12-17 20:01:44] INFO:main.py:upload_task:282 | æœ¬æ¬¡ä¸Šä¼ å®Œæ¯•ï¼Œä¸Šä¼ ï¼š2ï¼Œè·³è¿‡ï¼š0ï¼Œé”™è¯¯ï¼š0 | æ€»è®¡ï¼š2</span><br><span class="line">[23-12-17 20:01:44] INFO:main.py:upload_task:283 | æœ¬æ¬¡ä¸Šä¼ å®Œæ¯•ï¼Œå¹³å‡ä¸Šä¼ é€Ÿåº¦ï¼š43.143mb/s | æ€»è€—æ—¶ï¼š21.16s</span><br><span class="line">[23-12-17 20:01:44] INFO:main.py:upload_task:286 | æœ¬æ¬¡ä¸Šä¼ å®Œæ¯•ï¼Œä¸‹æ¬¡å¤„ç†ï¼š2023-12-17 21:00:00</span><br></pre></td></tr></table></figure><p>å¸¦ä¸ŠåŠ å¯†ä¹‹åæ›´åŠ ç¦»è°±ï¼Œåªæ˜¯ç¬¬ä¸€ä¸ªæ–‡ä»¶å°±ç›´æ¥æŠŠå†…å­˜å ç”¨å¹²åˆ°äº†3.2GBï¼Œå¤„ç†ç¬¬äºŒä¸ªæ–‡ä»¶çš„æ—¶å€™ï¼Œä¹Ÿæ˜¯ç›´æ¥å¹²åˆ°äº†2.4GBï¼Œè¿™ç§ç¨‹åº¦çš„å†…å­˜æ¶ˆè€—è°é¡¶å¾—ä½ï¼Ÿæ›´ä½•å†µç™¾åº¦äº‘APIæœ€å¤§æ”¯æŒ10GBçš„æ–‡ä»¶ä¸Šä¼ ï¼Œå¦‚æœè¦åŠ è½½ä¸€ä¸ª10GBçš„æ–‡ä»¶è¿˜å¾—äº†å•Šï¼Ÿ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">â•°â”€ python3.10 main.py</span><br><span class="line">[23-12-17 19:43:56] INFO:confLoad.py:&lt;module&gt;:68 | [config] loaded config from &#x27;./config/config.yml&#x27;</span><br><span class="line">[23-12-17 19:43:56] INFO:confLoad.py:&lt;module&gt;:89 | [config] loaded config success</span><br><span class="line">[23-12-17 19:43:56] INFO:querySql.py:&lt;module&gt;:72 | [sqlite3] create all tables</span><br><span class="line">[23-12-17 19:43:56] INFO:main.py:&lt;module&gt;:291 | [start] start at 23-12-17 19:43:56</span><br><span class="line">Memory used: 39.31 MB</span><br><span class="line">[23-12-17 19:43:56] INFO:encrypt.py:__init__:24 | load key file from &#x27;./config/encrypt.key&#x27;</span><br><span class="line">[23-12-17 19:43:56] INFO:main.py:upload_task:132 | ä¸Šä¼ ä»»åŠ¡å¼€å§‹ï¼š23-12-17 19:43:56</span><br><span class="line">[23-12-17 19:43:56] INFO:main.py:upload_task:139 | å¼€å§‹å¤„ç†è·¯å¾„ &#x27;/home/mu/code-wsl/py-wsl/encrypt2bdy/test&#x27; | æ–‡ä»¶æ•°é‡ 2</span><br><span class="line">Memory used: 923.04 MB</span><br><span class="line">Memory used: 3267.48 MB</span><br><span class="line">Memory used: 483.71 MB</span><br><span class="line">Memory used: 483.71 MB</span><br><span class="line">Memory used: 483.71 MB</span><br><span class="line">Memory used: 483.71 MB</span><br><span class="line">Memory used: 483.71 MB</span><br><span class="line">Memory used: 483.71 MB</span><br><span class="line">Memory used: 483.71 MB</span><br><span class="line">Memory used: 483.71 MB</span><br><span class="line">Memory used: 483.71 MB</span><br><span class="line">Memory used: 483.71 MB</span><br><span class="line">[23-12-17 19:44:08] INFO:main.py:upload_task:234 | [1] æˆåŠŸä¸Šä¼  &#x27;/home/mu/code-wsl/py-wsl/encrypt2bdy/test/ã€è¶…ä¸æ»‘60å¸§ã€‘4Kç²¾è£…å­—å¹•ç‰ˆã€ŠILLSHOWYOUã€‹KDAé˜¿ç‹¸.mp4&#x27; æ–‡ä»¶å“ˆå¸Œï¼š7d5735eba55a638a1290ab36e00530ca</span><br><span class="line">Memory used: 990.96 MB</span><br><span class="line">Memory used: 2410.97 MB</span><br><span class="line">Memory used: 1622.17 MB</span><br><span class="line">Memory used: 517.57 MB</span><br><span class="line">Memory used: 517.57 MB</span><br><span class="line">Memory used: 517.57 MB</span><br><span class="line">Memory used: 517.57 MB</span><br><span class="line">Memory used: 517.57 MB</span><br><span class="line">Memory used: 517.57 MB</span><br><span class="line">Memory used: 517.57 MB</span><br><span class="line">Memory used: 517.57 MB</span><br><span class="line">Memory used: 517.57 MB</span><br><span class="line">Memory used: 517.57 MB</span><br><span class="line">[23-12-17 19:44:22] INFO:main.py:upload_task:234 | [2] æˆåŠŸä¸Šä¼  &#x27;/home/mu/code-wsl/py-wsl/encrypt2bdy/test/ã€è¶…ä¸æ»‘60å¸§ã€‘4Kç²¾è£…å­—å¹•ç‰ˆã€ŠMOREã€‹KDA.mp4&#x27; æ–‡ä»¶å“ˆå¸Œï¼šb7b0cd46e3ac7681a3644d9761ad3e71</span><br><span class="line">[23-12-17 19:44:22] INFO:main.py:upload_task:279 | æœ¬æ¬¡ä¸Šä¼ å®Œæ¯•ï¼Œä¸Šä¼ ï¼š2ï¼Œè·³è¿‡ï¼š0ï¼Œé”™è¯¯ï¼š0 | æ€»è®¡ï¼š2</span><br><span class="line">[23-12-17 19:44:22] INFO:main.py:upload_task:280 | æœ¬æ¬¡ä¸Šä¼ å®Œæ¯•ï¼Œå¹³å‡ä¸Šä¼ é€Ÿåº¦ï¼š35.371mb/s | æ€»è€—æ—¶ï¼š25.81s</span><br><span class="line">[23-12-17 19:44:22] INFO:main.py:upload_task:283 | æœ¬æ¬¡ä¸Šä¼ å®Œæ¯•ï¼Œä¸‹æ¬¡å¤„ç†ï¼š2023-12-17 21:00:00</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å…ˆå°†md5è®¡ç®—çš„å‡½æ•°ç»™ä¿®æ”¹äº†ï¼Œæ”¹æˆåˆ†ç‰‡è®¡ç®—ã€‚å¯ä»¥çœ‹åˆ°ï¼Œæ•ˆæœæ˜¾è‘—ï¼å†…å­˜å ç”¨å’Œç¨‹åºåˆšå¼€å§‹è¿è¡Œçš„æ—¶å€™å·®è·åªæœ‰5MBï¼Œè¿™æ‰æ˜¯æ­£å¸¸çš„å†…å­˜å ç”¨ï¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">â•°â”€ python3.10 main.py</span><br><span class="line">[23-12-17 20:03:20] INFO:confLoad.py:&lt;module&gt;:68 | [config] loaded config from &#x27;./config/config.yml&#x27;</span><br><span class="line">[23-12-17 20:03:20] INFO:confLoad.py:&lt;module&gt;:89 | [config] loaded config success</span><br><span class="line">[23-12-17 20:03:20] INFO:querySql.py:&lt;module&gt;:72 | [sqlite3] create all tables</span><br><span class="line">[23-12-17 20:03:20] INFO:main.py:&lt;module&gt;:294 | [start] start at 23-12-17 20:03:20</span><br><span class="line">Memory used: 39.26 MB</span><br><span class="line">[23-12-17 20:03:20] INFO:encrypt.py:__init__:24 | load key file from &#x27;./config/encrypt.key&#x27;</span><br><span class="line">[23-12-17 20:03:20] INFO:main.py:upload_task:132 | ä¸Šä¼ ä»»åŠ¡å¼€å§‹ï¼š23-12-17 20:03:20</span><br><span class="line">[23-12-17 20:03:20] INFO:main.py:upload_task:139 | å¼€å§‹å¤„ç†è·¯å¾„ &#x27;/home/mu/code-wsl/py-wsl/encrypt2bdy/test&#x27; | æ–‡ä»¶æ•°é‡ 2</span><br><span class="line">[23-12-17 20:03:20] INFO:main.py:upload_task:144 | [0] å¼€å§‹å¤„ç† &#x27;/home/mu/code-wsl/py-wsl/encrypt2bdy/test/ã€è¶…ä¸æ»‘60å¸§ã€‘4Kç²¾è£…å­—å¹•ç‰ˆã€ŠILLSHOWYOUã€‹KDAé˜¿ç‹¸.mp4&#x27;</span><br><span class="line">Memory used: 44.08 MB</span><br><span class="line">Memory used: 44.08 MB</span><br><span class="line">Memory used: 44.08 MB</span><br><span class="line">Memory used: 44.08 MB</span><br><span class="line">Memory used: 44.08 MB</span><br><span class="line">Memory used: 44.08 MB</span><br><span class="line">Memory used: 44.08 MB</span><br><span class="line">Memory used: 44.08 MB</span><br><span class="line">Memory used: 44.08 MB</span><br><span class="line">Memory used: 44.08 MB</span><br><span class="line">Memory used: 44.08 MB</span><br><span class="line">[23-12-17 20:03:32] INFO:main.py:upload_task:237 | [1] æˆåŠŸä¸Šä¼  &#x27;/home/mu/code-wsl/py-wsl/encrypt2bdy/test/ã€è¶…ä¸æ»‘60å¸§ã€‘4Kç²¾è£…å­—å¹•ç‰ˆã€ŠILLSHOWYOUã€‹KDAé˜¿ç‹¸.mp4&#x27; æ–‡ä»¶å“ˆå¸Œï¼š7d5735eba55a638a1290ab36e00530ca</span><br><span class="line">[23-12-17 20:03:32] INFO:main.py:upload_task:144 | [1] å¼€å§‹å¤„ç† &#x27;/home/mu/code-wsl/py-wsl/encrypt2bdy/test/ã€è¶…ä¸æ»‘60å¸§ã€‘4Kç²¾è£…å­—å¹•ç‰ˆã€ŠMOREã€‹KDA.mp4&#x27;</span><br><span class="line">Memory used: 44.08 MB</span><br><span class="line">Memory used: 44.08 MB</span><br><span class="line">Memory used: 44.08 MB</span><br><span class="line">Memory used: 44.08 MB</span><br><span class="line">Memory used: 44.08 MB</span><br><span class="line">Memory used: 44.08 MB</span><br><span class="line">Memory used: 44.08 MB</span><br><span class="line">Memory used: 44.08 MB</span><br><span class="line">Memory used: 44.08 MB</span><br><span class="line">Memory used: 44.08 MB</span><br><span class="line">Memory used: 44.08 MB</span><br><span class="line">Memory used: 44.08 MB</span><br><span class="line">[23-12-17 20:03:44] INFO:main.py:upload_task:237 | [2] æˆåŠŸä¸Šä¼  &#x27;/home/mu/code-wsl/py-wsl/encrypt2bdy/test/ã€è¶…ä¸æ»‘60å¸§ã€‘4Kç²¾è£…å­—å¹•ç‰ˆã€ŠMOREã€‹KDA.mp4&#x27; æ–‡ä»¶å“ˆå¸Œï¼šb7b0cd46e3ac7681a3644d9761ad3e71</span><br><span class="line">[23-12-17 20:03:44] INFO:main.py:upload_task:282 | æœ¬æ¬¡ä¸Šä¼ å®Œæ¯•ï¼Œä¸Šä¼ ï¼š2ï¼Œè·³è¿‡ï¼š0ï¼Œé”™è¯¯ï¼š0 | æ€»è®¡ï¼š2</span><br><span class="line">[23-12-17 20:03:44] INFO:main.py:upload_task:283 | æœ¬æ¬¡ä¸Šä¼ å®Œæ¯•ï¼Œå¹³å‡ä¸Šä¼ é€Ÿåº¦ï¼š38.689mb/s | æ€»è€—æ—¶ï¼š23.60s</span><br><span class="line">[23-12-17 20:03:44] INFO:main.py:upload_task:286 | æœ¬æ¬¡ä¸Šä¼ å®Œæ¯•ï¼Œä¸‹æ¬¡å¤„ç†ï¼š2023-12-17 21:00:00</span><br></pre></td></tr></table></figure><h1 id="The-end"><a href="#The-end" class="headerlink" title="The end"></a>The end</h1><p>å…³äºåˆ†ç‰‡è®¡ç®—md5çš„ä»‹ç»å°±è¿™ä¹ˆå¤šï¼Œæˆ‘è¿™ä¸ªç¨‹åºé‡Œé¢æ–‡ä»¶åŠ å¯†çš„éƒ¨åˆ†ä¹Ÿéœ€è¦ä¿®æ”¹ï¼Œä¸è¿‡é‚£å°±ä¸æ˜¯æœ¬æ–‡çš„èŒƒç•´äº†~</p>]]></content>
    
    
    <summary type="html">Pythonåˆ†ç‰‡è®¡ç®—æ–‡ä»¶md5</summary>
    
    
    
    <category term="é€Ÿé€šPython" scheme="https://blog.musnow.top/categories/%E9%80%9F%E9%80%9APython/"/>
    
    
    <category term="Python" scheme="https://blog.musnow.top/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>ã€å›¾åºŠã€‘é€šè¿‡Cloudflareçš„è‡ªå®šä¹‰ä¸»æœºåæœåŠ¡ä»£ç†å›¾åºŠåŸŸå</title>
    <link href="https://blog.musnow.top/posts/923376033/"/>
    <id>https://blog.musnow.top/posts/923376033/</id>
    <published>2023-12-16T09:55:00.000Z</published>
    <updated>2023-12-16T11:55:00.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="è¯´æ˜"><a href="#è¯´æ˜" class="headerlink" title="è¯´æ˜"></a>è¯´æ˜</h1><p>æˆ‘çš„ç›®çš„æ˜¯ï¼Œå›¾åºŠçš„åŸŸåï¼Œå›½å†…ä¾æ—§ä½¿ç”¨ä¸ƒç‰›äº‘CDNï¼Œå¢ƒå¤–çš„è¯·æ±‚ä½¿ç”¨Cloudflareä»£ç†ã€‚Cloudflareèƒ½å¸®æˆ‘ä»¬æ‹¦æˆªä¸€äº›é«˜å±çš„IPåœ°å€ï¼Œèƒ½é¿å…æµ·å¤–è‚‰é¸¡åˆ·ä½ çš„å›¾åºŠæœåŠ¡ã€‚</p><p>å¦‚æœä½ ç”¨è¿‡Cloudflareï¼Œå…¶åœ¨SSL&#x2F;TLSæ¨¡å—æä¾›äº†ä¸€ä¸ª<code>è‡ªå®šä¹‰ä¸»æœºå</code>çš„æœåŠ¡ï¼Œå¯ä»¥è®©ç”¨æˆ·åœ¨<strong>ä¸å°†åŸŸåæ”¹æˆCloudflareçš„DNSçš„æƒ…å†µä¸‹</strong>ï¼Œä½¿ç”¨Cloudflareçš„ä»£ç†åŠŸèƒ½ã€‚</p><p>è¿™ä¸ªåŠŸèƒ½æ˜¯Cloudflare for SAASçš„ä¸€éƒ¨åˆ†ï¼Œä½ åº”è¯¥èƒ½åœ¨ç½‘ä¸Šæ‰¾åˆ°å¾ˆå¤šæ•™ç¨‹ã€‚</p><ul><li><a href="https://vircloud.net/exp/cf-cname-new.html">æœ€æ–° CloudFlare CNAME æ¥å…¥ç©æ³•è¯¦ç»†å›¾æ–‡æ•™ç¨‹ - SaaSÂ·æ°¸ä¹…å…è´¹Â·å®˜æ–¹ç¨³å®š - VirCloudâ€™s Blog - Learning&amp;Sharing</a></li><li><a href="https://cloud.tencent.com/developer/article/1970429">Cloudflare Saas æ¥å…¥CNAMEæµç¨‹-è…¾è®¯äº‘å¼€å‘è€…ç¤¾åŒº-è…¾è®¯äº‘</a></li><li><a href="https://blog.csdn.net/alex_yangchuansheng/article/details/125986096">Cloudflare CNAME æ¥å…¥æ»¡è¡€å¤æ´»ï¼Œä¸€åˆ†é’±ä¸ç”¨èŠ±ï¼-CSDNåšå®¢</a></li></ul><p>ç®€å•è¯´æ¥ï¼Œæƒ³ä½¿ç”¨è¿™ä¸ªåŠŸèƒ½ï¼Œéœ€è¦å¦‚ä¸‹å‡ ä¸ªæ¡ä»¶</p><ul><li>å®é™…ä½¿ç”¨çš„åŸŸåï¼šå¯¹äºæˆ‘è€Œè¨€æ˜¯musnow.top</li><li>ç”¨äºæŒ‡å®šå›é€€æºçš„åŸŸåï¼šè¿™æ˜¯ç¬¬äºŒä¸ªåŸŸåï¼Œåå­—æ— æ‰€è°“ï¼Œå¯ä»¥ç›´æ¥å»<a href="https://nic.eu.org/arf/en/">EU.org</a>ç”³è¯·ä¸€ä¸ªå…è´¹çš„ã€‚è¯¥åŸŸåéœ€è¦æ¥å…¥Cloudflareçš„DNSï¼Œè¿™é‡Œç”¨example.comä¸¾ä¾‹å­</li><li>ä¸€ä¸ªäº‘æœåŠ¡å™¨ï¼ŒIPç”¨1.1.1.1ä¸¾ä¾‹å­</li></ul><p>å½“ä½ é…ç½®å¥½äº†ä¹‹åï¼Œè¯·æ±‚ç½‘ç«™çš„è·¯å¾„å˜æˆäº†å¦‚ä¸‹æ¨¡æ ·</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">é…ç½®å‰ï¼šåŸŸåmusnow.top-&gt;Aè®°å½•-&gt;äº‘æœåŠ¡å™¨1.1.1.1</span><br><span class="line">é…ç½®åï¼šåŸŸåmusnow.top-&gt;CNAMEè®°å½•-&gt;å›é€€æºåŸŸåexample.com-&gt;Cloudflare-&gt;äº‘æœåŠ¡å™¨1.1.1.1</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨<code>è‡ªå®šä¹‰ä¸»æœºå</code>åŠŸèƒ½ï¼Œå¯ä»¥è®©Cloudflareåœ¨è¯·æ±‚ä½ æºç«™çš„æ—¶å€™ï¼Œä½¿ç”¨åŸæœ‰åŸŸåï¼ˆå®é™…ä½¿ç”¨çš„åŸŸåï¼‰ï¼Œè€Œä¸æ˜¯å›é€€æºåŸŸåã€‚å‡è®¾ä½ éœ€è¦å›æºçš„äº‘æœåŠ¡å™¨æ˜¯å›½å†…çš„æœåŠ¡å™¨ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">å›é€€æºåŸŸåexample.comæ²¡æœ‰å¤‡æ¡ˆ -&gt; è¯·æ±‚å›½å†…æœåŠ¡å™¨ä¼šè¢«æœåŠ¡å•†æ‹¦æˆª</span><br><span class="line">é…ç½®è‡ªå®šä¹‰ä¸»æœºåmusnow.topåï¼›</span><br><span class="line">Cloudflareåœ¨å›æºåˆ°æœåŠ¡å™¨çš„æ—¶å€™ï¼Œé‡‡ç”¨è‡ªå®šä¹‰ä¸»æœºåçš„åŸŸåï¼Œå³musnow.topï¼›</span><br><span class="line">å®é™…ä½¿ç”¨çš„åŸŸåmusnow.topå·²å¤‡æ¡ˆ -&gt; è¯·æ±‚å›½å†…æœåŠ¡å™¨ä¸å†è¢«æ‹¦æˆª</span><br></pre></td></tr></table></figure><p>æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œå›é€€æºåŸŸåexample.comå¯¹äºç”¨æˆ·æ˜¯æ— æ„ŸçŸ¥çš„ï¼æˆ‘ä»¬å®ç°äº†åœ¨åŸæœ‰åŸŸåmusnow.topçš„DNSæ²¡æœ‰æ¥å…¥Cloudflareçš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨äº†Cloudflareçš„é˜²æŠ¤æœåŠ¡ã€‚</p><p>ç›®å‰å…è´¹ç‰ˆæœ¬çš„è‡ªå®šä¹‰ä¸»æœºåæœ‰å¦‚ä¸‹è¦æ±‚</p><ul><li>Cloudflareå¿…é¡»è¦éªŒè¯ä½ çš„æ”¯ä»˜æ–¹å¼ï¼Œ<strong>ä¸ä¼šæ‰£ä½ é’±çš„</strong>ï¼ˆpaypalæˆ–è€…é“¶è”ä¿¡ç”¨å¡ï¼Œå½“æ—¶ä¸ºæ­¤æˆ‘è¿˜ä¸“é—¨å»åŠäº†ä¸ªæ²¡æœ‰é¢åº¦çš„å­¦ç”Ÿä¿¡ç”¨å¡ï¼Œåæ¥å‘ç°å‹æ ¹ä¸éœ€è¦ï¼Œç›´æ¥ç”¨paypalç»‘å®šä¸ªé“¶è”å‚¨è“„å¡&#x2F;å€Ÿè®°å¡å°±å¯ä»¥äº†ï¼‰</li><li>å…è´¹ç‰ˆæœ¬çš„å›é€€æºåªèƒ½æŒ‡å®šä¸€ä¸ªï¼Œå³åªèƒ½å›æºåˆ°ä¸€ä¸ªIPåœ°å€çš„æœåŠ¡ã€‚</li></ul><h1 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h1><h2 id="å›é€€æº"><a href="#å›é€€æº" class="headerlink" title="å›é€€æº"></a>å›é€€æº</h2><p>é¦–å…ˆæ˜¯è®¾ç½®å›é€€æºåŸŸåçš„DNSï¼Œå°†å…¶æ¥å…¥Cloudflareã€‚éšåæ˜¯åœ¨DNSè®°å½•ä¸­æ·»åŠ ä¸€ä¸ªAè®°å½•ï¼ŒæŒ‡å‘ä½ çš„æºç«™æœåŠ¡å™¨IPã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/141a4967805f6d4a177f84c9557cc47f.png" alt="image.png"></p><p>è¿™é‡Œæˆ‘ä½¿ç”¨çš„åç§°æ˜¯<code>back.å›é€€æºåŸŸå</code>ï¼Œåœ¨SSL&#x2F;TLSæ¨¡å—çš„è‡ªå®šä¹‰ä¸»æœºåä¸­å¼€é€šCloudflare SAASæœåŠ¡ï¼Œå¹¶æ·»åŠ å›é€€æºåŸŸå</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/44ad244bf4ee3f94cddb51153ca3d68f.png" alt="image.png"></p><p>æ·»åŠ å›é€€æºåŸŸåå¹¶éªŒè¯æˆåŠŸåï¼Œå°±å¯ä»¥ç‚¹å‡»è“è‰²<code>æ·»åŠ è‡ªå®šä¹‰ä¸»æœºå</code>æŒ‰é’®ï¼Œæ·»åŠ ä½ éœ€è¦ä»£ç†çš„åŸå§‹åŸŸåäº†ã€‚</p><p>è¿™é‡Œæˆ‘æ·»åŠ äº†æˆ‘çš„å›¾åºŠåŸŸå<code>img.musnow.top</code>ï¼Œé¦–å…ˆæ˜¯åœ¨è…¾è®¯äº‘çš„DNSä¸­è®¾ç½®CNAMEè§£æï¼Œå°†å¢ƒå¤–çº¿è·¯è®¾ç½®ä¸ºå›é€€æºçš„åŸŸåï¼Œé»˜è®¤çº¿è·¯è¿˜æ˜¯ä¸ƒç‰›äº‘CDNçš„CNAME</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/0257caf29cbdb23c5f99d91474f061f1.png" alt="image.png"></p><p>æ·»åŠ äº†åŸŸåè§£æä¹‹åï¼Œä½ è¿˜éœ€è¦åœ¨musnow.topçš„DNSè§£æé‡Œé¢æ·»åŠ ä¸¤ä¸ªTXTè®°å½•æ¥éªŒè¯å›é€€æºï¼Œå‚è€ƒCloudflareç»™å‡ºçš„txtè®°å½•æç¤ºå°±å¯ä»¥ã€‚ç•Œé¢ç±»ä¼¼ä¸‹å›¾</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/29ec2ba14997ccf0e5c5d64b8ec34d99.png" alt="image.png"></p><p>æ·»åŠ äº†ä¹‹åç‚¹å‡»åˆ·æ–°ï¼Œç›´åˆ°è‡ªå®šä¹‰ä¸»æœºåçš„çŠ¶æ€æ˜¾ç¤ºä¸º<code>æœ‰æ•ˆ</code>ï¼Œå³é…ç½®æˆåŠŸã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/06877d872e6521102ec83d0805e0bfc9.png" alt="image.png"></p><p>ä½¿ç”¨æµ·å¤–æœåŠ¡å™¨æµ‹è¯•ï¼Œé…ç½®å‰ï¼Œè§£æåˆ°ä¸ƒç‰›äº‘CDNï¼›é…ç½®åï¼Œè§£æåˆ°å›é€€æºåŸŸåï¼Œå³Cloudflare</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/d900e5b35ddd67f51413e66ab54c822d.png" alt="image.png"></p><h2 id="åå‘ä»£ç†"><a href="#åå‘ä»£ç†" class="headerlink" title="åå‘ä»£ç†"></a>åå‘ä»£ç†</h2><p>ä½†è¿™é‡Œåªæ˜¯é…ç½®å¥½äº†åŸŸåè§£æè€Œå·²ï¼Œè¿˜éœ€è¦ç”¨åä»£æ‰èƒ½è®©å¢ƒå¤–è®¿é—®å›¾åºŠåŸŸåèƒ½è®¿é—®å‡ºå›¾ç‰‡æ¥ã€‚</p><h3 id="åä»£åŸæœ‰ä¸ƒç‰›äº‘CDNçš„CNAMEä¸èµ·ä½œç”¨"><a href="#åä»£åŸæœ‰ä¸ƒç‰›äº‘CDNçš„CNAMEä¸èµ·ä½œç”¨" class="headerlink" title="åä»£åŸæœ‰ä¸ƒç‰›äº‘CDNçš„CNAMEä¸èµ·ä½œç”¨"></a>åä»£åŸæœ‰ä¸ƒç‰›äº‘CDNçš„CNAMEä¸èµ·ä½œç”¨</h3><p>ä½†æ˜¯è¿™ä¸ªåä»£è¦æ€ä¹ˆé…ç½®å‘¢ï¼Ÿå› ä¸ºåªæ˜¯è§£æçº¿è·¯ä¸åŒï¼Œç›´æ¥æŠŠimg.musnow.topåå‘ä»£ç†åˆ°img.musnow.topè‚¯å®šä¸è¡Œï¼Œ<strong>è¯•è¯•åä»£åˆ°ä¸ƒç‰›äº‘çš„CNMAE</strong>ï¼Ÿ</p><p>æµ‹è¯•å‘ç°ï¼Œç›´æ¥é€šè¿‡ä¸ƒç‰›äº‘CDNé‡Œé¢çš„CNAMEè®¿é—®è¿™ä¸ªå›¾ç‰‡ä¼š403ï¼ˆä¸ç®¡æ˜¯æµè§ˆå™¨è®¿é—®è¿˜æ˜¯ä½¿ç”¨curlè®¿é—®ï¼‰</p><p>è€Œåä»£è¿‡åï¼Œcurlå’Œwgetçš„ç»“æœéƒ½å˜æˆäº†526ï¼Œ<strong>æ— æ³•è®¿é—®å›¾ç‰‡</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">â•°â”€ curl https://img.musnow.top/i/2023/05/647563ddab0fb.gif</span><br><span class="line">error code: 526%    </span><br><span class="line"></span><br><span class="line">â•°â”€ wget https://img.musnow.top/i/2023/05/647563ddab0fb.gif</span><br><span class="line">--2023-12-16 18:48:21--  https://img.musnow.top/i/2023/05/647563ddab0fb.gif</span><br><span class="line">Resolving img.musnow.top (img.musnow.top)... 172.67.157.61, 104.21.56.251, 2606:4700:3035::ac43:9d3d, ...</span><br><span class="line">Connecting to img.musnow.top (img.musnow.top)|172.67.157.61|:443... connected.</span><br><span class="line">HTTP request sent, awaiting response... 526 </span><br><span class="line">2023-12-16 18:48:21 ERROR 526: (no description).</span><br></pre></td></tr></table></figure><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/b84073fd201689557c89a39ddf058e05.png" alt="image.png"></p><p>å³ä¾¿åœ¨åä»£é‡Œé¢è®¾ç½®äº†åç«¯è¯·æ±‚çš„åŸŸåä¸º<code>img.musnow.top</code>ï¼Œè®¿é—®ä¾æ—§ä¼šæ˜¯526</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/6e0441d8096870ebab9dc0f560005aa4.png" alt="image.png"></p><h3 id="æœªè®¾ç½®Cloudflareæ—¶èƒ½æˆåŠŸè§£æ"><a href="#æœªè®¾ç½®Cloudflareæ—¶èƒ½æˆåŠŸè§£æ" class="headerlink" title="æœªè®¾ç½®Cloudflareæ—¶èƒ½æˆåŠŸè§£æ"></a>æœªè®¾ç½®Cloudflareæ—¶èƒ½æˆåŠŸè§£æ</h3><p>ä½œä¸ºå¯¹æ¯”ï¼Œåœ¨<strong>æ²¡æœ‰é…ç½®</strong>è§£æåˆ°Cloudflareçš„æ—¶å€™ï¼Œä½¿ç”¨wgetæ˜¯èƒ½è®¿é—®å‡ºå›¾ç‰‡æ¥çš„</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/21bbf4746ffcc740728e4b1df8be6427.png" alt="image.png"></p><p>å°†wgetçš„è¿™ä¸ªå›¾ç‰‡é€šè¿‡sftpä¸‹è½½ä¸‹æ¥ï¼Œèƒ½çœ‹åˆ°å®ƒæ˜¯æ­£å¸¸çš„gifï¼Œå›¾ç‰‡è®¿é—®æ²¡æœ‰é—®é¢˜ã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/b29c2c5cbf14669c34f4037322aeeff6.png" alt="image.png"></p><h3 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><p>æˆ‘èƒ½æƒ³åˆ°çš„è§£å†³åŠæ³•ï¼Œæ˜¯ç™½å«–ä¸€ä¸‹ä¸ƒç‰›äº‘å…è´¹çš„10GB HTTPæµé‡ï¼Œæ–°å»ºä¸€ä¸ªHTTPå›æºçš„CDNï¼Œç»‘å®šåˆ°å›¾åºŠçš„bucketä¸Šå³å¯ã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/3e6bcea445ba19b11f6c77026ac658de.png" alt="image.png"></p><p>æ³¨æ„ï¼Œåªè¦ä½ çš„å›æºåœ°å€æ˜¯<strong>å›½å†…çš„bucket</strong>ï¼Œé‚£ä¹ˆåŸŸåå°±å¿…é¡»è¦å¤‡æ¡ˆæ‰èƒ½é…ç½®CDNã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/657d8838998a7.png"></p><p>å› ä¸ºç°åœ¨æ˜¯é€šè¿‡äº‘æœåŠ¡å™¨åä»£æ¥è®¿é—®è¿™ä¸ªCDNï¼Œæ­¤æ—¶åä»£çš„proxyè®¾ç½®ä¸ºhttpï¼Œåœ¨æ·»åŠ <code>img.musnow.top</code>çš„certè¯ä¹¦åˆ°åä»£è®¾ç½®é‡Œé¢ï¼Œå°±èƒ½å®ç°httpsã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">img.musnow.top åä»£ img-cloudflare.musnow.top</span><br></pre></td></tr></table></figure><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/0d22fc941aa251767a6d002cf9c587a0.png" alt="image.png"></p><p>æ³¨æ„ï¼Œåä»£ä¸­çš„åç«¯åŸŸåä¹Ÿéœ€è¦è®¾ç½®ä¸ºæ–°çš„CDNåŸŸåï¼Œå¦åˆ™è®¿é—®ä¼šå› ä¸ºåŸŸåä¸åŒ¹é…è€Œ403æ‹’ç»è®¿é—®ã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/342efa096d28d3bdbeb9a33454b14aa4.png" alt="image.png"></p><p>éšåå°±æ˜¯æ·»åŠ img.musnow.topçš„SSLè¯ä¹¦</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/d98f69744def3672429c19ae7879a690.png" alt="image.png"></p><p>æµ‹è¯•ä¸€ä¸‹ï¼Œæ–°å»ºçš„è¿™ä¸ªcdnåŸŸåå¯ä»¥é€šè¿‡httpè®¿é—®åˆ°bucketé‡Œé¢çš„å›¾ç‰‡</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/41d0ef29dc9f3da44647b7150b4625f0.png" alt="image.png"></p><p>å†æµ‹è¯•ä¸€ä¸‹<strong>åä»£åçš„åŸŸå</strong>ï¼Œä¹Ÿå¯ä»¥è®¿é—®åˆ°å›¾ç‰‡äº†ï¼Œè¿™é‡Œè®¿é—®çš„IPåœ°å€<code>104.21.56.251</code>ä¹Ÿå·²ç»æ˜¯Cloudflareçš„IPäº†ã€‚é…ç½®æˆåŠŸï¼</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/ba1eb6f04811dc5e15e62055fdcb0d4a.png" alt="image.png"></p><p>æ­¤æ—¶æµ·å¤–è®¿é—®æˆ‘çš„å›¾åºŠï¼Œè§£æå˜æˆäº†å¦‚ä¸‹è¿‡ç¨‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">img.musnow.top -&gt; CNAMEå›é€€æºåŸŸå -&gt; cloudflare(https) -&gt; äº‘æœåŠ¡å™¨åä»£(https) -&gt; img-cloudflare.musnow.top(http) -&gt; ä¸ƒç‰›äº‘bucket</span><br></pre></td></tr></table></figure><p>å› ä¸ºæœ€ç»ˆè®¿é—®çš„CDNæ˜¯é€šè¿‡HTTPå›æºbucketçš„ï¼Œèƒ½ç™½å«–ä¸ƒç‰›äº‘10Gçš„å…è´¹æµé‡ï¼</p><p>å½“ç„¶ï¼Œå¦‚æœçœŸæœ‰äººåœ¨æµ·å¤–æ‰“ä½ ï¼Œåˆ·å®Œ10Gæµé‡ä¹Ÿä¸æ˜¯ä¸å¯èƒ½â€¦â€¦æ‰€ä»¥åœ¨cloudflareé‡Œé¢æœ€å¥½å†é…ç½®ä¸€ä¸‹å•IPè®¿é—®çš„é¢‘æ¬¡é™åˆ¶ï¼</p><p>æ¯”å¦‚ä¸‹å›¾ï¼Œæˆ‘è®¾ç½®è®¿é—®URLä¸ºå›¾åºŠå¼€å¤´<code>/i</code>æ—¶è¿›è¡Œé€Ÿç‡ç›‘çœ‹ï¼Œå¦‚æœå•IPè®¿é—®é€Ÿç‡è¶…è¿‡60æ¬¡&#x2F;10ç§’ï¼Œé‚£ä¹ˆå°±ä¼šè§¦å‘cloudflareçš„é€Ÿç‡é™åˆ¶å“åº”ï¼ŒæŒç»­10ç§’ã€‚</p><p>å› ä¸ºæˆ‘çš„åšå®¢å·²ç»è®¾ç½®äº†<strong>æ‡’åŠ è½½</strong>ï¼Œæ‰€ä»¥ä¸€æ¬¡æ€§åŠ è½½60ä¸ªå›¾ç‰‡çš„åœºæ™¯æ˜¯ä¸å­˜åœ¨çš„ï¼è¿™ç§è§„æ¨¡çš„è¯·æ±‚è‚¯å®šæ˜¯æ”»å‡»äº†ï¼å†åŠ ä¸Šæˆ‘çš„åšå®¢ç†è®ºä¸Šä¸ä¼šæœ‰å‡ ä¸ªæµ·å¤–ç”¨æˆ·é˜…è¯»ï¼Œæ‰€ä»¥è¿™ä¸ªé…ç½®ä¸ä¼šå¯¹å›½å†…ç”¨æˆ·äº§ç”Ÿå½±å“ã€‚</p><blockquote><p>å¦‚æœä½ ä½¿ç”¨äº†ä»£ç†ï¼Œè¯·æŠŠmusnow.topæ‰€æœ‰å­åŸŸååŠ å…¥ä»£ç†ç™½åå•ã€‚</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/18bbfdad10fe93f2c9b33576946d009c.png" alt="image.png"></p><h3 id="è¿›ä¸€æ­¥ä¼˜åŒ–"><a href="#è¿›ä¸€æ­¥ä¼˜åŒ–" class="headerlink" title="è¿›ä¸€æ­¥ä¼˜åŒ–"></a>è¿›ä¸€æ­¥ä¼˜åŒ–</h3><p>è¿›ä¸€æ­¥ä¼˜åŒ–ï¼Œå°±æ˜¯æŠŠæ–°åˆ›å»ºçš„è¿™ä¸ªHTTP CDNé‡Œé¢è®¾ç½®IPç™½åå•ï¼Œåªå…è®¸æˆ‘ä»¬è®¾ç½®åä»£çš„æœåŠ¡å™¨çš„é‚£ä¸ªIPåœ°å€è®¿é—®ï¼Œè¿™æ ·å°±ä¿è¯äº†å…¶ä»–äººä¸èƒ½ç›´æ¥åˆ·æˆ‘æ–°å»ºçš„è¿™ä¸ªHTTPçš„CDNåŸŸåã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/0143324cb410b006374f3ae0e2e5da60.png" alt="image.png"></p><p>åœ¨ä¸ƒç‰›äº‘çš„CDNé…ç½®ç•Œé¢å¯ä»¥çœ‹åˆ°IPé»‘ç™½åå•ï¼Œæ·»åŠ æœåŠ¡å™¨IPåœ°å€ä¸ºç™½åå•å³å¯</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/68f0761d01ef17bd69ae3ae390276d43.png" alt="image.png"></p><p>é…ç½®åéœ€è¦è¿‡ä¸€æ®µæ—¶é—´æ‰ä¼šç”Ÿæ•ˆï¼Œä¼šæœ‰ä¸ªè¿›åº¦æ¡ã€‚å®Œæˆåï¼Œå†æ¬¡æœ¬åœ°æµ‹è¯•ä¸€ä¸‹ï¼Œå‘ç°å·²ç»403ä¸å…è®¸è®¿é—®äº†ã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/84a0913ebda28e60c4a6dd292e810ce9.png" alt="image.png"></p><p>æ­¤æ—¶åœ¨æµ·å¤–æœåŠ¡å™¨å°è¯•åä»£åŸŸåè®¿é—®ï¼Œä¾æ—§æ˜¯OKçš„ï¼Œè®¿é—®çš„IPåœ°å€<code>172.67.157.61</code>ä¹Ÿä¾æ—§æ˜¯Cloudflareçš„IPã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/4440fa31b56a35e7c25acc33e37974a1.png" alt="image.png"></p><h1 id="The-end"><a href="#The-end" class="headerlink" title="The end"></a>The end</h1><p>è‡³æ­¤ï¼Œé…ç½®å®Œæˆï¼</p>]]></content>
    
    
    <summary type="html">é€šè¿‡Cloudflareçš„SAASè‡ªå®šä¹‰ä¸»æœºåæœåŠ¡ä»£ç†å›¾åºŠåŸŸå</summary>
    
    
    
    <category term="å·®ç”Ÿæ–‡å…·å¤š" scheme="https://blog.musnow.top/categories/%E5%B7%AE%E7%94%9F%E6%96%87%E5%85%B7%E5%A4%9A/"/>
    
    
    <category term="å›¾åºŠ" scheme="https://blog.musnow.top/tags/%E5%9B%BE%E5%BA%8A/"/>
    
  </entry>
  
  <entry>
    <title>ã€WSLã€‘è§£å†³&#39;wslï¼šæ£€æµ‹åˆ°localhostä»£ç†é…ç½®ï¼Œä½†æœªé•œåƒåˆ°WSL&#39;é—®é¢˜</title>
    <link href="https://blog.musnow.top/posts/3693584344/"/>
    <id>https://blog.musnow.top/posts/3693584344/</id>
    <published>2023-12-16T09:52:00.000Z</published>
    <updated>2023-12-16T09:52:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>ä»Šå¤©ä½¿ç”¨wsl2çš„centosçš„æ—¶å€™é‡åˆ°äº†è¿™ä¸ªé—®é¢˜</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wsl: æ£€æµ‹åˆ° localhost ä»£ç†é…ç½®ï¼Œä½†æœªé•œåƒåˆ° WSLã€‚</span><br><span class="line">NAT æ¨¡å¼ä¸‹çš„ WSL ä¸æ”¯æŒ localhost ä»£ç†ã€‚</span><br></pre></td></tr></table></figure><p>å‚è€ƒ <a href="https://www.cnblogs.com/hg479/p/17869109.html">è§£å†³â€wsl: æ£€æµ‹åˆ° localhost ä»£ç†é…ç½®ï¼Œä½†æœªé•œåƒåˆ° WSLã€‚NAT æ¨¡å¼ä¸‹çš„ WSL ä¸æ”¯æŒ localhost ä»£ç†â€ - JustInCase - åšå®¢å›­</a></p><p>åœ¨windowsçš„<code>C:\User\&lt;ä½ çš„ç”¨æˆ·å&gt;\</code> ä¸‹åˆ›å»ºä¸€ä¸ª<code>.wslconfig</code>ï¼Œå†…éƒ¨å†™å…¥å¦‚ä¸‹å†…å®¹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[experimental]</span><br><span class="line">autoMemoryReclaim=gradual  </span><br><span class="line">networkingMode=mirrored</span><br><span class="line">dnsTunneling=true</span><br><span class="line">firewall=true</span><br><span class="line">autoProxy=true</span><br></pre></td></tr></table></figure><p>å†™å®Œåä¿å­˜ï¼Œé‡å¯wslå³å¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wsl --shutdown</span><br></pre></td></tr></table></figure><p>å†æ¬¡å¯åŠ¨wslï¼Œä¸å†å¼¹å‡ºä¸Šè¿°æç¤º</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/cf8be920995459ca75ed48adc48b4908.png" alt="image.png"></p>]]></content>
    
    
    <summary type="html">è§£å†³&#39;wslï¼šæ£€æµ‹åˆ°localhostä»£ç†é…ç½®ï¼Œä½†æœªé•œåƒåˆ°WSL&#39;é—®é¢˜</summary>
    
    
    
    <category term="ç©ä¸ŠLinux" scheme="https://blog.musnow.top/categories/%E7%8E%A9%E4%B8%8ALinux/"/>
    
    
    <category term="Linux" scheme="https://blog.musnow.top/tags/Linux/"/>
    
    <category term="è™šæ‹Ÿæœº" scheme="https://blog.musnow.top/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA/"/>
    
    <category term="wsl" scheme="https://blog.musnow.top/tags/wsl/"/>
    
  </entry>
  
  <entry>
    <title>ã€nginxã€‘nginxé€šè¿‡é…ç½®æ–‡ä»¶å…è®¸uptimerobotçš„è¯·æ±‚</title>
    <link href="https://blog.musnow.top/posts/1547739098/"/>
    <id>https://blog.musnow.top/posts/1547739098/</id>
    <published>2023-12-15T11:49:00.000Z</published>
    <updated>2023-12-15T11:49:00.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="é—®é¢˜è¯´æ˜"><a href="#é—®é¢˜è¯´æ˜" class="headerlink" title="é—®é¢˜è¯´æ˜"></a>é—®é¢˜è¯´æ˜</h1><p>å‰å‡ å¤©ï¼Œæˆ‘ç»™æˆ‘çš„artalkä¸Šäº†IPå±è”½ï¼Œåªæ”¾è¡Œå›½å†…IPï¼Œä¸å…è®¸ä»»ä½•å›½å¤–çš„IPåœ°å€è¯„è®ºã€‚</p><p><a href="https://blog.musnow.top/posts/2029711168/">ã€Nginxã€‘nginxé€šè¿‡é…ç½®æ–‡ä»¶é˜»æ­¢æµ·å¤–ipè®¿é—® | æ…•é›ªçš„å¯’èˆ</a></p><p>ç„¶åå°±å‘ç°äº†ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä½¿ç”¨çš„uptimerobotè¿™ä¸ªåœ¨çº¿çŠ¶æ€ç›‘æ§ç¨‹åºæ˜¯å›½å¤–çš„ï¼Œå®ƒçš„è¯·æ±‚è‡ªç„¶ä¹Ÿæ˜¯é€šè¿‡æµ·å¤–IPå‘èµ·çš„ï¼Œæ­¤æ—¶å°±ä¼šè¢«æˆ‘æœåŠ¡å™¨çš„nginxæ‹¦æˆªï¼Œå¯¼è‡´403ï¼Œuptimerobotè®¤ä¸º403ä¹Ÿæ˜¯æ— æ³•è®¿é—®ï¼Œservice downäº†ã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/9b7cc2eba613b4a9d0fbd06a003e63b8.png" alt="image.png"></p><h1 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h1><p>ä¹‹å‰é€šè¿‡æŠ˜è…¾ï¼Œå·²ç»çŸ¥é“äº†å¦‚ä½•ä½¿ç”¨nginxçš„é…ç½®æ–‡ä»¶æ¥allowæˆ–è€…denyä¸€ç³»åˆ—ipåœ°å€ï¼Œé‚£ä¹ˆuptimerobotçš„è¿™ä¸ªé—®é¢˜ä¹Ÿå¾ˆå¥½è§£å†³ï¼šåªè¦æˆ‘ä»¬çŸ¥é“uptimerobbotçš„è¯·æ±‚æ¥æºipï¼Œé‚£ä¹ˆå°†å…¶å†™å…¥ä¸€ä¸ªå¦‚ä¸‹ç±»ä¼¼çš„nginxé…ç½®æ–‡ä»¶ï¼Œå†åœ¨å…·ä½“çš„locationä¸­includeï¼Œæ”¾è¡Œå¯¹åº”ipåœ°å€å³å¯ã€‚</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">allow</span> uptime-robot-ip1;</span><br><span class="line"><span class="attribute">allow</span> uptime-robot-ip2;</span><br></pre></td></tr></table></figure><p>æˆ‘åœ¨uptimerobotçš„å®˜ç½‘æ‰¾åˆ°äº†å®ƒä»¬çš„ipåœ°å€åˆ—è¡¨ï¼š<a href="https://uptimerobot.com/help/locations/">Locations and IPs | UptimeRobot</a></p><p>txtæ–‡ä»¶ä¹Ÿæœ‰çš„ï¼š</p><ul><li>ipv4ï¼š<a href="https://uptimerobot.com/inc/files/ips/IPv4.txt">uptimerobot.com&#x2F;inc&#x2F;files&#x2F;ips&#x2F;IPv4.txt</a></li><li>ipv4+ipv6ï¼š<a href="https://uptimerobot.com/inc/files/ips/IPv4andIPv6.txt">uptimerobot.com&#x2F;inc&#x2F;files&#x2F;ips&#x2F;IPv4andIPv6.txt</a></li></ul><p>ç”¨å¦‚ä¸‹è„šæœ¬æ¥å®ç°</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line">rm -f IPv4.txt black_uptime_`date +%F`.conf</span><br><span class="line">wget https://uptimerobot.com/inc/files/ips/IPv4.txt</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ é™¤åŸæœ‰æ–‡ä»¶æ¯ä¸€è¡Œçš„å›è½¦ç¬¦å·</span></span><br><span class="line">sed -i &#x27;s/\r//g&#x27; IPv4.txt </span><br><span class="line"></span><br><span class="line">while IFS= read -r line</span><br><span class="line">do</span><br><span class="line">  echo &quot;allow $line;&quot; &gt;&gt; black_uptime_`date +%F`.conf</span><br><span class="line">done &lt; IPv4.txt</span><br><span class="line"></span><br><span class="line">rm -f /etc/nginx/black_uptime.conf &amp;&amp; \</span><br><span class="line">ln -s $PWD/black_uptime_`date +%F`.conf /etc/nginx/black_uptime.conf</span><br></pre></td></tr></table></figure><p>å°†å…¶å†™å…¥ä¸€ä¸ª<code>uptimerobot.sh</code>æ–‡ä»¶ï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æ‰§è¡Œå®ƒ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sh uptimerobot.sh</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªè„šæœ¬ä¼šåœ¨å½“å‰ç›®å½•é‡Œé¢ä¸‹è½½uptimerobotçš„è¿™ä¸ªIPv4.txtï¼Œå¹¶ä»¥nginxçš„å½¢å¼å†™ä¸ºallowï¼Œæœ€ååœ¨<code>/etc/nginx</code>é‡Œé¢åˆ›å»ºä¸€ä¸ªè½¯è¿æ¥ <code>/etc/nginx/black_uptime.conf</code> æ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">allow 18.116.158.121;</span><br><span class="line">allow 18.223.50.16;</span><br><span class="line">allow 54.241.175.147;</span><br></pre></td></tr></table></figure><p>éšåæˆ‘ä»¬è¿›å…¥nginxçš„é…ç½®æ–‡ä»¶ï¼Œåœ¨å¯¹åº”ç«™ç‚¹é…ç½®æ–‡ä»¶çš„locationé‡Œé¢ï¼Œincludeè¿™ä¸ªé…ç½®æ–‡ä»¶å°±å¯ä»¥äº†</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">location</span> / &#123;</span><br><span class="line"><span class="comment"># å…è®¸uptimerobotçš„è¯·æ±‚</span></span><br><span class="line"><span class="attribute">include</span> /etc/nginx/black_uptime.conf;</span><br><span class="line"><span class="attribute">deny</span> all; <span class="comment"># æ‹’ç»å…¶ä»–æ‰€æœ‰è¯·æ±‚</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ·»åŠ ä¹‹åï¼Œé‡å¯nginxï¼Œé…ç½®å°±ç”Ÿæ•ˆå•¦</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart nginx</span><br></pre></td></tr></table></figure><p>å¦‚ä¸‹å›¾ï¼Œuptimerobotå·²ç»å¯ä»¥æ­£å¸¸è¯·æ±‚å’Œç›‘çœ‹æˆ‘çš„artalkè¯„è®ºé¡µé¢äº†</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/80d723cf79673db1f53efb9452baa448.png" alt="image.png"></p>]]></content>
    
    
    <summary type="html">nginxé€šè¿‡é…ç½®æ–‡ä»¶å…è®¸uptimerobotçš„è¯·æ±‚ï¼Œæ”¾è¡Œuptimerobotçš„ip</summary>
    
    
    
    <category term="å·®ç”Ÿæ–‡å…·å¤š" scheme="https://blog.musnow.top/categories/%E5%B7%AE%E7%94%9F%E6%96%87%E5%85%B7%E5%A4%9A/"/>
    
    
    <category term="Linux" scheme="https://blog.musnow.top/tags/Linux/"/>
    
    <category term="nginx" scheme="https://blog.musnow.top/tags/nginx/"/>
    
  </entry>
  
  <entry>
    <title>ã€dockerã€‘éƒ¨ç½²minioå¯¹è±¡å­˜å‚¨å¹¶ç”¨rcloneåŒæ­¥</title>
    <link href="https://blog.musnow.top/posts/1950951389/"/>
    <id>https://blog.musnow.top/posts/1950951389/</id>
    <published>2023-12-13T13:29:02.000Z</published>
    <updated>2023-12-13T13:29:02.000Z</updated>
    
    <content type="html"><![CDATA[<p>dockeréƒ¨ç½²minioå¯¹è±¡å­˜å‚¨å¹¶ç”¨rcloneåŒæ­¥</p><h1 id="1-ä»€ä¹ˆæ˜¯minioï¼Ÿ"><a href="#1-ä»€ä¹ˆæ˜¯minioï¼Ÿ" class="headerlink" title="1.ä»€ä¹ˆæ˜¯minioï¼Ÿ"></a>1.ä»€ä¹ˆæ˜¯minioï¼Ÿ</h1><p>minioæ˜¯ä¸€ä¸ªå¼€æºçš„å¯¹è±¡å­˜å‚¨æœåŠ¡å™¨ï¼Œå…¼å®¹S3åè®®ã€‚</p><p>å®˜ç½‘ï¼š<a href="https://min.io/">https://min.io/</a></p><p>å®˜æ–¹åœ¨å¼€æºçš„åŸºç¡€ä¸Šä¹Ÿæä¾›äº‘ç«¯S3æœåŠ¡ï¼Œåˆ†ä¸ºä¸ªäººå’Œä¼ä¸šï¼Œæœ‰ä¸åŒçš„æ”¶è´¹æ ‡å‡†ã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/3dbb54877957d5ede7354a3401dd4cf0.png" alt="5ae0c978272b7ca6732817920adae0f5.png"></p><h2 id="1-1-è‡ªå»ºå¯¹è±¡å­˜å‚¨çš„å¥½å¤„ï¼Ÿ"><a href="#1-1-è‡ªå»ºå¯¹è±¡å­˜å‚¨çš„å¥½å¤„ï¼Ÿ" class="headerlink" title="1.1 è‡ªå»ºå¯¹è±¡å­˜å‚¨çš„å¥½å¤„ï¼Ÿ"></a>1.1 è‡ªå»ºå¯¹è±¡å­˜å‚¨çš„å¥½å¤„ï¼Ÿ</h2><p>å½“ç„¶ï¼Œæœ¬æ–‡å†™ä¸‹æ¥è‚¯å®šä¸æ˜¯è®©ä½ å»ä¹°å®ƒçš„å¯¹è±¡å­˜å‚¨æœåŠ¡çš„ï¼Œè€Œæ˜¯åœ¨æˆ‘ä»¬è‡ªå·±çš„æœåŠ¡å™¨&#x2F;Nasä¸Šéƒ¨ç½²ä¸€ä¸ªminioçš„dockerï¼Œæ¥æ‹¥æœ‰ä¸€ä¸ªæˆ‘ä»¬è‡ªå·±çš„å¯¹è±¡å­˜å‚¨æœåŠ¡å™¨ï¼</p><p>å¯¹è±¡å­˜å‚¨æœåŠ¡å™¨å¯ä»¥ç”¨æ¥åšå›¾åºŠã€é™æ€èµ„æºç¼“å­˜ï¼Œäº¦æˆ–è€…æ˜¯ç›´æ¥å½“ä½œä¸€ä¸ªç½‘ç›˜æ¥ä½¿ç”¨ã€‚</p><p>è‡ªå»ºçš„å¯¹è±¡å­˜å‚¨çš„å¥½å¤„æ˜¯æ‰€æœ‰æºæ–‡ä»¶æˆ‘ä»¬éƒ½èƒ½äº²æ‰‹ç®¡ç†ï¼Œä¸”æ— éœ€ä¸ºä»˜è´¹çš„å¯¹è±¡å­˜å‚¨çš„å¥‡æ€ªçš„è®¡ä»·æ–‡æ¡£æ„Ÿåˆ°æ‰‹è¶³æ— æªï¼Œä¹Ÿä¸éœ€è¦æ‹…å¿ƒæœ‰äººæ¶æ„åˆ·æµæŠŠä½ ä¸€å¥—æˆ¿å­ç»™å¥—èµ°ã€‚</p><p>ç¼ºç‚¹å°±æ˜¯ï¼Œè‡ªå»ºçš„ç¨³å®šæ€§è‚¯å®šä¸å¦‚å·²æœ‰å‚å®¶æä¾›çš„æœåŠ¡ï¼Œä¸”è‡ªè´­çš„æœåŠ¡å™¨&#x2F;Nasä¸Šä¼ å¸¦å®½ä¸€èˆ¬éƒ½å¾ˆä½ï¼Œæ–‡ä»¶ä¸€å¤šï¼Œè®¿é—®é€Ÿåº¦å°±å¾ˆæ…¢äº†ã€‚</p><p>å¯¹äºæˆ‘ä¸ªäººè€Œè¨€ï¼Œè‡ªå»ºminioçš„å”¯ä¸€ä½œç”¨ï¼Œå°±æ˜¯å¤‡ä»½ä¸ƒç‰›äº‘&#x2F;é˜¿é‡Œäº‘å¯¹è±¡å­˜å‚¨ä¸­çš„æ–‡ä»¶ã€‚è€ƒè™‘åˆ°2023ä¸‹åŠå¹´ï¼Œå„å¤§å‚æ¥è¿boomäº‘æœåŠ¡ï¼Œå›½å¤–çš„è°·æ­Œè¿˜å‡ºç°äº†äº‘ç›˜é‡Œé¢ç”¨æˆ·çš„æ•°æ®å›æ»šåˆ°å‡ æœˆå‰çš„æ¶æ€§é—®é¢˜ï¼Œè¿™å¯æ˜¯å¯èƒ½å¯¼è‡´ç”¨æˆ·æ•°æ®ä¸¢å¤±çš„å¤§é—®é¢˜å•Šï¼</p><ul><li><a href="https://www.ithome.com/0/737/538.htm">è°·æ­Œå…¬å¸ƒæ–¹æ¡ˆï¼Œä¿®å¤ Drive äº‘ç›˜æ–‡ä»¶ä¸¢å¤±é—®é¢˜</a></li><li><a href="https://news.zol.com.cn/845/8455073.html">è°·æ­Œæ‰¿è®¤äº‘ç«¯ç¡¬ç›˜Google Driveå­˜åœ¨BUGï¼Œ3æœˆå†…ç”¨æˆ·æ–‡ä»¶å¯èƒ½ä¸¢å¤±</a></li></ul><p>æ‰€ä»¥ï¼Œå°†æ•°æ®åœ¨è‡ªå·±æœ¬åœ°ç•™ä¸€ä»½æ€»æ˜¯å®‰å¿ƒä¸€äº›ã€‚æ•°æ®å®‰å…¨é çš„æ˜¯å¤‡ä»½ï¼Œä¸æ˜¯äº‘æœåŠ¡å‚å®¶ç»™ä½ æä¾›çš„<code>99.99999%</code>å¯ç”¨æ€§çš„ä¸€é¢ä¹‹è¯ã€‚</p><p>å¦‚æœä½ å¯¹æ•°æ®å¤‡ä»½è¿™ä¸ªè¯é¢˜æ„Ÿå…´è¶£ï¼Œå¯ä»¥çœ‹çœ‹æˆ‘çš„å¦å¤–ä¸€ç¯‡åšå®¢ï¼š<a href="https://blog.musnow.top/posts/3543423459/?f=minio">è°ˆè°ˆå¦‚ä½•è¿›è¡Œæœ‰æ•ˆæ•°æ®å¤‡ä»½ï¼Œ3+2+1</a></p><blockquote><p>æ¸©é¦¨æé†’ï¼šå¦‚æœä½ æƒ³åœ¨<strong>äº‘æœåŠ¡å™¨</strong>ä¸Šå®‰è£…minioæ¥å¤‡ä»½å·²æœ‰S3ä¸­çš„æ–‡ä»¶çš„è¯ï¼Œæœ€å¥½æ˜¯ä½¿ç”¨ä¸€ä¸ªå’Œå·²æœ‰S3<strong>ä¸åœ¨åŒä¸€ä¸ªåœ°åŸŸã€éåŒä¸€ä¸ªæœåŠ¡å•†</strong>çš„äº‘æœåŠ¡å™¨ï¼Œé¿å…æŸäº›æœåŠ¡å•†äº‘æœåŠ¡å™¨å’Œå¯¹è±¡å­˜å‚¨ä¸€èµ·boomçš„æƒ…å†µâ€¦â€¦</p></blockquote><h1 id="2-dockerå®‰è£…minio"><a href="#2-dockerå®‰è£…minio" class="headerlink" title="2.dockerå®‰è£…minio"></a>2.dockerå®‰è£…minio</h1><h2 id="2-1-å®‰è£…docker"><a href="#2-1-å®‰è£…docker" class="headerlink" title="2.1 å®‰è£…docker"></a>2.1 å®‰è£…docker</h2><p>dockerå®‰è£…çš„æ•™ç¨‹è¯¦è§æˆ‘çš„å¦å¤–ä¸€ç¯‡åšå®¢</p><p><a href="https://blog.musnow.top/posts/2069190154/?f=minio">ã€Dockerã€‘deepin&#x2F;centoså®‰è£…docker | æ…•é›ªçš„å¯’èˆ</a></p><h2 id="2-2-å®‰è£…minio"><a href="#2-2-å®‰è£…minio" class="headerlink" title="2.2 å®‰è£…minio"></a>2.2 å®‰è£…minio</h2><p>è¿™é‡Œæ¨èä½¿ç”¨ç”±VMwareç»´æŠ¤çš„minio dockerç‰ˆæœ¬<code>bitnami/minio</code>ï¼Œæ›´æ–°å¾ˆé¢‘ç¹ã€‚</p><p><a href="https://hub.docker.com/r/bitnami/minio">hub.docker.com&#x2F;r&#x2F;bitnami&#x2F;minio</a></p><p>åˆ›å»ºå®¹å™¨çš„å‘½ä»¤å¦‚ä¸‹ï¼Œéå¸¸ç®€å•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">docker run -it -d --name minio \</span><br><span class="line">-p 9000:9000 \</span><br><span class="line">-p 9001:9001 \</span><br><span class="line">--restart=always \</span><br><span class="line">-v /minio/data:/bitnami/minio/data \</span><br><span class="line">-e MINIO_ROOT_USER=<span class="string">&quot;minio_root&quot;</span> \</span><br><span class="line">-e MINIO_ROOT_PASSWORD=<span class="string">&quot;minio_123456&quot;</span> \</span><br><span class="line">-e TZ=<span class="string">&#x27;Asia/Shanghai&#x27;</span> \</span><br><span class="line">bitnami/minio:latest</span><br></pre></td></tr></table></figure><p>è¯¥åˆ›å»ºå®¹å™¨æ“ä½œåŸºäºå¦‚ä¸‹hashçš„dockeré•œåƒï¼ˆæ›´æ–°äº2023-12-12ï¼‰ï¼Œåˆ›å»ºå®¹å™¨çš„å‘½ä»¤åç»­å¯èƒ½ä¼šæœ‰å˜åŠ¨ï¼Œè¯·å‚è€ƒdocker-hubä¸­çš„å®˜æ–¹æ–‡æ¡£</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bitnami/minio  latest    552af9bd3d6d   2 days ago     212MB</span><br></pre></td></tr></table></figure><p>å¯¹è¿™ä¸ªdockerå‘½ä»¤è¿›è¡Œè§£é‡Š</p><ul><li><code>-it -d</code>ï¼Œitæä¾›äº¤äº’èƒ½åŠ›ï¼Œdä»£è¡¨åå°è¿è¡Œ</li><li><code>--restart=always</code>ï¼Œå§‹ç»ˆé‡å¯dockerï¼ˆdockeræœåŠ¡é‡å¯åï¼Œé•œåƒä¼šè‡ªåŠ¨å¯åŠ¨ï¼‰</li><li><code>-p 9000:9000</code>ï¼Œå°†dockerå†…çš„9000ç«¯å£ï¼ˆå³ä¾§ï¼‰æ˜ å°„ç»™å®¿ä¸»æœºï¼ˆå·¦ä¾§ï¼‰çš„9000ç«¯å£ï¼Œç«¯å£9001çš„æ˜ å°„åŒç†ã€‚<ul><li>å®¹å™¨å†…9000ç«¯å£æ˜¯minioçš„apiç«¯å£ï¼ˆç”¨äºS3åè®®æ“ä½œï¼‰</li><li>å®¹å™¨å†…9001ç«¯å£æ˜¯minioçš„webç®¡ç†ç•Œé¢ç«¯å£</li><li>æ ¹æ®ä½ çš„éœ€è¦ï¼Œä¿®æ”¹<strong>å†’å·å·¦ä¾§</strong>çš„å®¿ä¸»æœºç«¯å£å³å¯ã€‚</li></ul></li><li><code>-v /minio/data:/bitnami/minio/data</code>ï¼Œå°†dockerå†…<code>/bitnami/minio/data</code>è·¯å¾„æ˜ å°„ç»™ä¸»æœº<code>/minio/data</code>è·¯å¾„ï¼Œä¸»æœºä¸Šçš„è·¯å¾„ï¼ˆå·¦ä¾§ï¼‰è¯·è‡ªè¡Œä¿®æ”¹ï¼›è¿™ä¸ªè·¯å¾„æ˜¯bucketå’Œminioé…ç½®æ–‡ä»¶çš„å­˜å‚¨è·¯å¾„ã€‚</li><li>ä¸¤ä¸ª<code>-e</code>è®¾ç½®çš„æ˜¯ç¯å¢ƒå˜é‡ï¼Œåˆ†åˆ«è®¾ç½®çš„æ˜¯minioç®¡ç†å‘˜çš„è´¦æˆ·å’Œç®¡ç†å‘˜çš„å¯†ç ã€‚è¯·æ³¨æ„ï¼Œåœ¨è¿™é‡Œé…ç½®äº†ç®¡ç†å‘˜ç”¨æˆ·åå’Œå¯†ç åï¼Œ<strong>è¿›å…¥minioç®¡ç†ç³»ç»Ÿçš„å¯†ç æ— æ³•è¢«ä¿®æ”¹</strong>ã€‚å¦‚æœä½ çš„minioæœåŠ¡éœ€è¦æš´éœ²åœ¨å…¬ç½‘ä¸Šï¼Œè¯·ä¸€å®šè¦è®¾ç½®ä¸€ä¸ª<strong>é«˜å¼ºåº¦</strong>çš„å¯†ç ï¼</li><li><code>-e TZ=&#39;Asia/Shanghai&#39;</code> è®¾ç½®æ—¶åŒºä¸ºä¸œå…«åŒºï¼ˆåç»­å®šæ—¶å¤‡ä»½éœ€è¦æœ‰æ­£ç¡®æ—¶åŒºï¼‰</li><li>æœ€åçš„<code>bitnami/minio:latest</code>ä»£è¡¨æˆ‘ä»¬éœ€è¦åˆ›å»º<code>bitnami/minio</code>è¿™ä¸ªdockeré•œåƒçš„latestç‰ˆæœ¬ï¼Œå¦‚æœæœ¬åœ°æ²¡æœ‰è¿™ä¸ªé•œåƒï¼Œåˆ™ä¼šè‡ªåŠ¨å»docker-hubæ‹‰å–ã€‚</li><li>å¦‚æœä½ å¡åœ¨äº†pullé•œåƒçš„æ­¥éª¤ï¼Œè¯·è‡ªè¡Œç™¾åº¦å¦‚ä½•<a href="https://blog.musnow.top/posts/2069190154/?f=minio">æ›¿æ¢dockerçš„é•œåƒæº</a>ã€‚</li></ul><p>å¦‚ä¸‹æ˜¯æˆ‘åœ¨ä¸€ä¸ªæ²¡æœ‰å®‰è£…è¿‡minioçš„äº‘æœåŠ¡ä¸Šæµ‹è¯•çš„ç»“æœï¼ŒæˆåŠŸå®‰è£…å¹¶å¯åŠ¨minio</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root:~/docker]# docker run -it -d --name minio \</span><br><span class="line">&gt; -p 19000:9000 \</span><br><span class="line">&gt; -p 19001:9001 \</span><br><span class="line">&gt; --restart=always \</span><br><span class="line">&gt; -v /root/docker/minio:/bitnami/minio/data \</span><br><span class="line">&gt; -e MINIO_ROOT_USER=&quot;minio_root&quot; \</span><br><span class="line">&gt; -e MINIO_ROOT_PASSWORD=&quot;minio_123456&quot; \</span><br><span class="line">&gt; bitnami/minio:latest</span><br><span class="line">Unable to find image &#x27;bitnami/minio:latest&#x27; locally</span><br><span class="line">latest: Pulling from bitnami/minio</span><br><span class="line">ef5975039511: Pull complete </span><br><span class="line">Digest: sha256:3bb81d101dea57a5382a2d01eda6991e75ce69669d2d49c4646d82721b7c258e</span><br><span class="line">Status: Downloaded newer image for bitnami/minio:latest</span><br><span class="line">afefbb9514de0f4a1c02b7f4212b1e05eee5ef342ed4ce27e03de10071914060</span><br></pre></td></tr></table></figure><p>å®¹å™¨æ­£å¸¸å¯åŠ¨ï¼Œå¤„äºRunningçŠ¶æ€ï¼ŒSTATUSæ­£å¸¸ï¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CONTAINER ID   IMAGE                                  COMMAND                  CREATED         STATUS         PORTS                                                                                      NAMES</span><br><span class="line">afefbb9514de   bitnami/minio:latest                   &quot;/opt/bitnami/scriptâ€¦&quot;   3 minutes ago   Up 3 minutes   0.0.0.0:19000-&gt;9000/tcp, :::19000-&gt;9000/tcp, 0.0.0.0:19001-&gt;9001/tcp, :::19001-&gt;9001/tcp   minio</span><br></pre></td></tr></table></figure><p>è¿™æ ·è¿˜ä¸å¤Ÿï¼Œè¯·åœ¨åç»­åˆ›å»ºäº†bucketå¹¶ä¸Šä¼ æµ‹è¯•æ–‡ä»¶åï¼ŒæŸ¥çœ‹æœ¬åœ°æ˜ å°„çš„è·¯å¾„ä¸­æ˜¯å¦æœ‰å¯¹åº”æ–‡ä»¶å¤¹å’Œæ–‡ä»¶ï¼Œ<strong>é¿å…è·¯å¾„æ˜ å°„å¤±è´¥</strong>ï¼ï¼ˆå¦‚æœè·¯å¾„æ²¡æœ‰æˆåŠŸæ˜ å°„åˆ°æœ¬åœ°ï¼Œé‚£ä¹ˆä½ å½“å‰åˆ›å»ºçš„minioè¢«åˆ é™¤ä¹‹åï¼Œæ–‡ä»¶å°±å¾ˆéš¾æ‰¾å›æ¥äº†ï¼‰</p><blockquote><p>é¡ºå¸¦ä¸€æï¼Œåœ¨æˆ‘è¿™è¾¹æµ‹è¯•å‘ç°ï¼Œå¦‚æœä½ é”™è¯¯ä½¿ç”¨æµè§ˆå™¨è®¿é—®äº†9000è¿™ä¸ªapiç«¯å£ï¼Œä¼šè¢«è‡ªåŠ¨é‡å®šå‘åˆ°9001 webç®¡ç†é¡µé¢ç«¯å£ï¼ˆå‰ææ˜¯æ˜ å°„çš„å®¿ä¸»æœºç«¯å£å’Œdockerå†…ç«¯å£ä¸€è‡´ï¼‰</p></blockquote><h2 id="2-3-webç®¡ç†"><a href="#2-3-webç®¡ç†" class="headerlink" title="2.3 webç®¡ç†"></a>2.3 webç®¡ç†</h2><p>ä½¿ç”¨ <code>http://IP:ç«¯å£</code> æ‰“å¼€minioçš„9001ç«¯å£å¯¹åº”çš„å®¿ä¸»æœºç«¯å£ï¼Œè®¿é—®minioçš„webç®¡ç†é¡µé¢ã€‚è¾“å…¥åˆšåˆšåˆ›å»ºå®¹å™¨æ—¶ï¼Œåœ¨ç¯å¢ƒå˜é‡é‡Œé¢é…ç½®çš„ç”¨æˆ·åå’Œå¯†ç è¿›è¡Œç™»å½•ï¼Œå³å¯è¿›å…¥æ§åˆ¶å°ã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/8ab832241e5ea9a14713e75fb56c2df0.png" alt="image.png"></p><p>minioçš„ç•Œé¢æ¯”è¾ƒç®€å•ï¼ŒåŸºæœ¬è¦åšçš„æ“ä½œåªæœ‰ä¸¤ä¸ªï¼Œåˆ›å»ºbucketå­˜å‚¨æ¡¶ï¼Œå’Œaccesskeyç”¨äºapiè°ƒç”¨ã€‚</p><blockquote><p>æ›´é«˜é˜¶çš„é…ç½®é¡¹å’Œæ“ä½œæˆ‘æ²¡æœ‰å°è¯•è¿‡ï¼Œè¯·è‡ªè¡Œå‚è€ƒminioçš„æ–‡æ¡£æˆ–è€…å…¶ä»–æ•™ç¨‹ã€‚</p></blockquote><h3 id="2-3-1-åˆ›å»ºbucket"><a href="#2-3-1-åˆ›å»ºbucket" class="headerlink" title="2.3.1 åˆ›å»ºbucket"></a>2.3.1 åˆ›å»ºbucket</h3><p>ç¬¬ä¸€ä¸ªç•Œé¢å°±æ˜¯å¤§å¤§çš„Object Browserï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºå­˜å‚¨æ¡¶</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/df27f17b80655b3107ef12018f180712.png" alt="image.png"></p><p>ç‚¹å‡»åˆ›å»ºbucketï¼Œä¼šè¿›å…¥å¦‚ä¸‹é…ç½®é¡¹ï¼Œé™¤äº†bucketçš„åå­—ï¼Œè¿˜æœ‰ä¸‰ä¸ªé€‰é¡¹</p><ul><li>Versioningï¼šç‰ˆæœ¬æ§åˆ¶ï¼Œå¼€å¯åï¼Œè¯¥bucketå°†å¤„äºå¤šç‰ˆæœ¬æ¨¡å¼ä¸‹ï¼Œæ–‡ä»¶ä¼šä¿ç•™ä¿®æ”¹çš„å†å²è®°å½•ã€‚</li><li>Object Lockingï¼šé¿å…æ–‡ä»¶è¢«åˆ é™¤ï¼Œéœ€è¦æ”¯æŒä¿ç•™å’Œåˆæ³•ä¿ç•™ï¼ˆè¿™ä¸¤ä¸ªå•¥æ„æ€æˆ‘ä¸æ˜ç™½ï¼‰ï¼Œè¯¥é€‰é¡¹åªèƒ½åœ¨bucketåˆ›å»ºæ—¶æ‰“å¼€ã€‚</li><li>Quotaï¼šé™åˆ¶å®¹å™¨ä¸­æ–‡ä»¶å¤§å°ï¼ˆæ€»å®¹é‡ï¼‰</li></ul><p>å¯¹äºæˆ‘çš„å¤‡ä»½éœ€æ±‚æ¥è¯´ï¼Œè¿™ä¸‰ä¸ªé¢å¤–é€‰é¡¹éƒ½ä¸éœ€è¦ï¼Œç›´æ¥åˆ›å»ºå°±è¡Œäº†</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/c7b5efc573e9e3691f0237a6e9d7357a.png" alt="image.png"></p><p>åˆ›å»ºä¹‹åï¼Œåœ¨bucketé¡µé¢å¯ä»¥çœ‹åˆ°åˆšåˆšåˆ›å»ºçš„testå­˜å‚¨æ¡¶ï¼Œè¿™é‡Œä¼šç»Ÿè®¡å­˜å‚¨å®¹é‡å’Œæ–‡ä»¶æ•°é‡</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/01016c16a27570ded8d93a7aa4781a1f.png" alt="image-20231213232421462"></p><h3 id="2-3-2-åˆ›å»ºaccessKey"><a href="#2-3-2-åˆ›å»ºaccessKey" class="headerlink" title="2.3.2 åˆ›å»ºaccessKey"></a>2.3.2 åˆ›å»ºaccessKey</h3><p>accessKeyæ˜¯ç”¨äºæ“ä½œapiçš„tokenå‡­è¯ã€‚åˆ›å»ºå®Œæ¯•åï¼Œä»–åªä¼šæ˜¾ç¤ºä¸€æ¬¡ï¼Œåç»­å°†ä¸ä¼šæ˜¾ç¤ºå‡ºæ¥ã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/7413b4978a8916f3ba34043afa034e7f.png" alt="image.png"></p><p>å¦‚æœä½ ä¸æƒ³åˆ›å»ºå¤ªå¤šä¸ªå¯†é’¥ï¼Œé‚£å°±æŠŠè¿™ä¸ªå¯†é’¥çš„æ–‡ä»¶ä¸‹è½½ä¸‹æ¥ï¼Œå…å¾—åˆ°æ—¶å€™ä¸çŸ¥é“æ˜¯ä»€ä¹ˆäº†ã€‚ç‚¹å‡»å³ä¸‹è§’çš„importæ–‡ä»¶å°±å¯ä»¥ä¸‹è½½ï¼Œä¼šä¸‹è½½ä¸€ä¸ª<code>json</code>æ–‡ä»¶ï¼Œå†…éƒ¨åŒ…å«å¯†é’¥å’Œå…¶ä»–ä¸€äº›ç›¸å…³ä¿¡æ¯</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/c06b9cd5866f9b3d9a2f37e0ded15404.png" alt="image.png"></p><p>å› ä¸ºæˆ‘è¿™åªæ˜¯åšä¸ªæµ‹è¯•ï¼Œä¸€ä¼šå°±ä¼šæŠŠè¿™ä¸ªminioçš„dockeråˆ é™¤ï¼Œæ‰€ä»¥å±•ç¤ºå¯†é’¥æ— æ‰€è°“ã€‚å¦‚æœä½ æ˜¯åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ä½¿ç”¨ï¼Œè¯·ä¸€å®šä¸è¦æš´éœ²ä½ çš„å¯†é’¥ç»™ä»»ä½•äººã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://å…¬ç½‘IP:19001/api/v1/service-account-credentials&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;accessKey&quot;</span><span class="punctuation">:</span> <span class="string">&quot;aXpBxrUceV30Id6gOouG&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;secretKey&quot;</span><span class="punctuation">:</span> <span class="string">&quot;dIWl9IFL05UtaI08PZfPXE66zPGu2zWrGFfSTaUm&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;api&quot;</span><span class="punctuation">:</span> <span class="string">&quot;s3v4&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;auto&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>å¯†é’¥åˆ›å»ºå®Œæ¯•ï¼Œå°±èƒ½åœ¨åˆ—è¡¨çœ‹åˆ°å®ƒã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/d70adb75c6ec74a362a065e9afc88092.png" alt="image.png"></p><h1 id="3-rcloneå¤‡ä»½"><a href="#3-rcloneå¤‡ä»½" class="headerlink" title="3.rcloneå¤‡ä»½"></a>3.rcloneå¤‡ä»½</h1><p>rcloneæ˜¯ä¸€ä¸ªå…¨å¹³å°çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œå…¶å¯ä»¥ç”¨äºå¤šç§äº‘ç«¯&#x2F;æœ¬åœ°å­˜å‚¨ä¹‹é—´çš„æ•°æ®æ‹·è´ã€åŒæ­¥ã€åŠ å¯†åŒæ­¥ç­‰åŠŸèƒ½ã€‚è¯¦è§rcloneå®˜ç½‘ï¼š<a href="https://rclone.org/">rclone.org</a></p><p>å› ä¸ºæˆ‘çš„ç›®æ ‡å°±æ˜¯æˆ‘çš„ä¸ƒç‰›äº‘bucketé‡Œé¢çš„å›¾åºŠæ–‡ä»¶å¤‡ä»½åˆ°æœ¬åœ°ï¼Œrcloneç»å¯¹æ˜¯ä¸äºŒä¹‹é€‰ã€‚</p><h2 id="3-1-è¿›å…¥dockerå®¹å™¨å†…ç»ˆç«¯"><a href="#3-1-è¿›å…¥dockerå®¹å™¨å†…ç»ˆç«¯" class="headerlink" title="3.1 è¿›å…¥dockerå®¹å™¨å†…ç»ˆç«¯"></a>3.1 è¿›å…¥dockerå®¹å™¨å†…ç»ˆç«¯</h2><p>ä½ å¯ä»¥é€‰æ‹©åœ¨<strong>å®¿ä¸»æœº</strong>ä¸Šå®‰è£…rcloneï¼Œä¹Ÿå¯ä»¥é€‰æ‹©ç›´æ¥åœ¨minioçš„å®¹å™¨å†…å®‰è£…rcloneã€‚</p><p>å‰æ’æé†’ï¼šéƒ¨åˆ†naså“ç‰Œçš„ç³»ç»Ÿï¼ˆæ¯”å¦‚ç¾¤æ™–ï¼‰å·²ç»æä¾›äº†<strong>æ‰§è¡Œå®šæ—¶è„šæœ¬</strong>çš„åŠŸèƒ½ï¼Œè¿™ç§æƒ…å†µä¸‹ç›´æ¥ä½¿ç”¨ç³»ç»Ÿæä¾›çš„å®šæ—¶ä»»åŠ¡æ¥æ‰§è¡Œ<code>rclone sync</code>å³å¯ï¼Œ<strong>å³ç›´æ¥åœ¨nasé‡Œé¢å®‰è£…rcloneå’Œä½¿ç”¨å®šæ—¶ä»»åŠ¡</strong>ï¼Œä¸è¦åœ¨minioçš„dockeré‡Œé¢å®‰è£…rcloneã€‚</p><p>å¦‚ä½ é€‰æ‹©äº†åœ¨å®¿ä¸»æœºä¸Šå®‰è£…rcloneï¼Œåˆ™å¯ä»¥ç›´æ¥<strong>è·³è¿‡æœ¬3.1æ­¥éª¤</strong>ï¼Œé˜…è¯»3.2åŠåç»­æ­¥éª¤</p><h3 id="dockerç‰¹æƒæ¨¡å¼"><a href="#dockerç‰¹æƒæ¨¡å¼" class="headerlink" title="dockerç‰¹æƒæ¨¡å¼"></a>dockerç‰¹æƒæ¨¡å¼</h3><p>æ³¨æ„ï¼Œå¦‚æœåœ¨minioçš„å®¹å™¨å†…å®‰è£…rcloneï¼Œé‚£ä¹ˆminioå®¹å™¨è¢«åˆ é™¤åï¼Œ<strong>rcloneå’Œå®ƒçš„é…ç½®æ–‡ä»¶è‡ªç„¶ä¹Ÿä¸åœ¨äº†</strong>ã€‚</p><p><strong>ä¸”å¦‚æœéœ€è¦ç”¨minioçš„å®¹å™¨è¿›è¡Œcrontabå®šæ—¶ä»»åŠ¡</strong>ï¼Œåˆ™å¿…é¡»ç”¨<strong>ç‰¹æƒæ¨¡å¼</strong>å®‰è£…minioçš„dockerï¼Œåœ¨minioçš„dockeråˆ›å»ºå‘½ä»¤é‡Œé¢åŠ å¦‚ä¸‹è¿™æ¡ï¼Œè®¾ç½®ç‰¹æƒæ¨¡å¼ï¼ˆä¸éœ€è¦å®šæ—¶ä»»åŠ¡å¯ä»¥ä¸è®¾ç½®ï¼‰ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--privileged</span><br></pre></td></tr></table></figure><p>åœ¨ç»¿è”nasçš„dockerç®¡ç†ç•Œé¢ï¼Œåˆ›å»ºdockerçš„æ—¶å€™ç»™å®šæ‰€æœ‰æƒé™ï¼Œä¹Ÿæ˜¯ä¸€æ ·çš„æ•ˆæœã€‚ï¼ˆå› ä¸ºæˆ‘ä¸å¤ªäº†è§£è¿™é‡Œå…·ä½“æ¯ä¸ªæƒé™çš„ä½œç”¨ï¼Œå¹²è„†å…¨ç»™äº†ï¼‰</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/accf78ec16b7e73aec583e3672291e37.png" alt="image.png"></p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/e96098feea2769aa014db319b74bff58.png" alt="image.png"></p><h3 id="sshè¿æ¥å®¿ä¸»è®¾å¤‡"><a href="#sshè¿æ¥å®¿ä¸»è®¾å¤‡" class="headerlink" title="sshè¿æ¥å®¿ä¸»è®¾å¤‡"></a>sshè¿æ¥å®¿ä¸»è®¾å¤‡</h3><p>ä¸åŒnasæœºå‹è¿›å…¥sshçš„æ–¹å¼ä¸å¤ªä¸€æ ·ï¼Œè¯·å‚è€ƒä½ çš„nasæˆ–è®¾å¤‡å“ç‰Œæœç´¢å¯¹åº”ç±»å‹æ•™ç¨‹ã€‚</p><p><strong>è¿æ¥åˆ°å®¿ä¸»è®¾å¤‡çš„sshå</strong>ï¼Œå‚è€ƒï¼š<a href="https://www.cnblogs.com/langgeligelang/p/13628821.html">ä»¥æŒ‡å®šç”¨æˆ·å¯åŠ¨å’Œè¿›å…¥dockerå®¹å™¨ - langyong - åšå®¢å›­</a> ä¸€æ–‡ï¼Œä½¿ç”¨å¦‚ä¸‹dockerå‘½ä»¤è¿›å…¥minioçš„å®¹å™¨ç»ˆç«¯ä¸­ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it -u ç”¨æˆ·å å®¹å™¨å /bin/bash</span><br><span class="line"><span class="comment"># ç¤ºä¾‹å¦‚ä¸‹</span></span><br><span class="line">docker <span class="built_in">exec</span> -it -u root minio /bin/bash</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ç»¿è”ã€æç©ºé—´è¿™ç±»ä¸å¤ªæ–¹ä¾¿è¿›å…¥sshçš„nasï¼Œå¯ä»¥åœ¨nasçš„dockerç®¡ç†é¡µé‡Œé¢æ“ä½œï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œé€‰æ‹©<code>/bin/bash</code>åç‚¹å‡»é“¾æ¥å³å¯è¿›å…¥å®¹å™¨å†…ç»ˆç«¯ã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/20231214091932.png" alt="image.png"></p><h2 id="3-2-ä¸‹è½½å®‰è£…rclone"><a href="#3-2-ä¸‹è½½å®‰è£…rclone" class="headerlink" title="3.2 ä¸‹è½½å®‰è£…rclone"></a>3.2 ä¸‹è½½å®‰è£…rclone</h2><p>è¿›å…¥ç»ˆç«¯åï¼Œé»˜è®¤æ‰€åœ¨è·¯å¾„æ˜¯dockerå®¹å™¨çš„å·¥ä½œè·¯å¾„<code>/opt/bitnami/minio-client</code>ã€‚</p><p>ä¸ºäº†é¿å…å½±å“å®¹å™¨è¿è¡Œï¼Œæˆ‘ä»¬ä¸è¦åœ¨å·¥ä½œè·¯å¾„é‡Œé¢åšæ“ä½œï¼Œè¯·ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„rcloneæ–‡ä»¶å¤¹ï¼Œè¿›å…¥rootç”¨æˆ·çš„å®¶ç›®å½•è¿›è¡Œæ“ä½œã€‚</p><p>å¦‚æœä½ æ˜¯åœ¨å®¿ä¸»æœºä¸Šæ“ä½œï¼Œä¹Ÿæ˜¯ä¸€æ ·çš„é“ç†ï¼Œä¸ºrcloneå•ç‹¬åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œæ¥å­˜æ”¾å®ƒçš„è½¯ä»¶åŒ…ã€é…ç½®æ–‡ä»¶ã€æ‰§è¡Œæ—¥å¿—ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir /root/rclone</span><br><span class="line">cd /root/rclone</span><br></pre></td></tr></table></figure><blockquote><p>å¦‚æœæ˜¯dockerå†…æ“ä½œï¼Œä½ å¯ä»¥åœ¨åˆ›å»ºminioå®¹å™¨çš„æ—¶å€™ï¼Œå°±æŠŠ<code>/root/rclone</code>è·¯å¾„ç»™æ˜ å°„åˆ°å®¿ä¸»æœºä¸Šï¼Œæ–¹ä¾¿åç»­æŸ¥çœ‹rcloneå¤‡ä»½çš„æ—¥å¿—ã€‚</p></blockquote><p>ä¸‹è½½å®‰è£…rcloneçš„å‘½ä»¤å¦‚ä¸‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">curl -O https://downloads.rclone.org/rclone-current-linux-amd64.zip</span><br><span class="line">unzip rclone-current-linux-amd64.zip</span><br><span class="line"><span class="built_in">cd</span> rclone-*-linux-amd64</span><br><span class="line"> </span><br><span class="line">sudo <span class="built_in">cp</span> rclone /usr/bin/</span><br><span class="line">sudo <span class="built_in">chown</span> root:root /usr/bin/rclone</span><br><span class="line">sudo <span class="built_in">chmod</span> 755 /usr/bin/rclone</span><br></pre></td></tr></table></figure><p>minioçš„dockerå†…æ²¡æœ‰unzipå‘½ä»¤ï¼Œéœ€è¦å®‰è£…ä¸€ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get update &amp;&amp; apt-get install -y unzip</span><br></pre></td></tr></table></figure><p>minioçš„dockerå†…ä¹Ÿæ²¡æœ‰sudoï¼Œå°†ä¸Šè¿°å®‰è£…å‘½ä»¤ä¸­çš„sudoå»æ‰å°±å¯ä»¥äº†ã€‚</p><p>å®Œæˆå®‰è£…å‘½ä»¤åï¼Œæ‰§è¡Œä¸€ä¸‹<code>rclone</code>ï¼Œå‡ºç°rcloneå‘½ä»¤çš„ä½¿ç”¨æç¤ºï¼Œé‚£å°±æ˜¯å®‰è£…æˆåŠŸäº†ï¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@878a0dd03ec4:/root/rclone/rclone-v1.65.0-linux-amd64# rclone</span><br><span class="line">Usage:</span><br><span class="line">  rclone [flags]</span><br><span class="line">  rclone [command]</span><br><span class="line">  ...</span><br></pre></td></tr></table></figure><h2 id="3-3-rcloneå¯¹è±¡å­˜å‚¨é…ç½®"><a href="#3-3-rcloneå¯¹è±¡å­˜å‚¨é…ç½®" class="headerlink" title="3.3 rcloneå¯¹è±¡å­˜å‚¨é…ç½®"></a>3.3 rcloneå¯¹è±¡å­˜å‚¨é…ç½®</h2><p>rcloneçš„å®˜ç½‘ä¸Šæœ‰ä¸åŒäº‘ç«¯å­˜å‚¨åè®®å’Œä¸åŒS3æœåŠ¡å•†çš„é…ç½®æ•™ç¨‹ï¼Œè·Ÿç€å®˜æ–¹çš„æ¥å°±å¯ä»¥äº†ã€‚</p><p>æ‰§è¡Œ<code>rclone config</code>å‘½ä»¤ï¼Œå·¥å…·ä¼šè‡ªåŠ¨åœ¨<code>/.config/rclone/rclone.conf</code>ä¸‹åˆ›å»ºä¸€ä¸ªconfigæ–‡ä»¶ï¼Œä½ å¯ä»¥æ ¹æ®<a href="https://rclone.org/">å®˜æ–¹çš„å‘å¯¼</a>ï¼Œåœ¨æ­¤å¤„æ·»åŠ æ–°çš„remote;</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">root@878a0dd03ec4:/root/rclone/rclone-v1.65.0-linux-amd64# rclone config</span><br><span class="line">2023/12/14 04:38:44 NOTICE: Config file &quot;/.config/rclone/rclone.conf&quot; not found - using defaults</span><br><span class="line">No remotes found, make a new one?</span><br><span class="line">n) New remote</span><br><span class="line">s) Set configuration password</span><br><span class="line">q) Quit config</span><br><span class="line">n/s/q&gt; q</span><br></pre></td></tr></table></figure><p>ä¸‹é¢ç»™å‡ºminioå’Œä¸ƒç‰›äº‘çš„é…ç½®æ–‡ä»¶ï¼Œä½ å¯ä»¥ç›´æ¥ä¿®æ”¹è¿™ä¸ªé…ç½®æ–‡ä»¶ä¸­çš„å†…å®¹ä¸ºä½ çš„é…ç½®ï¼Œç„¶åå†™å…¥<code>/.config/rclone/rclone.conf</code>å³å¯ã€‚</p><ul><li><a href="https://rclone.org/s3/#minio">rclone.org&#x2F;s3&#x2F;#minio</a></li><li><a href="https://rclone.org/s3/#qiniu">rclone.org&#x2F;s3&#x2F;#qiniu</a></li></ul><p>å…¶ä¸­minioçš„regionåœ¨minioçš„æ§åˆ¶å°é‡Œé¢å¯ä»¥ä¿®æ”¹ï¼Œå¦‚æœä½ æ²¡æœ‰ä¿®æ”¹è¿‡ï¼Œé»˜è®¤ä½¿ç”¨çš„æ˜¯<code>us-east-1</code>ã€‚å› ä¸ºrcloneæ˜¯ç›´æ¥åœ¨minioçš„dockeré‡Œé¢æ‰§è¡Œçš„ï¼Œæ‰€ä»¥endpointåªéœ€è¦å†™æˆ<code>127.0.0.1</code>å’Œminioçš„apiç«¯å£9000å°±å¯ä»¥äº†ã€‚</p><p>å¦‚æœä½ çš„minioåœ¨å…¬ç½‘æˆ–è€…å…¶ä»–è®¾å¤‡ä¸Šï¼Œè¯·ä¿®æ”¹å¯¹åº”çš„IPåœ°å€å’Œç«¯å£ã€‚</p><p>ä¸ƒç‰›äº‘çš„regionå’Œendpointåœ¨<strong>ä¸ƒç‰›äº‘bucketé¡µé¢</strong>æ‰¾åˆ°<strong>S3åŸŸå</strong>å°±å¯ä»¥çœ‹åˆ°ã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/64d88c8052b653bb69edbed3d75fdca5.png" alt="image.png"></p><blockquote><p>è¯·æ³¨æ„ï¼Œä¸ƒç‰›äº‘&#x2F;é˜¿é‡Œäº‘è¿™ç±»å­˜å‚¨æœåŠ¡å•†ï¼Œå¦‚æœä½ æœ‰å¤šä¸ªbucketï¼Œä¸”ä»–ä»¬çš„åœ°åŸŸä¸ä¸€æ ·ï¼Œåˆ™éœ€è¦æ–°å¢å¯¹åº”åœ°åŸŸçš„é…ç½®é¡¹ã€‚é€šè¿‡ä¿®æ”¹<code>[]</code>é‡Œé¢çš„<strong>é…ç½®å</strong>è¿›è¡ŒåŒºåˆ†ã€‚</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[minio]</span><br><span class="line">type = s3</span><br><span class="line">provider = Minio</span><br><span class="line">env_auth = false</span><br><span class="line">access_key_id = æ§åˆ¶å°è·å–çš„key_id</span><br><span class="line">secret_access_key = æ§åˆ¶å°è·å–çš„secret_key</span><br><span class="line">region = us-east-1</span><br><span class="line">endpoint = http://127.0.0.1:9000</span><br><span class="line">location_constraint =</span><br><span class="line">server_side_encryption =</span><br><span class="line"></span><br><span class="line">[qiniu]</span><br><span class="line">type = s3</span><br><span class="line">provider = Qiniu</span><br><span class="line">access_key_id = ä¸ƒç‰›äº‘æ§åˆ¶å°è·å–key_id</span><br><span class="line">secret_access_key = ä¸ƒç‰›äº‘æ§åˆ¶å°è·å–secret_key</span><br><span class="line">region = cn-east-1</span><br><span class="line">endpoint = s3-cn-east-1.qiniucs.com</span><br><span class="line">location_constraint = cn-east-1</span><br><span class="line">acl = private</span><br><span class="line">storage_class = STANDARD</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå®‰è£…nanoç¼–è¾‘å™¨ï¼Œç„¶åä½¿ç”¨nanoç¼–è¾‘å™¨æ‰“å¼€rcloneé…ç½®æ–‡ä»¶è¿›è¡Œç¼–è¾‘ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt-get update &amp;&amp; apt-get install -y nano</span><br><span class="line">nano /.config/rclone/rclone.conf</span><br></pre></td></tr></table></figure><p>linuxä¸‹çš„ç²˜è´´å‘½ä»¤æ˜¯<code>CTRL+SHIFT+V</code>æˆ–<code>CTRL+INSERT</code>ï¼Œä½ å¯ä»¥åœ¨æœ¬åœ°ä¿®æ”¹äº†é…ç½®æ–‡ä»¶åï¼Œé€šè¿‡nanoç¼–è¾‘å™¨ï¼Œç›´æ¥ç²˜è´´åˆ°dockerå®¹å™¨å†…ã€‚ç¼–è¾‘å®Œæ¯•åï¼Œä½¿ç”¨<code>CTRL+X</code>é€€å‡ºnanoçš„ç¼–è¾‘æ¨¡å¼ï¼Œå¹¶æŒ‰Yç¡®è®¤ä¿å­˜ï¼Œéšåç›´æ¥å›è½¦ï¼Œå³å®Œæˆç¼–è¾‘ã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/f82a30d9349cb55e60bc621dc2264be3.png" alt="image.png"></p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/283ab6851395ecf722d287aa06a8de0b.png" alt="image.png"></p><p>è¿™ä¸ªé…ç½®æ–‡ä»¶å»ºè®®å¤‡ä»½ä¸€ä¸ªï¼Œå…å¾—æ¯æ¬¡éƒ½å¾—é‡æ–°å¼„</p><h2 id="3-4-rcloneåŸºæœ¬å‘½ä»¤"><a href="#3-4-rcloneåŸºæœ¬å‘½ä»¤" class="headerlink" title="3.4 rcloneåŸºæœ¬å‘½ä»¤"></a>3.4 rcloneåŸºæœ¬å‘½ä»¤</h2><h3 id="copy"><a href="#copy" class="headerlink" title="copy"></a>copy</h3><p>æ‹·è´å‘½ä»¤å¦‚ä¸‹ï¼Œé…ç½®åç§°æ˜¯åœ¨configæ–‡ä»¶ä¸­<code>[]</code>é‡Œé¢çš„æ–‡å­—ï¼Œæ¡¶åå°±æ˜¯ä½ çš„S3æœåŠ¡é‡Œé¢çš„å¯¹è±¡å­˜å‚¨æ¡¶ï¼Œè¿˜å¯ä»¥åœ¨æ¡¶ååé¢ç”¨<code>/</code>æ¥è¿½åŠ æŒ‡å®šä¸Šä¼ çš„è·¯å¾„ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rclone copy æœ¬åœ°æ–‡ä»¶è·¯å¾„ é…ç½®åç§°:æ¡¶å</span><br><span class="line">rclone copy æœ¬åœ°æ–‡ä»¶è·¯å¾„ é…ç½®åç§°:æ¡¶å/æ¡¶å†…ç›®å½•</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘åœ¨dockerå†…åˆ›å»ºäº†ä¸€ä¸ª<code>test.txt</code>æ–‡ä»¶ï¼Œå°è¯•å°†å…¶æ‹·è´åˆ°minioé‡Œé¢ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">touch test.txt</span><br><span class="line">rclone copy ./test.txt minio:1panel-bak</span><br></pre></td></tr></table></figure><p>å‘½ä»¤æ²¡æœ‰é”™è¯¯è¾“å‡ºï¼Œå³æ‹·è´æˆåŠŸï¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@878a0dd03ec4:/root/rclone# touch test.txt</span><br><span class="line">root@878a0dd03ec4:/root/rclone# rclone copy ./test.txt minio:1panel-bak</span><br><span class="line">root@878a0dd03ec4:/root/rclone# </span><br></pre></td></tr></table></figure><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/bcd922882c21dbe6aa3e8aeb67fe08fa.png" alt="image.png"></p><p>å°è¯•åœ¨æ‹·è´çš„æ—¶å€™æŒ‡å®šè¿œç«¯ä»“åº“å†…çš„è·¯å¾„</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rclone copy ./test.txt minio:qiniu-muxue-sy/test</span><br></pre></td></tr></table></figure><p>æˆåŠŸæŒ‡å®šï¼Œæ–‡ä»¶è¢«ä¸Šä¼ åˆ°äº†testæ–‡ä»¶å¤¹é‡Œé¢ã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/20231214133906.png" alt="image.png"></p><h3 id="sync"><a href="#sync" class="headerlink" title="sync"></a>sync</h3><p>å¤‡ä»½å‘½ä»¤å¦‚ä¸‹ï¼Œå¯ä»¥åœ¨ä»»æ„ç›®çš„åœ°ï¼ˆæœ¬åœ°-è¿œç«¯ï¼Œè¿œç«¯-æœ¬åœ°ï¼Œè¿œç«¯-è¿œç«¯ï¼‰é‡Œé¢æ‰§è¡Œè¿™ä¸ªå‘½ä»¤ï¼Œå·¦ä¾§æ˜¯æºè·¯å¾„ï¼Œå³ä¾§æ˜¯ç›®æ ‡ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rclone sync æœ¬åœ°æºæ–‡ä»¶è·¯å¾„  ç›®çš„åœ°é…ç½®åç§°:æ¡¶å </span><br><span class="line">rclone sync æºé…ç½®åç§°:æ¡¶å ç›®çš„åœ°é…ç½®åç§°:æ¡¶å</span><br><span class="line">rclone sync æºé…ç½®åç§°:æ¡¶å ç›®çš„åœ°çš„æœ¬åœ°æ–‡ä»¶è·¯å¾„</span><br></pre></td></tr></table></figure><p>rclone syncæœ‰ä¸¤ä¸ªå¸¸ç”¨çš„é€‰é¡¹ï¼Œåˆšå¼€å§‹ä½¿ç”¨çš„æ—¶å€™ï¼Œå»ºè®®å¸¦ä¸Š <code>--dry-run</code> å‘½ä»¤æ¥ç¡®è®¤è‡ªå·±çš„é…ç½®æ²¡æœ‰é—®é¢˜</p><ul><li><code>-P</code> æ˜¾ç¤ºè¯¦ç»†åŒæ­¥è¿›åº¦æ¡</li><li><code>--dry-run</code> ç”¨ä½œå‘½ä»¤æµ‹è¯•ï¼Œä¸ä¼šçœŸæ­£çš„æ‰§è¡ŒåŒæ­¥</li></ul><p>æŒ‡å®š<code>-P</code>å‘½ä»¤åçš„è¿›åº¦è¾“å‡ºå¦‚ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°å®æ—¶ç½‘é€Ÿå’Œæ–‡ä»¶æ•°é‡&#x2F;å¤§å°ã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/20231214133932.png" alt="image.png"></p><p>ç›®å‰å‘ç°çš„é—®é¢˜æ˜¯minioæ˜¾ç¤ºçš„æ–‡ä»¶æ€»é‡å’Œæ•°æ®å­˜å‚¨é‡ä¼š<strong>æœ‰ä¸€å®šæ»å</strong>ï¼Œåˆšå¼€å§‹æˆ‘è¿˜ä»¥ä¸ºæ˜¯rcloneæ²¡æœ‰è·‘å®Œå‘¢ï¼Œsyncå®Œæ¯•è¿‡äº†å‡ åˆ†é’Ÿminioé‡Œé¢æ‰åˆ·å‡ºæ­£ç¡®çš„æ–‡ä»¶æ•°é‡æ¥ã€‚</p><h2 id="3-5-cronå®šæ—¶åŒæ­¥"><a href="#3-5-cronå®šæ—¶åŒæ­¥" class="headerlink" title="3.5 cronå®šæ—¶åŒæ­¥"></a>3.5 cronå®šæ—¶åŒæ­¥</h2><p>å‰æ’æé†’ï¼šéƒ¨åˆ†naså“ç‰Œçš„ç³»ç»Ÿï¼ˆæ¯”å¦‚ç¾¤æ™–ï¼‰å·²ç»æä¾›äº†<strong>æ‰§è¡Œå®šæ—¶è„šæœ¬</strong>çš„åŠŸèƒ½ï¼Œè¿™ç§æƒ…å†µä¸‹ç›´æ¥ä½¿ç”¨ç³»ç»Ÿæä¾›çš„å®šæ—¶ä»»åŠ¡æ¥æ‰§è¡Œ<code>rclone sync</code>å³å¯ï¼Œæ— åºå®‰è£…å…¶ä»–æœåŠ¡ã€‚<strong>å³ç›´æ¥åœ¨nasé‡Œé¢å®‰è£…rcloneå’Œä½¿ç”¨å®šæ—¶ä»»åŠ¡</strong>ï¼Œä¸è¦åœ¨minioçš„dockeré‡Œé¢å®‰è£…rcloneå’Œcronã€‚</p><ul><li>ç¾¤æ™–å®˜ç½‘å…³äºå®šæ—¶ä»»åŠ¡çš„è¯´æ˜ï¼š <a href="https://kb.synology.cn/zh-cn/DSM/help/DSM/AdminCenter/system_taskscheduler?version=6">https://kb.synology.cn/zh-cn/DSM/help/DSM/AdminCenter/system_taskscheduler?version=6</a></li><li>ç»¿è”nasçš„ç¯å¢ƒä¸­å·²æœ‰crontabï¼Œä½†æˆ‘æ²¡æœ‰è¯•è¿‡ä½¿ç”¨å®ƒã€‚è€ƒè™‘åˆ°ç»¿è”è¿™ä¸ªnasçš„ç³»ç»Ÿè¿˜æ˜¯ä¸€ç‚¹éƒ½ä¸ç¨³å®šï¼Œè¿˜æ˜¯åˆ«åŠ¨å®ƒçš„ç³»ç»Ÿé‡Œé¢çš„ä¸œè¥¿äº†ï¼Œä¸çŸ¥é“ç»¿è”å®˜æ–¹æœ‰æ²¡æœ‰å¯èƒ½æŠŠå®šæ—¶ä»»åŠ¡åŠ åˆ°æ§åˆ¶é¡µé‡Œé¢å»å§ï¼ˆæˆ‘ä¼°è®¡æ˜¯æ²¡æˆï¼Œè¿™ä¸ªç³»ç»Ÿçš„é™åˆ¶å¤ªå¤šäº†ï¼‰ã€‚</li></ul><p>å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ç¾¤æ™–ã€å¨è”é€šç­‰æä¾›äº†æ‰§è¡Œå®šæ—¶ä»»åŠ¡çš„åŠŸèƒ½çš„nasï¼Œè¯·åœ¨naså†…é…ç½®å¥½rcloneåï¼Œè‡ªè¡Œç™¾åº¦æ‰§è¡Œå®šæ—¶ä»»åŠ¡ç›¸å…³æ•™ç¨‹ã€‚</p><h3 id="minio-dockerå†…å®‰è£…cronæœåŠ¡"><a href="#minio-dockerå†…å®‰è£…cronæœåŠ¡" class="headerlink" title="minio dockerå†…å®‰è£…cronæœåŠ¡"></a>minio dockerå†…å®‰è£…cronæœåŠ¡</h3><p>ä¸‹é¢ä»‹ç»åœ¨minioçš„dockerå†…cronæœåŠ¡çš„å®‰è£…å’Œä½¿ç”¨ã€‚</p><p>åœ¨minioçš„dockeré‡Œé¢ç›´æ¥å®‰è£…crontabæœåŠ¡å’Œnanoæ–‡æœ¬ç¼–è¾‘å™¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt-get update</span><br><span class="line">apt-get install -y cron nano</span><br></pre></td></tr></table></figure><p>ä½†è¿™è¿˜ä¸å¤Ÿï¼ŒcronæœåŠ¡çš„è¿è¡Œè¿˜ä¾èµ–äºå…¶ä»–ç»„ä»¶ï¼Œéœ€è¦ä¸€å¹¶å®‰è£…ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt-get install -y rsyslog  postfix</span><br><span class="line">service rsyslog start</span><br></pre></td></tr></table></figure><p>å®‰è£…postfixçš„æ—¶å€™ä¼šæç¤ºè®©ä½ é€‰æ‹©é…ç½®æ–‡ä»¶ï¼Œé”®å…¥1é€‰æ‹©æ— é…ç½®å°±å¤Ÿäº†ã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/934acd2b8c197729473f9d2a917740ca.png" alt="image.png"></p><p>postfixè¿˜éœ€è¦é¢å¤–é…ç½®ï¼Œå¦åˆ™å¯èƒ½ä¼šé‡åˆ°å¦‚ä¸‹é”™è¯¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Dec 16 01:07:01 878a0dd03ec4 postfix/sendmail[1859]: fatal: open /etc/postfix/main.cf: No such file or directory</span><br><span class="line">Dec 16 01:12:02 878a0dd03ec4 postfix/postdrop[1912]: warning: unable to look up public/pickup: No such file or directory</span><br></pre></td></tr></table></figure><p>é…ç½®å‘½ä»¤å¦‚ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">touch /etc/postfix/main.cf</span><br><span class="line">mkfifo /var/spool/postfix/public/pickup</span><br></pre></td></tr></table></figure><h3 id="crontabé…ç½®å®šæ—¶ä»»åŠ¡æµ‹è¯•"><a href="#crontabé…ç½®å®šæ—¶ä»»åŠ¡æµ‹è¯•" class="headerlink" title="crontabé…ç½®å®šæ—¶ä»»åŠ¡æµ‹è¯•"></a>crontabé…ç½®å®šæ—¶ä»»åŠ¡æµ‹è¯•</h3><p>å®‰è£…å®Œæ¯•åï¼Œä½¿ç”¨<code>crontab -e</code>çœ‹çœ‹æ˜¯å¦èƒ½æ‰“å¼€crontabçš„é…ç½®ç¼–è¾‘é¡µé¢ï¼Œå¦‚æœå¯ä»¥æ‰“å¼€å¦‚ä¸‹é…ç½®ç•Œé¢ï¼Œåˆ™ä»£è¡¨cronå®‰è£…æˆåŠŸã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/20231214111457.png" alt="image.png"></p><p>è¿™ä¸ªé…ç½®æ–‡ä»¶éœ€è¦å†™å…¥çš„æ ¼å¼å¦‚ä¸‹ï¼Œä¸€è¡Œå¯¹åº”ä¸€ä¸ªé…ç½®ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">äº”ä½cronè¡¨è¾¾å¼ éœ€è¦æ‰§è¡Œçš„å‘½ä»¤</span><br></pre></td></tr></table></figure><p>cronè¡¨è¾¾å¼å¯ä»¥ç”¨åœ¨çº¿å·¥å…·<a href="https://tool.lu/crontab/">crontabæ‰§è¡Œæ—¶é—´è®¡ç®— - åœ¨çº¿å·¥å…·</a></p><p>å…ˆç”¨å¦‚ä¸‹çš„é…ç½®æ¥æ£€æµ‹cronæœåŠ¡æ˜¯å¦èƒ½æ­£å¸¸è¿è¡Œï¼Œä»¥åŠæ˜¯å¦èƒ½æˆåŠŸè¾“å‡ºæ—¥å¿—</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*/1 * * * * echo &quot;$(date) This is a test command&quot; &gt;&gt; /root/rclone/log.txt</span><br></pre></td></tr></table></figure><p>è¯¥é…ç½®çš„å«ä¹‰æ˜¯æ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡echoå‘½ä»¤ï¼Œæ‰“å°å½“å‰æ—¶é—´å’Œå¯¹åº”å†…å®¹åˆ°<code>/root/rclone/log.txt</code>æ–‡ä»¶ä¸­ã€‚</p><p>ä¿®æ”¹äº†é…ç½®æ–‡ä»¶åï¼Œå¯åŠ¨cronæœåŠ¡ï¼Œæµ‹è¯•æˆ‘ä»¬çš„é…ç½®æ˜¯å¦æœ‰æ•ˆï¼ŒcronæœåŠ¡æ˜¯å¦èƒ½æ­£å¸¸è¿è¡Œã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service cron start </span><br></pre></td></tr></table></figure><p>è¯¥å‘½ä»¤æ‰§è¡Œæ•ˆæœå¦‚ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@878a0dd03ec4:/root/rclone# service cron start</span><br><span class="line">Starting periodic command scheduler: cron.</span><br></pre></td></tr></table></figure><p>ç­‰å¾…æ•°åˆ†é’Ÿï¼Œçœ‹çœ‹cronå‘½ä»¤æ˜¯å¦æˆåŠŸè¾“å‡ºå†…å®¹åˆ°æŒ‡å®šæ–‡ä»¶é‡Œé¢äº†ï¼Œæœ‰å†…å®¹åˆ™ä»£è¡¨é…ç½®å’Œè¿è¡ŒæˆåŠŸï¼é»˜è®¤æƒ…å†µä¸‹ï¼Œ<strong>ä½¿ç”¨cronæ‰§è¡Œçš„echoå‘½ä»¤å†…çš„date</strong>é‡‡ç”¨äº†<strong>UTCæ—¶é—´</strong>çš„è¾“å‡ºï¼Œä½†è¿™å¹¶ä¸å½±å“æˆ‘ä»¬çš„ä½¿ç”¨ï¼Œç»™å°æ—¶åŠ 8å°±èƒ½å¾—åˆ°ä¸œå…«åŒºçš„æ—¶é—´äº†ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@878a0dd03ec4:/root/rclone# cat /root/rclone/log.txt</span><br><span class="line">Sat Dec 16 01:18:01 UTC 2023 This is a test command</span><br><span class="line">Sat Dec 16 01:18:01 UTC 2023 This is a test command</span><br><span class="line">Sat Dec 16 01:19:01 UTC 2023 This is a test command</span><br><span class="line">Sat Dec 16 01:19:01 UTC 2023 This is a test command</span><br></pre></td></tr></table></figure><p>åœ¨syslogé‡Œé¢ä¹Ÿèƒ½çœ‹åˆ°cronçš„æœåŠ¡æ—¥å¿—ï¼Œè¯¥æœåŠ¡æ—¥å¿—ç»„ä»¶ä¾èµ–äºå…ˆå‰å®‰è£…çš„rsyslog</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /var/log/syslog</span><br></pre></td></tr></table></figure><p>æ–‡ä»¶<code>/var/log/syslog</code>å†…éƒ¨cronæ‰§è¡Œæ—¥å¿—å¦‚ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Dec 16 01:25:01 878a0dd03ec4 CRON[2059]: (root) CMD (echo &quot;$(date) This is a test command&quot; &gt;&gt; /root/rclone/log.txt)</span><br><span class="line">Dec 16 01:25:01 878a0dd03ec4 CRON[2058]: (root) CMD (echo &quot;$(date) This is a test command&quot; &gt;&gt; /root/rclone/log.txt)</span><br></pre></td></tr></table></figure><blockquote><p>è¯·æ³¨æ„ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œminioçš„dockeræ˜¯<strong>æ²¡æœ‰æ—¶åŒºé…ç½®</strong>çš„ï¼Œè¯·ä¸€å®šè¦åœ¨åˆ›å»ºdockerå®¹å™¨çš„æ—¶å€™ï¼Œä½¿ç”¨<strong>TZç¯å¢ƒå˜é‡</strong>æ¥è®¾ç½®æ—¶åŒºï¼Œå¦åˆ™crontabä¸ä¼šæ‰§è¡Œï¼<br>åŸå› ä¹Ÿå¾ˆç®€å•ï¼Œcronè¡¨è¾¾å¼æœ‰ä¸€ä¸ªæŒ‡å®šæ—¶é—´ï¼Œæ¯”å¦‚æ¯å‘¨ä¸€æ‰§è¡Œã€å‡ ç‚¹æ‰§è¡Œï¼Œå¦‚æœæ²¡æœ‰é…ç½®æ—¶åŒºï¼Œcronæ²¡æœ‰åŠæ³•æ˜ç¡®ä½ çš„cronè¡¨è¾¾å¼åˆ°åº•åº”è¯¥ä»€ä¹ˆæ—¶å€™è·‘ï¼Œå¹²è„†å°±ä¸è·‘äº†ï¼</p></blockquote><p>å¦‚æœä½ çš„dockerå·²ç»åˆ›å»ºï¼Œä¸æƒ³é‡æ–°åˆ›å»ºï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹é…ç½®æ–‡ä»¶æ¥è®¾ç½®æ—¶åŒºï¼Œä¿®æ”¹åé‡å¯dockerå®¹å™¨å³å¯ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nano /etc/environment</span><br><span class="line"># åœ¨æ–‡ä»¶æœ«å°¾å†™å…¥å¦‚ä¸‹å†…å®¹</span><br><span class="line">TZ=&#x27;Asia/Shanghai&#x27;</span><br></pre></td></tr></table></figure><h3 id="crontabé…ç½®å®šæ—¶rclone-sync"><a href="#crontabé…ç½®å®šæ—¶rclone-sync" class="headerlink" title="crontabé…ç½®å®šæ—¶rclone sync"></a>crontabé…ç½®å®šæ—¶rclone sync</h3><p>ç¡®è®¤cronæœåŠ¡å¯ç”¨ï¼Œå°±å¯ä»¥æ¥é…ç½®rclone syncçš„è‡ªåŠ¨æ‰§è¡Œå‘½ä»¤äº†ã€‚</p><p>å¯¹äºrcloneçš„syncå¤‡ä»½è€Œè¨€ï¼Œå†™å…¥å¦‚ä¸‹å†…å®¹å³å¯ï¼›</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0 3 * * 1,5 rclone sync qiniu-e1:muxue-sy  minio:qiniu-muxue-sy &gt;&gt; /root/rclone/rclone.log 2&gt;&amp;1</span><br><span class="line">0 2 * * 1,5 rclone sync qiniu-e2:muxue-img  minio:qiniu-muxue-img &gt;&gt; /root/rclone/rclone.log 2&gt;&amp;1</span><br></pre></td></tr></table></figure><p>è§£æå¦‚ä¸‹</p><ul><li><code>0 3 * * 1,5</code> ä»£è¡¨æ¯å‘¨ä¸€å’Œå‘¨äº”çš„å‡Œæ™¨3ç‚¹æ‰§è¡Œä¸€æ¬¡</li><li><code>0 2 * * 1,5</code> ä»£è¡¨æ¯å‘¨ä¸€å’Œå‘¨äº”çš„å‡Œæ™¨2ç‚¹æ‰§è¡Œä¸€æ¬¡</li><li><code>&gt;&gt; /root/rclone/rclone.log 2&gt;&amp;1</code> ä»£è¡¨å°†rcloneå‘½ä»¤çš„è¾“å‡ºç»“æœå†™å…¥åˆ° <code>/root/rclone/rclone.log</code> æ–‡ä»¶ä¸­ã€‚</li></ul><p>å› ä¸ºæˆ‘å¯¹å¤‡ä»½çš„é¢‘æ¬¡è¦æ±‚ä¸é«˜ï¼Œä¸€å‘¨å¤‡ä»½ä¸¤æ¬¡å°±å¤Ÿäº†ã€‚</p><p>å†™å…¥å®Œæ¯•åï¼Œ<code>CTRL+X</code>å…³é—­nanoç¼–è¾‘æ¨¡å¼ï¼ŒæŒ‰Yå’Œå›è½¦å³å®Œæˆnanoç¼–è¾‘ã€‚ç¼–è¾‘å®Œæˆåä¼šæœ‰å¦‚ä¸‹è¾“å‡ºã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@878a0dd03ec4:/root/rclone# crontab -e</span><br><span class="line">no crontab for root - using an empty one</span><br><span class="line">crontab: installing new crontab</span><br></pre></td></tr></table></figure><p>åç»­crontabæ‰§è¡Œçš„å‘½ä»¤ç»“æœéƒ½ä¼šè¾“å…¥åˆ°<code>/root/rclone/rclone.log</code>æ—¥å¿—æ–‡ä»¶ä¸­ã€‚rcloneå‘½ä»¤åªæœ‰åœ¨å‡ºç°ERRORçš„æ—¶å€™æ‰ä¼šè¾“å‡ºã€‚å¦‚æœè¿™ä¸ªæ–‡ä»¶é‡Œé¢ä»€ä¹ˆéƒ½ä¹ˆæœ‰ï¼Œå°±ä»£è¡¨è¿è¡Œæ²¡æœ‰å‡ºé”™ï¼</p><p>é…ç½®å¥½äº†ä¹‹åï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤é‡æ–°å¯åŠ¨cronæœåŠ¡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service cron restart</span><br></pre></td></tr></table></figure><p>ç”¨å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹cronæœåŠ¡çŠ¶æ€</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@878a0dd03ec4:/root/rclone# service cron status</span><br><span class="line">cron is running.</span><br></pre></td></tr></table></figure><h3 id="ä¼˜åŒ–cronæ—¥å¿—"><a href="#ä¼˜åŒ–cronæ—¥å¿—" class="headerlink" title="ä¼˜åŒ–cronæ—¥å¿—"></a>ä¼˜åŒ–cronæ—¥å¿—</h3><p>ä¸ºäº†è®©æ—¥å¿—æ›´åŠ åˆç†ï¼Œå¯ä»¥åœ¨æ‰§è¡Œrcloneå‘½ä»¤ä¹‹å‰ï¼Œæ‰“å°å½“å‰æ—¶é—´ï¼Œè¿™æ ·å¯ä»¥çŸ¥é“crontabåˆ°åº•æœ‰æ²¡æœ‰æ­£å¸¸æ‰§è¡Œå®šæ—¶ä»»åŠ¡ã€‚</p><p>æ‰“å°æ—¶é—´çš„åŸºæœ¬å‘½ä»¤å¦‚ä¸‹ï¼Œechoå‘½ä»¤ä¼šå°†å½“å‰æ—¶é—´å’Œç›¸å…³çš„è¯´æ˜ä¿¡æ¯å†™å…¥<code>test.txt</code>æ–‡ä»¶ä¸­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;$(date) This is a test command&quot; &gt;&gt; test.txt</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œæ•ˆæœå¦‚ä¸‹ï¼Œæ‰“å°äº†æ—¶é—´å’Œå¯¹åº”çš„æ—¥å¿—ä¿¡æ¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@878a0dd03ec4:/root/rclone# echo &quot;$(date) This is a test command&quot; &gt;&gt; test.txt</span><br><span class="line">root@878a0dd03ec4:/root/rclone# cat test.txt</span><br><span class="line">Sat Dec 16 09:36:06 CST 2023 This is a test command</span><br></pre></td></tr></table></figure><blockquote><p>å†æ¬¡æé†’ï¼Œminioçš„dockerå†…<strong>å¿…é¡»æŒ‡å®šTZç¯å¢ƒå˜é‡</strong>ï¼Œå¦åˆ™crontabä¸ä¼šæ‰§è¡Œï¼ä¸”dateå‘½ä»¤æ—¶åŒºå’Œä¸œå…«åŒºä¸ç¬¦ã€‚</p></blockquote><p>echoæ‰“å°çš„æ—¶å€™ï¼Œå¯ä»¥ä¸´æ—¶æŒ‡å®šTZç¯å¢ƒå˜é‡æ¥æ‰“å°ä¸åŒæ—¶åŒºçš„date</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;$(TZ=&#x27;Asia/Shanghai&#x27; date) è¿™æ˜¯ä¸œå…«åŒº&quot; &gt;&gt; test.txt</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œæ•ˆæœå¦‚ä¸‹ï¼Œå› ä¸ºæˆ‘çš„dockerå†…å·²ç»è®¾ç½®äº†TZç¯å¢ƒå˜é‡ä¸ºä¸œå…«åŒºï¼Œæ‰€ä»¥ä¸åŠ è¿™ä¸ªTZä¹Ÿæ˜¯æ‰“å°çš„ä¸œå…«åŒºçš„æ—¶é—´ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@878a0dd03ec4:/root/rclone# echo &quot;$(TZ=&#x27;Asia/Shanghai&#x27; date) è¿™æ˜¯ä¸œå…«åŒº&quot; &gt;&gt; test.txt</span><br><span class="line">root@878a0dd03ec4:/root/rclone# cat test.txt</span><br><span class="line">Sat Dec 16 09:36:06 CST 2023 This is a test command</span><br><span class="line">Sat Dec 16 09:37:39 CST 2023 è¿™æ˜¯ä¸œå…«åŒº</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä½¿ç”¨cronå‘½ä»¤æ‰§è¡Œçš„æ—¶å€™ï¼Œå®ƒä¾æ—§ä¼šæ‰“å°UTCæ—¶é—´ï¼Œå‰æ–‡å·²ç»æåˆ°è¿‡äº†ã€‚</p><p>å°†åŸæœ¬çš„crontabå‘½ä»¤æ”¹æˆå¦‚ä¸‹å½¢å¼ï¼ˆ<code>crontab -e</code>ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼‰ï¼Œä½¿ç”¨<code>&amp;&amp;</code>æ¥é“¾æ¥echoå’Œrcloneå‘½ä»¤ï¼Œè¿™æ ·åœ¨æ¯æ¬¡æ‰§è¡Œrcloneä¹‹å‰éƒ½ä¼šæœ‰ä¸€ä¸ªå½“å‰æ—¶é—´å’Œsyncçš„æ˜¯ä»€ä¹ˆå†…å®¹çš„çš„è¾“å‡ºï¼Œèƒ½è®©æˆ‘ä»¬çŸ¥é“crontabæ˜¯å¦æ­£å¸¸æ‰§è¡Œã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">0 3 * * 1,5 echo &quot;$(TZ=&#x27;Asia/Shanghai&#x27; date) sync muxue-sy&quot; &gt;&gt; /root/rclone/rclone.log &amp;&amp; rclone sync qiniu-e1:muxue-sy  minio:qiniu-muxue-sy &gt;&gt; /root/rclone/rclone.log 2&gt;&amp;1</span><br><span class="line"></span><br><span class="line">0 2 * * 1,5 echo &quot;$(TZ=&#x27;Asia/Shanghai&#x27; date) sync muxue-img&quot; &gt;&gt; /root/rclone/rclone.log &amp;&amp; rclone sync qiniu-e2:muxue-img  minio:qiniu-muxue-img &gt;&gt; /root/rclone/rclone.log 2&gt;&amp;1</span><br></pre></td></tr></table></figure><p>ä½ å¯ä»¥ä¿®æ”¹cronè¡¨è¾¾å¼ä¸º<code>*/1 * * * *</code>ï¼Œè®©crontabè¡¨è¾¾å¼ç«‹å³æ‰§è¡Œä¸€æ¬¡ï¼Œç¡®è®¤ä¸€ä¸‹è¾“å‡ºæ˜¯å¦æ­£ç¡®ï¼Œä»¥åŠrcloneå‘½ä»¤æ˜¯å¦æ­£å¸¸æ‰§è¡Œã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*/1 * * * * echo &quot;$(date) sync muxue-img&quot; &gt;&gt; /root/rclone/rclone.log &amp;&amp; rclone sync qiniu-e2:muxue-img  minio:qiniu-muxue-img &gt;&gt; /root/rclone/rclone.log 2&gt;&amp;1</span><br></pre></td></tr></table></figure><p>æˆ‘çš„æµ‹è¯•ç»“æœå¦‚ä¸‹ï¼Œrclone syncæˆåŠŸè¢«cronæ‰§è¡Œï¼ˆè¿™ä¸ªERRORæ˜¯å› ä¸ºæˆ‘çš„bucketé‡Œé¢æœ‰ä¸ªæ— æ•ˆçš„æ–‡ä»¶ï¼Œæ­£å¸¸æƒ…å†µä¸‹åº”è¯¥ä¸ä¼šæœ‰ERRORï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Sat Dec 16 01:45:01 UTC 2023 sync muxue-img</span><br><span class="line">2023/12/16 01:45:02 ERROR : : Entry doesn&#x27;t belong in directory &quot;&quot; (same as directory) - ignoring</span><br></pre></td></tr></table></figure><p>æµ‹è¯•ç»“æŸåï¼Œ<strong>è®°å¾—è¿˜åŸé…ç½®é¡¹</strong>ã€‚</p><p>æ¯æ¬¡ä¿®æ”¹é…ç½®æ–‡ä»¶åï¼Œéƒ½éœ€è¦é‡å¯cronæœåŠ¡ï¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@878a0dd03ec4:/root/rclone# service cron restart</span><br><span class="line">Restarting periodic command scheduler: cronStopping periodic command scheduler: cron.</span><br><span class="line">Starting periodic command scheduler: cron.</span><br></pre></td></tr></table></figure><h3 id="centoså®‰è£…cron"><a href="#centoså®‰è£…cron" class="headerlink" title="centoså®‰è£…cron"></a>centoså®‰è£…cron</h3><p>åœ¨centosä¸­å®‰è£…cronçš„å‘½ä»¤ä¸åŒ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum install -y vixie-cron </span><br><span class="line">yum install -y crontabs</span><br></pre></td></tr></table></figure><p>å¯åŠ¨crontab</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">systemctl start crond <span class="comment"># å¯åŠ¨cronæœåŠ¡</span></span><br><span class="line">systemctl <span class="built_in">enable</span> crond <span class="comment"># è®¾ç½®å¼€æœºè‡ªå¯</span></span><br><span class="line">systemctl status crond <span class="comment"># cronæœåŠ¡çŠ¶æ€</span></span><br><span class="line">systemctl restart crond <span class="comment"># é‡å¯cron</span></span><br></pre></td></tr></table></figure><p>croné…ç½®çš„å…¶ä½™æ“ä½œå’Œä¸Šæ–‡ç›¸åŒï¼Œéƒ½æ˜¯ç”¨<code>crontab -e</code>ç¼–è¾‘é…ç½®æ–‡ä»¶ã€‚</p><p>å› ä¸ºæˆ‘è¿™ä¸ªæ˜¯ä¸€ä¸ªäº‘æœåŠ¡å™¨çš„å®Œæ•´centosç³»ç»Ÿï¼Œæ‰€ä»¥ä¹Ÿä¸éœ€è¦å®‰è£…<code>rsyslog postfix</code> è¿™ä¸¤ä¸ªåŒ…ã€‚</p><h1 id="The-end"><a href="#The-end" class="headerlink" title="The end"></a>The end</h1><p>æœ¬æ–‡çš„æ•™ç¨‹ç»“æŸï¼Œæœ‰é—®é¢˜æ¬¢è¿åœ¨è¯„è®ºåŒºæå‡ºã€‚</p><p>æ•°æ®æ— ä»·ï¼Œå¤šä¸€ä»½å¤‡ä»½ï¼Œå¤šä¸€ä»½å®‰å¿ƒ</p>]]></content>
    
    
    <summary type="html">dockeréƒ¨ç½²minioå¯¹è±¡å­˜å‚¨å¹¶ç”¨rcloneåŒæ­¥</summary>
    
    
    
    <category term="dockerçœŸå¥½ç©" scheme="https://blog.musnow.top/categories/docker%E7%9C%9F%E5%A5%BD%E7%8E%A9/"/>
    
    
    <category term="docker" scheme="https://blog.musnow.top/tags/docker/"/>
    
  </entry>
  
  <entry>
    <title>ã€MySQLã€‘wslçš„ubuntuä¸­æ— æ³•systemctlå¯åŠ¨mariadbï¼ˆå·²è§£å†³ï¼‰</title>
    <link href="https://blog.musnow.top/posts/1382619221/"/>
    <id>https://blog.musnow.top/posts/1382619221/</id>
    <published>2023-12-13T09:52:14.000Z</published>
    <updated>2023-12-13T09:52:14.000Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™æ˜¯GPTçš„ç­”æ¡ˆï¼Œå®æµ‹æœ‰æ•ˆã€‚</p><p>å¦‚æœæ‚¨åœ¨å¯åŠ¨ MariaDB æ—¶é‡åˆ° <code>&quot;Failed to start mariadb.service: Interactive authentication required&quot; </code>é”™è¯¯ï¼Œè¿™æ˜¯å› ä¸ºåœ¨ Ubuntu 22.04 ä¸Šé»˜è®¤å¯ç”¨äº† systemd çš„ç”¨æˆ·ä¼šè¯é™åˆ¶ï¼Œéœ€è¦è¿›è¡Œä¸€äº›é¢å¤–çš„æ­¥éª¤æ¥è§£å†³è¯¥é—®é¢˜ã€‚ä»¥ä¸‹æ˜¯è§£å†³æ–¹æ³•ï¼š</p><p>æ‰“å¼€ç»ˆç«¯ï¼Œå¹¶ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç¼–è¾‘ MariaDB çš„æœåŠ¡æ–‡ä»¶ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nano /lib/systemd/system/mariadb.service</span><br></pre></td></tr></table></figure><p>åœ¨æ–‡ä»¶çš„ <code>[Service]</code> éƒ¨åˆ†ä¸­æ·»åŠ ä¸€ä¸ªæ–°çš„è¡Œï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[Service]</span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line">ExecStartPre=/bin/sh -c <span class="string">&#x27;touch /etc/mysql/mariadb.conf.d/.interactive&#x27;</span></span><br></pre></td></tr></table></figure><p>ç¡®ä¿åœ¨ <code>[Service]</code> éƒ¨åˆ†å†…çš„å…¶ä»–è¡Œä¹‹åæ·»åŠ æ­¤è¡Œã€‚</p><p>ä¿å­˜å¹¶å…³é—­æ–‡ä»¶ï¼ˆåœ¨ Nano ç¼–è¾‘å™¨ä¸­æŒ‰ Ctrl+Xï¼Œç„¶åæŒ‰ Y ç¡®è®¤ä¿å­˜ï¼‰ã€‚</p><p>è¿è¡Œä»¥ä¸‹å‘½ä»¤é‡æ–°åŠ è½½ systemd é…ç½®ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl daemon-reload</span><br></pre></td></tr></table></figure><p>ç°åœ¨ï¼Œæ‚¨å¯ä»¥å¯åŠ¨ MariaDB æœåŠ¡ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl start mariadb</span><br></pre></td></tr></table></figure><p>è¿™æ¬¡å¯åŠ¨åº”è¯¥æ²¡æœ‰å‡ºç° â€œInteractive authentication requiredâ€ é”™è¯¯ã€‚</p><p>æœ€åï¼Œæ‚¨å¯ä»¥è®¾ç½® MariaDB åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨å¯åŠ¨ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl enable mariadb</span><br></pre></td></tr></table></figure><p>ç°åœ¨ï¼Œæ‚¨åº”è¯¥èƒ½å¤ŸæˆåŠŸå¯åŠ¨å’Œè¿è¡Œ MariaDB æœåŠ¡äº†ã€‚å¦‚æœæ‚¨ä»ç„¶é‡åˆ°é—®é¢˜ï¼Œè¯·ç¡®ä¿æŒ‰ç…§ä¸Šè¿°æ­¥éª¤æ“ä½œï¼Œå¹¶ä»”ç»†æ£€æŸ¥æ‰€åšçš„æ›´æ”¹æ˜¯å¦æ­£ç¡®ã€‚</p>]]></content>
    
    
    <summary type="html">wslçš„ubuntuä¸­æ— æ³•systemctlå¯åŠ¨mariadbé—®é¢˜è§£å†³</summary>
    
    
    
    <category term="å­¦ä¹ sql" scheme="https://blog.musnow.top/categories/%E5%AD%A6%E4%B9%A0sql/"/>
    
    
    <category term="Linux" scheme="https://blog.musnow.top/tags/Linux/"/>
    
    <category term="mysql" scheme="https://blog.musnow.top/tags/mysql/"/>
    
  </entry>
  
  <entry>
    <title>ã€Linuxã€‘wslè™šæ‹Ÿæœºæ—¶é—´å’Œå®é™…æ—¶é—´ä¸ç¬¦åˆ</title>
    <link href="https://blog.musnow.top/posts/1339169411/"/>
    <id>https://blog.musnow.top/posts/1339169411/</id>
    <published>2023-12-12T01:30:55.000Z</published>
    <updated>2023-12-12T01:31:55.000Z</updated>
    
    <content type="html"><![CDATA[<p>å¶ç„¶é‡åˆ°äº†è¿™ä¸ªé—®é¢˜ï¼Œè§¦å‘åŸå› æ˜¯ç”µè„‘åœ¨å¼€å¯wslçš„æƒ…å†µä¸‹è¿›å…¥äº†<code>ä¼‘çœ </code>æ¨¡å¼ï¼Œä¸”åœ¨æ— ç½‘ç»œæƒ…å†µä¸‹å‡ å¤©ä¸ä½¿ç”¨ã€‚</p><p>ç„¶åå¼€å¯wslï¼Œå‘ç°<code>git log</code>æ˜¾ç¤ºæœ€æ–°commitçš„æäº¤æ—¶é—´æ˜¯æ˜å¤©ï¼Œç»™æˆ‘å“ä¸€è·³ï¼Œç„¶åæ‰å‘ç°åŸæ¥æ˜¯wslé‡Œé¢çš„æ—¶é—´ä¸å¯¹ã€‚</p><p>Linuxä¸‹çœ‹æ—¶é—´çš„å‘½ä»¤æ˜¯<code>date</code>ï¼Œæœ¬æ–‡å†™äº12æœˆ12æ—¥ï¼Œä½†wslä¸­çš„æ—¶é—´æ˜¯12æœˆ10æ—¥ï¼Œè‚¯å®šæ˜¯ä¸å¯¹ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; date</span><br><span class="line">Tue Dec 10 09:51:29 AM CST 2023</span><br></pre></td></tr></table></figure><p>åœ¨wslå†…éƒ¨ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤è¿›è¡Œæ—¶é—´åŒæ­¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo hwclock -s</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œåï¼Œåœ¨windowsçš„å‘½ä»¤è¡Œé‡Œé¢æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œé‡å¯wslå­ç³»ç»Ÿã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wsl --shutdown</span><br></pre></td></tr></table></figure><p>å†åœ¨wslé‡Œé¢æ‰§è¡Œ<code>date</code>å‘½ä»¤ï¼Œæ—¶é—´æ­£ç¡®ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; date</span><br><span class="line">Tue Dec 12 09:53:21 AM CST 2023</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">wslè™šæ‹Ÿæœºæ—¶é—´å’Œå®é™…æ—¶é—´ä¸ç¬¦åˆ</summary>
    
    
    
    <category term="ç©ä¸ŠLinux" scheme="https://blog.musnow.top/categories/%E7%8E%A9%E4%B8%8ALinux/"/>
    
    
    <category term="Linux" scheme="https://blog.musnow.top/tags/Linux/"/>
    
    <category term="è™šæ‹Ÿæœº" scheme="https://blog.musnow.top/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA/"/>
    
    <category term="wsl" scheme="https://blog.musnow.top/tags/wsl/"/>
    
  </entry>
  
  <entry>
    <title>ã€Hexoã€‘åœ¨ä¸­è‹±æ–‡ä¹‹é—´æ·»åŠ ç©ºæ ¼</title>
    <link href="https://blog.musnow.top/posts/3894841472/"/>
    <id>https://blog.musnow.top/posts/3894841472/</id>
    <published>2023-12-10T07:32:14.000Z</published>
    <updated>2023-12-10T07:32:14.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="è¯´æ˜å’Œæ’ä»¶å®‰è£…"><a href="#è¯´æ˜å’Œæ’ä»¶å®‰è£…" class="headerlink" title="è¯´æ˜å’Œæ’ä»¶å®‰è£…"></a>è¯´æ˜å’Œæ’ä»¶å®‰è£…</h1><p>å¦‚é¢˜ï¼Œä¸­è‹±æ–‡æ·»åŠ ç©ºæ ¼æ˜¯æ¯”è¾ƒè§„èŒƒçš„å†™æ³•ï¼Œ ä½†æ˜¯æˆ‘ä¸ªäººå®åœ¨æ˜¯æ‡’ï¼Œæ¯æ¬¡éƒ½è¦è¿™ä¹ˆå¼„å¤ªç´¯äº†ã€‚æƒ³æ‰¾æ‰¾hexoæœ‰æ²¡æœ‰å¯¹åº”çš„æ’ä»¶ï¼Œè¿˜æ˜¯æœ‰çš„</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-filter-auto-spacing --save</span><br></pre></td></tr></table></figure><p>å®‰è£…äº†ä¹‹åï¼Œåœ¨hexoçš„<code>_config.yml</code>é‡Œé¢æ·»åŠ é…ç½®é¡¹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># hexo ä¸­è‹±æ–‡ä¹‹é—´è‡ªåŠ¨åŠ ç©ºæ ¼</span><br><span class="line"># npm install hexo-filter-auto-spacing --save</span><br><span class="line">auto_spacing:</span><br><span class="line">  enable: true</span><br></pre></td></tr></table></figure><p>éšå<code>hexo s</code>å°±èƒ½çœ‹åˆ°æ’ä»¶å¯ç”¨åçš„ç»“æœäº†</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/bc23322af55db5caac57603bdc3df125.png" alt="image-20231210153203131"></p><p>è¯·æ³¨æ„ï¼Œè¯¥æ’ä»¶ä»“åº“ <a href="https://github.com/hexojs/hexo-filter-auto-spacing">https://github.com/hexojs/hexo-filter-auto-spacing</a> å·²ç»è¢«è®¾ç½®ä¸ºå…¬å…±å½’æ¡£ï¼Œä¸”æœ€åä¸€æ¬¡ä»£ç æäº¤æ˜¯<strong>2022å¹´6æœˆ</strong>ã€‚</p><p>2023å¹´12æœˆ10æ—¥å®æµ‹è¯¥æ’ä»¶ä¾æ—§æœ‰ç”¨ï¼Œä½†ä¸ä¿è¯hexoæ›´æ–°åä¾æ—§æœ‰æ•ˆã€‚æ…•é›ªä½¿ç”¨çš„hexoå’Œä¸»é¢˜ç‰ˆæœ¬å¦‚ä¸‹ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo 6.2.0</span><br><span class="line">hexo-butterfly 4.9.0</span><br></pre></td></tr></table></figure><p>æš‚æ—¶æ²¡æœ‰æœåˆ°å…¶ä»–ä»åœ¨æ›´æ–°çš„æ’ä»¶ã€‚</p><h1 id="buffterflyä¸»é¢˜è‡ªå¸¦é…ç½®"><a href="#buffterflyä¸»é¢˜è‡ªå¸¦é…ç½®" class="headerlink" title="buffterflyä¸»é¢˜è‡ªå¸¦é…ç½®"></a>buffterflyä¸»é¢˜è‡ªå¸¦é…ç½®</h1><p>æ„Ÿè°¢è¯„è®ºåŒºè€å“¥çš„æé†’ï¼Œbuffterflyä¸»é¢˜å…¶å®<strong>è‡ªå¸¦</strong>äº†è¿™ä¸ªé…ç½®é¡¹ <a href="https://butterfly.js.org/posts/ceeb73f/#Pangu">https://butterfly.js.org/posts/ceeb73f/#Pangu</a></p><p>ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤<strong>å¸è½½</strong>ä¸Šæ–¹æåˆ°çš„æ’ä»¶ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm uninstall hexo-filter-auto-spacing --save</span><br></pre></td></tr></table></figure><p>åœ¨hexo-butterflyä¸»é¢˜ä¸­<code>pangu</code>é…ç½®é¡¹å°±æ˜¯ä¸­è‹±æ–‡ä¹‹é—´æ·»åŠ ç©ºæ ¼çš„é…ç½®ã€‚</p><p>å…¶ä¸­siteæ˜¯å¯¹å…¨ç«™ç”Ÿæ•ˆï¼Œpostæ˜¯åªå¯¹æ–‡ç« ç”Ÿæ•ˆï¼ˆå¯¹å…¶ä»–é¡µé¢ä¸ç”Ÿæ•ˆï¼‰</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># https://github.com/vinta/pangu.js</span></span><br><span class="line"><span class="comment"># Insert a space between Chinese character and English character (ä¸­è‹±æ–‡ä¹‹é–“æ·»åŠ ç©ºæ ¼)</span></span><br><span class="line"><span class="attr">pangu:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">field:</span> <span class="string">site</span> <span class="comment"># site/post</span></span><br></pre></td></tr></table></figure><p>å°†enableæ”¹æˆtrueå³å¯å¯ç”¨ï¼Œæ•ˆæœä¹Ÿå¾ˆå¥½ï¼Œä¸ä»…ä¸­è‹±æ–‡ä¹‹é—´ä¼šæ·»åŠ ç©ºæ ¼ï¼Œæ•°å­—å’Œä¸­æ–‡ä¹‹é—´ä¹Ÿæ·»åŠ äº†ç©ºæ ¼ã€‚å®Œç¾å•¦ï¼</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/1ffcfb9e601a003fd9e246a31d833e15.png" alt="image-20231210213203331"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;è¯´æ˜å’Œæ’ä»¶å®‰è£…&quot;&gt;&lt;a href=&quot;#è¯´æ˜å’Œæ’ä»¶å®‰è£…&quot; class=&quot;headerlink&quot; title=&quot;è¯´æ˜å’Œæ’ä»¶å®‰è£…&quot;&gt;&lt;/a&gt;è¯´æ˜å’Œæ’ä»¶å®‰è£…&lt;/h1&gt;&lt;p&gt;å¦‚é¢˜ï¼Œä¸­è‹±æ–‡æ·»åŠ ç©ºæ ¼æ˜¯æ¯”è¾ƒè§„èŒƒçš„å†™æ³•ï¼Œ ä½†æ˜¯æˆ‘ä¸ªäººå®åœ¨æ˜¯æ‡’ï¼Œæ¯æ¬¡éƒ½è¦è¿™ä¹ˆå¼„å¤ªç´¯äº†ã€‚æƒ³æ‰¾æ‰¾hexoæœ‰æ²¡</summary>
      
    
    
    
    <category term="å·®ç”Ÿæ–‡å…·å¤š" scheme="https://blog.musnow.top/categories/%E5%B7%AE%E7%94%9F%E6%96%87%E5%85%B7%E5%A4%9A/"/>
    
    
    <category term="Hexo" scheme="https://blog.musnow.top/tags/Hexo/"/>
    
  </entry>
  
  <entry>
    <title>ã€nginxã€‘nginx é…ç½®é¿å… IP è®¿é—®æ—¶è¯ä¹¦æš´éœ²åŸŸå</title>
    <link href="https://blog.musnow.top/posts/3528013149/"/>
    <id>https://blog.musnow.top/posts/3528013149/</id>
    <published>2023-12-09T09:12:55.000Z</published>
    <updated>2023-12-09T10:12:55.000Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬æ–‡è½¬è½½è‡ªï¼š<a href="https://zinglix.xyz/2021/10/04/nginx-ssl-reject-handshake/">https://zinglix.xyz/2021/10/04/nginx-ssl-reject-handshake/</a></p><h1 id="åŸæ–‡"><a href="#åŸæ–‡" class="headerlink" title="åŸæ–‡"></a>åŸæ–‡</h1><h2 id="TL-DR"><a href="#TL-DR" class="headerlink" title="TL;DR"></a>TL;DR</h2><p>nginx é…ç½®é¿å… IP è®¿é—®æ—¶è¯ä¹¦æš´éœ²åŸŸå</p><p>åˆ©ç”¨ <code>nginx 1.19.4</code> åçš„æ–°ç‰¹æ€§ <code>ssl_reject_handshake on;</code>ï¼Œå°†å…¶ç½®äºé»˜è®¤è®¿é—®æ—¶é…ç½®ä¸­ï¼ŒIP è®¿é—®æ—¶ä¼šç»ˆæ­¢ TLS æ¡æ‰‹ï¼Œä¹Ÿå°±ä¸ä¼šæš´éœ²åŸŸåäº†ã€‚</p><p>ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹ä½ çš„nginxç‰ˆæœ¬</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># nginx -v</span><br><span class="line">nginx version: nginx/1.20.1</span><br></pre></td></tr></table></figure><h2 id="ç»†è¯´"><a href="#ç»†è¯´" class="headerlink" title="ç»†è¯´"></a>ç»†è¯´</h2><p>CDN æ˜¯å»ºç«™æ—¶å¸¸ç”¨çš„å·¥å…·ï¼Œåœ¨è‡ªå·±çš„ä¸»æœºå¤–é¢å¥—ä¸€å±‚ CDN æ˜¯å¸¸è§æ“ä½œï¼Œä¸€èˆ¬è¿™æ ·è®¤ä¸ºè‡ªå·±çš„ä¸»æœºå°±å®‰å…¨äº†ï¼Œæœ‰äººæ¥æ”»å‡»ä¹Ÿä¼šå…ˆåˆ° CDN æœåŠ¡å™¨ï¼Œæ”»å‡»è€…æ ¹æœ¬æ— æ³•è·å–åˆ°è‡ªå·±ä¸»æœºçš„ IPï¼Œä½†äº‹å®çœŸçš„æ˜¯è¿™æ ·å—ï¼Ÿ</p><p>æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ä¸€èˆ¬é…ç½®åä¼šå‡ºç°ä»€ä¹ˆé—®é¢˜ã€‚</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">80</span> default_server;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Redirect all HTTP requests to HTTPS.</span></span><br><span class="line">    <span class="attribute">return</span> <span class="number">301</span> https://<span class="variable">$host</span><span class="variable">$request_uri</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">443</span> default_server;</span><br><span class="line">    <span class="attribute">server_name</span> _;</span><br><span class="line">    <span class="attribute">include</span> conf.d/ssl.config;</span><br><span class="line">    <span class="attribute">return</span> <span class="number">444</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢æ˜¯ä¸€ä¸ªå¾ˆå¸¸ç”¨çš„ nginx é…ç½®ï¼ŒHTTP è®¿é—®å…¨éƒ¨é‡å®šå‘åˆ° HTTPS çš„ 443 ç«¯å£ä¸Šï¼Œæ²¡æœ‰é…ç½®è¿‡çš„åŸŸåè¿”å› 444 ç»ˆæ­¢è¿æ¥ã€‚</p><p>å¥½äº†ï¼Œç°åœ¨å°è¯•ç”¨ IP å’Œ HTTPS è®¿é—®ä½ çš„ç½‘ç«™ï¼Œä½ åº”è¯¥èƒ½å¤Ÿçœ‹åˆ°é¢„æƒ³ä¸­è®¿é—®å¤±è´¥ã€è¯ä¹¦æ— æ•ˆç­‰è¿æ¥å¤±è´¥çš„æç¤ºã€‚</p><p><strong>ä½†æ˜¯ï¼</strong>æ³¨æ„ä¸‹æµè§ˆå™¨å·¦ä¸Šè§’æç¤ºçš„ä¸å®‰å…¨ï¼Œç‚¹å¼€æŸ¥çœ‹è¯ä¹¦ä¿¡æ¯ï¼Œä½ å°±ä¼šå‘ç°ä½ çš„åŸŸåå…¶å®éšç€è¯ä¹¦å‘é€äº†è¿‡æ¥ã€‚æ­¤æ—¶å¦‚æœä½ æ˜¯æ”»å‡»è€…ï¼Œé‚£ä¹ˆå…¶å®å°±å¯ä»¥çŸ¥é“è¯¥åŸŸåèƒŒåçš„æºä¸»æœº IP å°±æ˜¯è¿™ä¸ªã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/035ad572d3638bb917c07e53e24c9575.png"></p><p>ä¸Šå›¾å³ä¸ºç”¨ IP è®¿é—®åï¼Œä¾æ—§èƒ½çœ‹åˆ°è¯ä¹¦å†…å®¹ã€‚è¿™æ˜¯å› ä¸ºè¿”å› 444 æ˜¯ HTTP å±‚é¢çš„äº‹æƒ…ï¼Œæ„å‘³ç€åˆ°è¾¾è¿™ä¸€æ­¥ä¸‹å±‚çš„ TLS æ¡æ‰‹å·²ç»å®Œæˆã€‚è¯ä¹¦ä¸è¢«ä¿¡ä»»æ˜¯ä¸€å›äº‹ï¼Œä½†è¯´æ˜å·²ç»æ‹¿åˆ°äº†æœåŠ¡å™¨çš„è¯ä¹¦ã€‚</p><p>CDN ç¡®å®é¿å…äº†ç›´æ¥ DNS æŸ¥è¯¢æš´éœ² IP çš„é—®é¢˜ï¼Œä½†æ”»å‡»è€…é€šè¿‡æ‰«æå…¨ç½‘ IPï¼Œç”¨ä¸Šè¿°æ–¹å¼ä¾æ—§å¯ä»¥çŸ¥é“æ¯ä¸ª IP å¯¹åº”çš„åŸŸåæ˜¯ä»€ä¹ˆï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå¾ˆå¤šç«™é•¿ç”¨äº† CDN åå¹¶ä¸”åå¤æ›´æ¢ IP å´ä¾æ—§è¢«æ”»å‡»è€…è¿…é€Ÿæ‰¾åˆ° IP çš„åŸå› ã€‚</p><blockquote><p><a href="https://search.censys.io/">Censys</a> å°±ä¸€ç›´åœ¨å¹²è¿™ä»¶äº‹ï¼Œå…¨ç½‘æ‰«æ IP å¹¶æ‰¾åˆ°å…¶å¯¹åº”çš„åŸŸå</p></blockquote><h2 id="é‚£è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ"><a href="#é‚£è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ" class="headerlink" title="é‚£è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ"></a>é‚£è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ</h2><p>é—®é¢˜æ ¹æºå‡ºåœ¨ client åœ¨ TLS æ¡æ‰‹æ—¶å‘é€äº† ClientHello åï¼Œnginx åœ¨ ServerHello ä¸­å¸¦ç€å«æœ‰åŸŸåçš„é»˜è®¤è¯ä¹¦è¿”å›äº†ï¼Œå› ä¸º nginx æœŸæœ›å¯ä»¥å®Œæˆæ¡æ‰‹ï¼Œè¿™å¯èƒ½å¯ä»¥ç®—æ˜¯ nginx çš„ä¸€ä¸ªç¼ºé™·ã€‚</p><blockquote><p>å¦‚æœä½ ä¸ç†Ÿæ‚‰ TLS æ¡æ‰‹æµç¨‹ï¼Œé‚£ä¹ˆå¯ä»¥çœ‹çœ‹ <a href="https://zinglix.xyz/2019/05/07/tls-handshake/">è¿™ç¯‡æ–‡ç« </a></p></blockquote><h3 id="ç¬¨åŠæ³•"><a href="#ç¬¨åŠæ³•" class="headerlink" title="ç¬¨åŠæ³•"></a>ç¬¨åŠæ³•</h3><p>æ—¢ç„¶ nginx é»˜è®¤æä¾›äº†å¸¦æœ‰åŸŸåçš„è¯ä¹¦ï¼Œé‚£ä¹ˆæƒ³ä¸æš´éœ²ä¹Ÿå¾ˆç®€å•ï¼Œæä¾›ä¸€ä¸ªä¸å«æœ‰æ­£ç¡®åŸŸåçš„è¯ä¹¦å³å¯ã€‚</p><p>nginx è®¾ç½®ä¸­ HTTPS è®¿é—®å¦‚æœæ²¡æœ‰è®¾ç½®è¯ä¹¦ï¼Œé‚£ä¹ˆå°±ä¼šæŠ¥é”™ã€‚ä½†åæ­£ IP è®¿é—®ä¹Ÿä¸éœ€è¦æä¾›æœåŠ¡ï¼Œé‚£ä¹ˆç›´æ¥è‡ªç­¾ä¸€ä¸ª IP è¯ä¹¦ï¼Œæˆ–è€…éšä¾¿ä¸€ä¸ªåŸŸåçš„è¯ä¹¦éƒ½å¯ã€‚å½“ç„¶ï¼Œå¦‚æœèƒ½æå®šåˆæ³•çš„ IP è¯ä¹¦ä¹Ÿä¸æ˜¯ä¸è¡Œã€‚</p><p>æå®šè¯ä¹¦åï¼Œæ·»åŠ ä¸€ä¸ªé…ç½®ï¼Œè®© IP è®¿é—®è¿”å›é”™è¯¯è¯ä¹¦å°±å®Œäº‹äº†ã€‚</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">443</span> ssl default_server;</span><br><span class="line">    <span class="attribute">server_name</span> your_ip;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">ssl_certificate</span>    xxxx.pem;</span><br><span class="line">    // <span class="attribute">and</span> more ssl config ...</span><br><span class="line"></span><br><span class="line">    return <span class="number">444</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å¥½æ–¹æ³•"><a href="#å¥½æ–¹æ³•" class="headerlink" title="å¥½æ–¹æ³•"></a>å¥½æ–¹æ³•</h3><p>è¿™ç§æ–¹æ³•è¿˜å¾—è‡ªå·±æä¸ªè¯ä¹¦ï¼Œå¦‚æœæœåŠ¡å™¨å¤šæ¯ä¸ªéƒ½å¾—è¿™ä¹ˆæä¹ŸæŒºéº»çƒ¦çš„ï¼Œå¥½åœ¨è¿™ä¸ªé—®é¢˜ nginx è¿™å·²ç»æœ‰äº†å¾ˆå®Œç¾çš„è§£å†³æ–¹æ¡ˆã€‚</p><p>ClientHello ä¸­æ˜¯å¸¦ç€ SNI çš„ï¼Œæ‰€ä»¥å…¶å®æ¡æ‰‹é˜¶æ®µæ˜¯å¯ä»¥çŸ¥é“è®¿é—®çš„åŸŸåæ˜¯å¦åˆæ³•çš„ï¼Œnginx 1.19.4 ä¸­æ·»åŠ äº†ä¸€ä¸ªæ–°çš„é…ç½®é¡¹ <code>ssl_reject_handshake</code> ç”¨äºæ‹’ç»æ¡æ‰‹ï¼Œä¹Ÿå°±ä¸ä¼šæä¾›è¯ä¹¦ã€‚</p><p>ä½¿ç”¨æ–¹æ³•ä¹Ÿå¾ˆç®€å•ï¼Œå°†åŸæœ¬é»˜è®¤é…ç½®ä¸­çš„ <code>return 444</code> æ›¿æ¢æˆ <code>ssl_reject_handshake on</code> å³å¯ã€‚</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">443</span> default_server;</span><br><span class="line">    <span class="attribute">server_name</span> _;</span><br><span class="line">    <span class="attribute">include</span> conf.d/ssl.config;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ä¸ç”¨è¿”å› 444 äº†ï¼Œç›´æ¥æ‹’ç»æ¡æ‰‹</span></span><br><span class="line">    <span class="attribute">ssl_reject_handshake</span> <span class="literal">on</span>;</span><br><span class="line">    <span class="comment"># return 444;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é…ç½®åï¼Œå†å°è¯• IP è®¿é—®ï¼Œä¼šå‘ç°æµè§ˆå™¨æŠ¥äº† <code>ERR_SSL_UNRECOGNIZED_NAME_ALERT</code> çš„é”™è¯¯ï¼Œä¹Ÿçœ‹ä¸åˆ°è¯ä¹¦ä¿¡æ¯ï¼Œç›®æ ‡è¾¾æˆï¼</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/18ba4a8ac5a7c8d5400ecf4a2a6bb392.png"></p><h2 id="å…¶å®è¿˜æ²¡å®Œ"><a href="#å…¶å®è¿˜æ²¡å®Œ" class="headerlink" title="å…¶å®è¿˜æ²¡å®Œ"></a>å…¶å®è¿˜æ²¡å®Œ</h2><p>ä¸Šè¿°æ–¹æ³•æ˜¯é€šè¿‡ ClientHello ä¸­çš„ SNI ç¡®å®šè®¿é—®æ˜¯å¦åˆæ³•çš„ï¼Œé‚£å¦‚æœ SNI å°±æ˜¯æ­£ç¡®çš„åŸŸåå‘¢ï¼Ÿ</p><p>è¿™ç§åœºæ™¯å‘ç”Ÿäºæ”»å‡»è€…å·²ç»ç¡®å®šè¦æ”»å‡»æŸä¸ªåŸŸåï¼Œé‚£ä¹ˆä»–å°±å¯ä»¥å°†å¸¦ç€è¯¥åŸŸåçš„æ¡æ‰‹ä¿¡æ¯éå†æ‰€æœ‰ IPï¼Œæ¡æ‰‹æˆåŠŸå°±æ‰¾åˆ°ï¼Œè¿™æ ·è®¿é—®å…¶å®ä¸æ­£å¸¸è®¿é—®å¹¶æ— åŒºåˆ«ï¼Œ<strong>å”¯ä¸€è§£å†³æ–¹æ³•</strong>å°±æ˜¯ç™½åå•åªå…è®¸ CDN æœåŠ¡å™¨è®¿é—®ã€‚</p><blockquote><p>ä¾‹å¦‚æ”»å‡»è€…ç”¨ hosts ç›´æ¥ç¡¬å†™ IPï¼Œ<strong>å°†åŸŸåå¼ºè¡ŒæŒ‡å‘æŸä¸ª IP</strong></p><p>æˆ–è€…ç”¨è¿™ç§æ–¹å¼ <code>curl https://example.com --resolve &#39;example.com:443:172.17.54.18&#39;</code></p></blockquote><p>å¦‚ä¸‹ï¼Œåœ¨ nginx é‡Œé¢çš„ location é…ç½®æ·»åŠ ä¸Š allow çš„ IP æ®µï¼Œåªå…è®¸ CDN è¿è¥å•†çš„ IP è®¿é—®ä½ çš„æœåŠ¡ï¼Œå°±èƒ½é¿å…ç»•è¿‡ CDN é€ æˆçš„æ”»å‡»</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">location</span> / &#123;</span><br><span class="line">    <span class="attribute">allow</span>   <span class="number">172.1.2.0</span>/<span class="number">24</span>; <span class="comment"># å…è®¸CDNè¿è¥å•†çš„IP</span></span><br><span class="line">    <span class="attribute">allow</span>   <span class="number">1.2.3.4</span>/<span class="number">32</span>;</span><br><span class="line">    <span class="attribute">deny</span>    all; <span class="comment"># é˜»æ­¢å…¶ä»–ä»»ä½•IP</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šè¿° IP æ®µåªèƒ½å‘ CDN æœåŠ¡æä¾›å•†è¯¢é—®ï¼Œä¸€èˆ¬æ–‡æ¡£ä¸­éƒ½æ˜¯æœ‰ç›¸å…³ä¿¡æ¯çš„ã€‚</p><h1 id="æ…•é›ªçš„æµ‹è¯•"><a href="#æ…•é›ªçš„æµ‹è¯•" class="headerlink" title="æ…•é›ªçš„æµ‹è¯•"></a>æ…•é›ªçš„æµ‹è¯•</h1><p>ä¸Šé¢è¿™ç¯‡æ–‡ç« æˆ‘ç¬¬ä¸€æ¬¡çœ‹çš„æ—¶å€™è¿˜æ²¡æœ‰ç†è§£ä»–è¯´çš„æ˜¯ä»€ä¹ˆå†…å®¹ã€‚åæ¥æµ‹è¯•äº†ä¸€ä¸‹ï¼Œæ˜ç™½äº†ã€‚</p><h2 id="è¯´æ˜"><a href="#è¯´æ˜" class="headerlink" title="è¯´æ˜"></a>è¯´æ˜</h2><p>ä»¥æˆ‘çš„æœåŠ¡å™¨ä¸¾ä¾‹ï¼Œæˆ‘æ˜¯<code>centos 7.2</code>çš„æœåŠ¡å™¨ï¼Œç›´æ¥ç”¨yumå®‰è£…çš„nginxï¼Œç‰ˆæœ¬<code>nginx/1.20.1</code>ï¼Œé…ç½®è·¯å¾„æ˜¯<code>/etc/nginx</code>ï¼›</p><p>åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œä½ ä¼šæœ‰ä¸ª<code>nginx.conf</code>ï¼Œå’Œ<code>/etc/nginx/conf.d</code>é‡Œé¢çš„ç”¨æˆ·é…ç½®æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/etc/nginx</span><br><span class="line">- nginx.conf</span><br><span class="line">- conf.d</span><br><span class="line">- server1.conf</span><br><span class="line">- server2.conf</span><br></pre></td></tr></table></figure><p>åœ¨<code>nginx.conf</code>é‡Œé¢é™¤äº†åŠ è½½ç”¨æˆ·é…ç½®æ–‡ä»¶ï¼Œè¿˜ä¼šæœ‰ä¸€ä¸ªé»˜è®¤çš„serverï¼ŒæŒ‡å‘ä¸€ä¸ª<strong>é™æ€æ–‡ä»¶è·¯å¾„</strong>ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"># ç”¨æˆ·é…ç½®æ–‡ä»¶</span><br><span class="line">   include /etc/nginx/conf.d/*.conf;</span><br><span class="line"></span><br><span class="line">   server &#123;</span><br><span class="line">       listen       80;</span><br><span class="line">       listen       [::]:80;</span><br><span class="line">       server_name  _;</span><br><span class="line">       root         /usr/share/nginx/html; # é»˜è®¤çš„é™æ€æ–‡ä»¶è·¯å¾„</span><br><span class="line"></span><br><span class="line">       # Load configuration files for the default server block.</span><br><span class="line">       include /etc/nginx/default.d/*.conf;</span><br><span class="line"></span><br><span class="line">       error_page 404 /404.html;</span><br><span class="line">       location = /404.html &#123;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       error_page 500 502 503 504 /50x.html;</span><br><span class="line">       location = /50x.html &#123;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>åœ¨æˆ‘çš„æœåŠ¡å™¨ä¸Šï¼Œè¿™ä¸ªè·¯å¾„é‡Œé¢æ˜¯å¦‚ä¸‹å†…å®¹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@bt-7274:/etc/nginx]# ls /usr/share/nginx/html</span><br><span class="line">404.html  50x.html  en-US  icons  img  index.html  nginx-logo.png  poweredby.png</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ç›´æ¥åœ¨æµè§ˆå™¨è®¿é—®ä½ çš„ipï¼Œä¼šå±•ç¤ºè¿™ä¸ªé»˜è®¤è·¯å¾„é‡Œé¢çš„<code>index.html</code>ï¼Œæ˜¯centosçš„ä¸€ä¸ªä»‹ç»é¡µé¢ã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/03207321f1c2ee5a4f77f22d55746121.png" alt="image-20231209173337849"></p><p>ä½†æ˜¯ï¼Œè¿™å¹¶ä¸ä»£è¡¨ä½ å½“å‰æ²¡æœ‰è§£æåˆ°ä»»ä½•<strong>ç”¨æˆ·è‡ªå®šä¹‰æ–‡ä»¶</strong>ï¼nginxé»˜è®¤æƒ…å†µä¸‹ä¼šä½¿ç”¨ç¬¬ä¸€ä¸ªç”¨æˆ·è‡ªå®šä¹‰confæ¥ä½œä¸ºipè®¿é—®çš„ç»“æœï¼ˆè¿™æ˜¯å› ä¸ºå¯¹ç”¨æˆ·è‡ªå®šä¹‰confçš„includeæ˜¯åœ¨defualt serverä¹‹å‰çš„ï¼Œä½ å¯ä»¥ç†è§£ä¸ºç”¨æˆ·è‡ªå®šä¹‰æ–‡ä»¶ä¼šåƒCè¯­è¨€çš„å¤´æ–‡ä»¶ä¸€æ ·åœ¨<code>nginx.conf</code>ä¸­è¢«å±•å¼€ï¼‰</p><p>å½“å‰å®é™…ä¸Šæ˜¯è®¿é—®äº†<code>/etc/nginx/conf.d</code>é‡Œé¢æŒ‰å­—å…¸æ’åºçš„<strong>ç¬¬ä¸€ä¸ªç”¨æˆ·confé…ç½®</strong>ï¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/etc/nginx</span><br><span class="line">- nginx.conf</span><br><span class="line">- conf.d</span><br><span class="line">- server1.conf # ç›´æ¥è®¿é—®ipï¼Œä½¿ç”¨äº†è¿™ä¸ªé…ç½®æ–‡ä»¶</span><br><span class="line">- server2.conf</span><br></pre></td></tr></table></figure><p>ä¸ºä»€ä¹ˆåœ¨æˆ‘è¿™é‡Œä¾æ—§å±•ç¤ºäº†<strong>é»˜è®¤çš„é™æ€æ–‡ä»¶è·¯å¾„å‘¢</strong>ï¼Ÿæ˜¯å› ä¸ºæˆ‘çš„ç¬¬ä¸€ä¸ªé…ç½®æ–‡ä»¶<code>a.conf</code>ä¸­æ²¡æœ‰é…ç½®<code>location /</code>ï¼Œå…¨éƒ½æ˜¯å…¶ä»–è·¯å¾„ï¼ˆæ¯”å¦‚<code>/a/</code>ï¼‰çš„åä»£ï¼æ‰€ä»¥nginxå°±å¾€åé‡‡ç”¨äº†æœ€æœ«å°¾çš„default serveré‡Œé¢æä¾›çš„é»˜è®¤é™æ€æ–‡ä»¶ã€‚</p><p>è€Œæµè§ˆå™¨é“¾æ¥å·¦ä¾§çš„çº¢è‰²<code>ä¸å®‰å…¨</code>å°±å‘Šè¯‰æˆ‘ä»¬ï¼Œå½“å‰å…¶å®æ”¶åˆ°äº†ä¸€ä¸ªsslè¯ä¹¦ï¼Œè¿™ä¾¿æ˜¯ä¸Šé¢åŸæ–‡ä¸­æåˆ°çš„<code>ipè®¿é—®ä¼šå› ä¸ºsslè¯ä¹¦æ³„æ¼åŸŸå</code>çš„é—®é¢˜ã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/0aff6af71c686835cb262961360442ab.png" alt="image-20231209174001901"></p><p>æˆ‘ä»¬å¯ä»¥ç‚¹å‡»<code>ä¸å®‰å…¨</code>æç¤ºï¼Œå†ç‚¹å‡»å³ä¸Šè§’é‚£ä¸ª<strong>å¸¦å¾½ç« çš„å°æŒ‰é’®</strong>ï¼ŒæŸ¥çœ‹å½“å‰æ”¶åˆ°çš„è¯ä¹¦</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/96fafa7dca660e58ec838fb95350aa05.png" alt="image-20231209174025184"></p><p>å¦‚ä¸‹å›¾ï¼Œå½“å‰æ”¶åˆ°çš„è¿™è¯ä¹¦ï¼Œæ­£æ˜¯æˆ‘çš„<code>/etc/nginx/conf.d</code>ä¸­ç¬¬ä¸€ä¸ªç”¨æˆ·é…ç½®é‡Œé¢çš„sslè¯ä¹¦ï¼›å†…éƒ¨åŒ…å«äº†è¯¥è¯ä¹¦å¯¹åº”çš„åŸŸåï¼Œæˆ‘ä»¬çš„åŸŸåå› æ­¤æ³„æ¼ï¼</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/c59ed5779697e2dda320ae46d6b8f7e5.png" alt="image-20231209174102666"></p><h2 id="æ€è·¯å›é¡¾"><a href="#æ€è·¯å›é¡¾" class="headerlink" title="æ€è·¯å›é¡¾"></a>æ€è·¯å›é¡¾</h2><p>å†æ¥ç¼•ä¸€ç¼•æ€è·¯</p><ul><li>nginxä¼šå…ˆåŠ è½½ç”¨æˆ·é…ç½®æ–‡ä»¶ï¼Œæœ«å°¾æ‰æ˜¯é»˜è®¤æŒ‡å‘<code>/usr/share/nginx/html</code>é™æ€è·¯å¾„çš„é…ç½®</li><li>å½“ä½ ä½¿ç”¨ipè®¿é—®å½“å‰æœåŠ¡å™¨ï¼Œnginxä¼šç»™æµè§ˆå™¨å‘é€<code>/etc/nginx/conf.d</code>ä¸­æŒ‰<strong>å­—å…¸åº</strong>æ’åœ¨ç¬¬ä¸€ä½çš„<strong>ç”¨æˆ·é…ç½®æ–‡ä»¶</strong>ä¸­çš„sslè¯ä¹¦ï¼ˆå³ä¸Šå›¾æ‰€ç¤ºè¯ä¹¦ï¼‰</li><li>æ¶æ„è®¿é—®äººå‘˜å¯ä»¥é€šè¿‡éå†è®¿é—®æ‰€æœ‰IPåœ°å€ï¼Œå½“è®¿é—®ä½ çš„æœåŠ¡å™¨IPåœ°å€æ—¶ï¼Œä»–æ‹¿åˆ°ä¸€ä¸ªsslè¯ä¹¦ï¼Œå…¶ä¸­åŒ…æ‹¬äº†ä¸€ä¸ªåŸŸåAï¼›</li><li>å‡è®¾ä½ çš„åŸŸåAæ˜¯æŒ‰<code>åŸŸåA-&gt;CDN-&gt;æœåŠ¡å™¨IP</code>æ¥è¿›è¡Œè§£æçš„ï¼Œæ­¤æ—¶æ¶æ„è®¿é—®äººå‘˜å°±é€šè¿‡è¿™ä¸ªsslè¯ä¹¦ç›´æ¥å¾—åˆ°äº†<code>åŸŸåA-&gt;æœåŠ¡å™¨IP</code>çš„å¯¹åº”å…³ç³»ï¼Œå®Œå…¨ç»•è¿‡äº†CDN</li><li>æ­¤æ—¶ä»–å°±å¯ä»¥é€šè¿‡ä¿®æ”¹hostså¼ºåˆ¶è®©<code>åŸŸåA</code>æŒ‡å‘<code>æœåŠ¡å™¨IP</code>ï¼Œç»•è¿‡CDNç›´æ¥æ”»å‡»ä½ çš„æºç«™</li></ul><p>å¥—äº†CDNè¿˜æš´éœ²æºç«™IPè‚¯å®šä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ç»“æœï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼</p><h2 id="è§£å†³åŠæ³•"><a href="#è§£å†³åŠæ³•" class="headerlink" title="è§£å†³åŠæ³•"></a>è§£å†³åŠæ³•</h2><p>åœ¨<code>/etc/nginx/conf.d</code>ä¸­ç›´æ¥æ·»åŠ ä¸€ä¸ª<code>a.conf</code>ï¼Œè®©å…¶æ’åºåœ¨<strong>å­—å…¸åºçš„ç¬¬ä¸€ä½</strong>ï¼Œé‡Œé¢å†™å…¥å¦‚ä¸‹å†…å®¹ï¼Œå…¶ä¸­<code>server_name _</code>çš„å«ä¹‰æ˜¯é™¤äº†æˆ‘ä»¬é…ç½®è¿‡çš„åŸŸåå¤–çš„å…¶ä»–è®¿é—®</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">80</span> default_server;</span><br><span class="line">    <span class="attribute">server_name</span> _;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Redirect all HTTP requests to HTTPS.</span></span><br><span class="line">    <span class="attribute">return</span> <span class="number">301</span> https://<span class="variable">$host</span><span class="variable">$request_uri</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">443</span> default_server;</span><br><span class="line">    <span class="attribute">server_name</span> _;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ä¸ç”¨è¿”å› 444 äº†ï¼Œç›´æ¥æ‹’ç»æ¡æ‰‹</span></span><br><span class="line">    <span class="attribute">ssl_reject_handshake</span> <span class="literal">on</span>;</span><br><span class="line">    <span class="comment"># return 444;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é…ç½®åç›´æ¥é‡å¯nginxï¼Œæ²¡æœ‰æŠ¥é”™å°±æ˜¯okäº†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@bt-7274:/etc/nginx/conf.d]# systemctl restart nginx</span><br><span class="line">[root@bt-7274:/etc/nginx/conf.d]# ll</span><br><span class="line">total 28</span><br><span class="line">-rw-r--r-- 1 root root  193 Dec  9 17:52 a.conf</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ç›´æ¥è®¿é—®å°±ä¼šæŠ¥é”™sslçš„alertäº†ï¼Œä½†æ˜¯edgeä¸­ä¼°è®¡æ˜¯å› ä¸º<strong>ç¼“å­˜çš„é—®é¢˜</strong>ï¼Œä¾æ—§èƒ½çœ‹åˆ°è¯ä¹¦</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/9c095bed2d740e56c781c10e33212c9d.png" alt="image-20231209175534238"></p><p>æ¢ç«ç‹çœ‹ä¸€ä¸‹ï¼Œæ— æ³•è¿æ¥ï¼Œæ²¡æœ‰è¯ä¹¦ï¼Œç›®æ ‡è¾¾æˆï¼</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/20311f168b98f1ebe38157edf25b0c1a.png" alt="image-20231209175736923"></p><p>è¿™é‡Œé¡ºå¸¦è´´ä¸€ä¸‹ç«ç‹ä¸­ä¸€ä¸ªæ­£å¸¸sslç½‘ç«™ä¼šæ˜¾ç¤ºæˆä»€ä¹ˆæ ·å­ã€‚å¦‚ä¸‹æ˜¯äº¬ä¸œå®˜ç½‘ï¼Œåœ¨é”çš„æŒ‰é’®é‡Œé¢èƒ½çœ‹åˆ°è¯ä¹¦çš„é¢å‘è€…ï¼Œè€Œ<strong>ä¸Šå›¾ä¿®æ”¹å®Œæ¯•é…ç½®æ–‡ä»¶åçš„æµ‹è¯•ä¸­</strong>æ²¡æœ‰çœ‹åˆ°è¯ä¹¦é¢å‘è€…ï¼Œå³æˆ‘ä»¬çš„è¯ä¹¦å¹¶æ²¡æœ‰æ³„æ¼ï¼Œç›®çš„è¾¾æˆã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/6b4716321086d0e5ef6978695a52b630.png" alt="image-20231209175834078"></p><p>å¦å¤–ï¼Œæˆ‘è¯•äº†è¯•æˆ‘å¦å¤–ä¸€ä¸ªæœåŠ¡å™¨ä½¿ç”¨çš„1panelå®‰è£…çš„OpenRestyï¼Œè¿™ä¸ªæ¯”è¾ƒå¥½ï¼Œåœ¨é»˜è®¤æƒ…å†µä¸‹ç›´æ¥è®¿é—®IPåœ°å€è¿”å›çš„æ˜¯404ï¼Œä¸”æ²¡æœ‰æš´éœ²è¯ä¹¦ã€‚ä¸éœ€è¦è‡ªå·±é¢å¤–åšé…ç½®äº†ã€‚</p>]]></content>
    
    
    <summary type="html">nginxé…ç½®é¿å…IPè®¿é—®æ—¶è¯ä¹¦æš´éœ²åŸŸå</summary>
    
    
    
    <category term="ç©ä¸ŠLinux" scheme="https://blog.musnow.top/categories/%E7%8E%A9%E4%B8%8ALinux/"/>
    
    
    <category term="Linux" scheme="https://blog.musnow.top/tags/Linux/"/>
    
    <category term="nginx" scheme="https://blog.musnow.top/tags/nginx/"/>
    
  </entry>
  
  <entry>
    <title>ã€nginxã€‘nginxé€šè¿‡é…ç½®æ–‡ä»¶é˜»æ­¢æµ·å¤–ipè®¿é—®</title>
    <link href="https://blog.musnow.top/posts/2029711168/"/>
    <id>https://blog.musnow.top/posts/2029711168/</id>
    <published>2023-12-09T08:12:55.000Z</published>
    <updated>2023-12-09T12:12:55.000Z</updated>
    
    <content type="html"><![CDATA[<p>nginxé€šè¿‡é…ç½®æ–‡ä»¶é˜»æ­¢æµ·å¤–ipè®¿é—®</p><h1 id="è¯´æ˜"><a href="#è¯´æ˜" class="headerlink" title="è¯´æ˜"></a>è¯´æ˜</h1><p>å› ä¸ºæœ€è¿‘å‘ç°æœ‰ä¸å°‘åˆ·è¯„è®ºçš„è„šæœ¬ï¼Œåœ¨nginxè¯·æ±‚æ—¥å¿—é‡Œé¢çœ‹äº†çœ¼ï¼Œéƒ½æ˜¯æµ·å¤–çš„ipï¼Œåæ­£æˆ‘çš„åšå®¢ä¹Ÿæ˜¯å…¨ä¸­æ–‡ã€‚æ‰€ä»¥å¹²è„†æŠŠæµ·å¤–ipç¦æ­¢artalkè¯„è®ºã€‚</p><p>åœ¨<code>/etc/nginx/nginx.conf</code>ä¸­å¯ä»¥çœ‹åˆ°é»˜è®¤çš„æ—¥å¿—è·¯å¾„ï¼Œåœ¨é‡Œé¢èƒ½æ‰¾åˆ°æ¯ä¸€ä¸ªè½¬å‘çš„è¯·æ±‚å’Œå…¶æºIPã€‚å…¶ä¸­artakæ–°å¢è¯„è®ºçš„è¯·æ±‚æ˜¯<code>/api/add</code>è·¯å¾„</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">access_log  /var/log/nginx/access.log  main;</span><br></pre></td></tr></table></figure><p>è€ƒè™‘åˆ°æ·»åŠ æµ·å¤–ipå±è”½å¯èƒ½ä¼šé˜»æ­¢ä¸€äº›çœŸçš„åœ¨å›½å¤–çš„æœ‹å‹ï¼Œå¦‚æœä½ åœ¨é˜…è¯»æœ¬ç«™åšå®¢æ—¶ï¼Œé‡åˆ°ç›¸å…³é—®é¢˜æ— æ³•ç›´æ¥è¯„è®ºä¸æˆ‘äº¤æµï¼Œå¯ä»¥ç§»æ­¥githubéšä¾¿æ‰¾ä¸ªæˆ‘çš„ä»“åº“å¼€ä¸ªissueæé—®ï¼</p><h1 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h1><h2 id="APNICä»‹ç»"><a href="#APNICä»‹ç»" class="headerlink" title="APNICä»‹ç»"></a>APNICä»‹ç»</h2><p>åæ–‡å‡ºç°çš„ç½‘ç«™æ˜¯æ¥è‡ª<strong>APNIC</strong> (Asia Pacific Network Information Center)ï¼Œå…¶æ˜¯IPåœ°å€ç®¡ç†æœºæ„ä¹‹ä¸€ï¼Œè´Ÿè´£äºšæ´²ã€å¤ªå¹³æ´‹åœ°åŒºã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">APNICæä¾›äº†æ¯æ—¥æ›´æ–°çš„äºšå¤ªåœ°åŒºIPv4ï¼ŒIPv6ï¼ŒASå·åˆ†é…çš„ä¿¡æ¯è¡¨ï¼š</span><br><span class="line">http://ftp.apnic.net/apnic/stats/apnic/delegated-apnic-latest</span><br><span class="line">è¯¥æ–‡ä»¶çš„æ ¼å¼ä¸å…·ä½“å†…å®¹å‚è§ï¼š</span><br><span class="line">http://ftp.apnic.net/pub/apnic/stats/apnic/README.TXT</span><br></pre></td></tr></table></figure><h2 id="è„šæœ¬è·å–ip"><a href="#è„šæœ¬è·å–ip" class="headerlink" title="è„šæœ¬è·å–ip"></a>è„šæœ¬è·å–ip</h2><p>åˆæ­¥è§£å†³æ–¹æ³•å‚è€ƒï¼š<a href="https://www.cnblogs.com/guoyabin/p/14263732.html">https://www.cnblogs.com/guoyabin/p/14263732.html</a></p><p>åŸåšä¸»æä¾›çš„è„šæœ¬å¦‚ä¸‹ï¼Œå¯ä»¥ä¸‹è½½æ‰€æœ‰æµ·å¤–ipåˆ—è¡¨å¹¶ç”Ÿæˆä¸€ä¸ªnginxé…ç½®ï¼Œå†™å…¥<code>/etc/nginx/blackip.conf</code>ä¸­</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">rm</span> -f legacy-apnic-latest black_`<span class="built_in">date</span> +%F`.conf &amp;&amp; wget http://ftp.apnic.net/apnic/stats/apnic/legacy-apnic-latest</span><br><span class="line"></span><br><span class="line">awk -F <span class="string">&#x27;|&#x27;</span> <span class="string">&#x27;&#123;if(NR&gt;2)printf(&quot;%s %s/%d%s\n&quot;,&quot;deny&quot;,$4,24,&quot;;&quot;)&#125;&#x27;</span> legacy-apnic-latest &gt; black_`<span class="built_in">date</span> +%F`.conf &amp;&amp; \</span><br><span class="line"><span class="built_in">rm</span> -f /etc/nginx/blackip.conf &amp;&amp; \</span><br><span class="line"><span class="built_in">ln</span> -s <span class="variable">$PWD</span>/black_`<span class="built_in">date</span> +%F`.conf /etc/nginx/blackip.conf</span><br></pre></td></tr></table></figure><p>è„šæœ¬æ‰§è¡Œåçš„æ•ˆæœå¦‚ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@bt-7274:/etc/nginx]# ll</span><br><span class="line">total 88</span><br><span class="line">lrwxrwxrwx 1 root root   34 Dec  9 16:03 blackip.conf -&gt; /root/docker/black_2023-12-09.conf</span><br></pre></td></tr></table></figure><p>æ–‡ä»¶å†…å®¹å¦‚ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@bt-7274:/etc/nginx/conf.d]# cat ../blackip.conf</span><br><span class="line">deny 128.134.0.0/24;</span><br><span class="line">deny 128.184.0.0/24;</span><br><span class="line">deny 128.250.0.0/24;</span><br><span class="line">deny 129.60.0.0/24;</span><br><span class="line">deny 129.78.0.0/24;</span><br><span class="line">...åé¢çš„çœç•¥äº†</span><br></pre></td></tr></table></figure><h2 id="nginxå±è”½æµ·å¤–ip"><a href="#nginxå±è”½æµ·å¤–ip" class="headerlink" title="nginxå±è”½æµ·å¤–ip"></a>nginxå±è”½æµ·å¤–ip</h2><p>å‚è€ƒåŸåšä¸»çš„åšæ³•ï¼Œä½ å¯ä»¥å°†è¿™ä¸ª<code>blackip.conf</code>åœ¨<code>/etc/nginx/nginx.conf</code>ä¸­çš„<strong>httpæ¨¡å—</strong>é‡Œé¢includeï¼Œè¿™æ ·ä¼šé˜»æ­¢å½“å‰æœåŠ¡å™¨æ‰€æœ‰åä»£çš„æµ·å¤–çš„è¯·æ±‚ã€‚</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">include</span> /etc/nginx/blackip.conf;</span><br></pre></td></tr></table></figure><p>è¿˜å¯ä»¥åœ¨å•ä¸ªé…ç½®æ–‡ä»¶çš„<a href="https://zinglix.xyz/2021/10/04/nginx-ssl-reject-handshake/">locationé‡Œé¢å¼•ç”¨</a></p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">  <span class="section">location</span> / &#123;</span><br><span class="line">      <span class="attribute">proxy_redirect</span> <span class="literal">off</span>; <span class="comment"># artalkçš„nginxé…ç½®ä¸­å¿…é¡»æœ‰è¿™ä¸ª</span></span><br><span class="line">      <span class="attribute">proxy_set_header</span> X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line">      <span class="attribute">proxy_set_header</span> X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">      <span class="attribute">proxy_set_header</span> Host <span class="variable">$host</span>;</span><br><span class="line">      <span class="attribute">proxy_set_header</span> Upgrade-Insecure-Requests <span class="number">1</span>;</span><br><span class="line">      <span class="attribute">proxy_set_header</span> X-Forwarded-Proto https;</span><br><span class="line"></span><br><span class="line">      <span class="attribute">include</span> /etc/nginx/blackip.conf; <span class="comment"># å¼•ç”¨é…ç½®</span></span><br><span class="line"></span><br><span class="line">      <span class="attribute">proxy_pass</span> http://127.0.0.1:14722;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹åé‡å¯nginxï¼Œæ²¡æœ‰æŠ¥é”™å°±æ˜¯okäº†</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart nginx</span><br></pre></td></tr></table></figure><p>ç”¨æµ·å¤–çš„æœåŠ¡å™¨è¯•è¯•èƒ½ä¸èƒ½è¯·æ±‚artalkï¼Œç”¨<a href="https://artk.musnow.top/sidebar/#/login">artk.musnow.top&#x2F;sidebar&#x2F;â€¦</a>è¿™ä¸ªç®¡ç†å‘˜ç™»å½•é¡µé¢æ¥è¿›è¡Œæµ‹è¯•ã€‚</p><p>å›½å†…æœåŠ¡å™¨è¯·æ±‚ç»“æœå¦‚ä¸‹ï¼Œå’Œæµè§ˆå™¨æ‰“å¼€çš„ç»“æœåŸºæœ¬æ˜¯ä¸€æ ·ï¼ˆç®¡ç†å‘˜ç™»å½•ç•Œé¢ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@bt-7274:/etc/nginx/conf.d]# curl https://artk.musnow.top/sidebar/#/login</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot; /&gt;</span><br><span class="line">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt;</span><br><span class="line">    &lt;title&gt;Artalk Sidebar&lt;/title&gt;</span><br><span class="line">    &lt;script type=&quot;module&quot; crossorigin src=&quot;./assets/index-5a0b3a93.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;link rel=&quot;stylesheet&quot; href=&quot;./assets/index-84fdcf98.css&quot;&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">    &lt;div id=&quot;app&quot;&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>æµ·å¤–æœåŠ¡å™¨è¯·æ±‚ç»“æœä¹Ÿæ˜¯ä¸Šé¢è¿™æ ·â€¦â€¦ç„¶åå‘ç°æ˜¯å› ä¸ºæˆ‘çš„æµ·å¤–æœåŠ¡å™¨ipå‹æ ¹ä¸åœ¨é‚£ä¸ªblackçš„denyåˆ—è¡¨é‡Œé¢</p><p>å°è¯•æŠŠipçš„ç½‘æ®µç»™åŠ è¿›å»ï¼Œé‡å¯nginxå†è¯•è¯•ã€‚<strong>å®Œç¾å¤„ç†</strong>ï¼æ·»åŠ å‰èƒ½æ­£å¸¸è¯·æ±‚åˆ°ï¼Œæ·»åŠ åå°±å˜æˆ403äº†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">[root@RainYun-8aNbbsmA:~]# curl https://artk.musnow.top/sidebar/#/login</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot; /&gt;</span><br><span class="line">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt;</span><br><span class="line">    &lt;title&gt;Artalk Sidebar&lt;/title&gt;</span><br><span class="line">    &lt;script type=&quot;module&quot; crossorigin src=&quot;./assets/index-5a0b3a93.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;link rel=&quot;stylesheet&quot; href=&quot;./assets/index-84fdcf98.css&quot;&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">    &lt;div id=&quot;app&quot;&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">[root@RainYun-8aNbbsmA:~]#</span><br><span class="line">[root@RainYun-8aNbbsmA:~]# curl https://artk.musnow.top/sidebar/#/login</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;&lt;title&gt;403 Forbidden&lt;/title&gt;&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;center&gt;&lt;h1&gt;403 Forbidden&lt;/h1&gt;&lt;/center&gt;</span><br><span class="line">&lt;hr&gt;&lt;center&gt;nginx/1.20.1&lt;/center&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">[root@RainYun-8aNbbsmA:~]#</span><br></pre></td></tr></table></figure><h2 id="nginxå±è”½éå›½å†…ip"><a href="#nginxå±è”½éå›½å†…ip" class="headerlink" title="nginxå±è”½éå›½å†…ip"></a>nginxå±è”½éå›½å†…ip</h2><p>æˆ‘å‰æ–‡æåˆ°äº†æˆ‘çš„æµ·å¤–æœåŠ¡å™¨çš„ipä¸åœ¨è¿™ä¸ªdenyçš„ipåˆ—è¡¨é‡Œé¢ï¼Œæ²¡æœ‰è¢«å±è”½ã€‚</p><p>è€ƒè™‘åˆ°ç½‘ä¸Šæœä¸åˆ°<code>legacy-apnic-latest</code>æ–‡ä»¶å­˜æ”¾çš„æ˜¯ä»€ä¹ˆipçš„ä¿¡æ¯ï¼Œæˆ‘å†³å®šæ¢ä¸€ä¸ªæ€è·¯ï¼šallowå›½å†…çš„ipï¼Œæ‹’ç»æ‰€æœ‰éå›½å†…çš„ip</p><blockquote><p>è·å–å›½å†…ipåˆ—è¡¨ <a href="https://www.cnblogs.com/sentangle/p/13201770.html">https://www.cnblogs.com/sentangle/p/13201770.html</a></p></blockquote><p>ä¸‹é¢è¿™ä¸ªurlé‡Œé¢çš„ipåœ°å€æ ‡æ˜äº†åœ°åŒºï¼Œæˆ‘ä»¬åªéœ€è¦å°†å…¶æå–å‡ºæ¥å³å¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://ftp.apnic.net/apnic/stats/apnic/delegated-apnic-latest</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ–‡ä»¶é‡Œé¢çš„å†…å®¹ç»“æ„å¦‚ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç­‰çº§æœºæ„|è·å¾—è¯¥IPæ®µçš„å›½å®¶/ç»„ç»‡|èµ„æºç±»å‹|èµ·å§‹IP|IPæ®µé•¿åº¦|åˆ†é…æ—¥æœŸ|åˆ†é…çŠ¶æ€</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬åªéœ€è¦æå–CNçš„æ‰€æœ‰IPï¼Œç„¶åå…è®¸ä»–ä»¬ï¼Œå†<code>deny all</code>é˜»æ­¢å…¶ä»–ipå°±å¯ä»¥äº†</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">rm</span> -f delegated-apnic-latest blackcn_`<span class="built_in">date</span> +%F`.conf &amp;&amp; wget http://ftp.apnic.net/apnic/stats/apnic/delegated-apnic-latest</span><br><span class="line"></span><br><span class="line">awk -F\| <span class="string">&#x27;/CN\|ipv4/ &#123; printf(&quot;%s %s/%d%s\n&quot;,&quot;allow&quot;,$4, 32-log($5)/log(2), &quot;;&quot;) &#125;&#x27;</span> delegated-apnic-latest &gt; blackcn_`<span class="built_in">date</span> +%F`.conf &amp;&amp; \</span><br><span class="line"><span class="built_in">rm</span> -f /etc/nginx/blackcn.conf &amp;&amp; \</span><br><span class="line"><span class="built_in">ln</span> -s <span class="variable">$PWD</span>/blackcn_`<span class="built_in">date</span> +%F`.conf /etc/nginx/blackcn.conf</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œè¿™ä¸ªè„šæœ¬åï¼Œä¼šç”Ÿæˆ<code>/etc/nginx/blackcn.conf</code>æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@bt-7274:/etc/nginx]# ll</span><br><span class="line">total 88</span><br><span class="line">lrwxrwxrwx 1 root root   42 Dec  9 16:54 blackcn.conf -&gt; /root/docker/nginx/blackcn_2023-12-09.conf</span><br><span class="line">lrwxrwxrwx 1 root root   40 Dec  9 16:56 blackip.conf -&gt; /root/docker/nginx/black_2023-12-09.conf</span><br></pre></td></tr></table></figure><p>å†…å®¹å¦‚ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">allow 223.248.0.0/14;</span><br><span class="line">allow 223.252.128.0/17;</span><br><span class="line">allow 223.254.0.0/16;</span><br><span class="line">allow 223.255.0.0/17;</span><br><span class="line">allow 223.255.236.0/22;</span><br><span class="line">allow 223.255.252.0/23;</span><br><span class="line">....</span><br></pre></td></tr></table></figure><p>è¿˜æ˜¯ä¿®æ”¹nginxå•ä¸ªç«™ç‚¹é…ç½®æ–‡ä»¶çš„locationä¸­çš„å†…å®¹</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">  <span class="section">location</span> / &#123;</span><br><span class="line">      <span class="attribute">proxy_redirect</span> <span class="literal">off</span>;</span><br><span class="line">  <span class="attribute">proxy_set_header</span> X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line">      <span class="attribute">proxy_set_header</span> X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">      <span class="attribute">proxy_set_header</span> Host <span class="variable">$host</span>;</span><br><span class="line">      <span class="attribute">proxy_set_header</span> Upgrade-Insecure-Requests <span class="number">1</span>;</span><br><span class="line">      <span class="attribute">proxy_set_header</span> X-Forwarded-Proto https;</span><br><span class="line"><span class="comment"># å…è®¸æ‰€æœ‰å›½å†…ip</span></span><br><span class="line">  <span class="attribute">include</span> /etc/nginx/blackcn.conf;</span><br><span class="line">  <span class="attribute">deny</span> all; <span class="comment"># é˜»æ­¢å…¶ä»–ip</span></span><br><span class="line"></span><br><span class="line">  <span class="attribute">proxy_pass</span> http://127.0.0.1:14722;</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure><p>å…ˆæ¥è¯•è¯•ä¸ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼ˆä¸åšä»»ä½•denyå’Œallowæ“ä½œçš„æƒ…å†µä¸‹ï¼‰æµ·å¤–ipè¯·æ±‚ç»“æœ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@RainYun-8aNbbsmA:~]# curl https://artk.musnow.top/sidebar/#/login</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot; /&gt;</span><br><span class="line">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt;</span><br><span class="line">    &lt;title&gt;Artalk Sidebar&lt;/title&gt;</span><br><span class="line">    &lt;script type=&quot;module&quot; crossorigin src=&quot;./assets/index-5a0b3a93.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;link rel=&quot;stylesheet&quot; href=&quot;./assets/index-84fdcf98.css&quot;&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">    &lt;div id=&quot;app&quot;&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>ç¬¦åˆé¢„æœŸï¼Œæ­£å¸¸è¯·æ±‚å‡ºäº†ç™»å½•é¡µé¢çš„htmlæ–‡ä»¶ã€‚</p><p>æ·»åŠ å¦‚ä¸Šä¿®æ”¹åï¼Œé‡å¯nginxï¼Œå†æ¬¡è¿›è¡Œæµ‹è¯•ã€‚è¿™ä¸€æ¬¡å·²ç»403é˜»æ­¢äº†ï¼Œå®Œç¾ï¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@RainYun-8aNbbsmA:~]# curl https://artk.musnow.top/sidebar/#/login</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;&lt;title&gt;403 Forbidden&lt;/title&gt;&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;center&gt;&lt;h1&gt;403 Forbidden&lt;/h1&gt;&lt;/center&gt;</span><br><span class="line">&lt;hr&gt;&lt;center&gt;nginx/1.20.1&lt;/center&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h1 id="The-end"><a href="#The-end" class="headerlink" title="The end"></a>The end</h1><p>ä½ å¯ä»¥å†™ä¸ªcrontabè®©å…¶å®šæ—¶æ‰§è¡Œè„šæœ¬å¹¶é‡å¯nginxï¼Œæˆ‘ä¸ªäººè¿˜æ˜¯é€‰æ‹©äººå·¥å¤„ç†äº†ï¼ˆä»€ä¹ˆæ—¶å€™æƒ³èµ·æ¥å°±å»æ›´æ–°ä¸€ä¸‹ipåˆ—è¡¨ï¼‰</p><p>æ„Ÿè°¢æœ¬æ–‡ä¸­å‡ºç°çš„åšå®¢çš„åšä¸»ã€‚æ²¡æœ‰ä»–ä»¬çš„å¸®åŠ©ï¼Œæˆ‘æ— æ³•ç¼–å†™å‡ºshellè„šæœ¬ã€‚</p>]]></content>
    
    
    <summary type="html">nginxé€šè¿‡é…ç½®æ–‡ä»¶é˜»æ­¢æµ·å¤–ipè®¿é—®</summary>
    
    
    
    <category term="ç©ä¸ŠLinux" scheme="https://blog.musnow.top/categories/%E7%8E%A9%E4%B8%8ALinux/"/>
    
    
    <category term="Linux" scheme="https://blog.musnow.top/tags/Linux/"/>
    
    <category term="nginx" scheme="https://blog.musnow.top/tags/nginx/"/>
    
  </entry>
  
  <entry>
    <title>ã€å›¾åºŠã€‘åˆ é™¤å¯¹è±¡å­˜å‚¨æ¡¶å‰ä¸€å®šè¦æ£€æŸ¥ï¼</title>
    <link href="https://blog.musnow.top/posts/3595872827/"/>
    <id>https://blog.musnow.top/posts/3595872827/</id>
    <published>2023-12-09T02:32:14.000Z</published>
    <updated>2023-12-09T02:32:14.000Z</updated>
    
    <content type="html"><![CDATA[<p>æˆ‘åˆå¹²è ¢äº‹äº†ï¼è™½ç„¶æ²¡æœ‰å¾ˆå¤§å½±å“ï¼Œä½†æ˜¯è¿™ç§é—®é¢˜è¿˜æ˜¯ä¸è¦å‘ç”Ÿçš„å¥½ã€‚</p><h2 id="ä»€ä¹ˆæƒ…å†µï¼Ÿ"><a href="#ä»€ä¹ˆæƒ…å†µï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæƒ…å†µï¼Ÿ"></a>ä»€ä¹ˆæƒ…å†µï¼Ÿ</h2><p>æˆ‘åœ¨åšå®¢å°šæœ‰å¼•ç”¨æŸä¸ªå¯¹è±¡å­˜å‚¨bucketä¸­å›¾ç‰‡çš„æƒ…å†µä¸‹ï¼Œåˆ é™¤äº†é‚£ä¸ªbucketï¼ˆå› ä¸ºè¿™ä¸ªbucketå¾ˆä¹…æ²¡æœ‰ç”¨ï¼Œç®—æ˜¯å¼ƒç”¨çš„ï¼‰</p><p>è¿˜å¥½ä»Šå¤©çœ‹æ—§ç¬”è®°çš„æ—¶å€™ï¼Œçªç„¶å‘ç°äº†è¿™ä¸ªé—®é¢˜ï¼Œç«‹é©¬å»é‡æ–°æœç´¢äº†ä¸€ä¸‹è¿™ä¸ªæ—§bucketçš„å›¾ç‰‡é“¾æ¥ï¼Œè¿˜å¥½è¿˜å¥½ï¼Œå—å½±å“çš„åªæœ‰ä¸¤ç¯‡æ–‡ç« </p><ul><li>ä¸€ç¯‡ä¹‹å‰å¯¼å‡ºè¿‡PDFï¼Œå›¾ç‰‡è¿˜èƒ½æ‰¾åˆ°</li><li>å¦å¤–ä¸€ç¯‡æ–‡ç« ä»¥æ–‡å­—ä¸ºä¸»ï¼Œå†…éƒ¨ä¸¢å¤±çš„å›¾ç‰‡å¯æœ‰å¯æ— </li></ul><p>æˆ‘æ¢å¤äº†ç¬¬ä¸€ç¯‡é‡Œé¢çš„å›¾ç‰‡ï¼Œç„¶åä¿®æ”¹äº†ç¬¬äºŒç¯‡ä¸­å’Œå›¾ç‰‡ç›¸å…³çš„æ–‡å­—è¯´æ˜ï¼Œç®—æ˜¯è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚</p><p>åˆé‡å†™æ£€æŸ¥äº†ä¸€ä¸‹ç¬”è®°ç›®å½•ï¼Œç®—æ˜¯å½»åº•æ²¡æœ‰è¿™ä¸ªè¢«æˆ‘åˆ é™¤çš„bucketé‡Œé¢çš„å›¾ç‰‡äº†ã€‚</p><p>è¿™ä¸€æ¬¡è¿˜å¥½ï¼Œç®—æ˜¯æ²¡æœ‰ä¸¢ä¸œè¥¿ï¼Œä¸ç„¶æ•°æ®ä¸å¤‡ä»½å°±åˆ é™¤çš„ç¬‘æ–™åˆè¦å¤šä¸€ä¸ªäº†â€¦â€¦ğŸ¤£</p><h2 id="ä»¥æ­¤ä¸ºæˆ’"><a href="#ä»¥æ­¤ä¸ºæˆ’" class="headerlink" title="ä»¥æ­¤ä¸ºæˆ’"></a>ä»¥æ­¤ä¸ºæˆ’</h2><p>åˆ é™¤bucketä¹‹å‰ä¸€å®šè¦æ£€æŸ¥è‡ªå·±åˆ°åº•è¿˜æœ‰æ²¡æœ‰ä½¿ç”¨è¿™ä¸ªbucketä¸­çš„æ–‡ä»¶æˆ–è€…å›¾ç‰‡ï¼</p><p>åˆ é™¤å›¾åºŠæœ¬åœ°ç›®å½•å‰ï¼Œä¸€å®šè¦æ£€æŸ¥è‡ªå·±è¿˜æœ‰æ²¡æœ‰è¿™ä¸ªæœ¬åœ°ç›®å½•é‡Œé¢çš„å›¾ç‰‡ï¼</p><p>æœ€ä½³æ–¹æ¡ˆï¼šä¸è¦ç®¡é‚£ä¸ªbucketï¼Œå°†å…¶è®¿é—®æƒé™æ”¹æˆ<strong>ç§æœ‰</strong>åï¼Œä½¿ç”¨å¤‡æ³¨åŠŸèƒ½å°†å…¶æ ‡è®°ä¸ºå¼ƒç”¨ã€‚ä»¥åä¸å†ä½¿ç”¨è¯¥bucketå³å¯ã€‚</p><p>å› ä¸ºå¯¹äºæˆ‘ä¸ªäººä½¿ç”¨æ¥è¯´ï¼Œä¸€ä¸ªbucketé‡Œé¢ä¸ä¼šæœ‰å¤ªå¤šæ–‡ä»¶ï¼Œç›®å‰æœ€å¤§çš„å›¾åºŠbucketä¹Ÿä¸è¿‡2GBè€Œå·²ï¼ŒæŠŠå®ƒç•™åœ¨é‚£é‡ŒèŠ±ä¸äº†å‡ ä¸ªé’±ï¼ä¸ç„¶æŠŠbucketåˆ äº†ï¼Œå“ªå¤©å‘ç°éœ€è¦å»é‡Œé¢æ‰¾æ—§æ–‡ä»¶çš„æ—¶å€™æ— ä»ä¸‹æ‰‹å°±éº»çƒ¦äº†ï¼</p><blockquote><p>è‡³äºæˆ‘ä¸ºä»€ä¹ˆè¦åˆ â€¦â€¦å…¶å®æ˜¯å› ä¸ºæˆ‘æœ‰ç‚¹å¼ºè¿«ç—‡ï¼Œä¸ç”¨è¿˜ç•™åœ¨é‚£é‡Œçœ‹ç€æœ‰ç‚¹ä¸çˆ½â€¦â€¦</p></blockquote><p>å½“ç„¶è¿˜æœ‰å¦å¤–ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨<code>rclone</code>ç­‰å·¥å…·ï¼Œå°†s3ä¸­çš„æ‰€æœ‰æ–‡ä»¶ä¸‹è½½åˆ°æœ¬åœ°ï¼Œæ‰“åŒ…å¤šåœ°å¤‡ä»½åï¼Œåˆ é™¤äº‘ç«¯bucket</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æˆ‘åˆå¹²è ¢äº‹äº†ï¼è™½ç„¶æ²¡æœ‰å¾ˆå¤§å½±å“ï¼Œä½†æ˜¯è¿™ç§é—®é¢˜è¿˜æ˜¯ä¸è¦å‘ç”Ÿçš„å¥½ã€‚&lt;/p&gt;
&lt;h2 id=&quot;ä»€ä¹ˆæƒ…å†µï¼Ÿ&quot;&gt;&lt;a href=&quot;#ä»€ä¹ˆæƒ…å†µï¼Ÿ&quot; class=&quot;headerlink&quot; title=&quot;ä»€ä¹ˆæƒ…å†µï¼Ÿ&quot;&gt;&lt;/a&gt;ä»€ä¹ˆæƒ…å†µï¼Ÿ&lt;/h2&gt;&lt;p&gt;æˆ‘åœ¨åšå®¢å°šæœ‰å¼•ç”¨æŸä¸ªå¯¹è±¡å­˜å‚¨bucke</summary>
      
    
    
    
    <category term="å·®ç”Ÿæ–‡å…·å¤š" scheme="https://blog.musnow.top/categories/%E5%B7%AE%E7%94%9F%E6%96%87%E5%85%B7%E5%A4%9A/"/>
    
    
    <category term="å›¾åºŠ" scheme="https://blog.musnow.top/tags/%E5%9B%BE%E5%BA%8A/"/>
    
  </entry>
  
  <entry>
    <title>ã€åšå®¢ã€‘hexoé…ç½®sitemapå’Œç™¾åº¦|å¿…åº”|è°·æ­Œæ”¶å½•</title>
    <link href="https://blog.musnow.top/posts/3595872826/"/>
    <id>https://blog.musnow.top/posts/3595872826/</id>
    <published>2023-12-08T12:32:14.000Z</published>
    <updated>2023-12-08T12:32:14.000Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘æ²¡äº‹æ‰¾äº‹ï¼Œåˆçœ‹äº†ä¼šå…³äºåšå®¢ä¸»é¢˜çš„ä¸œè¥¿ï¼Œä¹‹å‰çš„sitemapä¸€ç›´æ²¡æœ‰å¼„ä¸Šå»ï¼Œç°åœ¨æœ‰æ—¶é—´å°±å¼„ä¸€ä¸‹ã€‚</p><h1 id="1-hexoå®‰è£…sitemapæ’ä»¶"><a href="#1-hexoå®‰è£…sitemapæ’ä»¶" class="headerlink" title="1.hexoå®‰è£…sitemapæ’ä»¶"></a>1.hexoå®‰è£…sitemapæ’ä»¶</h1><p>åœ¨ä½ çš„hexoè·¯å¾„ä¸‹æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå®‰è£…sitemapç”Ÿæˆæ’ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-generator-baidu-sitemap --save</span><br><span class="line">npm install hexo-generator-sitemap --save</span><br></pre></td></tr></table></figure><p>å®æµ‹åœ¨windows11çš„<code>node v16.20.2</code>å’Œ<code>npm  9.8.1</code>ä¸‹å¯ä»¥æ­£å¸¸å®‰è£…ï¼Œä½†æ˜¯å®‰è£…baidu-sitemapæ’ä»¶çš„æ—¶å€™å¯èƒ½ä¼šæœ‰è­¦å‘Šï¼ˆä¸å½±å“ä½¿ç”¨ï¼‰</p><p>å®‰è£…å®Œæ¯•æ’ä»¶åï¼Œåœ¨ä½ çš„hexoé…ç½®æ–‡ä»¶<code>_config.yml</code>ä¸­æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼ŒæŒ‡å®šç«™ç‚¹åœ°å›¾çš„æ–‡ä»¶åå­—å³å¯ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç™¾åº¦å’Œè°·æ­Œçš„sitemap</span></span><br><span class="line"><span class="comment"># npm install hexo-generator-baidu-sitemap --save</span></span><br><span class="line"><span class="comment"># npm install hexo-generator-sitemap --save</span></span><br><span class="line"><span class="attr">baidusitemap:</span></span><br><span class="line">    <span class="attr">path:</span> <span class="string">baidusitemap.xml</span></span><br><span class="line"><span class="attr">sitemap:</span></span><br><span class="line">    <span class="attr">path:</span> <span class="string">sitemap.xml</span></span><br></pre></td></tr></table></figure><p>è¯·æ³¨æ„ï¼Œéœ€è¦ä¿®æ”¹çš„æ˜¯hexoçš„é…ç½®æ–‡ä»¶ï¼Œå¹¶éä¸»é¢˜é…ç½®æ–‡ä»¶ï¼</p><h1 id="2-å¦‚ä½•ä¿®æ”¹hexoä¸»é¢˜ç”Ÿæˆçš„index-htmlæ–‡ä»¶ï¼Ÿ"><a href="#2-å¦‚ä½•ä¿®æ”¹hexoä¸»é¢˜ç”Ÿæˆçš„index-htmlæ–‡ä»¶ï¼Ÿ" class="headerlink" title="2.å¦‚ä½•ä¿®æ”¹hexoä¸»é¢˜ç”Ÿæˆçš„index.htmlæ–‡ä»¶ï¼Ÿ"></a>2.å¦‚ä½•ä¿®æ”¹hexoä¸»é¢˜ç”Ÿæˆçš„index.htmlæ–‡ä»¶ï¼Ÿ</h1><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œç«™ç‚¹å¹³å°éƒ½ä¼šè®©ä½ åœ¨<code>index.html</code>çš„<code>&lt;head&gt;</code>é‡Œé¢åŠ ä¸€ä¸ªhtmlè¯­å¥ï¼Œæ¥éªŒè¯ç«™ç‚¹çš„æ‰€æœ‰æƒã€‚æ¯”å›¾ç™¾åº¦çš„éªŒè¯htmlè¯­å¥å¦‚ä¸‹</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;baidu-site-verification&quot;</span> <span class="attr">content</span>=<span class="string">&quot;éªŒè¯ç &quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><p>éƒ¨åˆ†hexoä¸»é¢˜å¯èƒ½æä¾›äº†è‡ªå®šä¹‰<code>&lt;head&gt;</code>çš„é€‰é¡¹ï¼ˆæ¯”å¦‚butterflyä¸»é¢˜å°±æœ‰ï¼‰</p><p>å¦‚æœä½ ä½¿ç”¨çš„ä¸»é¢˜æ²¡æœ‰æä¾›è‡ªå®šä¹‰<code>&lt;head&gt;</code>ï¼Œå¯ä»¥å°è¯•åœ¨ä¸»é¢˜æ–‡ä»¶å¤¹ä¸‹æœç´¢indexæˆ–è€…headå…³é”®å­—ï¼Œæ¥æ‰¾åˆ°å½“å‰ä¸»é¢˜ä½¿ç”¨çš„<code>index.html</code>ç”Ÿæˆæºæ–‡ä»¶</p><blockquote><p>è¯¥æ–¹æ³•<strong>ä»…</strong>é€‚ç”¨äºå°†ä¸»é¢˜æ–‡ä»¶ç›´æ¥ä¸‹è½½åˆ°<code>themes</code>æ–‡ä»¶å¤¹ä¸‹çš„æƒ…å†µï¼Œå› ä¸ºå¦‚æœä½ ç”¨çš„æ˜¯npmå®‰è£…çš„ä¸»é¢˜ï¼Œé‚£ä¹ˆä¿®æ”¹çš„ä¸»é¢˜æ–‡ä»¶æ˜¯ä¸ä¼šå¯¹å…¶ä»–åœ°æ–¹çš„éƒ¨ç½²ç”Ÿæ•ˆçš„ï¼Œä¸‹ä¸€æ¬¡æ›´æ–°ä¸»é¢˜è¿˜ä¼šè¦†ç›–æ‰ã€‚</p></blockquote><p>æ¯”å¦‚ä¸‹å›¾æ˜¯keepä¸»é¢˜<code>v3.6.1</code>ç‰ˆæœ¬ä¸­çš„<code>head.ejs</code>ï¼Œä½ åªéœ€è¦æŠŠæä¾›çš„metaæ ‡ç­¾åŠ åˆ°è¿™é‡Œé¢ï¼Œä¸‹ä¸€æ¬¡éƒ¨ç½²çš„æ—¶å€™çš„<code>index.html</code>ä¸­å°±ä¼šå¸¦ä¸Šè¿™ä¸ªæ ‡å¤´äº†ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">themes\keep\layout\_partial\head.ejs</span><br></pre></td></tr></table></figure><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/c5c020be0607437acbd2d4364edd839b.png" alt="image-20231208205004240"></p><h1 id="3-ç«™é•¿å¹³å°æ·»åŠ sitemap"><a href="#3-ç«™é•¿å¹³å°æ·»åŠ sitemap" class="headerlink" title="3.ç«™é•¿å¹³å°æ·»åŠ sitemap"></a>3.ç«™é•¿å¹³å°æ·»åŠ sitemap</h1><h2 id="ç™¾åº¦"><a href="#ç™¾åº¦" class="headerlink" title="ç™¾åº¦"></a>ç™¾åº¦</h2><p>ç™¾åº¦èµ„æºæœç´¢å¹³å° <a href="https://ziyuan.baidu.com/site/index#/">https://ziyuan.baidu.com/site/index#/</a></p><p>ç™¾åº¦å®åœ¨æ˜¯æ— è¯­ï¼Œä¹‹å‰å®‰è£…äº†<code>hexo-baidu-url-submit</code>æ’ä»¶ï¼Œä¸»åŠ¨è°ƒç”¨ç™¾åº¦apiç»™ä»–æ¨é€urlï¼Œç»“æœå¼„äº†å·²ç»å¿«ä¸€å¹´äº†ï¼Œè¿˜æ²¡æœ‰æ”¶å½•æˆ‘çš„ç«™ç‚¹ã€‚</p><blockquote><p>å®è¯è¯´ï¼Œç™¾åº¦ä¸æ”¶å½•ç«™ç‚¹ï¼Œç½‘ç«™çœ‹çš„äººå°±å¾ˆå°‘ã€‚ç™¾åº¦æˆ‘è‡ªå·±åšå®¢çš„å…³é”®è¯ï¼Œç»“æœæ˜¯ä¸€å †è¢«ç™¾åº¦æ”¶å½•çš„çˆ¬è™«ç«™ç‚¹ç”¨æˆ‘çš„æ–‡ç« èµšæµé‡ã€‚å”‰â€¦â€¦</p></blockquote><p>åœ¨èµ„æºæœç´¢å¹³å°çš„ç«™ç‚¹ç®¡ç†ä¸­æ·»åŠ ä½ çš„ç«™ç‚¹ï¼Œç”¨ç¬¬äºŒç‚¹æåˆ°çš„æ–¹å¼è¿›è¡ŒéªŒè¯</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/f5049ad4122b226e6621e3f77bbca406.png" alt="image-20231208205611557"></p><p>æ·»åŠ å®Œæ¯•åï¼Œåœ¨æ™®é€šæ”¶å½•ä¸­å¯ä»¥æ‰¾åˆ°sitemapæäº¤çš„åŒºåŸŸã€‚ä½†æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆæˆ‘è¿™é‡Œçš„æäº¤é…é¢æ˜¯0ï¼Œæœç´¢äº†ä¸€ä¸‹ä¹Ÿæ²¡æœ‰æ‰¾åˆ°åŸå› ã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/f1271309829d10b946af8dc1834d6530.png" alt="image-20231208205652153"></p><p><a href="https://zmingcx.com/baidu-linksubmit-sitemap.html">ç™¾åº¦èµ„æºå¹³å°æäº¤sitemapæ˜¯å–æ¶ˆäº†è¿˜æ˜¯æˆ‘è¢«é™åˆ¶äº†ï¼Ÿ</a></p><p>æœ‰äººè¯´æ˜¯ç«™ç‚¹è´¨é‡å¤ªä½è¢«ç™¾åº¦å±è”½äº†ï¼Œä½†æ˜¯è¿™ä¸ªæƒ…å†µä¹Ÿæ˜¯å¾ˆå¤šäººéƒ½é‡åˆ°è¿‡çš„ã€‚ä¼°è®¡æ˜¯ç™¾åº¦ç­–ç•¥æ›´æ–°ä»€ä¹ˆçš„ï¼Œä¸å…è®¸ä½ æ·»åŠ äº†å§ï¼</p><p>å¦‚æœä½ å·²ç»æ·»åŠ äº†sitemapï¼Œè¯·ä¸è¦å°†å…¶åˆ é™¤ï¼Œå…å¾—åˆ°æ—¶å€™åˆæ²¡æœ‰åŠæ³•æ·»åŠ äº†ã€‚</p><h2 id="bing"><a href="#bing" class="headerlink" title="bing"></a>bing</h2><p>bingçš„ç«™é•¿å¹³å°ç›´æ¥æœå°±è¡Œï¼š<a href="https://www.bing.com/webmasters/about?setlang=zh-cn">https://www.bing.com/webmasters/about?setlang=zh-cn</a></p><blockquote><p>å›½å†…è£¸è¿å¯èƒ½ä¸ç¨³å®šï¼Œéœ€è¦ç”¨ç‚¹æ–¹æ³•ã€‚</p><p>ä¸è¿‡bingå³ä¾¿ä¸æäº¤sitemapä¹Ÿå’”å’”æ”¶å½•äº†æˆ‘çš„åšå®¢ï¼Œä¸»æ‰“ä¸€ä¸ªä¸»åŠ¨+æ¥è€…ä¸æ‹’ã€‚</p></blockquote><p>è¿›å»ä¹‹åï¼Œç”¨å¾®è½¯è´¦æˆ·ç™»å½•ï¼Œç„¶åç‚¹å‡»æ–°å¢ç«™ç‚¹ï¼Œ<strong>è¾“å…¥ä½ åšå®¢çš„åŸŸå</strong></p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/46eaebbcbe275e5719c48c0fa212d482.png" alt="image-20231208203803163"></p><p>bingä¼šè®©ä½ éªŒè¯ç«™ç‚¹æ‰€æœ‰æƒï¼Œæ ¹æ®ä¸‹é¢ä¸‰ç§æ–¹å¼çš„æŒ‡å¼•ï¼Œé€‰æ‹©ä¸€ç§å°±è¡Œäº†ã€‚å¦‚æœä½ ä¸çŸ¥é“å¦‚ä½•ä¿®æ”¹hexoçš„æºæ–‡ä»¶ï¼Œä½¿ç”¨<strong>CNAMEéªŒè¯</strong>æ–¹å¼æ˜¯æœ€ç®€å•çš„ï¼ˆåªè¦ä½ æœ‰åŸŸåæœ‰æƒå°±è¡Œäº†ï¼‰ã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/6decdf248d463e8dcf22c1408d1521a8.png" alt="image-20231208204120311"></p><p>ä¸è¿‡ä¼°è®¡æœ‰å¾ˆå¤šè€å“¥éƒ½æ˜¯ç™½å«–çš„github pagesæˆ–è€…netlify&#x2F;vercelçš„<strong>äºŒçº§åŸŸå</strong>ï¼Œåœ¨æ²¡æœ‰åŸŸåæ‰€æœ‰æƒçš„æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥ç”¨å‰ä¸¤ç§æ–¹å¼æ¥éªŒè¯ã€‚</p><ul><li>XMLæ–‡ä»¶æ–¹å¼ï¼šå°†bingæä¾›çš„XMLæ–‡ä»¶ä¸‹è½½ï¼Œç„¶åæ”¾åˆ°ä½ hexoæºç›®å½•çš„<strong>source</strong>æ–‡ä»¶å¤¹ä¸‹ï¼Œå°±å¯ä»¥äº†ã€‚</li><li>HTML MATEæ ‡è®°éªŒè¯ï¼šéƒ¨åˆ†hexoä¸»é¢˜å¯èƒ½æä¾›äº†è‡ªå®šä¹‰headerçš„é€‰é¡¹ï¼ˆæ¯”å¦‚butterflyä¸»é¢˜å°±æœ‰ï¼‰å…¶ä»–ä¸»é¢˜å¯ä»¥å‚è€ƒä¸Šæ–‡ç¬¬äºŒç‚¹æ“ä½œ</li></ul><p>åŸŸåéªŒè¯å®Œæ¯•åï¼Œåœ¨å·¦ä¾§å¯ä»¥æäº¤ç½‘ç«™åœ°å›¾ï¼ˆå³sidemapï¼‰</p><p>ç›´æ¥ç‚¹å‡»æŒ‰é’®æäº¤ä½ çš„ç«™ç‚¹åœ°å›¾çš„urlå°±å¯ä»¥äº†ã€‚bingä¼šè‡ªåŠ¨è¿›è¡Œå¤„ç†ï¼Œå¦‚ä¸‹å›¾æˆ‘çš„ç¬¬ä¸€ä¸ªsitemapå·²ç»æˆåŠŸå¤„ç†å‡ºæ¥äº†383ä¸ªé“¾æ¥ï¼Œéå¸¸å®Œç¾ã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/24f236053b3ebece4028124e987e6c65.png" alt="image-20231208204707769"></p><h2 id="è°·æ­Œ"><a href="#è°·æ­Œ" class="headerlink" title="è°·æ­Œ"></a>è°·æ­Œ</h2><p>å®è¯è¯´ï¼Œä¸€ä¸ªçº¯ä¸­æ–‡ä¸”é¢å‘å›½å†…è¯»è€…çš„ç«™ç‚¹ï¼Œåœ¨è°·æ­Œä¸Šé¢æ”¶å½•äº†ä¼°è®¡ä¹Ÿæ²¡å¤šå¤§ç”¨å¤„ï¼Œä½†æ˜¯å¯ä»¥æ²¡ç”¨ï¼Œä½†ä¸èƒ½æ²¡æœ‰ã€‚ä¹Ÿç»™ä»–å¼„ä¸€ä¸‹å§ã€‚</p><p><a href="https://search.google.com/search-console/welcome">https://search.google.com/search-console/welcome</a></p><p>é¦–å…ˆæ˜¯è¾“å…¥ç«™ç‚¹ç½‘å€ï¼Œå› ä¸ºæˆ‘ä¸éœ€è¦éªŒè¯æ‰€æœ‰ç«™ç‚¹ï¼ŒåªæŠŠåšå®¢æ”¶å½•äº†å°±è¡Œï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘é€‰çš„æ˜¯ç½‘å€å‰ç¼€ã€‚è¾“å…¥ç«™ç‚¹çš„æ—¶å€™éœ€è¦æŠŠhttpä¹Ÿå¸¦ä¸Š</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/940d735d204146063e8cb6de8db30326.png" alt="image-20231208210159103"></p><p>è°·æ­Œçš„éªŒè¯æ–¹å¼ä¹Ÿæœ‰å¾ˆå¤šç§ï¼Œè¿™é‡Œçš„æ“ä½œå’Œbingæ˜¯ä¸€æ ·çš„ï¼ŒæŠŠå®ƒå‘ç»™ä½ çš„æ–‡ä»¶ç›´æ¥æ”¾åˆ°hexoçš„sourceè·¯å¾„ä¸‹å°±å¯ä»¥äº†ï¼Œæˆ–è€…é‡‡ç”¨htmlæ ‡ç­¾çš„æ–¹å¼éªŒè¯ã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/6b7aef8d762ec3127bf418fba2257ff7.png" alt="image-20231208210317624"></p><p>éªŒè¯æˆåŠŸåï¼Œé€‰æ‹©å‰å¾€èµ„æºç•Œé¢ï¼Œå³å‰å¾€å½“å‰ç«™ç‚¹çš„æ§åˆ¶å°ã€‚</p><p>å¦‚æœä½ ä¸å°å¿ƒç‚¹äº†å®Œæˆï¼Œç«™ç‚¹èµ„æºç•Œé¢åœ¨ç«™é•¿å·¥å…·çš„<strong>å·¦ä¾§è¾¹æ </strong>é‡Œé¢ï¼Œåœ¨é‡Œé¢å¯ä»¥æ‰¾åˆ°ä½ å·²ç»æ·»åŠ äº†çš„ç«™ç‚¹ã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/2b62fc8c0f4a83a969894d7a97f13007.png" alt="image-20231208210604314"></p><p>åœ¨å·¦ä¾§é€‰æ‹©ç«™ç‚¹åœ°å›¾ï¼Œç‚¹å‡»æ·»åŠ å³å¯</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/f8159f7211dc0f12fc854ae74476f2f8.png" alt="image-20231208210802621"></p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/12/d57012975919635230b6bd8f57e9871b.png" alt="image-20231208210849226"></p><h1 id="æå®šï¼"><a href="#æå®šï¼" class="headerlink" title="æå®šï¼"></a>æå®šï¼</h1><p>æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œæ¬¢è¿è¯„è®ºåŒºæå‡ºï¼</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æœ€è¿‘æ²¡äº‹æ‰¾äº‹ï¼Œåˆçœ‹äº†ä¼šå…³äºåšå®¢ä¸»é¢˜çš„ä¸œè¥¿ï¼Œä¹‹å‰çš„sitemapä¸€ç›´æ²¡æœ‰å¼„ä¸Šå»ï¼Œç°åœ¨æœ‰æ—¶é—´å°±å¼„ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;h1 id=&quot;1-hexoå®‰è£…sitemapæ’ä»¶&quot;&gt;&lt;a href=&quot;#1-hexoå®‰è£…sitemapæ’ä»¶&quot; class=&quot;headerlink&quot; title=&quot;1</summary>
      
    
    
    
    <category term="å·®ç”Ÿæ–‡å…·å¤š" scheme="https://blog.musnow.top/categories/%E5%B7%AE%E7%94%9F%E6%96%87%E5%85%B7%E5%A4%9A/"/>
    
    
    <category term="Hexo" scheme="https://blog.musnow.top/tags/Hexo/"/>
    
  </entry>
  
  <entry>
    <title>ã€Linuxã€‘lcov2.0å®‰è£…å’Œperlä¿®æ”¹é•œåƒæº</title>
    <link href="https://blog.musnow.top/posts/1274282021/"/>
    <id>https://blog.musnow.top/posts/1274282021/</id>
    <published>2023-11-26T12:12:55.000Z</published>
    <updated>2023-11-26T12:12:55.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å®‰è£…lcov-2-0"><a href="#å®‰è£…lcov-2-0" class="headerlink" title="å®‰è£…lcov 2.0"></a>å®‰è£…lcov 2.0</h1><p>ä½ å¯èƒ½ä¸çŸ¥é“lcovæ˜¯ä»€ä¹ˆï¼Œç®€è€Œè¨€ä¹‹ï¼Œå®ƒæ˜¯ä¸€ä¸ªä»£ç å•å…ƒæµ‹è¯•è¦†ç›–ç‡çš„æ˜¾ç¤ºå·¥å…·ï¼ŒåŸºäºgcovã€‚</p><ul><li>ä»€ä¹ˆæ˜¯å•å…ƒæµ‹è¯•è¦†ç›–ç‡ï¼Ÿ</li></ul><p>æˆ‘ä»¬éœ€è¦å¯¹é¡¹ç›®ä¸­çš„æ¯ä¸ªå‡½æ•°ç¼–å†™å•å…ƒæµ‹è¯•ï¼Œå…¶å®å°±æ˜¯æµ‹è¯•å‡½æ•°çš„åŠŸèƒ½ã€‚é€šè¿‡gcc&#x2F;g++çš„ç›¸å…³ç¼–è¯‘é€‰é¡¹ï¼Œå¯ä»¥å¾—åˆ°ä¸€ä¸ªgcdaæ–‡ä»¶ï¼Œå†…éƒ¨åŒ…å«æŸä¸ªcppæ–‡ä»¶ä¸­ç›¸å…³å‡½æ•°è¢«æ‰§è¡Œäº†å¤šå°‘æ¬¡ï¼Œä»¥åŠæŸäº›if&#x2F;switchä¸­çš„å¤šåˆ†æ”¯æ˜¯å¦è¦†ç›–ä¸Šäº†ï¼›</p><p>lcovå°±å¯ä»¥è§£æè¿™äº›gcdaæ–‡ä»¶ï¼Œå¾—åˆ°å¦‚ä¸‹å›¾æ‰€ç¤ºçš„å‡½æ•°<strong>æµ‹è¯•è¦†ç›–ç‡</strong>çš„æŠ¥å‘Š</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/11/6115958c076400afbfaf6ace5c1e89b9.png" alt="image-20231126201406666"></p><p>åŒ…æ‹¬å•å…ƒæµ‹è¯•åœ¨å†…ï¼Œè¿™éƒ¨åˆ†å¯¹ä»£ç å‡½æ•°æµ‹è¯•çš„æ“ä½œä¸€èˆ¬è¢«ç§°ä¹‹ä¸º<code>åŠŸèƒ½å®‰å…¨</code>ï¼Œè¿™é‡Œå°±ä¸å¤šè¯´äº†ã€‚</p><p>lcov 2.0çš„å®‰è£…å‘½ä»¤ç›¸å¯¹æ¥è¯´å¾ˆç®€å•ï¼Œå°±æ˜¯ä¸‹é¢è¿™äº›</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">wget https://github.com/linux-test-project/lcov/releases/download/v2.0/lcov-2.0.tar.gz</span><br><span class="line">tar -zxvf lcov-2.0.tar.gz</span><br><span class="line"><span class="built_in">cd</span> lcov-2.0</span><br><span class="line">sudo make install</span><br></pre></td></tr></table></figure><h1 id="perl"><a href="#perl" class="headerlink" title="perl"></a>perl</h1><p>ä½¿ç”¨lcovçš„æ—¶å€™éœ€è¦perlï¼Œæ­¤æ—¶å°±éœ€è¦ä¿®æ”¹é•œåƒæºã€‚é»˜è®¤çš„perl moduleçš„æºæ˜¯åœ¨å›½å¤–çš„ï¼Œå›½å†…åŸºæœ¬ä¸Šæ˜¯å®Œå…¨ç”¨ä¸äº†ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># centos8 å®‰è£…perl</span></span><br><span class="line">sudo yum install perl</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ çš„lcovè¿è¡Œçš„æ—¶å€™é‡åˆ°ä¸‹é¢ç±»ä¼¼çš„é”™è¯¯ï¼Œé‚£ä¹ˆå°±æ˜¯å› ä¸ºperlç¼ºå°‘å¯¹åº”moduleå¯¼è‡´çš„ï¼Œæ¯”å¦‚å¦‚ä¸‹æŠ¥é”™æ˜¯å› ä¸ºç¼ºå°‘<code>Capture::Tiny</code>è¿™ä¸ªmoduleï¼›</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Can&#x27;t locate Capture/Tiny.pm in @INC (you may need to install the Capture::Tiny module) (@INC contains: /usr/local/lib/lcov /usr/local/lib64/perl5 /usr/local/share/perl5 /usr/lib64/perl5/vendor_perl /usr/share/perl5/vendor_perl /usr/lib64/perl5 /usr/share/perl5) at /usr/local/lib/lcov/lcovutil.pm line 14.</span><br><span class="line">BEGIN failed--compilation aborted at /usr/local/lib/lcov/lcovutil.pm line 14.</span><br><span class="line">Compilation failed in require at /usr/local/bin/lcov line 102.</span><br><span class="line">BEGIN failed--compilation aborted at /usr/local/bin/lcov line 102.</span><br><span class="line">make: *** [makefile:6: lcov] Error 2</span><br></pre></td></tr></table></figure><h2 id="perlä½¿ç”¨æ¸…åæº"><a href="#perlä½¿ç”¨æ¸…åæº" class="headerlink" title="perlä½¿ç”¨æ¸…åæº"></a>perlä½¿ç”¨æ¸…åæº</h2><p>ä½¿ç”¨æ¸…åæºå°±è¡Œäº† <a href="https://mirrors.tuna.tsinghua.edu.cn/help/CPAN/">https://mirrors.tuna.tsinghua.edu.cn/help/CPAN/</a></p><p>å› ä¸ºæˆ‘ç”¨çš„centosçš„ç³»ç»Ÿï¼Œå®‰è£…çš„perlç‰ˆæœ¬å¾ˆè€ï¼Œ<code>v5.26.3</code>ï¼Œæ‰€ä»¥è¿™é‡Œè®°å½•ä¸€ä¸ªæ‰‹åŠ¨ä¿®æ”¹é•œåƒæºçš„åŠæ³•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">perl --version</span><br></pre></td></tr></table></figure><p>åœ¨rootç”¨æˆ·ä¸‹æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œä¼šè¿›å…¥ä¸€ä¸ªperlçš„å‘½ä»¤è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">perl -MCPAN -e shell</span><br></pre></td></tr></table></figure><p>åœ¨perlçš„å‘½ä»¤è¡Œä¸­æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">o conf init</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆå±•ç°çš„ç»“æœåº”è¯¥å¦‚ä¸‹ï¼Œä¼šè‡ªåŠ¨å¾€å½“å‰ç”¨æˆ·çš„å®¶ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªé…ç½®æ–‡ä»¶</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/11/fdfb49a8a83aa12789080503070a9a7a.png" alt="image-20231126200126012"></p><p>è¿™é‡Œåˆ›å»ºçš„é…ç½®æ–‡ä»¶æ˜¯åœ¨rootç”¨æˆ·ä¸‹ï¼Œè¾“å…¥<code>quit</code>é€€å‡ºperlçš„å‘½ä»¤è¡Œåï¼Œæˆ‘ä»¬ç›´æ¥vimæ‰“å¼€è¿™ä¸ªé…ç½®æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /root/.cpan/CPAN/MyConfig.pm</span><br></pre></td></tr></table></figure><p>åœ¨é‡Œé¢æ‰¾åˆ°urllisté€‰é¡¹ï¼Œæ ¹æ®å·²æœ‰æ ¼å¼æ·»åŠ ä¸€ä¸ªæ–°çš„é•œåƒè·¯å¾„å°±å¯ä»¥äº†</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/11/0f2b4af79a73a2f95bb6f6de6b17560b.png" alt="image-20231126200230352"></p><p>æˆ‘è¿™é‡Œæ·»åŠ åçš„urllisté…ç½®é¡¹å¦‚ä¸‹ï¼Œç¬¬ä¸€é¡¹æ˜¯é•œåƒæºå°±OK</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;urllist&#x27; =&gt; [q[https://mirrors.tuna.tsinghua.edu.cn/CPAN/], q[http://www.cpan.org/]],</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯è¦æ³¨æ„ä¸€ä¸‹ï¼Œåœ¨æˆ‘è¿™è¾¹çš„ç½‘ç»œç¯å¢ƒä¸­ï¼Œæ¸…åæºåœ¨perlå®‰è£…åŒ…çš„æ—¶å€™ä¹Ÿå®¹æ˜“æŠ½é£ï¼Œæˆ‘è¯•å‡ºæ¥æ¯”è¾ƒç¨³å®šçš„ipå¦‚ä¸‹ï¼Œå°†å…¶å†™å…¥<code>/etc/hosts</code>æ–‡ä»¶ä¸­ï¼Œè¿™æ ·å®‰è£…perlåŒ…çš„æ—¶å€™å°±ä¸ä¼štimeoutäº†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">101.6.15.130 mirrors.tuna.tsinghua.edu.cn</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªipåç»­å¯èƒ½ä¼šæœ‰å˜åŒ–å•Šï¼Œè¯·ä»¥ä½ çš„å®é™…æƒ…å†µä¸ºå‡†ï¼</p><h2 id="perlå®‰è£…module"><a href="#perlå®‰è£…module" class="headerlink" title="perlå®‰è£…module"></a>perlå®‰è£…module</h2><p>åç»­å®‰è£…åŒ…çš„æ—¶å€™ï¼Œå°±å¯ä»¥ç”¨ä¸Šé•œåƒæºäº†ï¼Œå®‰è£…åŒ…çš„è¯­å¥å¦‚ä¸‹ï¼Œè¯·æ³¨æ„è¿™ä¸ªå®‰è£…è¯­å¥æœ€åè¿˜æœ‰ä¸ªè‹±æ–‡çš„å•å¼•å·ï¼Œä¸€å®šä¸è¦æŠŠä»–åˆ äº†ï¼</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo perl -MCPAN -e <span class="string">&#x27;install &quot;åŒ…å&quot;&#x27;</span></span><br></pre></td></tr></table></figure><p>æˆ‘éœ€è¦ç”¨perlæ˜¯å› ä¸ºè¦ç”¨åˆ°lcovï¼Œåœ¨lcovä»“åº“çš„readmeé‡Œé¢æåˆ°äº†lcovéœ€è¦çš„perlåŒ…ï¼Œä¸€ä¸ªä¸€ä¸ªå®‰è£…å°±è¡Œäº†ï¼ˆä»¥ä¸‹èŠ‚é€‰è‡ª<code>lcov2.0</code>çš„ä»“åº“READMEï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">These perl packages include:</span><br><span class="line"></span><br><span class="line">  - Capture::Tiny</span><br><span class="line">  - DateTime</span><br><span class="line">  - Devel::Cover</span><br><span class="line">  - Digest::MD5</span><br><span class="line">  - File::Spec</span><br><span class="line">  - at least one flavor of JSON module.</span><br><span class="line">    In order of performance/preference:</span><br><span class="line">       - JSON::XS</span><br><span class="line">       - Cpanel::JSON::XS</span><br><span class="line">       - JSON::PP</span><br><span class="line">       - JSON</span><br><span class="line"> - Memory::Process</span><br><span class="line"> - Module::Load::Conditional</span><br><span class="line"> - Scalar::Util</span><br><span class="line"> - Time::HiRes</span><br><span class="line"></span><br><span class="line">If your system is missing any of these, then you may be able to install them</span><br><span class="line">via:</span><br><span class="line"></span><br><span class="line">   $ perl -MCPAN -e &#x27;install &quot;packageName&quot;&#x27;</span><br></pre></td></tr></table></figure><p>æ¯”å¦‚æˆ‘éœ€è¦å®‰è£…<code>Capture::Tiny</code>åŒ…ï¼Œå°±ç”¨å¦‚ä¸‹å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo perl -MCPAN -e <span class="string">&#x27;install &quot;Capture::Tiny&quot;&#x27;</span></span><br></pre></td></tr></table></figure><p>æ­£å¸¸å®‰è£…çš„å‘½ä»¤è¾“å‡ºç»“æœå¦‚ä¸‹å›¾æ‰€ç¤º</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/11/566a4438035e393943d353c48b016149.png" alt="image-20231126201023622"></p><h2 id="ubuntuå®‰è£…perl-module"><a href="#ubuntuå®‰è£…perl-module" class="headerlink" title="ubuntuå®‰è£…perl module"></a>ubuntuå®‰è£…perl module</h2><p>å¦‚æœæ˜¯ubuntuï¼Œå®‰è£…perlçš„åŒ…ä¼šæ–¹ä¾¿ä¸€ç‚¹ï¼Œå› ä¸ºaptæºé‡Œé¢æ˜¯æœ‰perlçš„module</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ubuntu 22.04 å¯ä»¥ç›´æ¥å®‰è£…ä¸‹é¢çš„ä¾èµ–é¡¹ï¼Œå°±å¯ä»¥ä½¿ç”¨lcov 2.0äº†</span></span><br><span class="line">sudo apt install -y perl libcapture-tiny-perl libdatetime-perl</span><br></pre></td></tr></table></figure><p>ä½ å¯ä»¥æ ¹æ®perlçš„åŒ…åä¸­çš„<strong>å…³é”®å­—</strong>ï¼Œå°è¯•åœ¨<code>apt list</code>é‡Œé¢æ‰¾æ‰¾æœ‰æ²¡æœ‰å¯¹åº”çš„åŒ…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt list | grep åŒ…å</span><br></pre></td></tr></table></figure><h1 id="ä½¿ç”¨lcov"><a href="#ä½¿ç”¨lcov" class="headerlink" title="ä½¿ç”¨lcov"></a>ä½¿ç”¨lcov</h1><p>å¯¹äºlcov2.0çš„å‘½ä»¤ä½¿ç”¨ï¼Œå¯ä»¥å‚è€ƒæˆ‘çš„linuxä»“åº“ä¸­çš„æµ‹è¯•</p><p><a href="https://gitee.com/musnows/raspberry-practice/tree/master/lcov_test">https://gitee.com/musnows/raspberry-practice/tree/master/lcov_test</a></p>]]></content>
    
    
    <summary type="html">lcov2.0å®‰è£…å’Œperlä¿®æ”¹é•œåƒæº</summary>
    
    
    
    <category term="ç©ä¸ŠLinux" scheme="https://blog.musnow.top/categories/%E7%8E%A9%E4%B8%8ALinux/"/>
    
    
    <category term="Linux" scheme="https://blog.musnow.top/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>ã€C++ã€‘ç©ºå¯¹è±¡æŒ‡é’ˆä¹Ÿèƒ½è®¿é—®æˆå‘˜å‡½æ•°ï¼Ÿ</title>
    <link href="https://blog.musnow.top/posts/3858168549/"/>
    <id>https://blog.musnow.top/posts/3858168549/</id>
    <published>2023-11-16T08:40:46.000Z</published>
    <updated>2023-11-16T08:40:46.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1-èµ·å› "><a href="#1-èµ·å› " class="headerlink" title="1.èµ·å› "></a>1.èµ·å› </h1><p>ä»Šå¤©å†™ä»£ç çš„æ—¶å€™é‡åˆ°ä¸€ä¸ªbugï¼Œä¸€ä¸ªç±»ä¸­çš„setå‡½æ•°åœ¨è®¾ç½®ä¸€ä¸ªPODç±»å‹çš„æ—¶å€™å‡ºç°äº†å¼‚å¸¸ï¼Œç›´æ¥æ®µé”™è¯¯é€€å‡ºäº†ã€‚</p><blockquote><p>å°tipsï¼ŒPODç±»å‹æŒ‡çš„æ˜¯å†…ç½®ç±»å‹ã€‚</p></blockquote><p>æƒ³äº†å¥½ä¹…ï¼Œéƒ½æ²¡å‘ç°è¿™é‡Œçš„é—®é¢˜åˆ°åº•æ˜¯å› ä¸ºä»€ä¹ˆã€‚åæ¥æ‰çŸ¥é“ï¼ŒåŸæ¥ç©ºçš„å¯¹è±¡æŒ‡é’ˆï¼Œä¹Ÿèƒ½è¢«è§£å¼•ç”¨è®¿é—®åˆ°å‡½æ•°ï¼</p><h1 id="2-ç¤ºä¾‹"><a href="#2-ç¤ºä¾‹" class="headerlink" title="2.ç¤ºä¾‹"></a>2.ç¤ºä¾‹</h1><p>ä¸‹é¢æ˜¯å…³äºè¿™ä¸ªæƒ…å†µçš„ç¤ºä¾‹ä»£ç </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">mytest</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">mytest</span>() = <span class="keyword">default</span>;</span><br><span class="line">    <span class="built_in">mytest</span>(<span class="type">int</span> a):_a(<span class="number">0</span>)&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">set_int</span><span class="params">(<span class="type">int</span> a)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;set int to &quot;</span> &lt;&lt; a &lt;&lt; endl;</span><br><span class="line">        _a = a;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">print</span><span class="params">(<span class="type">int</span> a)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;just a print&quot;</span> &lt;&lt; a &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">int</span> _a = <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    mytest* ptr = <span class="literal">nullptr</span>;</span><br><span class="line">    ptr-&gt;<span class="built_in">print</span>(<span class="number">20</span>);</span><br><span class="line">    ptr-&gt;<span class="built_in">set_int</span>(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œè¿™ä¸ªç¨‹åºï¼Œä¼šå‡ºç°æ®µé”™è¯¯ã€‚ä½†ä½ ä¼šå‘ç°è¿™ä¸ªæ®µé”™è¯¯å¹¶ä¸æ˜¯å› ä¸ºæˆ‘ä»¬çš„<code>ptr-&gt;</code> é‡Œé¢å‡ºç°çš„ï¼Œè€Œæ˜¯æˆåŠŸè¿›å…¥äº†set_intå‡½æ•°ï¼Œæ‰§è¡Œäº†æ‰“å°ï¼Œæœ€ç»ˆå¯¹æˆå‘˜å˜é‡<code>_a</code>èµ‹å€¼çš„æ—¶å€™å‡ºç°çš„ï¼</p><p>å¯¹è±¡æŒ‡é’ˆä¸ºç©ºï¼Œä»£è¡¨å‹æ ¹ä¸å­˜åœ¨ä¸€ä¸ªå®é™…çš„å¯¹è±¡ï¼Œä¹Ÿæ²¡åŠæ³•å¯¹ä¸å­˜åœ¨çš„æˆå‘˜å˜é‡æ“ä½œã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; ./test</span><br><span class="line">just a print20</span><br><span class="line">set int to 10</span><br><span class="line">[1]    280362 segmentation fault  ./test</span><br></pre></td></tr></table></figure><p>å½“ä»£ç å¾ˆå¤šçš„æ—¶å€™ï¼Œå°±ä¼šå› ä¸ºå¿½ç•¥è¿™ä¸ªç‰¹æ€§ï¼ˆå…¶å®æˆ‘å½“æ—¶æ˜¯å‹æ ¹ä¸çŸ¥é“ï¼‰è€Œè¯¯ä»¥ä¸ºé”™è¯¯å‡ºç°åœ¨set_intå‡½æ•°ä¸­ã€‚</p><p>æ²¡æœ‰æƒ³åˆ°æ˜¯å¤–å±‚çš„å¯¹è±¡æŒ‡é’ˆä¸ºç©ºå¯¼è‡´çš„ã€‚</p><h1 id="3-ä¸ºä»€ä¹ˆï¼Ÿ"><a href="#3-ä¸ºä»€ä¹ˆï¼Ÿ" class="headerlink" title="3.ä¸ºä»€ä¹ˆï¼Ÿ"></a>3.ä¸ºä»€ä¹ˆï¼Ÿ</h1><p>åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­ï¼Œå¯¹è±¡å°±å·²ç»ç»‘å®šäº†å‡½æ•°åœ°å€ã€‚ä¸€ä¸ªç±»çš„æ‰€æœ‰å¯¹è±¡ï¼Œä½¿ç”¨çš„å‡½æ•°åœ°å€éƒ½æ˜¯ä¸€æ ·çš„ã€‚å½“ç¼–è¯‘<code>ptr-&gt;set_int(10)</code> çš„æ—¶å€™ï¼Œå‡½æ•°çš„åœ°å€å°±å·²ç»å’Œè¿™ä¸ªæŒ‡é’ˆç»‘å®šäº†ï¼Œè°ƒç”¨å®ƒç­‰ä»·äºç›´æ¥è°ƒç”¨ set_int å‡½æ•°ã€‚</p><p>å¦‚æœè¿™ä¸ªå‡½æ•°ä¸­æ²¡æœ‰éœ€è¦ç”¨åˆ°æˆå‘˜å˜é‡çš„åœ°æ–¹ï¼Œä¹Ÿå°±ä¸éœ€è¦è§£å¼•ç”¨thisæŒ‡é’ˆï¼Œæ˜¯ä¸ä¼šå‡ºé”™çš„ã€‚æ¯”å¦‚ä¸Šæ–¹ä»£ç ä¸­çš„printå‡½æ•°ï¼Œå°±æ²¡æœ‰å‡ºç°å¼‚å¸¸ã€‚</p><p>ä½†å¦‚æœå‡½æ•°å†…è®¿é—®äº†å†…ç½®æˆå‘˜ï¼Œé‚£ä¹ˆå°±ä¼šå‡ºç°è§£å¼•ç”¨ç©ºæŒ‡é’ˆå¯¼è‡´çš„æ®µé”™è¯¯ï¼</p>]]></content>
    
    
    <summary type="html">çœŸæ²¡æƒ³åˆ°ï¼Œç©ºå¯¹è±¡æŒ‡é’ˆä¹Ÿèƒ½è®¿é—®æˆå‘˜å‡½æ•°å•Šï¼Ÿ</summary>
    
    
    
    <category term="é‡è§C++" scheme="https://blog.musnow.top/categories/%E9%81%87%E8%A7%81C/"/>
    
    
    <category term="æ•°æ®ç»“æ„" scheme="https://blog.musnow.top/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
    <category term="C++" scheme="https://blog.musnow.top/tags/C/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢ç»ã€‘C++é¢ç­‹è®°å½• (ä¸€) 231021</title>
    <link href="https://blog.musnow.top/posts/721187015/"/>
    <id>https://blog.musnow.top/posts/721187015/</id>
    <published>2023-10-21T10:50:14.000Z</published>
    <updated>2023-10-21T10:50:14.000Z</updated>
    
    <content type="html"><![CDATA[<p>è®°å½•éƒ¨åˆ†ä»ç‰›å®¢ç½‘ä¸Šçœ‹åˆ°çš„é¢ç­‹</p><span id="more"></span><h1 id="1-å£°æ˜ä¸€ä¸ªvectorï¼Œå½“vectorè¿‡å¤§æ—¶ä¼šæ ˆæº¢å‡ºå—ï¼Ÿ"><a href="#1-å£°æ˜ä¸€ä¸ªvectorï¼Œå½“vectorè¿‡å¤§æ—¶ä¼šæ ˆæº¢å‡ºå—ï¼Ÿ" class="headerlink" title="1.å£°æ˜ä¸€ä¸ªvectorï¼Œå½“vectorè¿‡å¤§æ—¶ä¼šæ ˆæº¢å‡ºå—ï¼Ÿ"></a>1.å£°æ˜ä¸€ä¸ªvectorï¼Œå½“vectorè¿‡å¤§æ—¶ä¼šæ ˆæº¢å‡ºå—ï¼Ÿ</h1><p>ç­”æ¡ˆæ˜¯ä¼šã€‚</p><p>é»˜è®¤ç”³è¯·çš„vectoræ˜¯æ”¾åœ¨æ ˆåŒºçš„ï¼Œæ ˆåŒºçš„å¤§å°&lt;&lt;å †åŒºçš„å¤§å°ã€‚æ‰€ä»¥å¦‚æœæˆ‘ä»¬åœ¨æ ˆåŒºä¸­å¼€è¾Ÿçš„vectorä¸­æ’å…¥å·¨é‡çš„æ•°æ®ï¼Œæ˜¯ä¼šå¯¼è‡´æ ˆæº¢å‡ºçš„ã€‚</p><p>è§£å†³åŠæ³•æ˜¯å°†æ•°æ®å­˜æ”¾åˆ°å †åŒºä¸Šï¼ˆä½¿ç”¨newæ¥åˆ›å»ºvectorï¼Œè€Œä¸æ˜¯ç›´æ¥åˆ›å»ºï¼‰</p><h1 id="2-å¦‚ä½•å®ç°å¤šæ¬¡è¿è¡Œç¨‹åºä½†åªæœ‰ä¸€ä¸ªåå°è¿›ç¨‹ï¼Ÿ"><a href="#2-å¦‚ä½•å®ç°å¤šæ¬¡è¿è¡Œç¨‹åºä½†åªæœ‰ä¸€ä¸ªåå°è¿›ç¨‹ï¼Ÿ" class="headerlink" title="2.å¦‚ä½•å®ç°å¤šæ¬¡è¿è¡Œç¨‹åºä½†åªæœ‰ä¸€ä¸ªåå°è¿›ç¨‹ï¼Ÿ"></a>2.å¦‚ä½•å®ç°å¤šæ¬¡è¿è¡Œç¨‹åºä½†åªæœ‰ä¸€ä¸ªåå°è¿›ç¨‹ï¼Ÿ</h1><p>ä½¿ç”¨å‘½åäº’æ–¥é”ï¼Œç¨‹åºå¯åŠ¨å‰ç”³è¯·é”ã€‚</p><ul><li>å¦‚æœé”æ²¡æœ‰è¢«ç”³è¯·ï¼Œä»£è¡¨æ˜¯ç¬¬ä¸€ä¸ªè¿›ç¨‹ï¼Œå¯ä»¥æ­£å¸¸è¿è¡Œ</li><li>å¦‚æœé”å·²ç»è¢«å ç”¨ï¼Œä»£è¡¨å·²ç»æœ‰è¿›ç¨‹äº†ï¼Œç›´æ¥é€€å‡ºå½“å‰è¿›ç¨‹ï¼ˆè¿™é‡Œè¦ä½¿ç”¨try_locké¿å…é˜»å¡ç­‰å¾…ï¼‰</li></ul><p>åœ¨Linuxä¸‹å¯ä»¥ç”¨å‘½åä¿¡å·é‡æ¥å®ç°ç±»ä¼¼è¿›ç¨‹å…±äº«é”çš„æ“ä½œã€‚è¿™éƒ¨åˆ†å¯ä»¥å»å­¦ä¹ è¿›ç¨‹é€šä¿¡ä¸­ä¿¡å·é‡çš„éƒ¨åˆ†ã€‚</p><p>å’¨è¯¢äº†å‘è¿™ç¯‡é¢ç­‹çš„å¤§ä½¬ï¼Œè¯´æ˜¯ç”¨æ–‡ä»¶ä¿å­˜ä¹‹å‰è¿›ç¨‹çš„PIDï¼Œè¯»å–å‡ºæ¥å°†ä¹‹å‰çš„è¿›ç¨‹killæ‰ã€‚</p><h1 id="3-äºŒåˆ†æ³•çš„å‰ææ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#3-äºŒåˆ†æ³•çš„å‰ææ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="3.äºŒåˆ†æ³•çš„å‰ææ˜¯ä»€ä¹ˆï¼Ÿ"></a>3.äºŒåˆ†æ³•çš„å‰ææ˜¯ä»€ä¹ˆï¼Ÿ</h1><ul><li>æ•°æ®æœ‰åº</li><li>æ•°æ®ç»“æ„æ”¯æŒéšæœºè®¿é—®</li></ul><h1 id="4-äº’æ–¥é”å’Œè‡ªæ—‹é”æœ‰ä»€ä¹ˆåŒºåˆ«"><a href="#4-äº’æ–¥é”å’Œè‡ªæ—‹é”æœ‰ä»€ä¹ˆåŒºåˆ«" class="headerlink" title="4.äº’æ–¥é”å’Œè‡ªæ—‹é”æœ‰ä»€ä¹ˆåŒºåˆ«"></a>4.äº’æ–¥é”å’Œè‡ªæ—‹é”æœ‰ä»€ä¹ˆåŒºåˆ«</h1><ul><li>äº’æ–¥é”æ˜¯åœ¨å†…æ ¸æ€è¿›è¡Œé˜»å¡ç­‰å¾…</li><li>è‡ªæ—‹é”æ˜¯åœ¨ç”¨æˆ·æ€ä¸æ–­å¾ªç¯æ²¦é™·æ£€æµ‹é”çš„çŠ¶æ€</li></ul><p>å¦‚æœä½¿ç”¨åœºæ™¯æ˜¯è¾ƒé•¿è¿è¡Œçš„å…±äº«èµ„æºï¼Œé‚£ä¹ˆå°±ä½¿ç”¨äº’æ–¥é”ã€‚é¿å…è‡ªæ—‹é”ä¸æ–­æ²¦é™·æ£€æµ‹æ¶ˆè€—å¤§é‡CPUèµ„æºã€‚</p><p>å¦‚æœä½¿ç”¨åœºæ™¯çš„å…±äº«èµ„æºè®¿é—®é€Ÿåº¦å¿«ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨è‡ªæ—‹é”ã€‚é¿å…äº’æ–¥é”é¢‘ç¹è¿›è¡Œç”¨æˆ·ã€å†…æ ¸æ€çš„è½¬æ¢è€Œé€ æˆæ¶ˆè€—ï¼ˆè¿™é‡ŒæŒ‡å…¶ä»–éœ€è¦è·å–é”çš„è¿›ç¨‹å¾—è¿›å…¥å†…æ ¸æ€é˜»å¡ç­‰å¾…ï¼‰</p><h1 id="5-TCPä¸‰æ¬¡æ¡æ‰‹é™¤äº†åºåˆ—å·è¿˜å‘äº†ä»€ä¹ˆå…¶ä»–ä¸œè¥¿ï¼Ÿ"><a href="#5-TCPä¸‰æ¬¡æ¡æ‰‹é™¤äº†åºåˆ—å·è¿˜å‘äº†ä»€ä¹ˆå…¶ä»–ä¸œè¥¿ï¼Ÿ" class="headerlink" title="5.TCPä¸‰æ¬¡æ¡æ‰‹é™¤äº†åºåˆ—å·è¿˜å‘äº†ä»€ä¹ˆå…¶ä»–ä¸œè¥¿ï¼Ÿ"></a>5.TCPä¸‰æ¬¡æ¡æ‰‹é™¤äº†åºåˆ—å·è¿˜å‘äº†ä»€ä¹ˆå…¶ä»–ä¸œè¥¿ï¼Ÿ</h1><ul><li>SYNå’ŒACKè¿™äº›è¡¨è®°ä½ï¼ˆå…·ä½“å¤ä¹ ä¸‰æ¬¡æ¡æ‰‹æ¯ä¸ªé˜¶æ®µçš„å‘é€ï¼‰</li><li>åŒæ–¹æœåŠ¡è¿›ç¨‹çš„ç«¯å£å·</li><li>èµ·å§‹åºåˆ—å·å’Œå¯¹å¯¹æ–¹å‘é€çš„SYNæŠ¥æ–‡çš„åº”ç­”åºåˆ—å·</li><li>TCPæ ¡éªŒå’Œ</li><li>TCPçª—å£å¤§å°</li></ul><p>åç»­å»ºç«‹è¿æ¥åï¼Œå°±ä¼šæ ¹æ®åŒæ–¹çš„çª—å£å¤§å°å’Œæ•°æ®çš„åºåˆ—å·å¼€å§‹ç›¸äº’é€šä¿¡ã€‚</p><h1 id="6-å­ç±»é‡å†™çˆ¶ç±»å‡½æ•°ï¼Œå­ç±»ä¸­è¯¥å‡½æ•°å£°æ˜ä¸ºprivateï¼Œèƒ½å¦é‡å†™æˆåŠŸï¼Ÿ"><a href="#6-å­ç±»é‡å†™çˆ¶ç±»å‡½æ•°ï¼Œå­ç±»ä¸­è¯¥å‡½æ•°å£°æ˜ä¸ºprivateï¼Œèƒ½å¦é‡å†™æˆåŠŸï¼Ÿ" class="headerlink" title="6.å­ç±»é‡å†™çˆ¶ç±»å‡½æ•°ï¼Œå­ç±»ä¸­è¯¥å‡½æ•°å£°æ˜ä¸ºprivateï¼Œèƒ½å¦é‡å†™æˆåŠŸï¼Ÿ"></a>6.å­ç±»é‡å†™çˆ¶ç±»å‡½æ•°ï¼Œå­ç±»ä¸­è¯¥å‡½æ•°å£°æ˜ä¸ºprivateï¼Œèƒ½å¦é‡å†™æˆåŠŸï¼Ÿ</h1><p>ç”¨ä¸‹é¢è¿™ä¸ªæ¯›å¯æˆ¿æ¥è¿›è¡Œæµ‹è¯•ï¼Œåœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å­ç±»çš„é‡å†™å‡½æ•°éƒ½å’Œçˆ¶ç±»æœ‰ç›¸åŒçš„ä½œç”¨åŸŸå£°æ˜ç¬¦ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">foo1</span>();</span><br><span class="line"><span class="built_in">foo2</span>();</span><br><span class="line"><span class="built_in">foo3</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">foo1</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;A::foo1&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">foo2</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;A::foo2&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">foo3</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;A::foo3&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span> : <span class="keyword">public</span> A</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">foo1</span>();</span><br><span class="line"><span class="built_in">foo2</span>();</span><br><span class="line"><span class="built_in">foo3</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">foo1</span><span class="params">()</span> <span class="keyword">override</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;B::foo1&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">foo2</span><span class="params">()</span> <span class="keyword">override</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;B::foo2&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">foo3</span><span class="params">()</span> <span class="keyword">override</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;B::foo3&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">B b;</span><br><span class="line">b.<span class="built_in">test</span>();</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;----&quot;</span> &lt;&lt; endl;</span><br><span class="line">A *bb = &amp;b;</span><br><span class="line">bb-&gt;<span class="built_in">test</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç›´æ¥è¿è¡Œï¼Œç»“æœä¹Ÿç¬¦åˆé¢„æœŸï¼Œç›®å‰è°ƒç”¨çš„æ˜¯å­ç±»é‡å†™åçš„è™šå‡½æ•°ï¼Œæ‰€æœ‰å‡½æ•°éƒ½é‡å†™æˆåŠŸã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">B::foo1</span><br><span class="line">B::foo2</span><br><span class="line">B::foo3</span><br><span class="line">----</span><br><span class="line">B::foo1</span><br><span class="line">B::foo2</span><br><span class="line">B::foo3</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">B</span> : <span class="keyword">public</span> A</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">foo1</span>();</span><br><span class="line"><span class="built_in">foo2</span>();</span><br><span class="line"><span class="built_in">foo3</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">foo2</span><span class="params">()</span> <span class="keyword">override</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;B::foo2&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">foo3</span><span class="params">()</span> <span class="keyword">override</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;B::foo3&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">foo1</span><span class="params">()</span> <span class="keyword">override</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;B::foo1&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// ç¼–è¯‘èƒ½é€šè¿‡ï¼Œè¿è¡Œè¾“å‡ºå’Œä¸Šæ–¹æ²¡åŒºåˆ«</span></span><br></pre></td></tr></table></figure><p>æˆ‘å°è¯•äº†å„ç§ä¿®æ”¹ä½œç”¨åŸŸçš„æ–¹å¼ï¼ŒåŒ…æ‹¬å°†å­ç±»ä¸­foo3å‡½æ•°æ”¹æˆå…¬æœ‰ï¼Œfoo1å‡½æ•°æ”¹æˆç§æœ‰ï¼Œéƒ½èƒ½æ­£å¸¸å®Œæˆé‡å†™ã€‚è¿™é‡Œçš„ä½œç”¨åŸŸå£°æ˜ç¬¦åªæ˜¯ä¼šæ”¹å˜<strong>å­ç±»å¤–æ˜¯å¦èƒ½è°ƒç”¨è¿™ä¸ªå‡½æ•°</strong>ï¼Œå’Œèƒ½å¦å®Œæˆè™šå‡½æ•°é‡å†™æ— å…³ï¼</p><p>è¯·æ³¨æ„ï¼Œå¦‚æœä½ å°†<strong>ç»§æ‰¿æ–¹å¼ç”±publicæ”¹æˆprivate</strong>ï¼Œé‚£ä¹ˆå°±æ— æ³•åœ¨ç±»å¤–ä½¿ç”¨çˆ¶ç±»æŒ‡é’ˆæŒ‡å‘å­ç±»å¯¹è±¡äº†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">â•°â”€ g++ test2.cpp -o test</span><br><span class="line">test2.cpp: In function â€˜int main()â€™:</span><br><span class="line">test2.cpp:316:11: error: â€˜Aâ€™ is an inaccessible base of â€˜Bâ€™</span><br><span class="line">  A *bb = &amp;b;</span><br></pre></td></tr></table></figure><p>ä½†è¿™ä¾æ—§ä¸å½±å“å­ç±»å‡½æ•°é‡å†™çˆ¶ç±»å‡½æ•°ï¼ˆæˆ‘çš„ä¾æ®æ˜¯overrideå…³é”®å­—æ²¡æœ‰æŠ¥é”™ï¼‰</p><h1 id="7-pthread-createèƒ½ä¼ å…¥ç±»æˆå‘˜å‡½æ•°çš„æŒ‡é’ˆå—"><a href="#7-pthread-createèƒ½ä¼ å…¥ç±»æˆå‘˜å‡½æ•°çš„æŒ‡é’ˆå—" class="headerlink" title="7.pthread_createèƒ½ä¼ å…¥ç±»æˆå‘˜å‡½æ•°çš„æŒ‡é’ˆå—"></a>7.pthread_createèƒ½ä¼ å…¥ç±»æˆå‘˜å‡½æ•°çš„æŒ‡é’ˆå—</h1><p>å¯ä»¥ï¼Œä½†æ˜¯å¿…é¡»æ˜¯é™æ€æˆå‘˜å‡½æ•°ã€‚</p><p>å¦‚æœæ˜¯æ™®é€šæˆå‘˜å‡½æ•°ï¼Œé‚£å°±éœ€è¦ç”¨ä¸­é—´å‡½æ•°æ¥å¤„ç†ï¼Œæ¯”å¦‚ä¸‹é¢çš„ç¤ºä¾‹ä»£ç ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;functional&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span>* <span class="title">threadFunc</span><span class="params">(<span class="type">void</span>* arg)</span> </span>&#123;</span><br><span class="line">    std::function&lt;<span class="type">void</span>()&gt; func = *<span class="keyword">reinterpret_cast</span>&lt;std::function&lt;<span class="built_in">void</span>()&gt;*&gt;(arg);</span><br><span class="line">    <span class="built_in">func</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    std::function&lt;<span class="type">void</span>()&gt; myFunc = []() &#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;Hello from thread!&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="type">pthread_t</span> thread;</span><br><span class="line">    <span class="built_in">pthread_create</span>(&amp;thread, <span class="literal">nullptr</span>, &amp;threadFunc, <span class="built_in">reinterpret_cast</span>&lt;<span class="type">void</span>*&gt;(&amp;myFunc));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç­‰å¾…çº¿ç¨‹ç»“æŸ</span></span><br><span class="line">    <span class="built_in">pthread_join</span>(thread, <span class="literal">nullptr</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥ç”¨<code>std::function</code>åŒ…è£…ä¸€ä¸ªç±»çš„æˆå‘˜å‡½æ•°ï¼Œå¹¶ç”¨<code>std::bind</code>å°†å¯¹è±¡çš„thisæŒ‡é’ˆç»‘å®šåˆ°ç¬¬ä¸€ä¸ªå‚æ•°ä¸Šã€‚å¤–å±‚å†å¥—ä¸Šä¸€ä¸ªç”¨äºæ‰§è¡Œè¯¥å‡½æ•°çš„voidå‡½æ•°ï¼Œå°±èƒ½ä¼ ç»™<code>pthread_create</code>ã€‚</p><p><code>std::function</code>çš„å¯¹è±¡ä¸èƒ½ç›´æ¥ä¼ ç»™Cè¯­è¨€çš„å‡½æ•°æŒ‡é’ˆï¼Œå³ä¾¿å‚æ•°å¯¹åº”ã€‚ä¼šæŠ¥é”™ã€‚</p><h1 id="8-å‡½æ•°å†…staticå˜é‡çš„ä½œç”¨"><a href="#8-å‡½æ•°å†…staticå˜é‡çš„ä½œç”¨" class="headerlink" title="8.å‡½æ•°å†…staticå˜é‡çš„ä½œç”¨"></a>8.å‡½æ•°å†…staticå˜é‡çš„ä½œç”¨</h1><p>åœ¨å‡½æ•°å†…å®šä¹‰ä¸€ä¸ªstaticå˜é‡ï¼Œè¯¥å˜é‡åªä¼šåœ¨è¿›å…¥è¿™ä¸ªå‡½æ•°çš„æ—¶å€™åˆå§‹åŒ–ä¸€æ¬¡ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è®¡ç®—æŸä¸€æœˆçš„1å·æ˜¯ä¸€å¹´çš„ç¬¬å‡ å¤©(ä¸è€ƒè™‘é—°å¹´)</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">DayOfYear</span><span class="params">(<span class="type">int</span> month)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> day_array = &#123;<span class="number">0</span>,<span class="number">31</span>,<span class="number">59</span>,<span class="number">90</span>,<span class="number">120</span>,<span class="number">151</span>,<span class="number">181</span>,<span class="number">212</span>,<span class="number">243</span>,<span class="number">273</span>,<span class="number">304</span>,<span class="number">334</span>&#125;;</span><br><span class="line">    <span class="keyword">return</span> day_array[month];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¯”å¦‚ä¸Šé¢çš„å‡½æ•°ï¼Œæˆ‘ä»¬å®šä¹‰çš„dayæ•°ç»„å°±åªä¼šåœ¨ç¬¬ä¸€æ¬¡è¿›å…¥è¿™ä¸ªå‡½æ•°çš„æ—¶å€™åˆå§‹åŒ–ã€‚ä¹‹åè¿›å…¥è¿™ä¸ªå‡½æ•°å°†ä¸åœ¨åˆå§‹åŒ–ï¼Œå°±èŠ‚çœäº†åˆå§‹åŒ–ä¸€ä¸ªæ•°ç»„çš„æ¶ˆè€—ã€‚å‡ºäº†è¿™ä¸ªå‡½æ•°åï¼Œè¯¥æ•°ç»„å˜é‡ä¾æ—§å­˜åœ¨ã€‚</p><p>è¯·æ³¨æ„ï¼Œè¿™ä¸ªstaticè¯­å¥å¹¶ä¸åªæ˜¯å˜é‡åªåˆå§‹åŒ–ä¸€æ¬¡ï¼Œå®é™…ä¸Šè¿™ä¸€è¡Œè¯­å¥åœ¨è¯¥å‡½æ•°ä¸­éƒ½åªä¼šè¿›è¡Œä¸€æ¬¡</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">bool</span> <span class="title function_">checkFlag</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">static</span> <span class="type">bool</span> flag = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span>(!flag)&#123;</span><br><span class="line">        <span class="comment">// ..è¿›è¡Œå¯¹åº”ä¿®æ”¹</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¯”å¦‚ä¸Šé¢çš„ä»£ç ä¸­ï¼Œå¦‚æœç”¨æ­£å¸¸æ€ç»´æ¥ç†è§£ï¼Œä½ ä¼šè§‰å¾—è¿™ä¸ªifè¯­å¥æ¯æ¬¡éƒ½ä¼šåˆ¤æ–­ä¸ºçœŸè€Œè¿›å…¥å…¶ä¸­ã€‚ä½†å®é™…ä¸Šflagçš„å®šä¹‰åªä¼šè¢«å®šä¹‰ä¸€æ¬¡ï¼Œ<strong>åªè¦æˆ‘ä»¬åœ¨ifä¸­å°†å…¶æ”¹æˆäº†true</strong>ï¼Œé‚£ä¹ˆä¸‹ä¸€æ¬¡è¿›å…¥è¯¥å‡½æ•°çš„æ—¶å€™ï¼Œ<strong>flagä¾æ—§ä¼šæ˜¯true</strong>ï¼Œ<code>static bool flag = false;</code>è¯­å¥ä¼šè¢«ç›´æ¥è·³è¿‡ï¼Œå¹¶ä¸ä¼šå†æ¬¡æ‰§è¡Œèµ‹å€¼ï¼</p><p>æˆ‘ä¹‹å‰ç†è§£çš„å°±æ˜¯flagå˜é‡åªä¼šè¢«åˆ›å»ºä¸€æ¬¡ï¼Œä½†staticåçš„èµ‹å€¼ä¾æ—§ä¼šæ‰§è¡Œã€‚è¿™ä¸ªç†è§£æ˜¯<strong>é”™è¯¯</strong>çš„ï¼</p><h1 id="9-ç§æœ‰staticæˆå‘˜å‡½æ•°çš„æ„ä¹‰ï¼Ÿ"><a href="#9-ç§æœ‰staticæˆå‘˜å‡½æ•°çš„æ„ä¹‰ï¼Ÿ" class="headerlink" title="9.ç§æœ‰staticæˆå‘˜å‡½æ•°çš„æ„ä¹‰ï¼Ÿ"></a>9.ç§æœ‰staticæˆå‘˜å‡½æ•°çš„æ„ä¹‰ï¼Ÿ</h1><p>è¿™ä¸ªé—®é¢˜æ¯”è¾ƒæœ‰æ„æ€ï¼Œæˆ‘ä»¬çŸ¥é“staticå‡½æ•°å±äºæ•´ä¸ªç±»ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡ç±»åä½œç”¨åŸŸè°ƒç”¨ã€‚ä¸”staticå‡½æ•°ä¸­æ— æ³•è®¿é—®ä»»ä½•éstaticçš„æˆå‘˜å˜é‡ã€‚</p><p>ä½†æ˜¯ï¼Œå¦‚æœç»™ä½ ä¸ªstaticçš„ç§æœ‰æˆå‘˜å‡½æ•°ï¼Œå®ƒåˆæœ‰ä»€ä¹ˆæ„ä¹‰å‘¢ï¼Ÿ</p><ul><li>ç§æœ‰staticæˆå‘˜æ˜¯æ— æ³•é€šè¿‡ç±»åè°ƒç”¨çš„</li><li>ä»–ä¹Ÿæ²¡æœ‰åŠæ³•è®¿é—®ç±»ä¸­éstaticæˆå‘˜å˜é‡</li></ul><p>å¯ä»¥è¿™ä¹ˆç†è§£ï¼šæˆ‘æœ‰ä¸€ä¸ªæ–¹æ³•åªåœ¨è¿™ä¸ªç±»é‡Œé¢éœ€è¦ï¼Œè¿™ä¸ªæ–¹æ³•ä¸éœ€è¦ä½¿ç”¨æˆå‘˜å˜é‡ï¼Œå¯ä»¥é€šè¿‡ä¼ å‚å®ç°ï¼ˆæ¯”å¦‚è®¡ç®—ä»€ä¹ˆçš„ï¼‰</p><p>ä½†æ˜¯ï¼Œæˆ‘åˆä¸æƒ³å®ƒçš„å‘½åæ±¡æŸ“çˆ¶ä½œç”¨åŸŸã€‚</p><p>é‚£ä¹ˆï¼Œæˆ‘å°±å¯ä»¥æŠŠå®ƒå†™ä¸ºç±»çš„ç§æœ‰æˆå‘˜å‡½æ•°ï¼Œå¹¶åŠ ä¸Šstaticå‘Šè¯‰å…¶ä»–äººï¼Œè¿™ä¸ªå‡½æ•°æ˜¯ä¸€ä¸ªå•çº¯çš„æ–¹æ³•ç±»ï¼Œä¸éœ€è¦ä½¿ç”¨ç±»çš„æˆå‘˜å˜é‡ã€‚</p><p>å½“ç„¶ï¼ŒåŠ ä¸Šstaticåªæ˜¯ä¸€ä¸ªç¼–ç¨‹ä¹ æƒ¯ç½¢äº†ï¼Œå®é™…ä¸Šè¿™ç§æƒ…å†µä¸å†™staticä¹Ÿæ— æ‰€è°“ã€‚</p>]]></content>
    
    
    <summary type="html">C++é¢ç­‹è®°å½• (ä¸€) 231021</summary>
    
    
    
    <category term="æ±‚èŒè·¯ä¸Šä¸€å»ä¸å¤è¿”" scheme="https://blog.musnow.top/categories/%E6%B1%82%E8%81%8C%E8%B7%AF%E4%B8%8A%E4%B8%80%E5%8E%BB%E4%B8%8D%E5%A4%8D%E8%BF%94/"/>
    
    
    <category term="é¢ç»" scheme="https://blog.musnow.top/tags/%E9%9D%A2%E7%BB%8F/"/>
    
  </entry>
  
  <entry>
    <title>ã€Linuxã€‘wslå®‰è£…çš„ubuntuä¸æ”¯æŒPOSIXæ¶ˆæ¯é˜Ÿåˆ— | å·²è§£å†³</title>
    <link href="https://blog.musnow.top/posts/4006913293/"/>
    <id>https://blog.musnow.top/posts/4006913293/</id>
    <published>2023-10-17T04:30:55.000Z</published>
    <updated>2023-10-17T04:30:55.000Z</updated>
    
    <content type="html"><![CDATA[<p>wslå®‰è£…çš„ubuntuä¸æ”¯æŒPOSIXæ¶ˆæ¯é˜Ÿåˆ—çš„è§£å†³åŠæ³•</p><span id="more"></span><h1 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h1><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/10/f317c38d511b44a48ff5dc5df48b1c80.png"></p><p>å¦‚é¢˜ï¼Œæˆ‘çš„win10ä¸Šå®‰è£…äº†wslçš„ubuntuåï¼ˆå¾®è½¯å•†åº—ä¸‹è½½çš„wslçš„Ubuntuï¼‰è¿™ä¸ªç³»ç»Ÿå†…éƒ¨ä¸æ”¯æŒPOSIXçš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œè™½ç„¶æœ‰<code>&lt;mqueue.h&gt;</code>å¤´æ–‡ä»¶ï¼Œä½†æ˜¯æ²¡æœ‰å®ç°ï¼Œä¼šæŠ¥é”™ã€‚</p><p>å¦‚æœæƒ³æ‰¾ä¸ªç®€å•çš„åŠæ³•å‘¢ï¼Œé‚£å°±æ˜¯ç”¨systemVçš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå¯è¿™æ˜¯ä¸ª<strong>è™šæ‹Ÿæœºæœ¬åœ°ç¯å¢ƒé—®é¢˜</strong>ï¼Œæˆ‘ç”¨virtualboxå®‰è£…çš„è™šæ‹Ÿæœºå°±èƒ½æ­£å¸¸ä½¿ç”¨ã€‚æ‰€ä»¥è‚¯å®šå¾—è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ¢æˆsystemVçš„æ¶ˆæ¯é˜Ÿåˆ—å°±æœ‰ç‚¹ã€Œæ©è€³ç›—é“ƒã€çš„æ„å‘³äº†ã€‚</p><h1 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h1><p>ä¸‹é¢æ˜¯ä¸€ä¸ªPOSIXæ¶ˆæ¯é˜Ÿåˆ—çš„demo</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;errno.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;mqueue.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">mqd_t</span> mqID;</span><br><span class="line">    mqID = <span class="built_in">mq_open</span>(<span class="string">&quot;/testmQueue&quot;</span>, O_RDWR | O_CREAT, <span class="number">0666</span>, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (mqID &lt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;open message queue error...&quot;</span>&lt;&lt;<span class="built_in">strerror</span>(errno)&lt;&lt;endl;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    mq_attr mqAttr;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">mq_getattr</span>(mqID, &amp;mqAttr) &lt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;get the message queue attribute error&quot;</span>&lt;&lt;endl;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;mq_flags:&quot;</span>&lt;&lt;mqAttr.mq_flags&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;mq_maxmsg:&quot;</span>&lt;&lt;mqAttr.mq_maxmsg&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;mq_msgsize:&quot;</span>&lt;&lt;mqAttr.mq_msgsize&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;mq_curmsgs:&quot;</span>&lt;&lt;mqAttr.mq_curmsgs&lt;&lt;endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœç¼–è¯‘åè¿è¡Œå‡ºç°äº†ä¸‹é¢çš„æŠ¥é”™ï¼Œä»£è¡¨å½“å‰ç³»ç»Ÿä¸æ”¯æŒPOSIXæ¶ˆæ¯é˜Ÿåˆ—ã€‚å½“å‰ç³»ç»Ÿä¸‹æœ‰mqueueå¤´æ–‡ä»¶ï¼Œä½†å¹¶æ²¡æœ‰å‡½æ•°çš„å®ç°ä½“</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@DESKTOP-5SQO6N0:~# ./test</span><br><span class="line">open message queue error...No such file or directory</span><br><span class="line">open message queue error...Function not implemented</span><br></pre></td></tr></table></figure><h1 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h1><p>éœ€è¦å°†wslç‰ˆæœ¬1æ”¹æˆç‰ˆæœ¬2ï¼Œå¦åˆ™æ— å®Œæ•´Linuxå†…æ ¸æ”¯æŒï¼Œæ— æ³•ä½¿ç”¨POSIXæ¶ˆæ¯é˜Ÿåˆ—ã€‚<strong>è¿™ä¹Ÿæ˜¯WSLç‰ˆæœ¬1å’Œ2çš„é‡å¤§åŒºåˆ«ä¹‹ä¸€</strong>ã€‚</p><p>ç”¨å¦‚ä¸‹å‘½ä»¤å°†å½“å‰è™šæ‹Ÿæœºæ”¹æˆwsl2ç‰ˆæœ¬ï¼Œå°±å¯ä»¥ä½¿ç”¨äº†ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wsl -l -v # ç”¨è¿™ä¸ªå‘½ä»¤æŸ¥çœ‹å½“å‰è™šæ‹Ÿæœºçš„versionæ˜¯ä¸æ˜¯1</span><br><span class="line">wsl --update # æ›´æ–°wsl</span><br><span class="line">wsl --set-version è™šæ‹Ÿæœºå 2  # æŠŠæŒ‡å®šè™šæ‹Ÿæœºæ”¹æˆwslç‰ˆæœ¬2</span><br></pre></td></tr></table></figure><h2 id="å†æ¬¡æµ‹è¯•"><a href="#å†æ¬¡æµ‹è¯•" class="headerlink" title="å†æ¬¡æµ‹è¯•"></a>å†æ¬¡æµ‹è¯•</h2><p>æ­£å¸¸æƒ…å†µä¸‹ï¼Œä¸Šé¢çš„æ¶ˆæ¯é˜Ÿåˆ—ä»£ç åº”è¯¥è¾“å‡ºå¦‚ä¸‹å†…å®¹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@DESKTOP-5SQO6N0:~# ./test</span><br><span class="line">mq_flags:0</span><br><span class="line">mq_maxmsg:10</span><br><span class="line">mq_msgsize:8192</span><br><span class="line">mq_curmsgs:0</span><br></pre></td></tr></table></figure><h2 id="ç»‘å®šç›®å½•"><a href="#ç»‘å®šç›®å½•" class="headerlink" title="ç»‘å®šç›®å½•"></a>ç»‘å®šç›®å½•</h2><p>é™¤äº†ä¸Šé¢è¿™ä¸ªé—®é¢˜ï¼Œåœ¨ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—ä¹‹å‰è¿˜å¯ä»¥monutä¸€ä¸‹è·¯å¾„ï¼Œå‚è€ƒmanæ‰‹å†Œä¸­çš„æ•™ç¨‹ï¼ˆä¼¼ä¹ä¸æ˜¯å¿…é¡»è¦åšçš„ï¼Œmountäº†è¿™ä¸ªè·¯å¾„ä¹‹åèƒ½æ›´å¥½åœ°çœ‹åˆ°ç°æœ‰çš„æ¶ˆæ¯é˜Ÿåˆ—ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir /dev/mqueue</span><br><span class="line">mount -t mqueue none /dev/mqueue</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">wslå®‰è£…çš„ubuntuä¸æ”¯æŒPOSIXæ¶ˆæ¯é˜Ÿåˆ—çš„è§£å†³åŠæ³•</summary>
    
    
    
    <category term="ç©ä¸ŠLinux" scheme="https://blog.musnow.top/categories/%E7%8E%A9%E4%B8%8ALinux/"/>
    
    
    <category term="Linux" scheme="https://blog.musnow.top/tags/Linux/"/>
    
    <category term="è™šæ‹Ÿæœº" scheme="https://blog.musnow.top/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA/"/>
    
    <category term="wsl" scheme="https://blog.musnow.top/tags/wsl/"/>
    
  </entry>
  
  <entry>
    <title>ã€å¾®æœºã€‘DOSBoxåœ¨windowsä¸Šçš„å®‰è£…å’Œmasmçš„é…ç½®</title>
    <link href="https://blog.musnow.top/posts/2839269095/"/>
    <id>https://blog.musnow.top/posts/2839269095/</id>
    <published>2023-10-16T17:49:13.000Z</published>
    <updated>2023-10-16T17:49:13.000Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘å­¦æ ¡å­¦ä¹ å¾®å‹è®¡ç®—æœºåŸç†ä¸æ¥å£æŠ€æœ¯ï¼Œéœ€è¦ç”¨åˆ°DOSBoxæ¥æ¨¡æ‹ŸDOSç¯å¢ƒè¿›è¡Œæ±‡ç¼–ç¼–ç¨‹çš„å­¦ä¹ ã€‚</p><p>æœ¬æ–‡è®°å½•äº†å¦‚ä½•åœ¨windows11&#x2F;10ä¸Šå®‰è£…<code>DOSBox0.74</code>å¹¶é…ç½®<code>masm5</code></p><h1 id="1-å®‰è£…"><a href="#1-å®‰è£…" class="headerlink" title="1.å®‰è£…"></a>1.å®‰è£…</h1><p>è¿™ä¸¤ä¸ªè½¯ä»¶æˆ‘æ‰“åŒ…ä¸Šä¼ åˆ°äº†ç™¾åº¦äº‘ç›˜ã€‚æ”¾å¿ƒï¼ŒåŠ èµ·æ¥ä¹Ÿå°±2mbï¼Œä¸‹è½½åº”è¯¥ä¸ä¼šå¾ˆä¹…</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">é“¾æ¥: https://pan.baidu.com/s/1vjbSL7iwP8WpMVA9K505ZA</span><br><span class="line">æå–ç : kr4x</span><br></pre></td></tr></table></figure><h2 id="1-1-DOSBox"><a href="#1-1-DOSBox" class="headerlink" title="1.1 DOSBox"></a>1.1 DOSBox</h2><p>ç‚¹å‡»<code>DOSBox0.74</code>çš„å®‰è£…åŒ…ï¼Œæ— è„‘ä¸‹ä¸€æ­¥å®‰è£…å³å¯</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/10/4ef1475a8016a019d58a90bd6845e70d.png" alt="image-20231017015458406"></p><p>å®‰è£…å‡ºæ¥çš„å›¾æ ‡å¦‚ä¸‹</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/10/cc5f29112bed916bb978c49a9a23636d.png" alt="image-20231017015529621"></p><h2 id="1-2-masm5"><a href="#1-2-masm5" class="headerlink" title="1.2 masm5"></a>1.2 masm5</h2><p>æ‰¾ä¸€ä¸ªç©ºçš„æ–‡ä»¶å¤¹ï¼Œæ–‡ä»¶è·¯å¾„ä¸­ä¸èƒ½åŒ…å«ç©ºæ ¼ã€ç‰¹æ®Šå­—ç¬¦å’Œä¸­æ–‡ï¼Œå°†<code>masm5.zip</code>ä¸­çš„æ–‡ä»¶å…¨éƒ¨è§£å‹åˆ°è¿™ä¸ªæ–‡ä»¶å¤¹ä¸­ï¼Œå¦‚ä¸‹å›¾</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/10/21d3adc3a7e767d3aa3d0eba69df75e9.png" alt="image-20231017015700958"></p><p>éšåä¿®æ”¹DOSBoxè½¯ä»¶çš„é…ç½®æ–‡ä»¶ï¼Œå³é”®æ¡Œé¢ä¸ŠDosboxè½¯ä»¶çš„å¿«æ·å›¾æ ‡ï¼Œé€‰æ‹©<code>æ‰“å¼€æ–‡ä»¶æ‰€åœ¨ä½ç½®</code>æ‰¾åˆ°DOSBoxè½¯ä»¶çš„å®‰è£…è·¯å¾„ï¼Œç‚¹å‡»<code>DOSBox 0.74 Options.bat</code>æ–‡ä»¶ï¼Œç¨ç­‰ç‰‡åˆ»ï¼Œä¼šä»¥è®°äº‹æœ¬çš„æ–¹å¼æ‰“å¼€é…ç½®æ–‡ä»¶ã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/10/06f84cbaea8c2c0380807a61e01f1a7d.png" alt="image-20231017015801923"></p><p>æ‹‰åˆ°é…ç½®æ–‡ä»¶æœ€åº•ä¸‹ï¼Œæ–°å¢å¦‚ä¸‹é…ç½®ã€‚ä½ åªéœ€è¦ä¿®æ”¹<code>D:\GAME\masm</code>ä¸ºä½ çš„masm5æ–‡ä»¶çš„è§£å‹ç›®å½•å°±è¡Œäº†ã€‚è¿™ä¸ªæ–‡ä»¶è·¯å¾„ä¸­ä¸èƒ½æœ‰ç©ºæ ¼ï¼Œä¹Ÿä¸èƒ½æœ‰ç‰¹æ®Šå­—ç¬¦å’Œä¸­æ–‡ï¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">MOUNT C D:\GAME\masm</span><br><span class="line">path=%path%; \masm</span><br><span class="line">C: </span><br><span class="line">cd \asm</span><br></pre></td></tr></table></figure><p>é…ç½®å®Œæˆåï¼Œå¯åŠ¨DOSboxï¼ŒæŸ¥çœ‹masmå‘½ä»¤æ˜¯å¦èƒ½æ­£å¸¸ä½¿ç”¨ã€‚å¦‚å›¾æ‰€ç¤ºï¼Œæ²¡æœ‰æŠ¥é”™masmå‘½ä»¤ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆå°±æ˜¯é…ç½®å¥½äº†ã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/10/62cba64fa60c2fd957b5968d4387109b.png" alt="image-20231017020002774"></p><h1 id="2-ä¿®æ”¹DOSBoxçª—å£å¤§å°"><a href="#2-ä¿®æ”¹DOSBoxçª—å£å¤§å°" class="headerlink" title="2.ä¿®æ”¹DOSBoxçª—å£å¤§å°"></a>2.ä¿®æ”¹DOSBoxçª—å£å¤§å°</h1><p>é»˜è®¤æƒ…å†µä¸‹DOSBoxçš„å‘½ä»¤è¡Œçª—å£æ˜¯éå¸¸éå¸¸éå¸¸å°çš„ï¼Œæˆ‘ä»¬éœ€è¦å°†å…¶æ”¹å¤§ã€‚åŒæ ·æ˜¯ä¿®æ”¹DOSBoxçš„é…ç½®æ–‡ä»¶ï¼Œå¦‚ä½•æ‰“å¼€é…ç½®æ–‡ä»¶å‚è€ƒä¸Šæ–‡ã€‚</p><p>æŒ‰ä¸‹å›¾æ‰€ç¤ºä¿®æ”¹</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/10/2b5bab3f2fc1dbb0a766659d1eb51130.png" alt="image-20231017020347782"></p><p>è¯·æ³¨æ„ï¼Œè¿™é‡Œçš„1280å’Œ1080ä¸­é—´çš„æ˜¯å¤§å†™çš„Xï¼Œå¹¶ä¸æ˜¯ä¹˜å·</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">windowresolution=1280X1080</span><br><span class="line">output=opengl</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹äº†ä¹‹åä¿å­˜ï¼Œå†é‡æ–°æ‰“å¼€DOSBoxï¼Œç•Œé¢å°±åº”è¯¥ä¼šå˜å¤§äº†ã€‚å¦‚æœä½ è§‰å¾—è¿˜æ˜¯å°äº†ï¼Œå¯ä»¥ä¿®æ”¹è¿™é‡Œçš„åˆ†è¾¨ç‡ï¼Œç»§ç»­è®©ä»–å˜å¤§ä¸€ç‚¹ã€‚</p><h1 id="3-ç¼–è¯‘ä¸€ä¸ªæ±‡ç¼–ç¨‹åº"><a href="#3-ç¼–è¯‘ä¸€ä¸ªæ±‡ç¼–ç¨‹åº" class="headerlink" title="3.ç¼–è¯‘ä¸€ä¸ªæ±‡ç¼–ç¨‹åº"></a>3.ç¼–è¯‘ä¸€ä¸ªæ±‡ç¼–ç¨‹åº</h1><p>ç”¨ä¸‹é¢æœ€ç®€å•çš„æ±‡ç¼–ç¨‹åºåšæµ‹è¯•ï¼Œå°†å¦‚ä¸‹å†…å®¹å†™å…¥åˆ°<code>test.asm</code>ä¸­ï¼Œå¹¶æ”¾å…¥å’Œmasmçš„åŒä¸€ç›®å½•ä¸‹ï¼ˆå¿…é¡»è¦æ˜¯åŒä¸€ç›®å½•ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">CODE SEGMENT ;USE16</span><br><span class="line">     ASSUME CS:CODE</span><br><span class="line">BEG: MOV DL,&#x27;H&#x27;</span><br><span class="line">     MOV AH, 2 ; è°ƒç”¨2å·DOSç³»ç»Ÿè°ƒç”¨è¾“å‡ºå­—ç¬¦åˆ°å±å¹•ä¸Š</span><br><span class="line">     INT 21H</span><br><span class="line">     MOV AH, 4CH</span><br><span class="line">     INT 21H</span><br><span class="line">CODE  ENDS</span><br><span class="line">        END BEG</span><br></pre></td></tr></table></figure><p>æ‰“å¼€DOSBoxï¼Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">masm test.asm</span><br><span class="line">link test.obj</span><br></pre></td></tr></table></figure><p>è¾“å‡ºå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œç¬¬ä¸€ä¸ªå‘½ä»¤çš„ä½œç”¨æ˜¯ç¼–è¯‘æºæ–‡ä»¶ï¼ˆæ³¨æ„çœ‹æœ‰æ²¡æœ‰ç¼–è¯‘æŠ¥é”™ï¼‰ï¼›ç¬¬äºŒä¸ªå‘½ä»¤çš„ä½œç”¨æ˜¯é“¾æ¥objæ–‡ä»¶ï¼Œæœ€ç»ˆä¼šå¼¹å‡ºæ¥ä¸€ä¸ªè­¦å‘Šï¼Œä¸ç”¨ç®¡ä»–ã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/10/60d8190bb6bda5b544018ce777909c0f.png" alt="image-20231017020903839"></p><p>æœ€ç»ˆæ‰§è¡Œtestï¼ŒæˆåŠŸè¾“å‡ºå­—ç¬¦Håˆ°ç»ˆç«¯ä¸Šã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/10/8cace87b33fc71a4387afa5d7765e8a4.png" alt="image-20231017020946832"></p><p>èƒ½èµ°åˆ°è¿™ä¸€æ­¥ï¼Œå°±ä»£è¡¨ä½ çš„masmåŸºæœ¬ç¯å¢ƒå·²ç»é…ç½®å¥½äº†ã€‚å¯ä»¥ç”¨æ¥ç¼–è¯‘è¿è¡Œæ±‡ç¼–ä»£ç äº†</p>]]></content>
    
    
    <summary type="html">DOSBoxåœ¨windowsä¸Šçš„å®‰è£…å’Œmasmçš„é…ç½®</summary>
    
    
    
    <category term="å·®ç”Ÿæ–‡å…·å¤š" scheme="https://blog.musnow.top/categories/%E5%B7%AE%E7%94%9F%E6%96%87%E5%85%B7%E5%A4%9A/"/>
    
    
    <category term="ç¼–è¯‘" scheme="https://blog.musnow.top/tags/%E7%BC%96%E8%AF%91/"/>
    
    <category term="windows" scheme="https://blog.musnow.top/tags/windows/"/>
    
  </entry>
  
  <entry>
    <title>ã€Linuxã€‘ubuntu/centos8å®‰è£…zshç»ˆç«¯</title>
    <link href="https://blog.musnow.top/posts/2565866661/"/>
    <id>https://blog.musnow.top/posts/2565866661/</id>
    <published>2023-10-15T09:12:55.000Z</published>
    <updated>2023-10-15T09:12:55.000Z</updated>
    
    <content type="html"><![CDATA[<p>æ ¹æ®è¿™ç¯‡çŸ¥ä¹æ–‡ç« è¿›è¡Œ <a href="https://zhuanlan.zhihu.com/p/514636147">https://zhuanlan.zhihu.com/p/514636147</a></p><h1 id="1-å®‰è£…zsh"><a href="#1-å®‰è£…zsh" class="headerlink" title="1.å®‰è£…zsh"></a>1.å®‰è£…zsh</h1><p>å…ˆå®‰è£…zshå¹¶è®¾ç½®ä¸ºé»˜è®¤çš„ç»ˆç«¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ubuntu</span></span><br><span class="line">sudo apt install zsh</span><br><span class="line"><span class="comment"># centos </span></span><br><span class="line">sudo yum install zsh util-linux-user</span><br><span class="line"><span class="comment"># é€šç”¨</span></span><br><span class="line">chsh -s /bin/zsh</span><br></pre></td></tr></table></figure><blockquote><p>å¦‚æœcentosä¸‹æ‰¾ä¸åˆ°chshå‘½ä»¤ï¼Œå‚è€ƒæ­¤åšå®¢ï¼š<a href="https://blog.csdn.net/FungLeo/article/details/99448425">https://blog.csdn.net/FungLeo/article/details/99448425</a></p></blockquote><p>ç„¶åå®‰è£…oh-my-zshï¼Œè¿™æ˜¯ä¸€ä¸ªå¤§ä½¬åœ¨githubä¸Šå¼€æºçš„ä¸€ä¸ªzshé…ç½®é¡¹ï¼Œç›¸å¯¹æ–¹ä¾¿ç‚¹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget --no-check-certificate https://github.com/robbyrussell/oh-my-zsh/raw/master/tools/install.sh -O - | sh </span><br></pre></td></tr></table></figure><p>å¦‚æœgithubè¿ä¸ä¸Šå°±ç”¨giteeï¼Œå¦‚æœä½ ç”¨çš„æ˜¯å­ç”¨æˆ·ï¼Œé‚£ä¹ˆ<strong>è¿™ä¸ªå‘½ä»¤ä¸è¦ç”¨sudoæƒé™æ‰§è¡Œ</strong>ï¼å¦åˆ™åç»­å­ç”¨æˆ·ä¼šå› ä¸ºæƒé™é—®é¢˜æ²¡åŠæ³•ä½¿ç”¨ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sh -c <span class="string">&quot;<span class="subst">$(curl -fsSL https://gitee.com/shmhlsy/oh-my-zsh-install.sh/raw/master/install.sh)</span>&quot;</span></span><br></pre></td></tr></table></figure><p>æœ€ç»ˆå‡ºç°å¦‚å›¾æ‰€ç¤ºçš„ç•Œé¢å°±æ˜¯å®‰è£…æˆåŠŸäº†ã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/10/5ebc935468a46d95ac77e65dc879c66d.png" alt="image-20231015205326739"></p><h1 id="2-å®‰è£…zshæ’ä»¶"><a href="#2-å®‰è£…zshæ’ä»¶" class="headerlink" title="2.å®‰è£…zshæ’ä»¶"></a>2.å®‰è£…zshæ’ä»¶</h1><p>å®‰è£…è¿™ä¸¤ä¸ªæœ€å¸¸ç”¨çš„æ’ä»¶å°±å¯ä»¥äº†</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># zsh-autosuggestions å‘½ä»¤è¡Œå‘½ä»¤é”®å…¥æ—¶çš„å†å²å‘½ä»¤å»ºè®®</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/zsh-users/zsh-autosuggestions <span class="variable">$&#123;ZSH_CUSTOM:-~/.oh-my-zsh/custom&#125;</span>/plugins/zsh-autosuggestions</span><br><span class="line"><span class="comment"># zsh-syntax-highlighting å‘½ä»¤è¡Œè¯­æ³•é«˜äº®æ’ä»¶</span></span><br><span class="line">git <span class="built_in">clone</span> https://gitee.com/Annihilater/zsh-syntax-highlighting.git <span class="variable">$&#123;ZSH_CUSTOM:-~/.oh-my-zsh/custom&#125;</span>/plugins/zsh-syntax-highlighting</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå†å²å‘½ä»¤å»ºè®®çš„æ’ä»¶æ˜¯ç”¨æ–¹å‘é”®ğŸ‘‰æ¥è¿›è¡Œè¡¥å…¨çš„ï¼Œä¸è¦å’Œæˆ‘ä¸€æ ·å‚»ä¹ä¹æŒ‰tabã€‚</p><h1 id="3-é…ç½®æ–‡ä»¶å’Œä¸»é¢˜"><a href="#3-é…ç½®æ–‡ä»¶å’Œä¸»é¢˜" class="headerlink" title="3.é…ç½®æ–‡ä»¶å’Œä¸»é¢˜"></a>3.é…ç½®æ–‡ä»¶å’Œä¸»é¢˜</h1><p>åŸæ–‡ä¸­çš„é…ç½®æ–‡ä»¶æœ‰å¾ˆå¤šåœ°æ–¹éƒ½ä¸å¯¹åŠ²ï¼Œéœ€è¦æˆ‘ä»¬ä¿®æ”¹ï¼›</p><p>é¦–å…ˆæ˜¯<code>oh-my-zsh</code>çš„å®‰è£…è·¯å¾„ï¼Œéœ€è¦æ”¹æˆä½ çš„ç”¨æˆ·å®¶ç›®å½•ä¸‹ï¼Œç„¶åéœ€è¦å…ˆå®‰è£…ä¸€ä¸‹<code>powerlevel10k</code>ä¸»é¢˜ï¼Œè¿™ä¸ªä¸»é¢˜å¾ˆå¥½ç”¨ï¼</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> --depth=1 https://gitee.com/romkatv/powerlevel10k.git <span class="variable">$&#123;ZSH_CUSTOM:-<span class="variable">$HOME</span>/.oh-my-zsh/custom&#125;</span>/themes/powerlevel10k</span><br></pre></td></tr></table></figure><p>é…ç½®æ–‡ä»¶<code>~/.zshrc</code>æ”¹æˆå¦‚ä¸‹å†…å®¹ï¼ˆå»ºè®®å°†åŸæœ¬çš„é…ç½®æ–‡ä»¶cpå¤‡ä»½ä¸€ä¸‹ï¼‰å…¶ä¸­çš„zshå®‰è£…è·¯å¾„ä¸€å®šè¦ä¿®æ”¹ï¼Œå¦åˆ™æ— æ³•æ­£å¸¸é…ç½®ï¼</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é˜²æ­¢ä¸­æ–‡ä¹±ç </span></span><br><span class="line"><span class="built_in">export</span> LC_ALL=en_US.UTF-8</span><br><span class="line"><span class="built_in">export</span> LANG=en_US.UTF-8</span><br><span class="line"><span class="comment"># oh-my-zshçš„å®‰è£…è·¯å¾„ï¼ˆzshçš„é…ç½®è·¯å¾„ï¼‰</span></span><br><span class="line">ZSH=<span class="string">&quot;/home/ä½ çš„ç”¨æˆ·å/.oh-my-zsh&quot;</span></span><br><span class="line"><span class="comment"># ZSH_THEME=&quot;robbyrussell&quot;</span></span><br><span class="line"><span class="comment"># è®¾ç½®å­—ä½“æ¨¡å¼ä»¥åŠé…ç½®å‘½ä»¤è¡Œçš„ä¸»é¢˜</span></span><br><span class="line">POWERLEVEL9K_MODE=<span class="string">&#x27;nerdfont-complete&#x27;</span></span><br><span class="line"><span class="comment"># ZSH_THEME=&quot;agnoster&quot;</span></span><br><span class="line">ZSH_THEME=<span class="string">&quot;powerlevel10k/powerlevel10k&quot;</span> <span class="comment"># ä¸»é¢˜æ¨èè¿™ä¸ªï¼Œéœ€è¦è¿›è¡Œå®‰è£…</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯åŠ¨é”™è¯¯å‘½ä»¤è‡ªåŠ¨æ›´æ­£</span></span><br><span class="line">ENABLE_CORRECTION=<span class="string">&quot;true&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨å‘½ä»¤æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨å°çº¢ç‚¹è¿›è¡Œæç¤º</span></span><br><span class="line">COMPLETION_WAITING_DOTS=<span class="string">&quot;true&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é…ç½®è¦ä½¿ç”¨çš„æ’ä»¶</span></span><br><span class="line">plugins=(</span><br><span class="line">        git</span><br><span class="line">        extract</span><br><span class="line">        zsh-autosuggestions</span><br><span class="line">        zsh-syntax-highlighting</span><br><span class="line">)</span><br><span class="line"><span class="built_in">source</span> <span class="variable">$ZSH</span>/oh-my-zsh.sh</span><br><span class="line"><span class="built_in">source</span> <span class="variable">$ZSH_CUSTOM</span>/plugins/zsh-autosuggestions/zsh-autosuggestions.zsh</span><br><span class="line"><span class="comment"># pythonè™šæ‹Ÿç¯å¢ƒç›¸å…³è®¾ç½®</span></span><br><span class="line"><span class="keyword">if</span> [ -f /usr/local/bin/virtualenvwrapper.sh ];</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">    <span class="built_in">export</span> WORKON_HOME=<span class="variable">$HOME</span>/.virtualenvs</span><br><span class="line">    <span class="built_in">export</span> VIRTUALENVWRAPPER_PYTHON=/usr/bin/python3</span><br><span class="line">    <span class="built_in">source</span> /usr/local/bin/virtualenvwrapper.sh</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure><p>æ”¹å¥½äº†ä¹‹åï¼Œå¯ç”¨ä»–ï¼Œç„¶åå°±å¯ä»¥äº†ï¼›æ‰§è¡Œä¸‹æ–¹å‘½ä»¤åï¼Œå°±ä¼šè‡ªåŠ¨å¼¹å‡º<code>powerlevel10k</code>ä¸»é¢˜çš„é…ç½®å¼•å¯¼è¿‡ç¨‹ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source ~/.zshrc</span><br></pre></td></tr></table></figure><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/10/684bc428ce3e1369d8d60997845180a8.png" alt="image-20231015205703586"></p><p>å¦‚æœè®¾ç½®å®Œæ¯•åï¼Œä½ å¯¹<code>powerlevel10k/powerlevel10k</code>çš„é…ç½®åˆä¸æ»¡æ„äº†ï¼Œå¯ä»¥æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤é‡æ–°é…ç½®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p10k configure</span><br></pre></td></tr></table></figure><p>ä½ å¯èƒ½ä¹Ÿä¼šé‡åˆ°å¦‚ä¸‹æŠ¥é”™ï¼ŒåŸå› æœªçŸ¥ï¼Œä½†ä¼¼ä¹ä¸å½±å“ä½¿ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">â¯ ls</span><br><span class="line">_p9k_worker_stop:zle:4: No handler installed for fd 12</span><br><span class="line">_p9k_worker_stop:5: failed to close file descriptor 12: bad file descriptor</span><br></pre></td></tr></table></figure><p>å¦‚ä¸ŠæŠ¥é”™è§£å†³åŠæ³•å‚è€ƒgithubçš„issueå†…çš„è¯´æ˜</p><p><a href="https://github.com/romkatv/powerlevel10k/issues/1554">https://github.com/romkatv/powerlevel10k/issues/1554</a></p><p>åœ¨é…ç½®æ–‡ä»¶<code>.zshrc</code>çš„æœ«å°¾åŠ ä¸Šä¸‹é¢è¿™ä¸€è¡Œï¼Œç„¶åsourceè®©å…¶ç”Ÿæ•ˆå°±å¯ä»¥äº†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unset ZSH_AUTOSUGGEST_USE_ASYNC</span><br></pre></td></tr></table></figure><h1 id="4-ä½¿ç”¨å°æŠ€å·§"><a href="#4-ä½¿ç”¨å°æŠ€å·§" class="headerlink" title="4.ä½¿ç”¨å°æŠ€å·§"></a>4.ä½¿ç”¨å°æŠ€å·§</h1><p>è¾“å…¥å‘½ä»¤çš„æ—¶å€™é”®å…¥tabï¼Œä¼šå¼¹å‡ºä¸€äº›å‘½ä»¤çš„æç¤º</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/10/486730657def543552dc7a82163410e9.png" alt="image-20231015210623737"></p><p>è¾“å…¥ä¹‹å‰å†™è¿‡çš„å‘½ä»¤çš„æ—¶å€™ï¼Œä¼šå‡ºç°å†å²å‘½ä»¤æç¤ºï¼Œä½¿ç”¨æ–¹å‘é”®å³ğŸ‘‰å°±å¯ä»¥è¡¥å…¨è¿™ä¸ªå‘½ä»¤</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/10/eb1e448943c27dd0bdeb29267b26d252.png" alt="image-20231015210708230"></p><p>zshä¸»è¦å°±æ˜¯è¿™ä¸€ç‚¹éå¸¸çš„æ–¹ä¾¿ï¼Œè‡³äºä¼šä¸ä¼šå’Œé»˜è®¤çš„<code>/bin/bash</code>æœ‰æ€§èƒ½å·®å¼‚ï¼Œé‚£å°±ä¸çŸ¥é“äº†ã€‚</p><p>å¦å¤–ï¼Œåœ¨zshç»ˆç«¯ä¸­ç›´æ¥é‡å®šå‘ä¼šå¡ä½ï¼Œå¦‚ä¸‹å‘½ä»¤å°±ä¼šé˜»å¡æ‰ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; æ–‡æœ¬æ–‡ä»¶</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥è¦ç”¨echoï¼ˆä¸€èˆ¬æˆ‘æ˜¯ç”¨æ¥æ¸…ç©ºæŸä¸ªæ–‡æœ¬æ–‡ä»¶ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &gt; æ–‡æœ¬æ–‡ä»¶</span><br></pre></td></tr></table></figure><h1 id="5-zshå®‰è£…ågitä¸­æ–‡ä¹±ç "><a href="#5-zshå®‰è£…ågitä¸­æ–‡ä¹±ç " class="headerlink" title="5.zshå®‰è£…ågitä¸­æ–‡ä¹±ç "></a>5.zshå®‰è£…ågitä¸­æ–‡ä¹±ç </h1><p>å®‰è£…zshåç”¨<code>git log</code>æŸ¥çœ‹æäº¤ä¿¡æ¯çš„æ—¶å€™å‘ç°ä¸­æ–‡ä¹±ç ã€‚</p><h2 id="5-1-ä¿®æ”¹zshé…ç½®æ–‡ä»¶"><a href="#5-1-ä¿®æ”¹zshé…ç½®æ–‡ä»¶" class="headerlink" title="5.1 ä¿®æ”¹zshé…ç½®æ–‡ä»¶"></a>5.1 ä¿®æ”¹zshé…ç½®æ–‡ä»¶</h2><p>å…¶å®ä¸Šæ–‡ä¸­æåˆ°çš„é…ç½®æ–‡ä»¶é‡Œé¢å·²ç»æœ‰è¿™ä¸¤ä¸ªé…ç½®é¡¹äº†ï¼Œè¯´æ˜é—®é¢˜ä¸åœ¨è¿™é‡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># é˜²æ­¢ä¸­æ–‡ä¹±ç </span><br><span class="line">export LC_ALL=en_US.UTF-8</span><br><span class="line">export LANG=en_US.UTF-8</span><br></pre></td></tr></table></figure><h2 id="5-2-æ‰§è¡Œgité…ç½®"><a href="#5-2-æ‰§è¡Œgité…ç½®" class="headerlink" title="5.2 æ‰§è¡Œgité…ç½®"></a>5.2 æ‰§è¡Œgité…ç½®</h2><p>ä¸€ç¯‡åšå®¢è¯´è¦æ‰§è¡Œä¸‹é¢çš„gitå‘½ä»¤ï¼Œä¹Ÿæ²¡æœ‰ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git config --global core.quotepath false </span><br><span class="line">git config --global gui.encoding utf-8 </span><br><span class="line">git config --global i18n.commit.encoding utf-8 </span><br><span class="line">git config --global i18n.logoutputencoding utf-8 </span><br><span class="line">set LESSCHARSET=utf-8</span><br></pre></td></tr></table></figure><h2 id="5-3-ä¿®æ”¹ç³»ç»Ÿå­—ç¬¦é…ç½®"><a href="#5-3-ä¿®æ”¹ç³»ç»Ÿå­—ç¬¦é…ç½®" class="headerlink" title="5.3 ä¿®æ”¹ç³»ç»Ÿå­—ç¬¦é…ç½®"></a>5.3 ä¿®æ”¹ç³»ç»Ÿå­—ç¬¦é…ç½®</h2><p>å¦å¤–ä¸€ç¯‡åšå®¢è¯´è¦ä¿®æ”¹ç³»ç»Ÿçš„å­—ç¬¦é›†é…ç½®ï¼Œå¦‚ä¸‹ç¯å¢ƒå˜é‡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export LESSCHARSET=utf-8</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œåç¡®å®okäº†ï¼Œå¯ä»¥ç¼–è¾‘<code>/etc/profile</code>æ–‡ä»¶ï¼Œåœ¨è¯¥æ–‡ä»¶æœ«å°¾è¿½åŠ å¦‚ä¸‹å†…å®¹è®©å…¶å§‹ç»ˆç”Ÿæ•ˆ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export LESSCHARSET=utf-8</span><br></pre></td></tr></table></figure><p>éšåç”¨sourceå‘½ä»¤åˆ·æ–°è¿™ä¸ªé…ç½®æ–‡ä»¶å³å¯ã€‚</p><h1 id="6-ç²˜è´´æ–‡æœ¬å¾ˆæ…¢çš„é—®é¢˜"><a href="#6-ç²˜è´´æ–‡æœ¬å¾ˆæ…¢çš„é—®é¢˜" class="headerlink" title="6.ç²˜è´´æ–‡æœ¬å¾ˆæ…¢çš„é—®é¢˜"></a>6.ç²˜è´´æ–‡æœ¬å¾ˆæ…¢çš„é—®é¢˜</h1><p>å‚è€ƒ <a href="https://github.com/zsh-users/zsh-autosuggestions/issues/238">zsh-users&#x2F;zsh-autosuggestions&#x2F;issues&#x2F;238</a> è§£å†³è¿™ä¸ªé—®é¢˜</p><p>åœ¨<code>.zshrc</code>ä¹‹åæ·»åŠ å¦‚ä¸‹é…ç½®é¡¹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># This speeds up pasting w/ autosuggest</span><br><span class="line"># https://github.com/zsh-users/zsh-autosuggestions/issues/238</span><br><span class="line">pasteinit() &#123;</span><br><span class="line">  OLD_SELF_INSERT=$&#123;$&#123;(s.:.)widgets[self-insert]&#125;[2,3]&#125;</span><br><span class="line">  zle -N self-insert url-quote-magic # I wonder if you&#x27;d need `.url-quote-magic`?</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">pastefinish() &#123;</span><br><span class="line">  zle -N self-insert $OLD_SELF_INSERT</span><br><span class="line">&#125;</span><br><span class="line">zstyle :bracketed-paste-magic paste-init pasteinit</span><br><span class="line">zstyle :bracketed-paste-magic paste-finish pastefinish</span><br></pre></td></tr></table></figure><p>é…ç½®äº†ä¹‹åï¼Œsourceä½¿å…¶ç”Ÿæ•ˆã€‚</p><p>è¿™æ—¶å€™åœ¨ç»ˆç«¯é‡Œé¢ç²˜è´´å†…å®¹çš„æ—¶å€™ï¼Œå°±ä¸ä¼šä¸€ä¸ªä¸€ä¸ªå­—ç¬¦åœ°æ‰“å°å‡ºæ¥äº†ã€‚é‚£æ ·å®åœ¨æ˜¯å¤ªæ…¢äº†ã€‚</p>]]></content>
    
    
    <summary type="html">ubuntu/centos8è™šæ‹Ÿæœºå®‰è£…zshç»ˆç«¯</summary>
    
    
    
    <category term="ç©ä¸ŠLinux" scheme="https://blog.musnow.top/categories/%E7%8E%A9%E4%B8%8ALinux/"/>
    
    
    <category term="Linux" scheme="https://blog.musnow.top/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>ã€è™šæ‹Ÿæœºã€‘WIN11çš„WSLå®‰è£…CentOS8Streamè™šæ‹Ÿæœº</title>
    <link href="https://blog.musnow.top/posts/4065446782/"/>
    <id>https://blog.musnow.top/posts/4065446782/</id>
    <published>2023-10-15T03:30:55.000Z</published>
    <updated>2023-10-15T03:30:55.000Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬äººæ‰€ä½¿ç”¨çš„ç³»ç»Ÿæ˜¯ <code>win11 22H2 å®¶åº­ç‰ˆ</code>ï¼Œå¦‚æœä½ ä¸æ˜¯éCentOSä¸å¯ï¼Œå¼ºçƒˆå»ºè®®ç›´æ¥å»å¾®è½¯åº”ç”¨å•†åº—é‡Œé¢ä¸‹è½½Ubuntuï¼Œå…¨è‡ªåŠ¨å®‰è£…åˆ°WSLï¼Œå•¥éƒ½ä¸ç”¨ç®¡ã€‚(å°±æ˜¯å¥½åƒæ²¡åŠæ³•é€‰æ‹©å®‰è£…è·¯å¾„)</p><h1 id="1-å¯ç”¨WSL"><a href="#1-å¯ç”¨WSL" class="headerlink" title="1.å¯ç”¨WSL"></a>1.å¯ç”¨WSL</h1><p>åˆšå¼€å§‹å®‰è£…WSLçš„æ—¶å€™ï¼Œå‚è€ƒçš„æ˜¯<a href="https://blog.csdn.net/qq_38442140/article/details/120724215">è¿™ä¸ªåšå®¢</a>ã€‚è¯´å®è¯ï¼Œæˆ‘ä¸ªäººå¹¶ä¸å–œæ¬¢è¿™ç¯‡åšå®¢ã€‚å› ä¸ºé‡Œé¢é—æ¼äº†å¾ˆå¤šä¸œè¥¿ï¼Œå¹¶ä¸”åœ¨ä¸æ°å½“çš„ä½ç½®è´´å‡ºäº†å‘½ä»¤ï¼Œå¯¼è‡´è¯»è€…ä¼šè¯¯ä»¥ä¸ºæ˜¯éœ€è¦æ‰§è¡Œè¿™äº›å‘½ä»¤ã€‚</p><p>æ¯”å¦‚æˆ‘å°±ç†è§£é”™è¯¯ï¼Œå…ˆæ‰§è¡Œäº†è®¾ç½®wslé»˜è®¤ç‰ˆæœ¬ä¸º2çš„å‘½ä»¤ï¼Œ<strong>è¿™ä¸ªå‘½ä»¤å…ˆä¸è¦æ‰§è¡Œ</strong>ï¼åæ–‡ä¼šå‘Šè¯‰ä½ ä¸ºä»€ä¹ˆã€‚</p><p>è¿™ç¯‡åšå®¢ä¸­å¯¹å¼€å¯wslçš„è®¾ç½®çš„ä½ç½®æè¿°ä¹Ÿä¸å®Œå…¨ï¼Œçœ‹ä¸Šå»åƒä»ç½‘ä¸Šå“ªé‡ŒæŠ„è¿‡æ¥çš„win10çš„è®¾ç½®é€»è¾‘ï¼ˆwin11çš„ä½ç½®å®Œå…¨ä¸ä¸€æ ·ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¯¥åšå®¢åŸæ–‡ï¼šåœ¨windowsè®¾ç½®ä¸­æ‰“å¼€ã€å¯ç”¨æˆ–å…³é—­WindwosåŠŸèƒ½ã€‘ï¼Œå‹¾é€‰ã€é€‚ç”¨äºLinuxçš„Windwoså­ç³»ç»Ÿã€‘ï¼Œç‚¹å‡»ç¡®å®šåä¼šç³»ç»Ÿä¼šæç¤ºé‡å¯ï¼Œé€‰æ‹©ç¡®è®¤å³å¯</span><br></pre></td></tr></table></figure><p>å®é™…ä¸Šåœ¨win11ä¸­ï¼Œéœ€è¦å¤šç‚¹å¥½å‡ ä¸ªåœ°æ–¹æ‰èƒ½æ‰¾åˆ°è¿™ä¸ªè®¾ç½®çš„ä½ç½®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å³é”®æ¡Œé¢ - ä¸ªæ€§åŒ– - è¿›å…¥win11è®¾ç½®ç•Œé¢ - åº”ç”¨ - å¯é€‰åŠŸèƒ½ - (å¾€ä¸‹æ»‘)æ›´å¤šwindowsåŠŸèƒ½</span><br></pre></td></tr></table></figure><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/10/542d2e77f4272f4598629626e44ee2a7.png" alt="image-20231015104701566"></p><blockquote><p>è¿™éƒ½æ˜¯æˆ‘å¯¹ä¸€ä¸ª<strong>ä¸å®Œå–„åšå®¢</strong>çš„åæ§½ï¼Œä½†å¹¶æ²¡æœ‰è´¬ä½è¿™ä¸ªæ•™ç¨‹çš„æ„æ€å•Šï¼è‡³å°‘ä»–å‘Šè¯‰æˆ‘åŸºæœ¬æ­¥éª¤åº”è¯¥åšå“ªäº›ã€‚</p><p>ä¸ºä»€ä¹ˆæˆ‘è¦åæ§½å‘¢ï¼Ÿå› ä¸ºè¿™ç§å†™çš„ä¸å…¨çš„åšå®¢ç»å¸¸ä¼šè®©è¯»è€…å¾—å»é‡æ–°æœç´¢æŸäº›è®¾ç½®çš„ä½ç½®ï¼Œè€Œä½œè€…æ˜æ˜æ˜¯å·²ç»èµ°è¿‡è¿™ä¸ªæµç¨‹çš„ã€‚åšå®¢é‡Œé¢ä½œè€…çš„æˆªå›¾æ˜æ˜¾æ˜¯windows11ï¼Œä½†ä»–æä¾›çš„è®¾ç½®å´æ˜¯win10ä¸­çš„æ—§ä½ç½®ã€‚å¤šèŠ±30ç§’å†™æ¸…æ¥šä½ç½®å¹¶å¸¦ä¸Šæˆªå›¾ï¼Œä¸çŸ¥é“èƒ½èŠ‚çœè¯»è€…å¤šå°‘æ—¶é—´â€¦â€¦å¦‚æœä½ ä½“ä¼šè¿‡æŸ¥èµ„æ–™çš„æ—¶å€™é˜…è¯»è¿™äº›ã€Œæ–­å¤´çŸ­å°¾ã€çš„åšå®¢ï¼Œåº”è¯¥ä¹Ÿèƒ½ä½“ä¼šåˆ°æˆ‘çš„å¿ƒæƒ…ã€‚</p></blockquote><p>å›åˆ°æ­£é¢˜ã€‚åœ¨æ›´å¤š windows åŠŸèƒ½é€‰é¡¹æ¡†ä¸­ï¼ˆwin10&#x2F;11çš„è¿™ä¸ªé€‰é¡¹æ¡†åŸºæœ¬ç›¸åŒï¼‰ï¼Œå‹¾é€‰ä¸Šä¸‹é¢çš„å‡ ä¸ªé€‰é¡¹ï¼Œä¸‰ä¸ªéƒ½è¦å‹¾é€‰ä¸Šï¼</p><ul><li>é€‚ç”¨äº Linux çš„ Windows å­ç³»ç»Ÿ</li><li>è™šæ‹Ÿæœºå¹³å°</li><li>windows è™šæ‹Ÿæœºç›‘æ§ç¨‹åºå¹³å°</li></ul><p>ç‚¹å‡»ç¡®å®šï¼Œå°±æˆåŠŸå¯ç”¨äº† WSLã€‚ç³»ç»Ÿä¼šå¼¹å‡ºä¸€ä¸ªè¿›åº¦æ¡ï¼Œä¸‹è½½ä¸€äº›ä¸œè¥¿ã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/10/61b796407e655ae94c7ff535edaeae69.png" alt="image-20231015104951463"></p><p>å¤„ç†å®Œæ¯•åï¼ŒWIN+Rè¾“å…¥cmdï¼Œæ‰“å¼€å‘½ä»¤è¡Œå·¥å…·ï¼Œåœ¨å‘½ä»¤è¡Œå·¥å…·ä¸­è¾“å…¥<code>wsl -l -v</code>å‘½ä»¤ï¼Œæœ‰ç›¸å…³è¾“å‡ºå°±æ˜¯å¯ç”¨æˆåŠŸäº†ï¼</p><p>åˆå§‹åŒ–æƒ…å†µä¸‹ï¼Œæ‰§è¡Œè¿™ä¸ªå‘½ä»¤ï¼Œåº”è¯¥ä¼šæç¤ºä½ å½“å‰ä»€ä¹ˆè™šæ‹Ÿæœºéƒ½æ²¡æœ‰å®‰è£…ã€‚</p><h1 id="2-å®‰è£…Centos8"><a href="#2-å®‰è£…Centos8" class="headerlink" title="2.å®‰è£…Centos8"></a>2.å®‰è£…Centos8</h1><h2 id="2-1-ä¸‹è½½ç³»ç»Ÿzip"><a href="#2-1-ä¸‹è½½ç³»ç»Ÿzip" class="headerlink" title="2.1 ä¸‹è½½ç³»ç»Ÿzip"></a>2.1 ä¸‹è½½ç³»ç»Ÿzip</h2><p>å» <a href="https://github.com/wsldl-pg/CentWSL/releases/tag/8.1.1911.1">github&#x2F;wsldl-pg&#x2F;CentWSL</a> ä¸Šä¸‹è½½é€‚ç”¨äºwslçš„<code>CentOS8</code>ç³»ç»Ÿçš„zip</p><blockquote><p>è¿™ä¸ªä¹Ÿå¯ä»¥ï¼š<a href="https://github.com/mishamosher/CentOS-WSL">https://github.com/mishamosher/CentOS-WSL</a></p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/10/c42449d2875a2e60a296953f2bfcfae8.png" alt="image-20231015104110576"></p><p>æŠŠzipè§£å‹åˆ°ä½ æƒ³å®‰è£…è™šæ‹Ÿæœºçš„ä½ç½®ï¼ˆä¸€å®šè¦æ˜¯ä¸€ä¸ªç©ºæ–‡ä»¶å¤¹ï¼‰ï¼Œç„¶åå³é”®<code>CentOS8.exe</code>ï¼Œä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/10/a13a0b3e0db1dab54e499c9c7bf5ddc6.png" alt="image-20231015104455537"></p><h2 id="2-2-æŠ¥é”™HRESULT-0x80370102è§£å†³"><a href="#2-2-æŠ¥é”™HRESULT-0x80370102è§£å†³" class="headerlink" title="2.2 æŠ¥é”™HRESULT:0x80370102è§£å†³"></a>2.2 æŠ¥é”™HRESULT:0x80370102è§£å†³</h2><p>å®‰è£…CentOS8çš„æ—¶å€™ï¼Œå°±é‡åˆ°äº†è¿™ä¸ª<strong>issue</strong>ä¸­çš„é—®é¢˜ğŸ‘‡</p><p><a href="https://github.com/wsldl-pg/CentWSL/issues/36">github.com&#x2F;wsldl-pg&#x2F;CentWSL&#x2F;issues&#x2F;36</a></p><p>ç”¨ç®¡ç†å‘˜èº«ä»½è¿è¡Œ<code>CentOS8.exe</code>ä¹‹åï¼Œå¼¹å‡ºçš„ç»ˆç«¯ä¼šè¾“å‡ºå¦‚ä¸‹å†…å®¹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ERROR:Installation Failed!</span><br><span class="line">HRESULT:0x80370102</span><br></pre></td></tr></table></figure><p>æ ¹æ®<a href="https://github.com/wsldl-pg/CentWSL/issues/36">è¯¥issue</a> ä¸­æœ€åä¸€ä¸ªå›å¤çš„è§£å†³åŠæ³•ï¼Œæˆ‘å…ˆå°†wslç‰ˆæœ¬è®¾ç½®å›äº†1ï¼ˆè¿™å°±æ˜¯ä¸ºä»€ä¹ˆå‰æ–‡è¯´ä¸è¦å…ˆè®¾ç½®ä¸ºé»˜è®¤wsl2ï¼‰</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/10/d19e82cbafe8e5eba20d8c6eef64687a.png" alt="image-20231015112649042"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wsl --set-default-version 1</span><br></pre></td></tr></table></figure><p>é‡å¤å¦‚ä¸Šå®‰è£…æ­¥éª¤ï¼ˆä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ<code>CentOS8.exe</code>ï¼‰ï¼Œå°±æˆåŠŸå®‰è£…äº†è™šæ‹Ÿæœºã€‚åœ¨win11çš„æ–‡ä»¶ç®¡ç†å™¨å·¦ä¾§ä¼šå¤šå‡ºæ¥ä¸€ä¸ªLinuxå›¾æ ‡ï¼Œé‡Œé¢æœ‰CentOS8çš„ç³»ç»Ÿé‡Œé¢çš„æ–‡ä»¶ã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/10/721c72e099c746ab5f618282dc205e27.png" alt="image-20231015105247440"></p><p>åœ¨windowsçš„powershellæˆ–è€…cmdä¸­ï¼Œè¾“å…¥<code>wsl</code>ï¼Œå°±å¯ä»¥è¿›å…¥CentOS8çš„bashï¼›è§ä¸‹å›¾ï¼Œæˆ‘ä»¬å·²ç»æˆåŠŸå®‰è£…å¥½äº†ä¸€ä¸ªCentOS8çš„è™šæ‹Ÿæœºã€‚å†…éƒ¨çš„æ–‡ä»¶å°±æ˜¯CentOS8ç³»ç»Ÿçš„é»˜è®¤æ–‡ä»¶ã€‚</p><p>åœ¨å†…éƒ¨æ‰§è¡Œ<code>exit</code>å‘½ä»¤ï¼Œå°±å¯ä»¥é€€å‡ºwslè™šæ‹Ÿæœºï¼Œå›åˆ°windowsçš„ç»ˆç«¯ä¸‹ã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/10/fa9eb9786e59758af270ae93f120ed51.png" alt="image-20231015105338512"></p><p>è€Œä¸”WSLæœ‰ä¸ªæœ€å¤§çš„å¥½å¤„ï¼Œå°±æ˜¯å®ƒèƒ½è‡ªåŠ¨æŒ‚è½½windowsä¸‹çš„æ–‡ä»¶åˆ°<code>/mnt</code>ç›®å½•ä¸‹ï¼Œè¿™ä¸ªç›®å½•é‡Œé¢å¯ä»¥çœ‹åˆ°æˆ‘çš„win11å®¿ä¸»æœºçš„3ä¸ªç¡¬ç›˜åˆ†åŒºï¼›windowsçš„æ–‡ä»¶èµ„æºç®¡ç†å™¨é‡Œé¢ä¹Ÿå¯ä»¥çœ‹åˆ°Linuxä¸­çš„æ–‡ä»¶ï¼Œ<strong>æ–¹ä¾¿æˆ‘ä»¬åœ¨windowså’Œlinuxä¸‹äº’ä¼ æ–‡ä»¶</strong>ï¼ˆå°±ä¸éœ€è¦ç”¨sftpå·¥å…·äº†ï¼‰</p><p>ç‰¹åˆ«æ˜¯å¦‚æœä½ éœ€è¦å†™å¸¦Doxygenæ–‡æ¡£çš„é¡¹ç›®ï¼Œåœ¨ç”ŸæˆDoxygençš„htmlåï¼Œå°±èƒ½ç›´æ¥ä»è¿™é‡Œåœ¨windowsçš„æµè§ˆå™¨ä¸­æ‰“å¼€ç½‘é¡µï¼Œè€Œä¸éœ€è¦ç”¨sftpæˆ–è€…å…¶ä»–å·¥å…·ä¼ åˆ°windowsä¸‹å†æ‰“å¼€äº†ï¼</p><blockquote><p>å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥ç”¨å¸¦GUIçš„Linuxç³»ç»Ÿæ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p></blockquote><h2 id="2-3-æ›´æ–°ä¸ºWSL2"><a href="#2-3-æ›´æ–°ä¸ºWSL2" class="headerlink" title="2.3 æ›´æ–°ä¸ºWSL2"></a>2.3 æ›´æ–°ä¸ºWSL2</h2><p>ä½¿ç”¨<code>wsl -l -v</code>å‘½ä»¤ï¼Œå¯ä»¥çœ‹åˆ°å½“å‰è¿è¡Œçš„wslè™šæ‹Ÿæœºï¼Œç‰ˆæœ¬æ˜¯1</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users\S2522\Desktop&gt; wsl -l -v</span><br><span class="line">  NAME       STATE           VERSION</span><br><span class="line">* CentOS8    Running         1</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥å°†å…¶å‡çº§ä¸ºWSL2ç‰ˆæœ¬ï¼Œä½†æ˜¯è¿™é‡Œä¼šå‘Šè¯‰ä½ éœ€è¦æ›´æ–°å†…æ ¸ç»„ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users\S2522\Desktop&gt; wsl --set-version CentOS8 2</span><br><span class="line">æ­£åœ¨è¿›è¡Œè½¬æ¢ï¼Œè¿™å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿæ—¶é—´...</span><br><span class="line">æœ‰å…³ä¸ WSL 2 çš„ä¸»è¦åŒºåˆ«çš„ä¿¡æ¯ï¼Œè¯·è®¿é—® https://aka.ms/wsl2</span><br><span class="line">WSL 2 éœ€è¦æ›´æ–°å…¶å†…æ ¸ç»„ä»¶ã€‚æœ‰å…³ä¿¡æ¯ï¼Œè¯·è®¿é—® https://aka.ms/wsl2kernel</span><br></pre></td></tr></table></figure><p>é‚£å°±æ›´æ–°å‘—ï¼<a href="https://aka.ms/wsl2kernel">å¾®è½¯å®˜æ–¹æ–‡æ¡£</a> ä¸­ä¼šå‘Šè¯‰ä½ éœ€è¦ <code>wsl.exe --install</code> æˆ– <code>wsl.exe --update</code>å‘½ä»¤ã€‚</p><p>è¿™é‡Œæˆ‘æ‰§è¡Œäº†<code>wsl --update</code>å‘½ä»¤ï¼Œæ‰§è¡Œåä¼šå¼¹çª—è¦ä½ æä¾›ç®¡ç†æƒé™ï¼Œå¹¶å‡ºç°ä¸€ä¸ªè¿›åº¦æ¡ï¼Œç­‰ä»–è·‘å®Œå°±è¡Œã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users\S2522\Desktop&gt; wsl --update</span><br><span class="line">æ­£åœ¨å®‰è£…: é€‚ç”¨äº Linux çš„ Windows å­ç³»ç»Ÿ</span><br><span class="line">å·²å®‰è£… é€‚ç”¨äº Linux çš„ Windows å­ç³»ç»Ÿã€‚</span><br></pre></td></tr></table></figure><p>æ›´æ–°å¥½äº†ï¼Œå†é‡æ–°æ‰§è¡Œ<code>wsl --set-version CentOS8 2</code>å‡çº§å‘½ä»¤ï¼Œä¼šæç¤ºä½ æ­£åœ¨æ‰§è¡Œè½¬æ¢ï¼Œéœ€è¦ç­‰å¾…ä¸€ä¼šã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/10/a870772fe8f185d55935bb2eb1d720d3.png" alt="image-20231015105730332"></p><p>æœ€ç»ˆæˆåŠŸè½¬æ¢äº†ï¼Œä½¿ç”¨å‘½ä»¤<code>wsl -l -v</code>é‡Œé¢æ˜¾ç¤ºçš„ç‰ˆæœ¬ä¹Ÿæ˜¯2äº†ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users\S2522\Desktop&gt; wsl --set-version CentOS8 2</span><br><span class="line">æœ‰å…³ä¸ WSL 2 å…³é”®åŒºåˆ«çš„ä¿¡æ¯ï¼Œè¯·è®¿é—® https://aka.ms/wsl2</span><br><span class="line"></span><br><span class="line">æ­£åœ¨è¿›è¡Œè½¬æ¢ï¼Œè¿™å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿæ—¶é—´ã€‚</span><br><span class="line">æ“ä½œæˆåŠŸå®Œæˆã€‚</span><br><span class="line">PS C:\Users\S2522\Desktop&gt; wsl -l -v</span><br><span class="line">  NAME       STATE           VERSION</span><br><span class="line">* CentOS8    Stopped         2</span><br></pre></td></tr></table></figure><p>æå®šï¼ç°åœ¨æˆ‘ä»¬å°±æœ‰ä¸€ä¸ªæ–¹ä¾¿çš„CentOS8çš„WSLç¯å¢ƒå•¦ï¼</p><p>å¯ä»¥ç”¨å¦‚ä¸‹å‘½ä»¤ï¼Œå°†å½“å‰çš„CentOS8è®¾ç½®ä¸ºé»˜è®¤çš„wslè™šæ‹Ÿæœºã€‚è¿™æ ·åœ¨windowså‘½ä»¤è¡Œä¸­æ‰§è¡Œwslæˆ–è€…bashå‘½ä»¤ï¼Œå°±èƒ½ç›´æ¥è¿›å…¥CentOS8ä¸­ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wslconfig /setdefault CentOS8</span><br></pre></td></tr></table></figure><p>é‡å¯ç”µè„‘åï¼Œåœ¨powershellçš„ä¸‹æ‹‰æ ä¸­ä¼šè‡ªåŠ¨å‡ºç°CentOS8çš„é€‰é¡¹ï¼Œç‚¹å‡»å®ƒä¹Ÿèƒ½è¿›å…¥wslè™šæ‹Ÿæœºç¯å¢ƒä¸­ã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/10/e40e68ef976f8ef57c9f73d03a8dc892.png" alt="image-20231015134927313"></p><h1 id="3-è§£å†³yumæŠ¥é”™é—®é¢˜"><a href="#3-è§£å†³yumæŠ¥é”™é—®é¢˜" class="headerlink" title="3.è§£å†³yumæŠ¥é”™é—®é¢˜"></a>3.è§£å†³yumæŠ¥é”™é—®é¢˜</h1><p>å› ä¸ºè¿™ä¸ªCentOSçš„é•œåƒæ˜¯æœ€å°å®‰è£…ç‰ˆæœ¬ï¼ˆç±»ä¼¼äºDockerå®‰è£…çš„CentOSï¼‰ï¼Œæ‰€ä»¥å†…éƒ¨çš„yumæºéƒ½æ˜¯åæ‰çš„ã€‚æ‰§è¡Œ<code>yum update</code>ä¼šå‡ºç°å¦‚ä¸‹æŠ¥é”™ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@7945R9P ~]# yum -y update</span><br><span class="line">Failed to set locale, defaulting to C.UTF-8</span><br><span class="line">CentOS-8 - AppStream                                                                     68  B/s |  38  B     00:00</span><br><span class="line">Failed to download metadata for repo &#x27;AppStream&#x27;</span><br><span class="line">Error: Failed to download metadata for repo &#x27;AppStream&#x27;</span><br></pre></td></tr></table></figure><p>è¿™æ—¶å€™éœ€è¦è¿›è¡Œyumæºçš„é‡æ–°è®¾ç½®ï¼Œå‚è€ƒæœ¬ç«™åšå®¢è§£å†³è¿™ä¸ªé—®é¢˜å°±è¡Œ</p><p> <a href="https://blog.musnow.top/posts/1296728696/">ã€Dockerã€‘é…ç½®CentOSå®¹å™¨æ—¶å‡ºç° Error Failed to download metadata for repo â€˜appstreamâ€™ Cannot prepare internal mirrorlist | è½¬è½½</a></p><p>æå®šyumä¹‹åï¼Œå°±å¯ä»¥æ­£å¸¸å®‰è£…ä½ æƒ³è¦çš„å¼€å‘è½¯ä»¶äº†ã€‚è¿™ä¸ªç³»ç»Ÿå¾ˆè½»é‡ï¼Œsudoå’Œpasswdç­‰å¾ˆå¤šå®Œæ•´ç³»ç»Ÿä¼šè‡ªå¸¦çš„å‘½ä»¤éƒ½æ²¡æœ‰ï¼Œéœ€è¦è‡ªè¡Œå®‰è£…ä¸€äº›ã€‚</p><p>å¦å¤–ï¼Œæˆ‘å†™è¿‡ä¸€ä¸ªCentOS8çš„åˆå§‹åŒ–è„šæœ¬ï¼Œå¯ä»¥è‡ªåŠ¨åŒ–å®‰è£…ä¸€äº›è½¯ä»¶ï¼Œè¿™é‡Œå®‰è£…çš„è½¯ä»¶å¹¶ä¸ä¸€å®šæ˜¯ä½ æƒ³è¦çš„ï¼Œè¯·é…Œæƒ…å‚è€ƒï¼š<a href="https://gitee.com/musnows/centos8-init">https://gitee.com/musnows/centos8-init</a></p><hr><p>è€Œä¸”ï¼Œé»˜è®¤æƒ…å†µä¸‹çš„lså‘½ä»¤ä¹Ÿæ²¡æœ‰é¢œè‰²è¾“å‡ºï¼Œéœ€è¦ä¿®æ”¹bashé…ç½®æ¥è®¾ç½®å‘½ä»¤åˆ«å</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">alias</span> <span class="built_in">ls</span>=<span class="string">&#x27;ls --color=auto&#x27;</span></span><br></pre></td></tr></table></figure><p>ä½ ä¹Ÿå¯ä»¥æ ¹æ®è‡ªå·±çš„å–œå¥½ï¼Œæ”¹æˆzshæˆ–è€…å…¶ä»–ç»ˆç«¯ã€‚</p><h1 id="4-vscodeè¿æ¥"><a href="#4-vscodeè¿æ¥" class="headerlink" title="4.vscodeè¿æ¥"></a>4.vscodeè¿æ¥</h1><p>æ™®é€šçš„è™šæ‹Ÿæœºæˆ‘ä»¬éœ€è¦ç”¨vscodeçš„remote sshæ’ä»¶æ¥è¿æ¥ï¼Œä½†æ˜¯WSLä¸»æœºæˆ‘ä»¬ç›´æ¥ç”¨vscçš„<strong>WSLæ’ä»¶</strong>æ¥è¿æ¥å°±è¡Œäº†ï¼Œä½¿ç”¨çš„æ•ˆæœå’Œremote sshæ’ä»¶æ˜¯ç›¸åŒçš„</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/10/4211aec9f60b6984a3a680c1a900b5c8.png" alt="image-20231015111412100"></p><p>åœ¨å·¦ä¾§è¿™ä¸ªè¿œç¨‹è¿æ¥æ§åˆ¶å™¨ä¸­ï¼ˆå’ŒRemote sshæ˜¯åŒä¸€ä¸ªä½ç½®ï¼‰ï¼Œæ‰¾åˆ°ä¸Šæ–¹çš„ä¸‹æ‹‰æ¡ï¼Œæ”¹æˆWSLç›®æ ‡ï¼Œå°±èƒ½çœ‹åˆ°æˆ‘ä»¬çš„CentOS8è™šæ‹Ÿæœºã€‚ç‚¹å‡»è¿æ¥å®ƒå°±å¯ä»¥äº†ã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/10/344e4ab417ab6246fa14351b211f016c.png" alt="image-20231015111429863"></p><p>ä½†æ˜¯vscodeé»˜è®¤é“¾æ¥çš„æ˜¯rootç”¨æˆ·ï¼Œä¸€èˆ¬æƒ…å†µä¸‹è‚¯å®šä¸ä¼šåœ¨rootä¸‹å†™ä»£ç çš„ã€‚æ‰€ä»¥éœ€è¦é…ç½®ä¸€ä¸‹å­ç”¨æˆ·</p><p>ä¿®æ”¹è™šæ‹Ÿæœºä¸­çš„<code>/etc/wsl.conf</code>æ–‡ä»¶ï¼Œæ·»åŠ ä¸‹é¢ä¸¤è¡Œ</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[user]</span><br><span class="line">default=ç”¨æˆ·å</span><br></pre></td></tr></table></figure><p>ç„¶åå›åˆ°windowsçš„å‘½ä»¤è¡Œï¼Œé‡å¯wsl</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wsl --shutdown CentOS8</span><br></pre></td></tr></table></figure><p>å†æ¬¡å¯åŠ¨wslï¼Œè¿™æ ·vscå°±èƒ½é»˜è®¤é“¾æ¥ä½ çš„å­ç”¨æˆ·äº†ã€‚</p><h1 id="5-ä¿®æ”¹wslèµ„æºé™åˆ¶"><a href="#5-ä¿®æ”¹wslèµ„æºé™åˆ¶" class="headerlink" title="5.ä¿®æ”¹wslèµ„æºé™åˆ¶"></a>5.ä¿®æ”¹wslèµ„æºé™åˆ¶</h1><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<strong>wsl2çš„è™šæ‹Ÿæœºèƒ½è®¿é—®åˆ°å®Œæ•´çš„ç³»ç»Ÿèµ„æº</strong>ï¼ŒåŒ…æ‹¬æ‰€æœ‰CPUæ ¸å¿ƒå’Œå†…å­˜ã€‚</p><p>è¿™å°±ä¼šå¯¼è‡´å¦‚æœLinuxä¸‹å¯¹ä¸€äº›ä¸œè¥¿è¿›è¡Œäº†ç¼“å­˜è€Œæ²¡æœ‰åŠæ—¶æ¸…ç†ï¼ŒWindowsæ˜¯æ²¡åŠæ³•å›æ”¶è¿™éƒ¨åˆ†å†…å­˜çš„ã€‚<strong>æœ€ç»ˆå°±å¯¼è‡´æˆ‘ä»¬Windowså®¿ä¸»æœºæ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜å¯ç”¨äº†</strong>ï¼Œè¿™æ€ä¹ˆè¡Œï¼Ÿ</p><blockquote><p>è¿™ç§æƒ…å†µä¸‹ï¼Œä¸€èˆ¬windowsç³»ç»Ÿä¼šæŠŠwslç›´æ¥ç»™å¹²æ‰ï¼Œé‚£æˆ‘ä»¬è™šæ‹Ÿæœºé‡Œé¢è·‘çš„æ´»ä¹Ÿæ²¡åŠæ³•å®Œæˆäº†ã€‚è¦çŸ¥é“ï¼ŒLinuxå¯æ˜¯å¾ˆå–œæ¬¢cacheå†…å­˜çš„ï¼Œå¾ˆå®¹æ˜“ä¼šæŠŠå®¿ä¸»æœºçš„å†…å­˜ç»™å¹²æ²¡ã€‚</p></blockquote><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®wslçš„è™šæ‹Ÿæœºå†…å­˜&#x2F;CPUé™åˆ¶ã€‚</p><p>åœ¨<strong>Linuxä¸‹</strong>å¯ä»¥ç”¨è¿™ä¸¤ä¸ªå‘½ä»¤æ¥æŸ¥çœ‹cpuå’Œå†…å­˜çš„é…ç½®ä¿¡æ¯ï¼Œåˆšå¼€å§‹çš„æ—¶å€™åº”è¯¥æ˜¯å’Œä½ çš„å®¿ä¸»æœºçš„CPUå’Œå†…å­˜ä¸€æ ·ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /proc/cpuinfo | grep processor <span class="comment"># æŸ¥çœ‹cpuæ ¸å¿ƒæ•°é‡</span></span><br><span class="line"><span class="built_in">cat</span> /proc/meminfo | grep Total     <span class="comment"># æŸ¥çœ‹å†…å­˜ä¿¡æ¯</span></span><br></pre></td></tr></table></figure><p>åœ¨windowsçš„<strong>Cç›˜</strong>çš„<strong>ç”¨æˆ·æ–‡ä»¶å¤¹</strong>ä¸‹ï¼Œåˆ›å»ºä¸€ä¸ª<code>.wslconfig</code>æ–‡ä»¶ï¼Œå¹¶åœ¨å†…éƒ¨å†™å…¥é™åˆ¶</p><ul><li>processorsæ˜¯cpuæ ¸æ•°é™åˆ¶</li><li>memoryå’Œswapéƒ½æ˜¯å†…å­˜é™åˆ¶</li></ul><p>é¡¶å¤šè®¾ç½®ä¸ºå®¿ä¸»æœºå†…å­˜çš„ä¸€åŠï¼Œé¿å…å®¿ä¸»æœºå¡é¡¿ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[wsl2]</span><br><span class="line">processors=8</span><br><span class="line">memory=8GB</span><br><span class="line">swap=8GB</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªé…ç½®æ–‡ä»¶çš„è·¯å¾„æ˜¯ï¼ˆwindowsä¸‹ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\ä½ çš„ç”¨æˆ·å\.wslconfig</span><br></pre></td></tr></table></figure><p>éšååœ¨windowsçš„ç»ˆç«¯ä¸­ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼Œç»ˆæ­¢è¿™ä¸ªwslè™šæ‹Ÿæœº</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users\S2522\Desktop&gt; wsl --shutdown CentOS8</span><br><span class="line">PS C:\Users\S2522\Desktop&gt; wsl -l -v</span><br><span class="line">  NAME       STATE           VERSION</span><br><span class="line">* CentOS8    Stopped         2</span><br></pre></td></tr></table></figure><p>wslå‘½ä»¤ä¸­å¹¶æ²¡æœ‰<code>--start</code>é€‰é¡¹ï¼Œæˆ‘ä»¬ç›´æ¥ç”¨wslå‘½ä»¤ï¼Œå°±ä¼šè‡ªåŠ¨é‡å¯å¹¶è¿›å…¥è¿™ä¸ªè™šæ‹Ÿæœºã€‚</p><p>è¿™æ—¶å€™å†åœ¨è™šæ‹Ÿæœºå†…éƒ¨çœ‹çœ‹CPUå’Œå†…å­˜ä¿¡æ¯ï¼Œå°±å¯ä»¥çœ‹åˆ°ä½ åˆšåˆšé…ç½®çš„æ€§èƒ½é™åˆ¶ç»“æœäº†ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@7945R9P ~]# cat /proc/cpuinfo | grep processor</span><br><span class="line">processor       : 0</span><br><span class="line">processor       : 1</span><br><span class="line">processor       : 2</span><br><span class="line">processor       : 3</span><br><span class="line">processor       : 4</span><br><span class="line">processor       : 5</span><br><span class="line">processor       : 6</span><br><span class="line">processor       : 7</span><br><span class="line">[root@7945R9P ~]# cat /proc/meminfo | grep Total</span><br><span class="line">MemTotal:        8136640 kB</span><br><span class="line">SwapTotal:       8388608 kB</span><br><span class="line">VmallocTotal:   34359738367 kB</span><br><span class="line">HugePages_Total:       0</span><br></pre></td></tr></table></figure><h2 id="åˆ é™¤wslä¸»æœº"><a href="#åˆ é™¤wslä¸»æœº" class="headerlink" title="åˆ é™¤wslä¸»æœº"></a>åˆ é™¤wslä¸»æœº</h2><p>åˆ é™¤è™šæ‹Ÿæœºçš„å‘½ä»¤å¦‚ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wsl --unregister &lt;DistributionName&gt;</span><br></pre></td></tr></table></figure><p>æ›´å¤šå‘½ä»¤å‚è€ƒå¾®è½¯å®˜ç½‘ <a href="https://learn.microsoft.com/zh-cn/windows/wsl/basic-commands">https://learn.microsoft.com/zh-cn/windows/wsl/basic-commands</a></p><h1 id="6-å¯ç”¨systemctl"><a href="#6-å¯ç”¨systemctl" class="headerlink" title="6.å¯ç”¨systemctl"></a>6.å¯ç”¨systemctl</h1><p>æˆ‘ä»¬çš„ç³»ç»Ÿé‡Œé¢æœ‰systemctlå‘½ä»¤ï¼Œä½†æ˜¯æ²¡æœ‰åŠæ³•ä½¿ç”¨ã€‚ç½‘ä¸Šæœ‰äº›æ•™ç¨‹è¯´ç”¨serviceå‘½ä»¤æ¥æ›¿ä»£ï¼Œä½†CentOSä¸­æ˜¯æ²¡æœ‰serviceå‘½ä»¤çš„ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@7945R9P bison-3.8]# systemctl</span><br><span class="line">System has not been booted with systemd as init system (PID 1). Can&#x27;t operate.</span><br><span class="line">Failed to connect to bus: Host is down</span><br></pre></td></tr></table></figure><h2 id="6-1-distrod-ç¬¬ä¸‰æ–¹å·¥å…·"><a href="#6-1-distrod-ç¬¬ä¸‰æ–¹å·¥å…·" class="headerlink" title="6.1 distrod ç¬¬ä¸‰æ–¹å·¥å…·"></a>6.1 distrod ç¬¬ä¸‰æ–¹å·¥å…·</h2><p>æˆ‘ä»¬éœ€è¦ç”¨distrodæ¥å®‰è£…systemctlçš„ç»„ä»¶ï¼Œæ‰èƒ½æˆåŠŸå¯ç”¨å®ƒã€‚å…·ä½“æ•™ç¨‹å‚è€ƒgithubä»“åº“çš„READMEä¸­çš„ä»‹ç»ã€‚ä¸æ˜¯å¾ˆéš¾</p><blockquote><p><a href="https://github.com/nullpo-head/wsl-distrod">https://github.com/nullpo-head/wsl-distrod</a></p></blockquote><p>å…ˆä¸‹è½½ä¸€ä¸ªè‡ªåŠ¨å®‰è£…çš„è„šæœ¬ï¼ˆè¿ä¸ä¸Šgithubä¼šæŠ¥sslæˆ–è€…timeouté”™è¯¯ï¼Œè¯·ä½¿ç”¨å…¶ä»–åŠæ³•ä¸‹è½½è¿™ä¸ªè„šæœ¬å†ä¸¢åˆ°è™šæ‹Ÿæœºé‡Œé¢å»å°±è¡Œï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl -L -O &quot;https://raw.githubusercontent.com/nullpo-head/wsl-distrod/main/install.sh&quot;</span><br><span class="line">chmod +x install.sh</span><br><span class="line">sudo ./install.sh install</span><br></pre></td></tr></table></figure><p>ç„¶åç”¨ä¸‹é¢ä¸¤ä¸ªå‘½ä»¤ä¹‹ä¸€æ¥å¯åŠ¨ï¼ˆç¬¬ä¸€ä¸ªå‘½ä»¤æ˜¯ä¼šåœ¨windowså¼€æœºè‡ªåŠ¨å¯åŠ¨çš„ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/opt/distrod/bin/distrod enable --start-on-windows-boot</span><br><span class="line">/opt/distrod/bin/distrod enable</span><br></pre></td></tr></table></figure><p>æ›´å¤šå†…å®¹ç›¸è§<a href="https://github.com/nullpo-head/wsl-distrod">è¯¥ä»“åº“README</a>ï¼›</p><p>è¯·æ³¨æ„ï¼Œæ‰§è¡Œç¬¬ä¸€ä¸ªè‡ªå¯åŠ¨å‘½ä»¤çš„æ—¶å€™éœ€è¦windowsçš„ç®¡ç†å‘˜æƒé™ï¼Œæ­¤æ—¶éœ€è¦è¾“å…¥çš„æ˜¯ç³»ç»Ÿç™»å½•çš„å¾®è½¯è´¦æˆ·çš„å¯†ç ï¼ˆä¸æ˜¯ä½ çš„PINï¼‰ï¼Œçœ‹ä¸‹é¢ï¼Œæˆ‘ç¬¬ä¸€æ¬¡è¾“å…¥å¯†ç è¾“å…¥çš„å°±æ˜¯PINï¼Œæ˜¾ç¤ºé”™è¯¯ï¼Œç¬¬äºŒæ¬¡è¾“å…¥äº†å¾®è½¯è´¦æˆ·çš„å¯†ç æ‰æˆåŠŸã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@7945R9P pkg]# /opt/distrod/bin/distrod enable --start-on-windows-boot</span><br><span class="line">[Distrod] Distrod has been enabled. Now your shell will start under systemd.</span><br><span class="line">[Distrod] Enabling atuomatic startup of Distrod. UAC dialog will appear because scheduling</span><br><span class="line">a task requires the admin privilege. Please hit enter to proceed.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Error</span><br><span class="line">It seems the task has not been scheduled successfully. You may have typed a wrong password, or you may not have the</span><br><span class="line">necessary administrative privileges. Do you want to retry?</span><br><span class="line">[Y] Yes  [N] No  [?] å¸®åŠ© (é»˜è®¤å€¼ä¸ºâ€œYâ€): y</span><br><span class="line">Enabling autostart has succeeded.</span><br><span class="line">[Distrod] Distrod will now start automatically on Windows startup.</span><br></pre></td></tr></table></figure><p>æ“ä½œå®Œæˆåï¼Œéœ€è¦é‡å¯è™šæ‹Ÿæœºã€‚ç”¨å¦‚ä¸‹å‘½ä»¤å°†å¯¹åº”çš„wslè™šæ‹Ÿæœºå…³é—­å°±è¡Œäº†ï¼Œå†æ¬¡æ‰§è¡Œwslå°±ä¼šé‡å¯è¿™ä¸ªè™šæ‹Ÿæœºã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wsl --terminate CentOS8</span><br></pre></td></tr></table></figure><p>å¦‚å›¾ï¼Œæˆ‘çš„systemctlå‘½ä»¤å·²ç»ç”Ÿæ•ˆã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/10/9340e7964572037fbd3b58f1b379b177.png" alt="image-20231015150251531"></p><p>ä¹Ÿèƒ½æ­£å¸¸é€šè¿‡systemctlå‘½ä»¤å¯åŠ¨mariadbæ•°æ®åº“</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/10/6edf311cf4a5dd1749328456a0008255.png" alt="image-20231015150404823"></p><h2 id="6-2-å¾®è½¯å®˜æ–¹ï¼ˆæ¨èï¼‰"><a href="#6-2-å¾®è½¯å®˜æ–¹ï¼ˆæ¨èï¼‰" class="headerlink" title="6.2 å¾®è½¯å®˜æ–¹ï¼ˆæ¨èï¼‰"></a>6.2 å¾®è½¯å®˜æ–¹ï¼ˆæ¨èï¼‰</h2><blockquote><p>å‚è€ƒ <a href="https://zhuanlan.zhihu.com/p/569883693">https://zhuanlan.zhihu.com/p/569883693</a></p></blockquote><p>æŸ¥çœ‹wslç‰ˆæœ¬å·å‘½ä»¤ä¸ºï¼š <code>wsl --version</code>ï¼Œå¦‚æœæ­¤å‘½ä»¤æœªæ­£å¸¸å›æ˜¾ç‰ˆæœ¬å·ï¼Œæˆ–ç‰ˆæœ¬å·ä½äº<code>0.67.6</code>ï¼Œé‚£ä¹ˆä½ å®‰è£…çš„wslè¿˜ä¸æ”¯æŒsystemdã€‚å¦‚ä¸‹ï¼Œæˆ‘çš„wslç‰ˆæœ¬å·²ç»æ˜¯æ”¯æŒçš„äº†ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users\S2522\Desktop&gt; wsl --version</span><br><span class="line">WSL ç‰ˆæœ¬ï¼š 1.2.5.0</span><br><span class="line">å†…æ ¸ç‰ˆæœ¬ï¼š 5.15.90.1</span><br><span class="line">WSLg ç‰ˆæœ¬ï¼š 1.0.51</span><br><span class="line">MSRDC ç‰ˆæœ¬ï¼š 1.2.3770</span><br><span class="line">Direct3D ç‰ˆæœ¬ï¼š 1.608.2-61064218</span><br><span class="line">DXCore ç‰ˆæœ¬ï¼š 10.0.25131.1002-220531-1700.rs-onecore-base2-hyp</span><br><span class="line">Windows ç‰ˆæœ¬ï¼š 10.0.22621.2134</span><br></pre></td></tr></table></figure><p>è¿›å…¥wslçš„CentOSè™šæ‹Ÿæœºï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;[boot]\nsystemd=true&quot;</span> | sudo <span class="built_in">tee</span> -a /etc/wsl.conf</span><br></pre></td></tr></table></figure><p>éšåexité€€å‡ºè™šæ‹Ÿæœºï¼Œ<strong>å›åˆ°windowsç»ˆç«¯å‘½ä»¤è¡Œ</strong>ï¼Œé‡å¯wsl</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wsl <span class="literal">--shutdown</span></span><br></pre></td></tr></table></figure><p>éšåå†æ¬¡åœ¨windowså‘½ä»¤è¡Œä¸‹æ‰§è¡Œwslå‘½ä»¤ï¼Œé‡å¯è¿™ä¸ªè™šæ‹Ÿæœºï¼›</p><p>é‡å¯wslè™šæ‹Ÿæœºåï¼Œåœ¨<strong>è™šæ‹Ÿæœºå†…éƒ¨</strong>æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps --no-headers -o <span class="built_in">comm</span> 1</span><br></pre></td></tr></table></figure><ul><li>å¦‚æœè¿™ä¸ªå‘½ä»¤è¿”å›ç»“æœæ˜¯<strong>systemd</strong>ï¼Œåˆ™ä»£è¡¨æˆ‘ä»¬çš„<code>systemctl</code>å‘½ä»¤å·²ç»å¯ä»¥ä½¿ç”¨ã€‚</li><li>å¦‚æœè¿”å›çš„æ˜¯<code>init</code>ï¼Œåˆ™è®¾ç½®å¤±è´¥</li></ul><p>å¦‚ä¸‹å›¾ï¼Œæˆ‘å·²ç»è®¾ç½®æˆåŠŸäº†ï¼</p><p><img src= "/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/10/a072fdd5b53abc04cf444c1ab0ac9ad2.png" alt="image-20231015204810685"></p><p>å¾®è½¯å®˜æ–¹æ”¯æŒçš„systemdè¿˜æ˜¯æœ‰ä¸€ç‚¹æ˜¯ä¼˜äºdistrodçš„ï¼Œé‚£å°±æ˜¯å¯ç”¨äº†å®˜æ–¹ systemd çš„ wsl2 å®ä¾‹ï¼Œåœ¨ç”¨æˆ·åœæ­¢æ“ä½œåï¼Œ<strong>ä¼šè‡ªåŠ¨å…³é—­</strong>ï¼Œå’Œæœªå¯ç”¨ systemd æ—¶çš„ç‰¹æ€§ä¸€æ ·ï¼Œè¿™æœ‰åˆ©äºèŠ‚çº¦ç”µè„‘çš„è®¡ç®—èµ„æºã€‚</p>]]></content>
    
    
    <summary type="html">win11å®‰è£…wslå’ŒCentOS8Streamè™šæ‹Ÿæœº</summary>
    
    
    
    <category term="ç©ä¸ŠLinux" scheme="https://blog.musnow.top/categories/%E7%8E%A9%E4%B8%8ALinux/"/>
    
    
    <category term="Linux" scheme="https://blog.musnow.top/tags/Linux/"/>
    
    <category term="è™šæ‹Ÿæœº" scheme="https://blog.musnow.top/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA/"/>
    
    <category term="wsl" scheme="https://blog.musnow.top/tags/wsl/"/>
    
  </entry>
  
</feed>
