<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"><title>【MySQL】基础命令操作 | 慕雪的寒舍</title><meta name="author" content="慕雪年华"><meta name="copyright" content="慕雪年华"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="MySQL的基础SQL命令"><meta property="og:type" content="article"><meta property="og:title" content="【MySQL】基础命令操作"><meta property="og:url" content="https://blog.musnow.top/posts/2109090510/index.html"><meta property="og:site_name" content="慕雪的寒舍"><meta property="og:description" content="MySQL的基础SQL命令"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://img.musnow.top/i/2023/04/64302610057ae.png"><meta property="article:published_time" content="2023-04-07T08:32:14.000Z"><meta property="article:modified_time" content="2024-10-26T05:39:28.000Z"><meta property="article:author" content="慕雪年华"><meta property="article:tag" content="Linux"><meta property="article:tag" content="mysql"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://img.musnow.top/i/2023/04/64302610057ae.png"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="https://blog.musnow.top/posts/2109090510/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"><meta name="google-site-verification" content="iR4A6ntiwhI9JX_YDe2ZFY6DerPD7c-NaLyIDlrDguY"><meta name="msvalidate.01" content="D5CD621F38EE3FB5071F785AD4977161"><meta name="baidu-site-verification" content="codeva-aZGKJiqRSI"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.19/fancybox/fancybox.min.css" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.json","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: {"limitDay":180,"position":"top","messagePrev":"距离上次更新本文已经过去了","messageNext":"天，文章部分内容可能已经过时，请注意甄别"},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":420},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":600,"languages":{"author":"作者: 慕雪年华","link":"链接: ","source":"来源: 慕雪的寒舍","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdnjs.cloudflare.com/ajax/libs/flickr-justified-gallery/2.1.2/fjGallery.min.js',
      css: 'https://cdnjs.cloudflare.com/ajax/libs/flickr-justified-gallery/2.1.2/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"【MySQL】基础命令操作",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2024-10-26 13:39:28"}</script><noscript><style type="text/css">#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/equipment/equipment.css?1"><link rel="stylesheet" href="/rating/rating.css?1"><script>!function(r){"use strict";!function(){var t=window,s=document,e=r,c="".concat("https:"===s.location.protocol?"https://":"http://","sdk.51.la/js-sdk-pro.min.js"),i=s.createElement("script"),n=s.getElementsByTagName("script")[0];i.type="text/javascript",i.setAttribute("charset","UTF-8"),i.async=!0,i.src=c,i.id="LA_COLLECT",e.d=i;function o(){t.LA.ids.push(e)}t.LA?t.LA.ids&&o():(t.LA=r,t.LA.ids=[],o()),n.parentNode.insertBefore(i,n)}()}({id:"JwxEfuZ8fwQ1GPEq",ck:"JwxEfuZ8fwQ1GPEq"})</script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="慕雪的寒舍" type="application/atom+xml"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/favicon.jpg" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">431</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">73</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">21</div></a></div><hr class="custom-hr"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 归档</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 文章</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/rating/"><i class="fa-fw fas fa-film"></i><span> 书·影</span></a></div><div class="menus_item"><a class="site-page" href="/qa/"><i class="fa-fw fa-fw fas fa-comment-dots"></i><span> 留言</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-user-friends"></i><span> 友人</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li><li><a class="site-page child" href="/fcircle/"><i class="fa-fw fas fa-link"></i><span> 朋友圈</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://www.travellings.cn/go.html"><i class="fa-fw fas fa-train"></i><span> 开往</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://www.foreverblog.cn/go.html"><i class="fa-fw fab fa-superpowers"></i><span> 虫洞</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://travel.moe/go.html?travel=on"><i class="fa-fw fas fa-globe-americas"></i><span> 异次元</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-glass-whiskey"></i><span> 镜像</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="https://blog.musnow.top/?utm_source=mirror"><i class="fa-fw fas fa-home"></i><span> Main</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://blog1.musnow.top/?utm_source=mirror"><i class="fa-fw fa-brands fa-battle-net"></i><span> Netlify</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://musnows.github.io/?utm_source=mirror"><i class="fa-fw fa-brands fa-square-github"></i><span> Github</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://blog2.musnow.top/?utm_source=mirror"><i class="fa-fw fa-solid fa-square-caret-up"></i><span> Vercel</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://blog3.musnow.top/?utm_source=mirror"><i class="fa-fw fas fa-cloud"></i><span> Cloudflare</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://keep-hexo.musnow.top/?utm_source=mirror"><i class="fa-fw fa-brands fa-kickstarter"></i><span> KeepTheme</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://musnow.blog.csdn.net/"><i class="fa-fw fas fa-copyright"></i><span> CSDN</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://blog.51cto.com/u_15307009"><i class="fa-fw fas fa-dice-five"></i><span> 51CTO</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fab fa-blackberry"></i><span> 更多</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page child" href="/gallery/"><i class="fa-fw fas fa-images"></i><span> 画廊</span></a></li><li><a class="site-page child" href="/equipment/"><i class="fa-fw fas fa-laptop"></i><span> 背包</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://memos.musnow.top"><i class="fa-fw fas fa-map-signs"></i><span> 说说</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://stats.uptimerobot.com/qrNpVSLkgV"><i class="fa-fw fas fa-chart-bar"></i><span> Uptime</span></a></li><li><a class="site-page child" href="/atom.xml"><i class="fa-fw fas fa-rss-square"></i><span> RSS</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image:url(https://img.musnow.top/i/2023/04/64302610057ae.png)"><nav id="nav"><span id="blog-info"><a href="/" title="慕雪的寒舍"><img class="site-icon" src="/favicon.jpg"><span class="site-name">慕雪的寒舍</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 归档</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 文章</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/rating/"><i class="fa-fw fas fa-film"></i><span> 书·影</span></a></div><div class="menus_item"><a class="site-page" href="/qa/"><i class="fa-fw fa-fw fas fa-comment-dots"></i><span> 留言</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-user-friends"></i><span> 友人</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li><li><a class="site-page child" href="/fcircle/"><i class="fa-fw fas fa-link"></i><span> 朋友圈</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://www.travellings.cn/go.html"><i class="fa-fw fas fa-train"></i><span> 开往</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://www.foreverblog.cn/go.html"><i class="fa-fw fab fa-superpowers"></i><span> 虫洞</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://travel.moe/go.html?travel=on"><i class="fa-fw fas fa-globe-americas"></i><span> 异次元</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-glass-whiskey"></i><span> 镜像</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="https://blog.musnow.top/?utm_source=mirror"><i class="fa-fw fas fa-home"></i><span> Main</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://blog1.musnow.top/?utm_source=mirror"><i class="fa-fw fa-brands fa-battle-net"></i><span> Netlify</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://musnows.github.io/?utm_source=mirror"><i class="fa-fw fa-brands fa-square-github"></i><span> Github</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://blog2.musnow.top/?utm_source=mirror"><i class="fa-fw fa-solid fa-square-caret-up"></i><span> Vercel</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://blog3.musnow.top/?utm_source=mirror"><i class="fa-fw fas fa-cloud"></i><span> Cloudflare</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://keep-hexo.musnow.top/?utm_source=mirror"><i class="fa-fw fa-brands fa-kickstarter"></i><span> KeepTheme</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://musnow.blog.csdn.net/"><i class="fa-fw fas fa-copyright"></i><span> CSDN</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://blog.51cto.com/u_15307009"><i class="fa-fw fas fa-dice-five"></i><span> 51CTO</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fab fa-blackberry"></i><span> 更多</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page child" href="/gallery/"><i class="fa-fw fas fa-images"></i><span> 画廊</span></a></li><li><a class="site-page child" href="/equipment/"><i class="fa-fw fas fa-laptop"></i><span> 背包</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://memos.musnow.top"><i class="fa-fw fas fa-map-signs"></i><span> 说说</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://stats.uptimerobot.com/qrNpVSLkgV"><i class="fa-fw fas fa-chart-bar"></i><span> Uptime</span></a></li><li><a class="site-page child" href="/atom.xml"><i class="fa-fw fas fa-rss-square"></i><span> RSS</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">【MySQL】基础命令操作</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-04-07T08:32:14.000Z" title="发表于 2023-04-07 16:32:14">2023-04-07</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-10-26T05:39:28.000Z" title="更新于 2024-10-26 13:39:28">2024-10-26</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%BC%96%E7%A8%8B%E5%AD%A6%E4%B9%A0/">编程学习</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%BC%96%E7%A8%8B%E5%AD%A6%E4%B9%A0/%E6%95%B0%E6%8D%AE%E5%BA%93SQL/">数据库SQL</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">18.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>77分钟</span></span><span class="post-meta-separator">|</span><span data-flag-title="【MySQL】基础命令操作"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="ArtalkPV"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>本文记录了MySQL的基础SQL命令。</p><span id="more"></span><p>本文演示所用mariadb版本，可以认为其与MySQL8对应。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql  Ver 15.1 Distrib 10.3.28-MariaDB, for Linux (x86_64) using readline 5.1</span><br></pre></td></tr></table></figure><h2 id="前言：SQL语句的分类"><a href="#前言：SQL语句的分类" class="headerlink" title="前言：SQL语句的分类"></a>前言：SQL语句的分类</h2><p>学习MySQL之前，我们先了解一下MySQL中SQL的分类</p><ul><li>DDL【data definition language】 数据定义语言，用来维护存储数据的结构。代表指令: <code>create, drop, alter</code></li><li>DML【data manipulation language】 数据操纵语言，用来对数据进行操作。代表指令： <code>insert，delete，update</code><ul><li>DML中又单独分了一个<code>DQL</code>，数据查询语言，代表指令： <code>select</code></li></ul></li><li>DCL【Data Control Language】 数据控制语言，主要负责权限管理和事务。 代表指令： <code>grant，revoke，commit</code></li></ul><h2 id="0-连接mysql"><a href="#0-连接mysql" class="headerlink" title="0.连接mysql"></a>0.连接mysql</h2><p>默认情况下，我们的mysql没有密码，直接使用如下命令，就能链接上mysql</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot</span><br></pre></td></tr></table></figure><p>mysql数据库文件路径</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/var/lib/mysql</span><br></pre></td></tr></table></figure><p>mysql的语句是大小写不敏感的，大小写都可以。</p><p>如果你的MySQL有密码，那就是用如下命令进入MySQL命令行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -p123456 <span class="comment"># 示例</span></span><br><span class="line">mysql -u用户名 -p密码  <span class="comment"># 基本操作</span></span><br></pre></td></tr></table></figure><h3 id="0-1-查看有谁连接了"><a href="#0-1-查看有谁连接了" class="headerlink" title="0.1 查看有谁连接了"></a>0.1 查看有谁连接了</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> processlist;</span><br></pre></td></tr></table></figure><p>该命令可以查看当前有谁连接了MySQL服务，所在数据库是什么，正在执行的cmd是什么</p><p><img src="/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/04/643a5694b058a.png" alt="image-20230415154733573"></p><h3 id="0-2-查看支持的存储引擎"><a href="#0-2-查看支持的存储引擎" class="headerlink" title="0.2 查看支持的存储引擎"></a>0.2 查看支持的存储引擎</h3><p>mysql支持多种<strong>存储引擎</strong></p><blockquote><p>存储引擎是：数据库管理系统如何存储数据、如何为存储的数据建立索引和如何更新、查询数据等技术的实现方法。</p></blockquote><p>每个引擎各有其优势。可以用下面的语句查询当前支持的引擎</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show engines;</span><br></pre></td></tr></table></figure><p><img src="/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/04/643a14d11ee29.png" alt="image-20230415110657396"></p><h2 id="1-数据库"><a href="#1-数据库" class="headerlink" title="1.数据库"></a>1.数据库</h2><h3 id="1-1-创建"><a href="#1-1-创建" class="headerlink" title="1.1 创建"></a>1.1 创建</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">create database 数据库名字;</span><br><span class="line">create database if not exists 数据库名字; # 如果不存在才创建</span><br><span class="line">create database hello;</span><br></pre></td></tr></table></figure><p>上面的命令创建了一个名为<code>hello</code>的数据库。对于mysql服务端而言，其实际上是在数据文件路径中，帮我们创建了一个对应的文件夹</p><p><img src="/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/04/643a12c188e01.png" alt="image-20230415105802521"></p><p>如果是<code>mysql5.7</code>，在创建语句之前新增一个<code>show</code>，可以看到当前执行语句的详细信息。我当前使用的是高版本的mariadb，<strong>不支持这个操作</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show create database hello;</span><br></pre></td></tr></table></figure><p>创建数据库或者表的时候，我们还可以给名称带上如下符号作为分割符</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create database `数据库名称`;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [(none)]&gt; create database `test2`;</span><br><span class="line">Query OK, 1 row affected (0.001 sec)</span><br></pre></td></tr></table></figure><p>带上该符号后，可以用于区分你的表名和数据库的内置语句。建议创建、删除操作的时候，都给名字带上这个符号。</p><p>当然，创建的数据库、表名最好<strong>不要</strong>和<code>mysql</code>内置语句冲突，这和写代码的时候不要用编程语言的关键字&#x2F;库函数名来命名变量一样。</p><h3 id="1-2-查看已有"><a href="#1-2-查看已有" class="headerlink" title="1.2 查看已有"></a>1.2 查看已有</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show databases;</span><br></pre></td></tr></table></figure><p>查看当前已有数据库</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| hello              |</span><br><span class="line">| information_schema |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">+--------------------+</span><br><span class="line">4 rows in set (0.001 sec)</span><br></pre></td></tr></table></figure><h3 id="1-3-进入"><a href="#1-3-进入" class="headerlink" title="1.3 进入"></a>1.3 进入</h3><p>进入这个数据库</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">use hello;</span><br></pre></td></tr></table></figure><h3 id="1-4-删除"><a href="#1-4-删除" class="headerlink" title="1.4 删除"></a>1.4 删除</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drop database [if exists] 名字;</span><br></pre></td></tr></table></figure><p>如下，我先是创建了一个<code>test1</code>数据库</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [(none)]&gt; create database test1;</span><br><span class="line">Query OK, 1 row affected (0.001 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; show databases;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| hello              |</span><br><span class="line">| information_schema |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| test1              |</span><br><span class="line">+--------------------+</span><br><span class="line">5 rows in set (0.000 sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>用下面这个命令删除该数据库</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drop database test1;</span><br></pre></td></tr></table></figure><p>成功删除</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [(none)]&gt; drop database test1;</span><br><span class="line">Query OK, 0 rows affected (0.035 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; show databases;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| hello              |</span><br><span class="line">| information_schema |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">+--------------------+</span><br><span class="line">4 rows in set (0.001 sec)</span><br></pre></td></tr></table></figure><p>数据文件路径中，test1文件夹也被对应删除</p><p><img src="/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/04/643a12fe84e1e.png" alt="image-20230415105910841"></p><h3 id="1-5-字符集和校验规则"><a href="#1-5-字符集和校验规则" class="headerlink" title="1.5 字符集和校验规则"></a>1.5 字符集和校验规则</h3><p>字符集会有自己对应的校验规则</p><ul><li>字符集用于将数据以特定编码<strong>存入</strong>数据库</li><li>校验规则用于<strong>取</strong>数据时对数据进行校验</li></ul><p>修改字符集的时候，mysql会为我们自动指定对应的校验规则</p><h4 id="1-5-1-字符集"><a href="#1-5-1-字符集" class="headerlink" title="1.5.1 字符集"></a>1.5.1 字符集</h4><p>一个数据被存放的时候，是会有其所用的编码的。编码不相同，会导致数据在不同软件中显示出不同的结果。</p><blockquote><p>比如 我们使用VS写的C语言代码，文件内的中文注释放入<code>devc++</code>之中，有可能会乱码，这就是字符编码不匹配的原因</p></blockquote><p><code>show variables like</code>语句可以查看mysql的内置变量，其中如下变量就是数据库字符集的编码格式</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show variables like &#x27;character_set_database&#x27;;</span><br></pre></td></tr></table></figure><p>可以看到，为<code>utf-8</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">+------------------------+-------+</span><br><span class="line">| Variable_name          | Value |</span><br><span class="line">+------------------------+-------+</span><br><span class="line">| character_set_database | utf8  |</span><br><span class="line">+------------------------+-------+</span><br><span class="line">1 row in set (0.002 sec)</span><br></pre></td></tr></table></figure><p>在配置mariadb的时候，就已经修改过了配置文件中数据库的编码规则，所以所有相关字符集编码都是<code>utf-8</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show variables like &#x27;character_set_%&#x27;;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [(none)]&gt; show variables like &#x27;character_set_%&#x27;;</span><br><span class="line">+--------------------------+------------------------------+</span><br><span class="line">| Variable_name            | Value                        |</span><br><span class="line">+--------------------------+------------------------------+</span><br><span class="line">| character_set_client     | utf8                         |</span><br><span class="line">| character_set_connection | utf8                         |</span><br><span class="line">| character_set_database   | utf8                         |</span><br><span class="line">| character_set_filesystem | binary                       |</span><br><span class="line">| character_set_results    | utf8                         |</span><br><span class="line">| character_set_server     | utf8                         |</span><br><span class="line">| character_set_system     | utf8                         |</span><br><span class="line">| character_sets_dir       | /usr/share/mariadb/charsets/ |</span><br><span class="line">+--------------------------+------------------------------+</span><br><span class="line">8 rows in set (0.002 sec)</span><br></pre></td></tr></table></figure><p>使用如下命令可以查看数据库支持的所有编码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show charset;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [(none)]&gt; show charset;</span><br><span class="line">+----------+-----------------------------+---------------------+--------+</span><br><span class="line">| Charset  | Description                 | Default collation   | Maxlen |</span><br><span class="line">+----------+-----------------------------+---------------------+--------+</span><br><span class="line">| big5     | Big5 Traditional Chinese    | big5_chinese_ci     |      2 |</span><br><span class="line">| dec8     | DEC West European           | dec8_swedish_ci     |      1 |</span><br><span class="line">| cp850    | DOS West European           | cp850_general_ci    |      1 |</span><br><span class="line">| hp8      | HP West European            | hp8_english_ci      |      1 |</span><br><span class="line">| koi8r    | KOI8-R Relcom Russian       | koi8r_general_ci    |      1 |</span><br><span class="line">| latin1   | cp1252 West European        | latin1_swedish_ci   |      1 |</span><br><span class="line">| latin2   | ISO 8859-2 Central European | latin2_general_ci   |      1 |</span><br><span class="line">| swe7     | 7bit Swedish                | swe7_swedish_ci     |      1 |</span><br><span class="line">| ascii    | US ASCII                    | ascii_general_ci    |      1 |</span><br><span class="line">| ujis     | EUC-JP Japanese             | ujis_japanese_ci    |      3 |</span><br><span class="line">| sjis     | Shift-JIS Japanese          | sjis_japanese_ci    |      2 |</span><br><span class="line">| hebrew   | ISO 8859-8 Hebrew           | hebrew_general_ci   |      1 |</span><br><span class="line">| tis620   | TIS620 Thai                 | tis620_thai_ci      |      1 |</span><br><span class="line">| euckr    | EUC-KR Korean               | euckr_korean_ci     |      2 |</span><br><span class="line">| koi8u    | KOI8-U Ukrainian            | koi8u_general_ci    |      1 |</span><br><span class="line">| gb2312   | GB2312 Simplified Chinese   | gb2312_chinese_ci   |      2 |</span><br><span class="line">| greek    | ISO 8859-7 Greek            | greek_general_ci    |      1 |</span><br><span class="line">| cp1250   | Windows Central European    | cp1250_general_ci   |      1 |</span><br><span class="line">| gbk      | GBK Simplified Chinese      | gbk_chinese_ci      |      2 |</span><br><span class="line">| latin5   | ISO 8859-9 Turkish          | latin5_turkish_ci   |      1 |</span><br><span class="line">| armscii8 | ARMSCII-8 Armenian          | armscii8_general_ci |      1 |</span><br><span class="line">| utf8     | UTF-8 Unicode               | utf8_general_ci     |      3 |</span><br><span class="line">| ucs2     | UCS-2 Unicode               | ucs2_general_ci     |      2 |</span><br><span class="line">| cp866    | DOS Russian                 | cp866_general_ci    |      1 |</span><br><span class="line">| keybcs2  | DOS Kamenicky Czech-Slovak  | keybcs2_general_ci  |      1 |</span><br><span class="line">| macce    | Mac Central European        | macce_general_ci    |      1 |</span><br><span class="line">| macroman | Mac West European           | macroman_general_ci |      1 |</span><br><span class="line">| cp852    | DOS Central European        | cp852_general_ci    |      1 |</span><br><span class="line">| latin7   | ISO 8859-13 Baltic          | latin7_general_ci   |      1 |</span><br><span class="line">| utf8mb4  | UTF-8 Unicode               | utf8mb4_general_ci  |      4 |</span><br><span class="line">| cp1251   | Windows Cyrillic            | cp1251_general_ci   |      1 |</span><br><span class="line">| utf16    | UTF-16 Unicode              | utf16_general_ci    |      4 |</span><br><span class="line">| utf16le  | UTF-16LE Unicode            | utf16le_general_ci  |      4 |</span><br><span class="line">| cp1256   | Windows Arabic              | cp1256_general_ci   |      1 |</span><br><span class="line">| cp1257   | Windows Baltic              | cp1257_general_ci   |      1 |</span><br><span class="line">| utf32    | UTF-32 Unicode              | utf32_general_ci    |      4 |</span><br><span class="line">| binary   | Binary pseudo charset       | binary              |      1 |</span><br><span class="line">| geostd8  | GEOSTD8 Georgian            | geostd8_general_ci  |      1 |</span><br><span class="line">| cp932    | SJIS for Windows Japanese   | cp932_japanese_ci   |      2 |</span><br><span class="line">| eucjpms  | UJIS for Windows Japanese   | eucjpms_japanese_ci |      3 |</span><br><span class="line">+----------+-----------------------------+---------------------+--------+</span><br><span class="line">40 rows in set (0.001 sec)</span><br></pre></td></tr></table></figure><h4 id="1-5-2-校验规则"><a href="#1-5-2-校验规则" class="headerlink" title="1.5.2 校验规则"></a>1.5.2 校验规则</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show variables like &#x27;collation_%&#x27;;</span><br></pre></td></tr></table></figure><p>如下可以看到，当前的校验规则都是<code>utf-8</code>相关的</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [(none)]&gt; show variables like &#x27;collation_%&#x27;;</span><br><span class="line">+----------------------+-----------------+</span><br><span class="line">| Variable_name        | Value           |</span><br><span class="line">+----------------------+-----------------+</span><br><span class="line">| collation_connection | utf8_general_ci |</span><br><span class="line">| collation_database   | utf8_general_ci |</span><br><span class="line">| collation_server     | utf8_general_ci |</span><br><span class="line">+----------------------+-----------------+</span><br><span class="line">3 rows in set (0.001 sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>查看系统中所有校验集</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show collation;</span><br></pre></td></tr></table></figure><p>结果很长，就不全贴出来了。能看到每一个编码集都对应了一个字符集</p><p><img src="/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/04/643a1d27ea9d4.png" alt="image-20230415114232320"></p><h4 id="1-5-3-创建库时指定"><a href="#1-5-3-创建库时指定" class="headerlink" title="1.5.3 创建库时指定"></a>1.5.3 创建库时指定</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CREATE DATABASE [IF NOT EXISTS] db_name [create_specification [,</span><br><span class="line">create_specification] ...]</span><br><span class="line"></span><br><span class="line">create_specification:</span><br><span class="line">    [DEFAULT] CHARACTER SET charset_name</span><br><span class="line">    [DEFAULT] COLLATE collation_name</span><br></pre></td></tr></table></figure><p>其中<code>[]</code>代表是可选项</p><ul><li>CHARACTER SET 指定数据库采用的字符集</li><li>COLLATE 指定数据库字符集的校验规则</li></ul><p>如果在创建数据库时没有指定字符集和校验规则，则会采用数据库默认的。</p><p>在数据库的文件夹中，有一个<code>db.opt</code>文件，其中就包含了当前数据库使用的字符集和校验规则</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@1c2261732150:/var/lib/mysql]# ls hello</span><br><span class="line">db.opt  stu_test.frm  stu_test.ibd</span><br><span class="line">[root@1c2261732150:/var/lib/mysql]# cat hello/db.opt</span><br><span class="line">default-character-set=utf8</span><br><span class="line">default-collation=utf8_general_ci</span><br></pre></td></tr></table></figure><p>如果在创建的时候指明字符集编码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">create database `test1` character set gbk; </span><br><span class="line">create database `test1` charset=gbk; # 两种写法相同 </span><br></pre></td></tr></table></figure><p>查看<code>db.opt</code>，可以看到系统自动指定了gbk字符集对应的校验和</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@1c2261732150:/var/lib/mysql]# ls test1</span><br><span class="line">db.opt</span><br><span class="line">[root@1c2261732150:/var/lib/mysql]# cat test1/db.opt</span><br><span class="line">default-character-set=gbk</span><br><span class="line">default-collation=gbk_chinese_ci</span><br></pre></td></tr></table></figure><p>同时指定字符集和编码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create database `test2` charset=utf8 collate utf8_bin;</span><br></pre></td></tr></table></figure><p>执行成功后，查看本地文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@1c2261732150:/var/lib/mysql]# cat test2/db.opt</span><br><span class="line">default-character-set=utf8</span><br><span class="line">default-collation=utf8_bin</span><br></pre></td></tr></table></figure><p>成功设置了字符集和编码规则</p><hr><p>虽然在创建的时候可以这么做，但我们保持默认配置的utf8即可</p><h4 id="1-5-4-校验的影响"><a href="#1-5-4-校验的影响" class="headerlink" title="1.5.4 校验的影响"></a>1.5.4 校验的影响</h4><p>通过指定不同的编码，我创建了两个校验规则不同的数据库</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [(none)]&gt; create database test_ci charset=utf8;</span><br><span class="line">Query OK, 1 row affected (0.001 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; create database test_bin charset=utf8 collate utf8_bin;</span><br><span class="line">Query OK, 1 row affected (0.000 sec)</span><br></pre></td></tr></table></figure><p>其中一个的校验规则是<code>utf8_general_ci</code>，另外一个是<code>utf8_bin</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@1c2261732150:/var/lib/mysql]# cat test_bin/db.opt</span><br><span class="line">default-character-set=utf8</span><br><span class="line">default-collation=utf8_bin</span><br><span class="line">[root@1c2261732150:/var/lib/mysql]# cat test_ci/db.opt</span><br><span class="line">default-character-set=utf8</span><br><span class="line">default-collation=utf8_general_ci</span><br></pre></td></tr></table></figure><h5 id="utf8-bin"><a href="#utf8-bin" class="headerlink" title="utf8_bin"></a>utf8_bin</h5><p>先进入<code>test_bin</code>数据库</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">use test_bin;</span><br></pre></td></tr></table></figure><p>创建一个student表，只有一个字符串类型的name字段</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create table student(name varchar(30));</span><br></pre></td></tr></table></figure><p>插入如下数据</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [test_bin]&gt; insert into student value (&#x27;a&#x27;);</span><br><span class="line">Query OK, 1 row affected (0.042 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [test_bin]&gt; insert into student value (&#x27;A&#x27;);</span><br><span class="line">Query OK, 1 row affected (0.008 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [test_bin]&gt; insert into student value (&#x27;b&#x27;);</span><br><span class="line">Query OK, 1 row affected (0.003 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [test_bin]&gt; insert into student value (&#x27;B&#x27;);</span><br><span class="line">Query OK, 1 row affected (0.004 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [test_bin]&gt; insert into student value (&#x27;c&#x27;);</span><br><span class="line">Query OK, 1 row affected (0.009 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [test_bin]&gt; insert into student value (&#x27;C&#x27;);</span><br><span class="line">Query OK, 1 row affected (0.007 sec)</span><br></pre></td></tr></table></figure><p>查看已有数据，分别是大小写的abc</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [test_bin]&gt; select * from  student;</span><br><span class="line">+------+</span><br><span class="line">| name |</span><br><span class="line">+------+</span><br><span class="line">| a    |</span><br><span class="line">| A    |</span><br><span class="line">| b    |</span><br><span class="line">| B    |</span><br><span class="line">| c    |</span><br><span class="line">| C    |</span><br><span class="line">+------+</span><br><span class="line">6 rows in set (0.001 sec)</span><br></pre></td></tr></table></figure><p>查询数据，可以看到，返回的结果是只有小写a的</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [test_bin]&gt; select * from student where name=&#x27;a&#x27;;</span><br><span class="line">+------+</span><br><span class="line">| name |</span><br><span class="line">+------+</span><br><span class="line">| a    |</span><br><span class="line">+------+</span><br><span class="line">1 row in set (0.001 sec)</span><br></pre></td></tr></table></figure><p>执行排序（升序）后输出，得到如下结果。我们知道，小写字母的ASCII是在大写字母的之后的，所以这个排序结果是正确的。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [test_bin]&gt; select * from student order by name;</span><br><span class="line">+------+</span><br><span class="line">| name |</span><br><span class="line">+------+</span><br><span class="line">| A    |</span><br><span class="line">| B    |</span><br><span class="line">| C    |</span><br><span class="line">| a    |</span><br><span class="line">| b    |</span><br><span class="line">| c    |</span><br><span class="line">+------+</span><br><span class="line">6 rows in set (0.001 sec)</span><br></pre></td></tr></table></figure><h5 id="utf8-general-ci"><a href="#utf8-general-ci" class="headerlink" title="utf8_general_ci"></a>utf8_general_ci</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">use test_ci;</span><br></pre></td></tr></table></figure><p>在这个数据库中进行相同的插入工作，创建表，插入大小写abc（命令同上不再重复）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [test_ci]&gt; select * from  student;</span><br><span class="line">+------+</span><br><span class="line">| name |</span><br><span class="line">+------+</span><br><span class="line">| a    |</span><br><span class="line">| A    |</span><br><span class="line">| b    |</span><br><span class="line">| B    |</span><br><span class="line">| c    |</span><br><span class="line">| C    |</span><br><span class="line">+------+</span><br><span class="line">6 rows in set (0.000 sec)</span><br></pre></td></tr></table></figure><p>执行查询语句，发现当我们查询小a的时候，同时返回了A和a的结果</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [test_ci]&gt; select * from student where name=&#x27;a&#x27;;</span><br><span class="line">+------+</span><br><span class="line">| name |</span><br><span class="line">+------+</span><br><span class="line">| a    |</span><br><span class="line">| A    |</span><br><span class="line">+------+</span><br><span class="line">2 rows in set (0.001 sec)</span><br></pre></td></tr></table></figure><p>排序的时候，大小a没有按ASCII码顺序排，而是放到了一起</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [test_ci]&gt; select * from student order by name;</span><br><span class="line">+------+</span><br><span class="line">| name |</span><br><span class="line">+------+</span><br><span class="line">| a    |</span><br><span class="line">| A    |</span><br><span class="line">| b    |</span><br><span class="line">| B    |</span><br><span class="line">| c    |</span><br><span class="line">| C    |</span><br><span class="line">+------+</span><br><span class="line">6 rows in set (0.001 sec)</span><br></pre></td></tr></table></figure><h5 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h5><ul><li>utf8_bin：查询的时候区分大小写</li><li>utf8_general_ci：查询时忽略大小写</li></ul><p>在实际场景中，我们就可以根据需求，选择这两个校验规则中的其一作为我们数据库的校验规则。</p><p>这两个只是众多校验规则之一，更多编码的区别，还得等后续慢慢探寻。在一般场景中，使用utf8是完全足够的。</p><h3 id="1-6-修改"><a href="#1-6-修改" class="headerlink" title="1.6 修改"></a>1.6 修改</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">alter database 数据库名 [create_specification [,</span><br><span class="line">create_specification] ...];</span><br></pre></td></tr></table></figure><p>一般情况下，我们修改的是数据库的字符集和校验规则。</p><p>示例如下，修改数据库<code>test_ci</code>的字符集为gbk</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [test_ci]&gt; alter database test_ci charset=gbk;</span><br><span class="line">Query OK, 1 row affected (0.006 sec)</span><br></pre></td></tr></table></figure><p>修改后查看配置文件，字符集和校验规则确实变化了（系统自动查找对应的校验规则）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@1c2261732150:/var/lib/mysql]# cat test_ci/db.opt</span><br><span class="line">default-character-set=utf8</span><br><span class="line">default-collation=utf8_general_ci</span><br><span class="line">[root@1c2261732150:/var/lib/mysql]# cat test_ci/db.opt</span><br><span class="line">default-character-set=gbk</span><br><span class="line">default-collation=gbk_chinese_ci</span><br></pre></td></tr></table></figure><p>也可以同时修改校验规则，这里和新建数据库时的操作是一样的</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter database test_ci charset=utf8 collate utf8_bin;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@1c2261732150:/var/lib/mysql]# cat test_ci/db.opt</span><br><span class="line">default-character-set=gbk</span><br><span class="line">default-collation=gbk_chinese_ci</span><br><span class="line">[root@1c2261732150:/var/lib/mysql]# cat test_ci/db.opt</span><br><span class="line">default-character-set=utf8</span><br><span class="line">default-collation=utf8_bin</span><br></pre></td></tr></table></figure><h3 id="1-7-备份数据库"><a href="#1-7-备份数据库" class="headerlink" title="1.7 备份数据库"></a>1.7 备份数据库</h3><h4 id="1-7-1-备份一个数据库"><a href="#1-7-1-备份一个数据库" class="headerlink" title="1.7.1 备份一个数据库"></a>1.7.1 备份一个数据库</h4><p>如下操作是在linux命令行中执行的</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -P3306 -u root -p 密码 -B 数据库名 &gt; 数据库备份存储的文件路径</span><br></pre></td></tr></table></figure><p>示例</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -P3306 -u root -B hello &gt; hello.bak.sql</span><br></pre></td></tr></table></figure><p>这会在当前路径中出现了一个<code>sql</code>文件，其内容如下。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MySQL dump 10.19  Distrib 10.3.28-MariaDB, for Linux (x86_64)</span></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="comment">-- Host: localhost    Database: hello</span></span><br><span class="line"><span class="comment">-- ------------------------------------------------------</span></span><br><span class="line"><span class="comment">-- Server version       10.3.28-MariaDB</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */</span>;</span><br><span class="line"><span class="comment">/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */</span>;</span><br><span class="line"><span class="comment">/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */</span>;</span><br><span class="line"><span class="comment">/*!40101 SET NAMES utf8 */</span>;</span><br><span class="line"><span class="comment">/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */</span>;</span><br><span class="line"><span class="comment">/*!40103 SET TIME_ZONE=&#x27;+00:00&#x27; */</span>;</span><br><span class="line"><span class="comment">/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */</span>;</span><br><span class="line"><span class="comment">/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */</span>;</span><br><span class="line"><span class="comment">/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE=&#x27;NO_AUTO_VALUE_ON_ZERO&#x27; */</span>;<span class="comment">/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="comment">-- Current Database: `hello`</span></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> DATABASE <span class="comment">/*!32312 IF NOT EXISTS*/</span> `hello` <span class="comment">/*!40100 DEFAULT CHARACTER SET utf8 */</span>;</span><br><span class="line"></span><br><span class="line">USE `hello`;</span><br><span class="line"></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="comment">-- Table structure for table `stu_test`</span></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `stu_test`;</span><br><span class="line"><span class="comment">/*!40101 SET @saved_cs_client     = @@character_set_client */</span>;</span><br><span class="line"><span class="comment">/*!40101 SET character_set_client = utf8 */</span>;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `stu_test` (</span><br><span class="line">  `id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `name` <span class="type">varchar</span>(<span class="number">30</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `age` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `score` <span class="type">decimal</span>(<span class="number">4</span>,<span class="number">2</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">5</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8;</span><br><span class="line"><span class="comment">/*!40101 SET character_set_client = @saved_cs_client */</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="comment">-- Dumping data for table `stu_test`</span></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"></span><br><span class="line">LOCK TABLES `stu_test` WRITE;</span><br><span class="line"><span class="comment">/*!40000 ALTER TABLE `stu_test` DISABLE KEYS */</span>;</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `stu_test` <span class="keyword">VALUES</span> (<span class="number">2</span>,<span class="string">&#x27;小图图&#x27;</span>,<span class="number">5</span>,<span class="number">72.80</span>),(<span class="number">3</span>,<span class="string">&#x27;大司马&#x27;</span>,<span class="number">42</span>,<span class="number">87.30</span>),(<span class="number">4</span>,<span class="string">&#x27;乐迪&#x27;</span>,<span class="number">32</span>,<span class="number">99.00</span>);</span><br><span class="line"><span class="comment">/*!40000 ALTER TABLE `stu_test` ENABLE KEYS */</span>;</span><br><span class="line">UNLOCK TABLES;</span><br><span class="line"><span class="comment">/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*!40101 SET SQL_MODE=@OLD_SQL_MODE */</span>;</span><br><span class="line"><span class="comment">/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */</span>;</span><br><span class="line"><span class="comment">/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */</span>;</span><br><span class="line"><span class="comment">/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */</span>;</span><br><span class="line"><span class="comment">/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */</span>;</span><br><span class="line"><span class="comment">/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */</span>;</span><br><span class="line"><span class="comment">/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Dump completed on 2023-04-15 15:20:25</span></span><br></pre></td></tr></table></figure><p>我们会发现这里面的内容其实都是sql语句，如果将这个备份导入到另外一个数据库中，实际上就是将历史的所有sql语句全部执行一遍！</p><blockquote><p>除此之外，复制<code>/var/lib/mysql</code>下的数据库文件也是可行的一种备份方案。但并不推荐这么做！</p></blockquote><h4 id="1-7-2-备份数据库中的多张表"><a href="#1-7-2-备份数据库中的多张表" class="headerlink" title="1.7.2 备份数据库中的多张表"></a>1.7.2 备份数据库中的多张表</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -u root -p 数据库名 表名1 表名2 &gt; 备份文件名</span><br></pre></td></tr></table></figure><h4 id="1-7-3-同时备份多个数据库"><a href="#1-7-3-同时备份多个数据库" class="headerlink" title="1.7.3 同时备份多个数据库"></a>1.7.3 同时备份多个数据库</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -u root -p -B 数据库名1 数据库名2  &gt; 备份文件名</span><br></pre></td></tr></table></figure><h4 id="1-7-4-还原"><a href="#1-7-4-还原" class="headerlink" title="1.7.4 还原"></a>1.7.4 还原</h4><p>如下命令需要在mysql中执行</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">source 备份文件路径</span><br><span class="line">## 示例</span><br><span class="line">source /root/hello.bak.sql;</span><br></pre></td></tr></table></figure><p><img src="/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/04/643a51c431d57.png" alt="image-20230415152700967"></p><p>数据库中的内容和原有数据库是完全相同的</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello]&gt; show tables;</span><br><span class="line">+-----------------+</span><br><span class="line">| Tables_in_hello |</span><br><span class="line">+-----------------+</span><br><span class="line">| stu_test        |</span><br><span class="line">+-----------------+</span><br><span class="line">1 row in set (0.001 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [hello]&gt; select * from stu_test;</span><br><span class="line">+----+-----------+------+-------+</span><br><span class="line">| id | name      | age  | score |</span><br><span class="line">+----+-----------+------+-------+</span><br><span class="line">|  2 | 小图图    |    5 | 72.80 |</span><br><span class="line">|  3 | 大司马    |   42 | 87.30 |</span><br><span class="line">|  4 | 乐迪      |   32 | 99.00 |</span><br><span class="line">+----+-----------+------+-------+</span><br><span class="line">3 rows in set (0.001 sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="1-7-5-化简"><a href="#1-7-5-化简" class="headerlink" title="1.7.5 化简"></a>1.7.5 化简</h4><p>如果你看过了上面对校验影响的验证，其中我往test_bin数据库中使用6条语句插入了大小写的abc。</p><p>但当我们执行备份的时候，可以看到备份出来的sql文件，六个语句被合并了！</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO `student` VALUES (&#x27;a&#x27;),(&#x27;A&#x27;),(&#x27;b&#x27;),(&#x27;B&#x27;),(&#x27;c&#x27;),(&#x27;C&#x27;);</span><br></pre></td></tr></table></figure><p>这也是mysql备份的智能之处之一！</p><h3 id="1-8-清空屏幕"><a href="#1-8-清空屏幕" class="headerlink" title="1.8 清空屏幕"></a>1.8 清空屏幕</h3><p>在MySQL中，可以通过<code>system</code> 来执行linux系统命令</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">system clear</span><br></pre></td></tr></table></figure><p>比如使用如上命令可以清空屏幕</p><h2 id="2-表"><a href="#2-表" class="headerlink" title="2.表"></a>2.表</h2><p>如下命令需要先进入特定database才能执行</p><h3 id="2-1-创建表"><a href="#2-1-创建表" class="headerlink" title="2.1 创建表"></a>2.1 创建表</h3><p>基础的创建操作如下。其中末尾的字符集、校验规则、存储引擎的设置项可以留空不填</p><ul><li>field 列名</li><li>datatype 列的类型</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">create table 表名 (</span><br><span class="line">    field1 datatype,</span><br><span class="line">    field2 datatype,</span><br><span class="line">    field3 datatype</span><br><span class="line">) character set 字符集 collate 校验规则 engine 存储引擎;</span><br></pre></td></tr></table></figure><p>示例如下，创建了一个student表，并配置了两个键值name和age，类型分别为字符串和int</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">create table student(</span><br><span class="line">    name varchar(30),</span><br><span class="line">    age int</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>除了基础操作之外，我们还可以给这个表新增一个comment作为列备注</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">create table student(</span><br><span class="line">    name varchar(30) comment &#x27;学生名字&#x27;,</span><br><span class="line">    age int comment &#x27;学生年龄&#x27;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>用下面的语句可以查看创建表时候的操作</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show create table 表名;</span><br></pre></td></tr></table></figure><p><img src="/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/04/643a5ce696843.png" alt="image-20230415161430461"></p><p>这部分和备份的时候的sql也是一样的，mysql会帮我们自动规整语句，使其语法规则更规整；</p><p>如下语句也能看到创建表时所用命令</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">table</span> stu_test\G</span><br></pre></td></tr></table></figure><p>在数据库帮我们创建这张表的时候，如果没有手动指定引擎和字符集，则会使用数据库的默认设置；</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello]&gt; show create table stu_test\G</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">       Table: stu_test</span><br><span class="line">Create Table: CREATE TABLE `stu_test` (</span><br><span class="line">  `id` int(11) NOT NULL AUTO_INCREMENT,</span><br><span class="line">  `name` varchar(30) DEFAULT NULL,</span><br><span class="line">  `age` int(11) DEFAULT NULL,</span><br><span class="line">  `score` decimal(4,2) DEFAULT NULL,</span><br><span class="line">  `avatar` varchar(100) NOT NULL DEFAULT &#x27;default-avatar.png&#x27; COMMENT &#x27;头像图片路径&#x27;,</span><br><span class="line">  PRIMARY KEY (`id`)</span><br><span class="line">) ENGINE=InnoDB AUTO_INCREMENT=6 DEFAULT CHARSET=utf8</span><br><span class="line">1 row in set (0.000 sec)</span><br></pre></td></tr></table></figure><p>这两个show命令的结果是类似的</p><p><img src="/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/05/6455c2d282a8a.png" alt="image-20230506110031599"></p><p>如果想在建立表的时候，设置数据库所用引擎和字符集，可以在create语句的括号之后，依照格式添加配置项</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> xxx() ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8;</span><br></pre></td></tr></table></figure><h3 id="2-2-查看已有表"><a href="#2-2-查看已有表" class="headerlink" title="2.2 查看已有表"></a>2.2 查看已有表</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show tables;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello]&gt; show tables;</span><br><span class="line">+-----------------+</span><br><span class="line">| Tables_in_hello |</span><br><span class="line">+-----------------+</span><br><span class="line">| student         |</span><br><span class="line">+-----------------+</span><br><span class="line">1 row in set (0.001 sec)</span><br></pre></td></tr></table></figure><h3 id="2-3-查看表的属性-x2F-结构"><a href="#2-3-查看表的属性-x2F-结构" class="headerlink" title="2.3 查看表的属性&#x2F;结构"></a>2.3 查看表的属性&#x2F;结构</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">desc 表名;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello]&gt; desc stu_test;</span><br><span class="line">+-------+--------------+------+-----+---------+----------------+</span><br><span class="line">| Field | Type         | Null | Key | Default | Extra          |</span><br><span class="line">+-------+--------------+------+-----+---------+----------------+</span><br><span class="line">| id    | int(11)      | NO   | PRI | NULL    | auto_increment |</span><br><span class="line">| name  | varchar(30)  | YES  |     | NULL    |                |</span><br><span class="line">| age   | int(11)      | YES  |     | NULL    |                |</span><br><span class="line">| score | decimal(4,2) | YES  |     | NULL    |                |</span><br><span class="line">+-------+--------------+------+-----+---------+----------------+</span><br><span class="line">4 rows in set (0.002 sec)</span><br></pre></td></tr></table></figure><p>还可以使用如下命令，输出的结果包括更多信息</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">FULL</span> COLUMNS <span class="keyword">FROM</span> 表名;</span><br></pre></td></tr></table></figure><p><img src="/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2023/08/ae4f9de761c8c492d034ce790bf602bc.png" alt="image-20230804102257863"></p><h3 id="2-4-删除该表"><a href="#2-4-删除该表" class="headerlink" title="2.4 删除该表"></a>2.4 删除该表</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drop table student;</span><br></pre></td></tr></table></figure><h3 id="2-5-修改表的结构"><a href="#2-5-修改表的结构" class="headerlink" title="2.5 修改表的结构"></a>2.5 修改表的结构</h3><p>注意，这里是对表的属性的修改，并不是对数据的修改！</p><p>比如我想新增字段，或者修改已有字段的属性，或者删除字段</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 新增字段</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> tablename <span class="keyword">ADD</span> (<span class="keyword">column</span> datatype [<span class="keyword">DEFAULT</span> expr][,<span class="keyword">column</span></span><br><span class="line">datatype]...);</span><br><span class="line"><span class="comment">-- 修改字段</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> tablename MODIfy (<span class="keyword">column</span> datatype [<span class="keyword">DEFAULT</span> expr][,<span class="keyword">column</span></span><br><span class="line">datatype]...);</span><br><span class="line"><span class="comment">-- 删除字段</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> tablename <span class="keyword">DROP</span> (<span class="keyword">column</span>);</span><br></pre></td></tr></table></figure><h4 id="2-5-0-注意事项"><a href="#2-5-0-注意事项" class="headerlink" title="2.5.0 注意事项"></a>2.5.0 注意事项</h4><p>请注意：修改表的字段是一个很麻烦的操作，<strong>其可能会涉及到已有数据的有效性问题</strong></p><ul><li>请在生产环境上线前的测试阶段，完成表字段的定义！</li></ul><p>说人话就是，前期设计要想的尽量到位，避免后期表中已有数据的时候修改表的属性！</p><h4 id="2-5-1-新增字段"><a href="#2-5-1-新增字段" class="headerlink" title="2.5.1 新增字段"></a>2.5.1 新增字段</h4><p>比如我给上方<code>2.5</code>中出现过的<code>stu_test</code>表新增一列，可以用如下的命令</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> stu_test <span class="keyword">add</span> avatar <span class="type">varchar</span>(<span class="number">100</span>) comment <span class="string">&#x27;头像图片路径&#x27;</span> after score;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello]&gt; select * from stu_test;</span><br><span class="line">+----+-----------+------+-------+</span><br><span class="line">| id | name      | age  | score |</span><br><span class="line">+----+-----------+------+-------+</span><br><span class="line">|  2 | 小图图    |    5 | 72.80 |</span><br><span class="line">|  3 | 大司马    |   42 | 87.30 |</span><br><span class="line">|  4 | 乐迪      |   32 | 99.00 |</span><br><span class="line">|  5 | dc872458  |   25 |  NULL |</span><br><span class="line">+----+-----------+------+-------+</span><br><span class="line">4 rows in set (0.000 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [hello]&gt; alter table stu_test add avatar varchar(100) comment &#x27;头像图片路径&#x27; after</span><br><span class="line">    -&gt; score;</span><br><span class="line">Query OK, 0 rows affected (0.005 sec)</span><br><span class="line">Records: 0  Duplicates: 0  Warnings: 0</span><br><span class="line"></span><br><span class="line">MariaDB [hello]&gt; select * from stu_test;</span><br><span class="line">+----+-----------+------+-------+--------+</span><br><span class="line">| id | name      | age  | score | avatar |</span><br><span class="line">+----+-----------+------+-------+--------+</span><br><span class="line">|  2 | 小图图    |    5 | 72.80 | NULL   |</span><br><span class="line">|  3 | 大司马    |   42 | 87.30 | NULL   |</span><br><span class="line">|  4 | 乐迪      |   32 | 99.00 | NULL   |</span><br><span class="line">|  5 | dc872458  |   25 |  NULL | NULL   |</span><br><span class="line">+----+-----------+------+-------+--------+</span><br><span class="line">4 rows in set (0.000 sec)</span><br></pre></td></tr></table></figure><p>此时可以看到，已有数据都多了一个<code>avatar</code>字段，且这些已有数据的新字段都为<code>NULL</code></p><p>说明新增字段并不会影响旧数据的旧字段。我们可以在新增字段之后，给旧的数据修改默认值</p><h4 id="2-5-2-删除字段"><a href="#2-5-2-删除字段" class="headerlink" title="2.5.2 删除字段"></a>2.5.2 删除字段</h4><blockquote><p>如果表中的数据只剩一列（只有一个字段）是不能删除这个字段的（只能删除这个表）</p></blockquote><p>使用如下命令，删除刚刚新增的<code>avatar</code>字段</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> stu_test <span class="keyword">drop</span> avatar;</span><br></pre></td></tr></table></figure><p>可以看到avatar列被删除了</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello]&gt; select * from stu_test;</span><br><span class="line">+----+-----------+------+-------+--------+</span><br><span class="line">| id | name      | age  | score | avatar |</span><br><span class="line">+----+-----------+------+-------+--------+</span><br><span class="line">|  2 | 小图图    |    5 | 72.80 | NULL   |</span><br><span class="line">|  3 | 大司马    |   42 | 87.30 | NULL   |</span><br><span class="line">|  4 | 乐迪      |   32 | 99.00 | NULL   |</span><br><span class="line">|  5 | dc872458  |   25 |  NULL | NULL   |</span><br><span class="line">+----+-----------+------+-------+--------+</span><br><span class="line">4 rows in set (0.000 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [hello]&gt; alter table stu_test drop avatar;</span><br><span class="line">Query OK, 0 rows affected (0.034 sec)</span><br><span class="line">Records: 0  Duplicates: 0  Warnings: 0</span><br><span class="line"></span><br><span class="line">MariaDB [hello]&gt; select * from stu_test;</span><br><span class="line">+----+-----------+------+-------+</span><br><span class="line">| id | name      | age  | score |</span><br><span class="line">+----+-----------+------+-------+</span><br><span class="line">|  2 | 小图图    |    5 | 72.80 |</span><br><span class="line">|  3 | 大司马    |   42 | 87.30 |</span><br><span class="line">|  4 | 乐迪      |   32 | 99.00 |</span><br><span class="line">|  5 | dc872458  |   25 |  NULL |</span><br><span class="line">+----+-----------+------+-------+</span><br><span class="line">4 rows in set (0.000 sec)</span><br></pre></td></tr></table></figure><p>在具体场景中，如果需要给已有用户新增<code>头像</code>，一般存放的是头像的文件路径（而不是图片），此时我们就可以设计一个默认头像，并在新增字段的时候将默认值（默认的头像文件路径）修改为这个默认头像图片的路径。</p><p>比如我现在的头像存储的文件路径是</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./images/</span><br></pre></td></tr></table></figure><p>此时存放的用户头像文件就应该放到这个目录中，而mysql中只需要存放文件的路径。</p><p>比如用户上传了一个头像图片，我们将头像图片保存到这个路径，再往sql中的avatar字段插入路径</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./images/test-img.png</span><br><span class="line">sql中只需要保存test-img.png，取图片的时候拼接上前方的文件路径</span><br></pre></td></tr></table></figure><p>设计一个默认头像，也是放在这个路径中</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./images/test-img.png</span><br><span class="line">./images/default-avatar.png</span><br></pre></td></tr></table></figure><p>这时候新增avatar字段的时候，就可以指定默认值</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> stu_test <span class="keyword">add</span> avatar <span class="type">varchar</span>(<span class="number">100</span>) <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">default</span> <span class="string">&#x27;default-avatar.png&#x27;</span>  comment <span class="string">&#x27;头像图片路径&#x27;</span> after</span><br><span class="line">score;</span><br></pre></td></tr></table></figure><p>这时候就能看到，旧数据的头像都是默认头像了！</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello]&gt; select * from stu_test;</span><br><span class="line">+----+-----------+------+-------+--------------------+</span><br><span class="line">| id | name      | age  | score | avatar             |</span><br><span class="line">+----+-----------+------+-------+--------------------+</span><br><span class="line">|  2 | 小图图    |    5 | 72.80 | default-avatar.png |</span><br><span class="line">|  3 | 大司马    |   42 | 87.30 | default-avatar.png |</span><br><span class="line">|  4 | 乐迪      |   32 | 99.00 | default-avatar.png |</span><br><span class="line">|  5 | dc872458  |   25 |  NULL | default-avatar.png |</span><br><span class="line">+----+-----------+------+-------+--------------------+</span><br><span class="line">4 rows in set (0.000 sec)</span><br></pre></td></tr></table></figure><p>默认头像总好过没有图片嘛！</p><h4 id="2-5-3-修改字段类型"><a href="#2-5-3-修改字段类型" class="headerlink" title="2.5.3 修改字段类型"></a>2.5.3 修改字段类型</h4><p>在设计<code>stu_test</code>表的时候，只给name分配了30个字节的空间。此时如果来了个名字特别特别长的新同学（有些地方的人名确实很长）</p><p>我们发现30个字节存不下这个名字了，就可以考虑将名字字段的长度增加</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> stu_test modify name <span class="type">varchar</span>(<span class="number">60</span>);</span><br></pre></td></tr></table></figure><p>如下，成功修改！</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello]&gt; desc stu_test;</span><br><span class="line">+--------+--------------+------+-----+--------------------+----------------+</span><br><span class="line">| Field  | Type         | Null | Key | Default            | Extra          |</span><br><span class="line">+--------+--------------+------+-----+--------------------+----------------+</span><br><span class="line">| id     | int(11)      | NO   | PRI | NULL               | auto_increment |</span><br><span class="line">| name   | varchar(30)  | YES  |     | NULL               |                |</span><br><span class="line">| age    | int(11)      | YES  |     | NULL               |                |</span><br><span class="line">| score  | decimal(4,2) | YES  |     | NULL               |                |</span><br><span class="line">| avatar | varchar(100) | NO   |     | default-avatar.png |                |</span><br><span class="line">+--------+--------------+------+-----+--------------------+----------------+</span><br><span class="line">5 rows in set (0.001 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [hello]&gt; alter table stu_test modify name varchar(60);</span><br><span class="line">Query OK, 0 rows affected (0.013 sec)</span><br><span class="line">Records: 0  Duplicates: 0  Warnings: 0</span><br><span class="line"></span><br><span class="line">MariaDB [hello]&gt; desc stu_test;</span><br><span class="line">+--------+--------------+------+-----+--------------------+----------------+</span><br><span class="line">| Field  | Type         | Null | Key | Default            | Extra          |</span><br><span class="line">+--------+--------------+------+-----+--------------------+----------------+</span><br><span class="line">| id     | int(11)      | NO   | PRI | NULL               | auto_increment |</span><br><span class="line">| name   | varchar(60)  | YES  |     | NULL               |                |</span><br><span class="line">| age    | int(11)      | YES  |     | NULL               |                |</span><br><span class="line">| score  | decimal(4,2) | YES  |     | NULL               |                |</span><br><span class="line">| avatar | varchar(100) | NO   |     | default-avatar.png |                |</span><br><span class="line">+--------+--------------+------+-----+--------------------+----------------+</span><br><span class="line">5 rows in set (0.001 sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>因为是增加字段的长度，所以也不影响已有数据</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello]&gt; select * from stu_test;</span><br><span class="line">+----+-----------+------+-------+--------------------+</span><br><span class="line">| id | name      | age  | score | avatar             |</span><br><span class="line">+----+-----------+------+-------+--------------------+</span><br><span class="line">|  2 | 小图图    |    5 | 72.80 | default-avatar.png |</span><br><span class="line">|  3 | 大司马    |   42 | 87.30 | default-avatar.png |</span><br><span class="line">|  4 | 乐迪      |   32 | 99.00 | default-avatar.png |</span><br><span class="line">|  5 | dc872458  |   25 |  NULL | default-avatar.png |</span><br><span class="line">+----+-----------+------+-------+--------------------+</span><br><span class="line">4 rows in set (0.000 sec)</span><br></pre></td></tr></table></figure><p>如果是减小字段长度，就需要确认已有数据是否有超过新长度的内容了！比如从60减小到30，那么长度为40的数据就会出现错误！</p><p>那如果是将varchar直接改成int，或者将int改成char，会发生什么呢？</p><p>表中的id字段是一个int，尝试将其修改成char</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> stu_test modify id <span class="type">varchar</span>(<span class="number">32</span>);</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello]&gt; select * from stu_test;</span><br><span class="line">+----+-----------+------+-------+--------------------+</span><br><span class="line">| id | name      | age  | score | avatar             |</span><br><span class="line">+----+-----------+------+-------+--------------------+</span><br><span class="line">| 2  | 小图图    |    5 | 72.80 | default-avatar.png |</span><br><span class="line">| 3  | 大司马    |   42 | 87.30 | default-avatar.png |</span><br><span class="line">| 4  | 乐迪      |   32 | 99.00 | default-avatar.png |</span><br><span class="line">| 5  | dc872458  |   25 |  NULL | default-avatar.png |</span><br><span class="line">+----+-----------+------+-------+--------------------+</span><br><span class="line">4 rows in set (0.001 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [hello]&gt; desc stu_test;</span><br><span class="line">+--------+--------------+------+-----+--------------------+-------+</span><br><span class="line">| Field  | Type         | Null | Key | Default            | Extra |</span><br><span class="line">+--------+--------------+------+-----+--------------------+-------+</span><br><span class="line">| id     | varchar(32)  | NO   | PRI | NULL               |       |</span><br><span class="line">| name   | varchar(60)  | YES  |     | NULL               |       |</span><br><span class="line">| age    | int(11)      | YES  |     | NULL               |       |</span><br><span class="line">| score  | decimal(4,2) | YES  |     | NULL               |       |</span><br><span class="line">| avatar | varchar(100) | NO   |     | default-avatar.png |       |</span><br><span class="line">+--------+--------------+------+-----+--------------------+-------+</span><br><span class="line">5 rows in set (0.002 sec)</span><br></pre></td></tr></table></figure><p>可以看到，其不仅成功变成了字符串类型，已有的值也没有出错。毕竟int数字改成字符串是可行的。那反过来呢？</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello]&gt; insert into stu_test (id,name,age,score,avatar) values (&#x27;kb&#x27;,&#x27;你好&#x27;,30,60,&#x27;测试图片.png&#x27;);</span><br><span class="line">Query OK, 1 row affected (0.007 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [hello]&gt; select * from stu_test;</span><br><span class="line">+----+-----------+------+-------+--------------------+</span><br><span class="line">| id | name      | age  | score | avatar             |</span><br><span class="line">+----+-----------+------+-------+--------------------+</span><br><span class="line">| 2  | 小图图    |    5 | 72.80 | default-avatar.png |</span><br><span class="line">| 3  | 大司马    |   42 | 87.30 | default-avatar.png |</span><br><span class="line">| 4  | 乐迪      |   32 | 99.00 | default-avatar.png |</span><br><span class="line">| 5  | dc872458  |   25 |  NULL | default-avatar.png |</span><br><span class="line">| kb | 你好      |   30 | 60.00 | 测试图片.png       |</span><br><span class="line">+----+-----------+------+-------+--------------------+</span><br><span class="line">5 rows in set (0.000 sec)</span><br></pre></td></tr></table></figure><p>此时我往表中插入了一个id为<code>kb</code>的数据，再尝试将id从varchar改回int类型</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello]&gt; alter table stu_test modify id int;</span><br><span class="line">ERROR 1292 (22007): Truncated incorrect INTEGER value: &#x27;kb&#x27;</span><br><span class="line">MariaDB [hello]&gt; desc stu_test;</span><br><span class="line">+--------+--------------+------+-----+--------------------+-------+</span><br><span class="line">| Field  | Type         | Null | Key | Default            | Extra |</span><br><span class="line">+--------+--------------+------+-----+--------------------+-------+</span><br><span class="line">| id     | varchar(32)  | NO   | PRI | NULL               |       |</span><br><span class="line">| name   | varchar(60)  | YES  |     | NULL               |       |</span><br><span class="line">| age    | int(11)      | YES  |     | NULL               |       |</span><br><span class="line">| score  | decimal(4,2) | YES  |     | NULL               |       |</span><br><span class="line">| avatar | varchar(100) | NO   |     | default-avatar.png |       |</span><br><span class="line">+--------+--------------+------+-----+--------------------+-------+</span><br><span class="line">5 rows in set (0.001 sec)</span><br></pre></td></tr></table></figure><p>此时就会报错，<code>kb</code>不符合int类型；修改失败了！</p><p>所以，修改字段的类型，需要保证原有类型和目标类型之间是可以正常双向转换的！</p><h4 id="2-5-4-修改字段名字"><a href="#2-5-4-修改字段名字" class="headerlink" title="2.5.4 修改字段名字"></a>2.5.4 修改字段名字</h4><p>如下使用<code>change</code>修改字段<code>id -&gt; num</code>，同时还需要注明属性（也可以修改属性）</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> stu_test change id num <span class="type">varchar</span>(<span class="number">32</span>);</span><br></pre></td></tr></table></figure><p>这里可以看到<code>0 rows affected</code>，因为我们修改的是字段名字而已，所以不会影响到数据</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello]&gt; alter table stu_test change id num varchar(32);</span><br><span class="line">Query OK, 0 rows affected (0.008 sec)</span><br><span class="line">Records: 0  Duplicates: 0  Warnings: 0</span><br><span class="line"></span><br><span class="line">MariaDB [hello]&gt; desc stu_test;</span><br><span class="line">+--------+--------------+------+-----+--------------------+-------+</span><br><span class="line">| Field  | Type         | Null | Key | Default            | Extra |</span><br><span class="line">+--------+--------------+------+-----+--------------------+-------+</span><br><span class="line">| num    | varchar(32)  | NO   | PRI | NULL               |       |</span><br><span class="line">| name   | varchar(60)  | YES  |     | NULL               |       |</span><br><span class="line">| age    | int(11)      | YES  |     | NULL               |       |</span><br><span class="line">| score  | decimal(4,2) | YES  |     | NULL               |       |</span><br><span class="line">| avatar | varchar(100) | NO   |     | default-avatar.png |       |</span><br><span class="line">+--------+--------------+------+-----+--------------------+-------+</span><br><span class="line">5 rows in set (0.001 sec)</span><br></pre></td></tr></table></figure><h3 id="2-6-修改表名"><a href="#2-6-修改表名" class="headerlink" title="2.6 修改表名"></a>2.6 修改表名</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> stu_test rename stu;</span><br></pre></td></tr></table></figure><p>可以看到修改成功了</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello]&gt; alter table stu_test rename stu;</span><br><span class="line">Query OK, 0 rows affected (0.015 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [hello]&gt; show tables;</span><br><span class="line">+-----------------+</span><br><span class="line">| Tables_in_hello |</span><br><span class="line">+-----------------+</span><br><span class="line">| stu             |</span><br><span class="line">| tb_video        |</span><br><span class="line">+-----------------+</span><br><span class="line">2 rows in set (0.000 sec)</span><br></pre></td></tr></table></figure><h3 id="2-7-新增自增主键且不影响原有数据"><a href="#2-7-新增自增主键且不影响原有数据" class="headerlink" title="2.7 新增自增主键且不影响原有数据"></a>2.7 新增自增主键且不影响原有数据</h3><p>新增了一个自增的<code>int id</code>主键到表内，可以使用如下命令</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> 表名 <span class="keyword">ADD</span> id <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT <span class="keyword">PRIMARY</span> KEY <span class="keyword">FIRST</span>;</span><br></pre></td></tr></table></figure><h3 id="2-8-表字段的约束"><a href="#2-8-表字段的约束" class="headerlink" title="2.8 表字段的约束"></a>2.8 表字段的约束</h3><p>参考 【<a href="https://blog.musnow.top/posts/4138950838/">mysql字段约束</a> 】一文！建议看了这个之后再往下看。</p><h2 id="3-数据记录-CURD"><a href="#3-数据记录-CURD" class="headerlink" title="3.数据记录 CURD"></a>3.数据记录 CURD</h2><p>下方学习的都是数据操控语言<strong>DML</strong>；主要针对的就是表的增加删除修改和查询，简称CRUD（增查改删）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Create   创建</span><br><span class="line">Retrieve 读取</span><br><span class="line">Update   更新</span><br><span class="line">Delete   删除</span><br></pre></td></tr></table></figure><p>在MySQL中，我们将一行新增的数据，称为<code>一条记录</code></p><h3 id="3-1-新增-Create"><a href="#3-1-新增-Create" class="headerlink" title="3.1 新增 Create"></a>3.1 新增 Create</h3><p>要想往一个表里面插入数据，首先需要创建表（好像是一句废话）</p><p>先使用如下表进行测试</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> students (</span><br><span class="line">	id <span class="type">INT</span> UNSIGNED <span class="keyword">PRIMARY</span> KEY AUTO_INCREMENT comment <span class="string">&#x27;主键序号&#x27;</span>,</span><br><span class="line">	sn <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">UNIQUE</span> COMMENT <span class="string">&#x27;学号&#x27;</span>,</span><br><span class="line">	name <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT  <span class="string">&#x27;学生名字&#x27;</span>,</span><br><span class="line">	qq <span class="type">VARCHAR</span>(<span class="number">20</span>) COMMENT <span class="string">&#x27;学生QQ&#x27;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>在学习插入之前，我们首先要会最基本的查询语句</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span>  表名; <span class="comment">-- 显示表中的所有数据</span></span><br></pre></td></tr></table></figure><h4 id="3-1-1-单行全列插入"><a href="#3-1-1-单行全列插入" class="headerlink" title="3.1.1 单行全列插入"></a>3.1.1 单行全列插入</h4><p>所谓单行，代表一次只插入一条记录；</p><p>所谓全列插入，代表插入这条数据的时候，将全部列的数据都手动指定。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> students <span class="keyword">values</span> (<span class="number">1</span>,<span class="number">1000</span>,<span class="string">&#x27;小明&#x27;</span>,<span class="string">&#x27;123124&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> students <span class="keyword">values</span> (<span class="number">2</span>,<span class="number">1001</span>,<span class="string">&#x27;小红&#x27;</span>,<span class="keyword">NULL</span>);</span><br></pre></td></tr></table></figure><p>如上就是两个全列插入的示例；执行完毕这条sql的时候，MySQL会显示 <code>1 row affected</code>，代表只有一行收到了影响（新增了一条记录）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; insert into students values (1,1000,&#x27;小明&#x27;,&#x27;123124&#x27;);</span><br><span class="line">Query OK, 1 row affected (0.007 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [hello_mysql]&gt; insert into students values (2,1001,&#x27;小红&#x27;,NULL);</span><br><span class="line">Query OK, 1 row affected (0.002 sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>查询表中数据，可以看到我们刚刚插入的记录</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; select * from students;</span><br><span class="line">+----+------+--------+--------+</span><br><span class="line">| id | sn   | name   | qq     |</span><br><span class="line">+----+------+--------+--------+</span><br><span class="line">|  1 | 1000 | 小明   | 123124 |</span><br><span class="line">|  2 | 1001 | 小红   | NULL   |</span><br><span class="line">+----+------+--------+--------+</span><br><span class="line">2 rows in set (0.001 sec)</span><br></pre></td></tr></table></figure><h4 id="3-1-2-多行指定列插入"><a href="#3-1-2-多行指定列插入" class="headerlink" title="3.1.2 多行指定列插入"></a>3.1.2 多行指定列插入</h4><p>所谓多行插入，就是一次插入多条数据。指定列是在插入的时候，明确告诉MySQL我们想插入的列数是哪几个。</p><p>需要注意的是，只要某一列没有<code>DEFAULT</code>值，如果不指定此列，则会被默认为<code>NULL</code>；如果某一列设置了<code>NOT NULL</code>并且没有设置<code>DEFAULT</code>值，那就必须要指定值，否则会报错。</p><p>另外，指定的列的个数和values中数据的个数需要对应上。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> students (id, sn, name) <span class="keyword">VALUES</span></span><br><span class="line">    (<span class="number">102</span>, <span class="number">20001</span>, <span class="string">&#x27;曹孟德&#x27;</span>),</span><br><span class="line">    (<span class="number">103</span>, <span class="number">20002</span>, <span class="string">&#x27;孙仲谋&#x27;</span>);</span><br></pre></td></tr></table></figure><p>执行效果如下</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; INSERT INTO students (id, sn, name) VALUES</span><br><span class="line">    -&gt;     (102, 20001, &#x27;曹孟德&#x27;),</span><br><span class="line">    -&gt;     (103, 20002, &#x27;孙仲谋&#x27;);</span><br><span class="line">Query OK, 2 rows affected (0.013 sec)</span><br><span class="line">Records: 2  Duplicates: 0  Warnings: 0</span><br><span class="line"></span><br><span class="line">MariaDB [hello_mysql]&gt; select * from students;</span><br><span class="line">+-----+-------+-----------+--------+</span><br><span class="line">| id  | sn    | name      | qq     |</span><br><span class="line">+-----+-------+-----------+--------+</span><br><span class="line">|   1 |  1000 | 小明      | 123124 |</span><br><span class="line">|   2 |  1001 | 小红      | NULL   |</span><br><span class="line">| 102 | 20001 | 曹孟德    | NULL   |</span><br><span class="line">| 103 | 20002 | 孙仲谋    | NULL   |</span><br><span class="line">+-----+-------+-----------+--------+</span><br><span class="line">4 rows in set (0.000 sec)</span><br></pre></td></tr></table></figure><h4 id="3-1-3-插入否则更新"><a href="#3-1-3-插入否则更新" class="headerlink" title="3.1.3 插入否则更新"></a>3.1.3 插入否则更新</h4><p>如果我们往表里面插入一个已经存在的主键&#x2F;唯一键的值，就会出现主键&#x2F;唯一键冲突而导致的拒绝插入。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; insert into students values (1,1003,&#x27;李华&#x27;,&#x27;12354&#x27;);</span><br><span class="line">ERROR 1062 (23000): Duplicate entry &#x27;1&#x27; for key &#x27;PRIMARY&#x27;</span><br><span class="line">MariaDB [hello_mysql]&gt; insert into students values (5,1000,&#x27;小可&#x27;,&#x27;53134&#x27;);</span><br><span class="line">ERROR 1062 (23000): Duplicate entry &#x27;1000&#x27; for key &#x27;sn&#x27;</span><br></pre></td></tr></table></figure><p>此时我们可以根据具体情况，将插入改成<code>插入否则更新</code>，即如果主键和唯一键冲突，则更新已有记录。不冲突则正常插入；</p><p>这样就可以把插入和更新的语句给统一成一个。但需要避免出现明明是要插入一个新的，但却因为主键设置错误而更新了旧值，导致记录丢失，那样就不好了。</p><p>插入否则更新的语法是下面这样</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> ... <span class="keyword">ON</span> DUPLICATE KEY <span class="keyword">UPDATE</span> <span class="keyword">column</span> <span class="operator">=</span> <span class="keyword">value</span> [, <span class="keyword">column</span> <span class="operator">=</span> <span class="keyword">value</span>] ...</span><br></pre></td></tr></table></figure><p>示例如下，这个语句的意思是，如果唯一键和主键没有冲突，则插入 <code>(100, 10010, &#39;唐大师&#39;)</code>的记录，如果id和sn冲突了，则将sn更新为10010，name更新为唐大师。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> students (id, sn, name) <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="number">10010</span>, <span class="string">&#x27;唐大师&#x27;</span>)</span><br><span class="line">	<span class="keyword">ON</span> DUPLICATE KEY <span class="keyword">UPDATE</span> sn <span class="operator">=</span> <span class="number">10010</span>, name <span class="operator">=</span> <span class="string">&#x27;唐大师&#x27;</span>;</span><br></pre></td></tr></table></figure><p>执行的效果如下，执行后，可以看到第一行记录因为主键冲突，而更新了这条记录的sn和name</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; select * from students;</span><br><span class="line">+-----+-------+-----------+--------+</span><br><span class="line">| id  | sn    | name      | qq     |</span><br><span class="line">+-----+-------+-----------+--------+</span><br><span class="line">|   1 |  1000 | 小明      | 123124 |</span><br><span class="line">|   2 |  1001 | 小红      | NULL   |</span><br><span class="line">| 102 | 20001 | 曹孟德    | NULL   |</span><br><span class="line">| 103 | 20002 | 孙仲谋    | NULL   |</span><br><span class="line">+-----+-------+-----------+--------+</span><br><span class="line">4 rows in set (0.000 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [hello_mysql]&gt; INSERT INTO students (id, sn, name) VALUES (1, 10010, &#x27;唐大师&#x27;)</span><br><span class="line">    -&gt; ON DUPLICATE KEY UPDATE sn = 10010, name = &#x27;唐大师&#x27;;</span><br><span class="line">Query OK, 2 rows affected (0.001 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [hello_mysql]&gt; select * from students;</span><br><span class="line">+-----+-------+-----------+--------+</span><br><span class="line">| id  | sn    | name      | qq     |</span><br><span class="line">+-----+-------+-----------+--------+</span><br><span class="line">|   1 | 10010 | 唐大师    | 123124 |</span><br><span class="line">|   2 |  1001 | 小红      | NULL   |</span><br><span class="line">| 102 | 20001 | 曹孟德    | NULL   |</span><br><span class="line">| 103 | 20002 | 孙仲谋    | NULL   |</span><br><span class="line">+-----+-------+-----------+--------+</span><br><span class="line">4 rows in set (0.000 sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>唯一键冲突的时候，也是一样的效果，下图中是唯一键sn与原有的第二条记录冲突，最终将第二条记录的sn和name做了更新。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; select * from students;</span><br><span class="line">+-----+-------+-----------+--------+</span><br><span class="line">| id  | sn    | name      | qq     |</span><br><span class="line">+-----+-------+-----------+--------+</span><br><span class="line">|   1 | 10010 | 唐大师    | 123124 |</span><br><span class="line">|   2 |  1001 | 小红      | NULL   |</span><br><span class="line">| 102 | 20001 | 曹孟德    | NULL   |</span><br><span class="line">| 103 | 20002 | 孙仲谋    | NULL   |</span><br><span class="line">+-----+-------+-----------+--------+</span><br><span class="line">4 rows in set (0.000 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [hello_mysql]&gt; INSERT INTO students (id, sn, name) VALUES (3, 1001, &#x27;唐大师2&#x27;) ON DUPLICATE KEY UPDATE sn = 1005, name = &#x27;唐大师&#x27;;</span><br><span class="line">Query OK, 2 rows affected (0.001 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [hello_mysql]&gt; select * from students;</span><br><span class="line">+-----+-------+-----------+--------+</span><br><span class="line">| id  | sn    | name      | qq     |</span><br><span class="line">+-----+-------+-----------+--------+</span><br><span class="line">|   1 | 10010 | 唐大师    | 123124 |</span><br><span class="line">|   2 |  1005 | 唐大师    | NULL   |</span><br><span class="line">| 102 | 20001 | 曹孟德    | NULL   |</span><br><span class="line">| 103 | 20002 | 孙仲谋    | NULL   |</span><br><span class="line">+-----+-------+-----------+--------+</span><br><span class="line">4 rows in set (0.000 sec)</span><br></pre></td></tr></table></figure><p>需要注意的是，在<code>UPDATE</code>语句之后的sn也不能和已有的sn冲突，不然会因为唯一键冲突（因为你需要更新到这个值，而这个值已有了）而拒绝更新</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; INSERT INTO students (id, sn, name) VALUES (3, 1001, &#x27;唐大师2&#x27;) ON DUPLICATE KEY UPDATE sn = 10010, name = &#x27;唐大师&#x27;;</span><br><span class="line">ERROR 1062 (23000): Duplicate entry &#x27;10010&#x27; for key &#x27;sn&#x27;</span><br></pre></td></tr></table></figure><h4 id="3-1-4-替换-Replace"><a href="#3-1-4-替换-Replace" class="headerlink" title="3.1.4 替换 Replace"></a>3.1.4 替换 Replace</h4><p>除了上面那种更新的方式，我们还有一个替换语句可以用来<strong>替换</strong>值</p><ul><li>如果没有冲突则直接插入</li><li>如果已经冲突了则删除原有的记录，然后再插入</li></ul><p>这里要注意替换和<code>插入否则更新</code>的区别！<code>插入否则更新</code>是需要你指定要更新那些列的数据，而替换是会直接将原视数据删除的！</p><p>下面给出两条sql语句，其中第一条没有冲突，第二条的sn冲突</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 无冲突</span></span><br><span class="line">REPLACE <span class="keyword">INTO</span> students (sn,name) <span class="keyword">VALUES</span> (<span class="number">20000</span>,<span class="string">&#x27;闰土&#x27;</span>);</span><br><span class="line"><span class="comment">-- 有冲突</span></span><br><span class="line">REPLACE <span class="keyword">INTO</span> students (sn,name) <span class="keyword">VALUES</span> (<span class="number">1005</span>,<span class="string">&#x27;周树人&#x27;</span>);</span><br></pre></td></tr></table></figure><p>先执行第一个sql，可以看到返回的是1行受到影响，代表数据被插入</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; REPLACE INTO students (sn,name) VALUES (20000,&#x27;闰土&#x27;);</span><br><span class="line">Query OK, 1 row affected (0.001 sec)</span><br></pre></td></tr></table></figure><p>再执行有冲突的，可以看到是2行受影响，因为这条语句会删除原有的再插入，相当于执行了一次删除和一次插入，影响了两行的数据。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; REPLACE INTO students (sn,name) VALUES (1005,&#x27;周树人&#x27;);</span><br><span class="line">Query OK, 2 rows affected (0.001 sec)</span><br></pre></td></tr></table></figure><h3 id="3-2-查询-Retrieve"><a href="#3-2-查询-Retrieve" class="headerlink" title="3.2 查询 Retrieve"></a>3.2 查询 Retrieve</h3><p>查询的基础语法如下</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    [<span class="keyword">DISTINCT</span>] &#123;<span class="operator">*</span> <span class="operator">|</span> &#123;<span class="keyword">column</span> [, <span class="keyword">column</span>] ...&#125;</span><br><span class="line">    [<span class="keyword">FROM</span> table_name]</span><br><span class="line">    [<span class="keyword">WHERE</span> ...]</span><br><span class="line">    [<span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">column</span> [<span class="keyword">ASC</span> <span class="operator">|</span> <span class="keyword">DESC</span>], ...]</span><br><span class="line">    LIMIT ...</span><br></pre></td></tr></table></figure><h4 id="3-2-1-全列查询"><a href="#3-2-1-全列查询" class="headerlink" title="3.2.1 全列查询"></a>3.2.1 全列查询</h4><p>用通配符<code>*</code>表示查询整个表的数据</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from  students;</span><br></pre></td></tr></table></figure><p>该语句会查表中的所有值，在前面我们已经接触过了</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; select * from  students;</span><br><span class="line">+-----+-------+-----------+--------+</span><br><span class="line">| id  | sn    | name      | qq     |</span><br><span class="line">+-----+-------+-----------+--------+</span><br><span class="line">|   1 | 10010 | 唐大师    | 123124 |</span><br><span class="line">| 102 | 20001 | 曹孟德    | NULL   |</span><br><span class="line">| 103 | 20002 | 孙仲谋    | NULL   |</span><br><span class="line">| 104 | 20000 | 闰土      | NULL   |</span><br><span class="line">| 105 |  1005 | 周树人    | NULL   |</span><br><span class="line">+-----+-------+-----------+--------+</span><br><span class="line">5 rows in set (0.000 sec)</span><br></pre></td></tr></table></figure><p>不过一般情况下不建议用全列查询：</p><ul><li>查询的列越多，意味着需要传输的数据量越大；</li><li>可能会影响到索引的使用（后续会学习到）</li></ul><h4 id="3-2-2-指定列查询"><a href="#3-2-2-指定列查询" class="headerlink" title="3.2.2 指定列查询"></a>3.2.2 指定列查询</h4><p>所谓指定列，就是在查询的时候返回特定的列，比如如下就是在学生表里面返回sn和name这两列的数据</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> sn,name <span class="keyword">from</span>  students;</span><br></pre></td></tr></table></figure><p>执行效果如下，最终只显示了我们指定的两个列，并没有把id和qq列也给展示出来</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; select sn,name from  students;</span><br><span class="line">+-------+-----------+</span><br><span class="line">| sn    | name      |</span><br><span class="line">+-------+-----------+</span><br><span class="line">| 10010 | 唐大师    |</span><br><span class="line">| 20001 | 曹孟德    |</span><br><span class="line">| 20002 | 孙仲谋    |</span><br><span class="line">| 20000 | 闰土      |</span><br><span class="line">|  1005 | 周树人    |</span><br><span class="line">+-------+-----------+</span><br><span class="line">5 rows in set (0.000 sec)</span><br></pre></td></tr></table></figure><h4 id="3-2-3-表达式查询"><a href="#3-2-3-表达式查询" class="headerlink" title="3.2.3 表达式查询"></a>3.2.3 表达式查询</h4><p>为了进行后续的学习，我们先来构造一个测试表</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 表创建</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> exam_result (</span><br><span class="line">    id <span class="type">INT</span> UNSIGNED <span class="keyword">PRIMARY</span> KEY AUTO_INCREMENT,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;同学姓名&#x27;</span>,</span><br><span class="line">    chinese <span class="type">float</span> <span class="keyword">DEFAULT</span> <span class="number">0.0</span> COMMENT <span class="string">&#x27;语文成绩&#x27;</span>,</span><br><span class="line">    math <span class="type">float</span> <span class="keyword">DEFAULT</span> <span class="number">0.0</span> COMMENT <span class="string">&#x27;数学成绩&#x27;</span>,</span><br><span class="line">    english <span class="type">float</span> <span class="keyword">DEFAULT</span> <span class="number">0.0</span> COMMENT <span class="string">&#x27;英语成绩&#x27;</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 插入多行测试数据</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> exam_result (name, chinese, math, english) <span class="keyword">VALUES</span></span><br><span class="line">    (<span class="string">&#x27;唐三藏&#x27;</span>, <span class="number">67</span>, <span class="number">98</span>, <span class="number">56</span>),</span><br><span class="line">    (<span class="string">&#x27;孙悟空&#x27;</span>, <span class="number">87</span>, <span class="number">78</span>, <span class="number">77</span>),</span><br><span class="line">    (<span class="string">&#x27;猪悟能&#x27;</span>, <span class="number">88</span>, <span class="number">98</span>, <span class="number">90</span>),</span><br><span class="line">    (<span class="string">&#x27;曹孟德&#x27;</span>, <span class="number">82</span>, <span class="number">84</span>, <span class="number">67</span>),</span><br><span class="line">    (<span class="string">&#x27;刘玄德&#x27;</span>, <span class="number">55</span>, <span class="number">85</span>, <span class="number">45</span>),</span><br><span class="line">    (<span class="string">&#x27;孙权&#x27;</span>, <span class="number">70</span>, <span class="number">73</span>, <span class="number">78</span>),</span><br><span class="line">    (<span class="string">&#x27;宋公明&#x27;</span>, <span class="number">75</span>, <span class="number">65</span>, <span class="number">30</span>);</span><br></pre></td></tr></table></figure><p>在前面两种查询中，我们都只是查询表里面已经有的数据，但实际上我们在查询结果展示的时候，还可以让MySQL帮我们完成一定的表达式计算</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> id,name,english,<span class="number">10</span> <span class="keyword">from</span> exam_result;</span><br></pre></td></tr></table></figure><p>比如如上的sql，我们在原本的指定列查询后新增了一个10，这个10就是一个表达式，它并不包含表中已经有的字段，所以会拼接在表的原有数据之后展示出来</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; select id,name,english,10 from exam_result;</span><br><span class="line">+----+-----------+---------+----+</span><br><span class="line">| id | name      | english | 10 |</span><br><span class="line">+----+-----------+---------+----+</span><br><span class="line">|  1 | 唐三藏    |      56 | 10 |</span><br><span class="line">|  2 | 孙悟空    |      77 | 10 |</span><br><span class="line">|  3 | 猪悟能    |      90 | 10 |</span><br><span class="line">|  4 | 曹孟德    |      67 | 10 |</span><br><span class="line">|  5 | 刘玄德    |      45 | 10 |</span><br><span class="line">|  6 | 孙权      |      78 | 10 |</span><br><span class="line">|  7 | 宋公明    |      30 | 10 |</span><br><span class="line">+----+-----------+---------+----+</span><br><span class="line">7 rows in set (0.000 sec)</span><br></pre></td></tr></table></figure><p>在这里写个算式，MySQL也会帮我们计算并展示出来</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; select id,name,english,10+20 from exam_result;</span><br><span class="line">+----+-----------+---------+-------+</span><br><span class="line">| id | name      | english | 10+20 |</span><br><span class="line">+----+-----------+---------+-------+</span><br><span class="line">|  1 | 唐三藏    |      56 |    30 |</span><br><span class="line">|  2 | 孙悟空    |      77 |    30 |</span><br><span class="line">|  3 | 猪悟能    |      90 |    30 |</span><br><span class="line">|  4 | 曹孟德    |      67 |    30 |</span><br><span class="line">|  5 | 刘玄德    |      45 |    30 |</span><br><span class="line">|  6 | 孙权      |      78 |    30 |</span><br><span class="line">|  7 | 宋公明    |      30 |    30 |</span><br><span class="line">+----+-----------+---------+-------+</span><br><span class="line">7 rows in set (0.001 sec)</span><br></pre></td></tr></table></figure><p>这时候我们就可以在返回结果的时候，对原视的数据做一些处理，比如将数学和英语成绩给加起来返回</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; select id,name,english+math from exam_result;</span><br><span class="line">+----+-----------+--------------+</span><br><span class="line">| id | name      | english+math |</span><br><span class="line">+----+-----------+--------------+</span><br><span class="line">|  1 | 唐三藏    |          154 |</span><br><span class="line">|  2 | 孙悟空    |          155 |</span><br><span class="line">|  3 | 猪悟能    |          188 |</span><br><span class="line">|  4 | 曹孟德    |          151 |</span><br><span class="line">|  5 | 刘玄德    |          130 |</span><br><span class="line">|  6 | 孙权      |          151 |</span><br><span class="line">|  7 | 宋公明    |           95 |</span><br><span class="line">+----+-----------+--------------+</span><br><span class="line">7 rows in set (0.000 sec)</span><br></pre></td></tr></table></figure><h4 id="3-2-4-为表达式设置别名"><a href="#3-2-4-为表达式设置别名" class="headerlink" title="3.2.4 为表达式设置别名"></a>3.2.4 为表达式设置别名</h4><p>在表达式查询的时候，我们可以给表达式设置一些别名来提高可读性，基础语法如下</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">column</span> [<span class="keyword">AS</span>] alias_name [...] <span class="keyword">FROM</span> table_name;</span><br></pre></td></tr></table></figure><p>比如当我们将三科总分加起来返回的时候，就可以将其设置一个总分别名来返回</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; select id,name,chinese+english+math as &#x27;总分&#x27; from exam_result;</span><br><span class="line">+----+-----------+--------+</span><br><span class="line">| id | name      | 总分   |</span><br><span class="line">+----+-----------+--------+</span><br><span class="line">|  1 | 唐三藏    |    221 |</span><br><span class="line">|  2 | 孙悟空    |    242 |</span><br><span class="line">|  3 | 猪悟能    |    276 |</span><br><span class="line">|  4 | 曹孟德    |    233 |</span><br><span class="line">|  5 | 刘玄德    |    185 |</span><br><span class="line">|  6 | 孙权      |    221 |</span><br><span class="line">|  7 | 宋公明    |    170 |</span><br><span class="line">+----+-----------+--------+</span><br><span class="line">7 rows in set (0.000 sec)</span><br></pre></td></tr></table></figure><p>此时MySQL展示的是总分，而不是原视表达式，可读性更好！</p><h4 id="3-2-5-结果去重-distinct"><a href="#3-2-5-结果去重-distinct" class="headerlink" title="3.2.5 结果去重 distinct"></a>3.2.5 结果去重 distinct</h4><p>有的时候我们想知道班里同学的成绩都有那些分段，并不想看到底是谁考出来的。此时就可以使用<code>distinct</code>去重查询过滤出不重复的一个集和并展示出来</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> math <span class="keyword">from</span> exam_result;</span><br></pre></td></tr></table></figure><p>如上语句就是在展示math列的结果的时候对结果进行去重，原本的数据中98分是重复的，添加上这个关键字后，重复的98就被去掉了。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; select math from exam_result;</span><br><span class="line">+------+</span><br><span class="line">| math |</span><br><span class="line">+------+</span><br><span class="line">|   98 |</span><br><span class="line">|   78 |</span><br><span class="line">|   98 |</span><br><span class="line">|   84 |</span><br><span class="line">|   85 |</span><br><span class="line">|   73 |</span><br><span class="line">|   65 |</span><br><span class="line">+------+</span><br><span class="line">7 rows in set (0.000 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [hello_mysql]&gt; select distinct math from exam_result;</span><br><span class="line">+------+</span><br><span class="line">| math |</span><br><span class="line">+------+</span><br><span class="line">|   98 |</span><br><span class="line">|   78 |</span><br><span class="line">|   84 |</span><br><span class="line">|   85 |</span><br><span class="line">|   73 |</span><br><span class="line">|   65 |</span><br><span class="line">+------+</span><br><span class="line">6 rows in set (0.001 sec)</span><br></pre></td></tr></table></figure><h4 id="3-2-6-where条件查询"><a href="#3-2-6-where条件查询" class="headerlink" title="3.2.6 where条件查询"></a>3.2.6 where条件查询</h4><h5 id="运算符"><a href="#运算符" class="headerlink" title="运算符"></a>运算符</h5><p>说完了基本的查询，就得来看大头条件查询了，基本用法是在表名后用where带上具体条件。在那之前，先来看看where支持什么比较运算符吧</p><table><thead><tr><th>比较运算符</th><th>说明</th></tr></thead><tbody><tr><td><code>&gt;,&gt;=,&lt;,&lt;=</code></td><td>这个应该不需要说吧</td></tr><tr><td><code>=</code></td><td>等于，NULL不安全，<code>NULL=NULL</code>的结果是NULL</td></tr><tr><td><code>&lt;=&gt;</code></td><td>等于，NULL安全，<code>NULL&lt;=&gt;NULL</code>的结果是 <code>TRUE(1)</code></td></tr><tr><td><code>!=,&lt;&gt;</code></td><td>不等于</td></tr><tr><td><code>BETWEEN a AND b</code></td><td>范围匹配，闭区间，如果 <code>a&lt;=value&lt;=b</code>返回 <code>TRUE(1)</code></td></tr><tr><td><code>IN (option,...)</code></td><td>如果是option中的任意一个，则返回 <code>TRUE(1)</code></td></tr><tr><td><code>IS NULL</code></td><td>是NULL</td></tr><tr><td><code>IS NOT NULL</code></td><td>不是NULL</td></tr><tr><td><code>LIKE</code></td><td>模糊匹配，<code>%</code>表示任意多个（包括0个）字符；<code>_</code>表示任意一个字符；</td></tr></tbody></table><p>除了比较的运算符，还有<strong>逻辑</strong>运算符</p><table><thead><tr><th>逻辑运算符号</th><th>说明</th></tr></thead><tbody><tr><td>AND</td><td>与，相当于cpp中的<code>&amp;&amp;</code>，全真为1，有假为0</td></tr><tr><td>OR</td><td>或，相当于cpp中的&#96;</td></tr><tr><td>NOT</td><td>逻辑取反，条件为<code>TRUE(1)</code>的时候结果为<code>FALSE(0)</code></td></tr></tbody></table><h5 id="大于小于和区间筛选"><a href="#大于小于和区间筛选" class="headerlink" title="大于小于和区间筛选"></a>大于小于和区间筛选</h5><p>比如最基础的，查询成绩表里面某科成绩低于多少分的用户</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> name,english <span class="keyword">from</span> exam_result </span><br><span class="line"><span class="keyword">where</span> english <span class="operator">&lt;</span> <span class="number">60</span>;</span><br></pre></td></tr></table></figure><p>运行结果如下，成功展示出来了英语成绩小于60分的人</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; select name,english from exam_result where english &lt; 60;</span><br><span class="line">+-----------+---------+</span><br><span class="line">| name      | english |</span><br><span class="line">+-----------+---------+</span><br><span class="line">| 唐三藏    |      56 |</span><br><span class="line">| 刘玄德    |      45 |</span><br><span class="line">| 宋公明    |      30 |</span><br><span class="line">+-----------+---------+</span><br><span class="line">3 rows in set (0.000 sec)</span><br></pre></td></tr></table></figure><p>我们还可以用and进行拼接多个条件</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> name,chinese,english <span class="keyword">from</span> exam_result </span><br><span class="line"><span class="keyword">where</span> english <span class="operator">&lt;</span> <span class="number">60</span> <span class="keyword">and</span> chinese <span class="operator">&lt;</span> <span class="number">60</span>;</span><br></pre></td></tr></table></figure><p>比如如上sql是查询英语和语文都不及格的人</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; select name,chinese,english from exam_result where english &lt; 60 and chinese &lt; 60;</span><br><span class="line">+-----------+---------+---------+</span><br><span class="line">| name      | chinese | english |</span><br><span class="line">+-----------+---------+---------+</span><br><span class="line">| 刘玄德    |      55 |      45 |</span><br><span class="line">+-----------+---------+---------+</span><br><span class="line">1 row in set (0.000 sec)</span><br></pre></td></tr></table></figure><p>还有通过<code>between ... and ...</code>语句查询语文成绩在<code>[30,60]</code>区间的人</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; select name,chinese from exam_result where chinese between 30 and 65;</span><br><span class="line">+-----------+---------+</span><br><span class="line">| name      | chinese |</span><br><span class="line">+-----------+---------+</span><br><span class="line">| 刘玄德    |      55 |</span><br><span class="line">+-----------+---------+</span><br><span class="line">1 row in set (0.000 sec)</span><br></pre></td></tr></table></figure><p>当然，大于小于的比较也可以用于两个字段之间的比较，只要两个字段是可比较的（比如都是integer），比如如下筛选出语文比英语好的同学</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; SELECT name, chinese, english FROM exam_result WHERE chinese &gt; english;</span><br><span class="line">+-----------+---------+---------+</span><br><span class="line">| name      | chinese | english |</span><br><span class="line">+-----------+---------+---------+</span><br><span class="line">| 唐三藏    |      67 |      56 |</span><br><span class="line">| 孙悟空    |      87 |      77 |</span><br><span class="line">| 曹孟德    |      82 |      67 |</span><br><span class="line">| 刘玄德    |      55 |      45 |</span><br><span class="line">| 宋公明    |      75 |      30 |</span><br><span class="line">+-----------+---------+---------+</span><br><span class="line">5 rows in set (0.000 sec)</span><br></pre></td></tr></table></figure><h5 id="相等筛选"><a href="#相等筛选" class="headerlink" title="相等筛选"></a>相等筛选</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> name,math <span class="keyword">from</span> exam_result </span><br><span class="line"><span class="keyword">where</span> math <span class="operator">=</span> <span class="number">50</span> </span><br><span class="line">	<span class="keyword">or</span> math <span class="operator">=</span> <span class="number">59</span> </span><br><span class="line">	<span class="keyword">or</span> math <span class="operator">=</span> <span class="number">98</span> </span><br><span class="line">	<span class="keyword">or</span> math <span class="operator">=</span> <span class="number">99</span>;</span><br></pre></td></tr></table></figure><p>如上语句可以帮我们筛选出数学成绩等于 50、59、98、99其中一个的学生</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; select name,math from exam_result where math = 50 or math = 59 or math = 98 or math = 99;</span><br><span class="line">+-----------+------+</span><br><span class="line">| name      | math |</span><br><span class="line">+-----------+------+</span><br><span class="line">| 唐三藏    |   98 |</span><br><span class="line">| 猪悟能    |   98 |</span><br><span class="line">+-----------+------+</span><br><span class="line">2 rows in set (0.000 sec)</span><br></pre></td></tr></table></figure><p>和这个语句相同效果的，还有如下的in运算符</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; select name,math from exam_result where math in (50,59,98,99);</span><br><span class="line">+-----------+------+</span><br><span class="line">| name      | math |</span><br><span class="line">+-----------+------+</span><br><span class="line">| 唐三藏    |   98 |</span><br><span class="line">| 猪悟能    |   98 |</span><br><span class="line">+-----------+------+</span><br><span class="line">2 rows in set (0.001 sec)</span><br></pre></td></tr></table></figure><h5 id="字符匹配-LIKE"><a href="#字符匹配-LIKE" class="headerlink" title="字符匹配 LIKE"></a>字符匹配 LIKE</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- % 匹配多个字符，如下语句代表匹配名字为孙开头的人</span></span><br><span class="line"><span class="keyword">select</span> name <span class="keyword">from</span> exam_result <span class="keyword">where</span> name <span class="keyword">LIKE</span> <span class="string">&#x27;孙%&#x27;</span>;</span><br><span class="line"><span class="comment">-- _ 匹配单个字符，如下语句代表匹配名字开头为孙，但只有两个字的人</span></span><br><span class="line"><span class="keyword">select</span> name <span class="keyword">from</span> exam_result <span class="keyword">where</span> name <span class="keyword">LIKE</span> <span class="string">&#x27;孙_&#x27;</span>;</span><br></pre></td></tr></table></figure><p>效果如下，可以看到在第二个单字匹配的时候，就没有将孙悟空也匹配进去</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; select name from exam_result where name LIKE &#x27;孙%&#x27;;</span><br><span class="line">+-----------+</span><br><span class="line">| name      |</span><br><span class="line">+-----------+</span><br><span class="line">| 孙悟空    |</span><br><span class="line">| 孙权      |</span><br><span class="line">+-----------+</span><br><span class="line">2 rows in set (0.013 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [hello_mysql]&gt; select name from exam_result where name LIKE &#x27;孙_&#x27;;</span><br><span class="line">+--------+</span><br><span class="line">| name   |</span><br><span class="line">+--------+</span><br><span class="line">| 孙权   |</span><br><span class="line">+--------+</span><br><span class="line">1 row in set (0.000 sec)</span><br></pre></td></tr></table></figure><p>如下语句可以筛选出语文成绩大于80分且不姓孙的同学，同时用到了and和not</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; SELECT name, chinese FROM exam_result</span><br><span class="line">    -&gt; WHERE chinese &gt; 80 AND name NOT LIKE &#x27;孙%&#x27;;</span><br><span class="line">+-----------+---------+</span><br><span class="line">| name      | chinese |</span><br><span class="line">+-----------+---------+</span><br><span class="line">| 猪悟能    |      88 |</span><br><span class="line">| 曹孟德    |      82 |</span><br><span class="line">+-----------+---------+</span><br><span class="line">2 rows in set (0.000 sec)</span><br></pre></td></tr></table></figure><h5 id="计算后筛选"><a href="#计算后筛选" class="headerlink" title="计算后筛选"></a>计算后筛选</h5><p>上面我们筛选的都是字段本身，但我们还可以将一些字段加起来之后再进行筛选；</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; SELECT name, chinese + math + english 总分 FROM exam_result WHERE chinese + math + english &lt; 200;</span><br><span class="line">+-----------+--------+</span><br><span class="line">| name      | 总分   |</span><br><span class="line">+-----------+--------+</span><br><span class="line">| 刘玄德    |    185 |</span><br><span class="line">| 宋公明    |    170 |</span><br><span class="line">+-----------+--------+</span><br><span class="line">2 rows in set (0.000 sec)</span><br></pre></td></tr></table></figure><p>需要注意的是，这里虽然我们给三科分数加起来设置了别名，但是别名是不能在where条件中使用的！你可以理解为别名其实只是最终显示结果的时候被修改了，在查询的过程中别名实际上并没有生效！</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; SELECT name, chinese + math + english 总分 FROM exam_result WHERE 总分 &lt; 200;</span><br><span class="line">ERROR 1054 (42S22): Unknown column &#x27;总分&#x27; in &#x27;where clause&#x27;</span><br></pre></td></tr></table></figure><h5 id="NULL的查询"><a href="#NULL的查询" class="headerlink" title="NULL的查询"></a>NULL的查询</h5><p>在之前的<code>students</code>表中，我们有些记录的qq号是NULL，这时候应该使用 <code>IS NULL/IS NOT NULL</code>来进行针对NULL的查询</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- qq号不是空的人</span></span><br><span class="line">MariaDB [hello_mysql]<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> students <span class="keyword">where</span> qq <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------+-----------+--------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> sn    <span class="operator">|</span> name      <span class="operator">|</span> qq     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------+-----------+--------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> <span class="number">10010</span> <span class="operator">|</span> 唐大师    <span class="operator">|</span> <span class="number">123124</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------+-----------+--------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.000</span> sec)</span><br><span class="line"><span class="comment">-- qq号是空的人</span></span><br><span class="line">MariaDB [hello_mysql]<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> students <span class="keyword">where</span> qq <span class="keyword">is</span> <span class="keyword">null</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">-----+-------+-----------+------+</span></span><br><span class="line"><span class="operator">|</span> id  <span class="operator">|</span> sn    <span class="operator">|</span> name      <span class="operator">|</span> qq   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----+-------+-----------+------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">102</span> <span class="operator">|</span> <span class="number">20001</span> <span class="operator">|</span> 曹孟德    <span class="operator">|</span> <span class="keyword">NULL</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">103</span> <span class="operator">|</span> <span class="number">20002</span> <span class="operator">|</span> 孙仲谋    <span class="operator">|</span> <span class="keyword">NULL</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">104</span> <span class="operator">|</span> <span class="number">20000</span> <span class="operator">|</span> 闰土      <span class="operator">|</span> <span class="keyword">NULL</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">105</span> <span class="operator">|</span>  <span class="number">1005</span> <span class="operator">|</span> 周树人    <span class="operator">|</span> <span class="keyword">NULL</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----+-------+-----------+------+</span></span><br><span class="line"><span class="number">4</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.000</span> sec)</span><br></pre></td></tr></table></figure><p>这里我们还可以试验一下 <code>=</code>和<code>&lt;=&gt;</code>的不同，前文提到，<code>=</code>是NULL不安全的，这是因为<code>NULL=NULL为NULL</code>，而我们预期的结果应该是<code>TRUE(1)</code>。</p><p>从测试可以看出，使用 <code>=</code> 筛选出来的是空的，因为NULL在MySQL中认为是假，无法正常进行判断，而使用 <code>&lt;=&gt;</code>的成功筛选出了正确的结果</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; select * from students where qq = null;</span><br><span class="line">Empty set (0.000 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [hello_mysql]&gt; select * from students where qq &lt;=&gt; null;</span><br><span class="line">+-----+-------+-----------+------+</span><br><span class="line">| id  | sn    | name      | qq   |</span><br><span class="line">+-----+-------+-----------+------+</span><br><span class="line">| 102 | 20001 | 曹孟德    | NULL |</span><br><span class="line">| 103 | 20002 | 孙仲谋    | NULL |</span><br><span class="line">| 104 | 20000 | 闰土      | NULL |</span><br><span class="line">| 105 |  1005 | 周树人    | NULL |</span><br><span class="line">+-----+-------+-----------+------+</span><br><span class="line">4 rows in set (0.000 sec)</span><br></pre></td></tr></table></figure><p>同时我们可以将NULL和01进行一下对比，也能看出来NULL的特殊性；NULL和我们认识的真1与假0没有关系，其为一个独立的特殊值，NULL只能用来和NULL进行比较。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; SELECT NULL &lt;=&gt; NULL, NULL &lt;=&gt; 1, NULL &lt;=&gt; 0;</span><br><span class="line">+---------------+------------+------------+</span><br><span class="line">| NULL &lt;=&gt; NULL | NULL &lt;=&gt; 1 | NULL &lt;=&gt; 0 |</span><br><span class="line">+---------------+------------+------------+</span><br><span class="line">|             1 |          0 |          0 |</span><br><span class="line">+---------------+------------+------------+</span><br><span class="line">1 row in set (0.000 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [hello_mysql]&gt; SELECT NULL = NULL, NULL = 1, NULL = 0;</span><br><span class="line">+-------------+----------+----------+</span><br><span class="line">| NULL = NULL | NULL = 1 | NULL = 0 |</span><br><span class="line">+-------------+----------+----------+</span><br><span class="line">|        NULL |     NULL |     NULL |</span><br><span class="line">+-------------+----------+----------+</span><br><span class="line">1 row in set (0.000 sec)</span><br></pre></td></tr></table></figure><h5 id="查询条件不一定需要显示"><a href="#查询条件不一定需要显示" class="headerlink" title="查询条件不一定需要显示"></a>查询条件不一定需要显示</h5><p>如下，我们使用了math作为查询的条件，但最终展示的结果里面并没有math，这也是被允许的。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; select name,chinese from exam_result where math &gt; 70;</span><br><span class="line">+-----------+---------+</span><br><span class="line">| name      | chinese |</span><br><span class="line">+-----------+---------+</span><br><span class="line">| 唐三藏    |      67 |</span><br><span class="line">| 孙悟空    |      87 |</span><br><span class="line">| 猪悟能    |      88 |</span><br><span class="line">| 曹孟德    |      82 |</span><br><span class="line">| 刘玄德    |      55 |</span><br><span class="line">| 孙权      |      70 |</span><br><span class="line">+-----------+---------+</span><br><span class="line">6 rows in set (0.012 sec)</span><br></pre></td></tr></table></figure><h4 id="3-2-7-结果排序"><a href="#3-2-7-结果排序" class="headerlink" title="3.2.7 结果排序"></a>3.2.7 结果排序</h4><p>在很多时候，我们除了想获取到指定的结果，还希望对结果进行一定的排序，以筛选出更加精细的数据</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- ASC  为升序（从小到大）</span></span><br><span class="line"><span class="comment">-- DESC 为降序（从大到小）</span></span><br><span class="line"><span class="comment">-- ORDER BY 默认为 ASC</span></span><br><span class="line"><span class="keyword">SELECT</span> ... <span class="keyword">FROM</span> table_name [<span class="keyword">WHERE</span> ...]</span><br><span class="line">	<span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">column</span> [<span class="keyword">ASC</span><span class="operator">|</span><span class="keyword">DESC</span>], [...];</span><br></pre></td></tr></table></figure><p>注意：没有<code>ORDER BY</code>子句的查询，返回的顺序是<strong>未定义</strong>的（乱序）；</p><p>如果某个值是NULL，那它比任何值都<strong>小</strong>！</p><h5 id="单字段升序-x2F-降序显示"><a href="#单字段升序-x2F-降序显示" class="headerlink" title="单字段升序&#x2F;降序显示"></a>单字段升序&#x2F;降序显示</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> name, math <span class="keyword">FROM</span> exam_result <span class="keyword">ORDER</span> <span class="keyword">BY</span> math; <span class="comment">-- 默认升序</span></span><br><span class="line"><span class="keyword">SELECT</span> name, math <span class="keyword">FROM</span> exam_result <span class="keyword">ORDER</span> <span class="keyword">BY</span> math <span class="keyword">DESC</span>; <span class="comment">-- 降序</span></span><br></pre></td></tr></table></figure><p>使用这个语句，可以让结果以某个字段的升序或者降序来显示；</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; SELECT name, math FROM exam_result ORDER BY math;</span><br><span class="line">+-----------+------+</span><br><span class="line">| name      | math |</span><br><span class="line">+-----------+------+</span><br><span class="line">| 宋公明    |   65 |</span><br><span class="line">| 孙权      |   73 |</span><br><span class="line">| 孙悟空    |   78 |</span><br><span class="line">| 曹孟德    |   84 |</span><br><span class="line">| 刘玄德    |   85 |</span><br><span class="line">| 唐三藏    |   98 |</span><br><span class="line">| 猪悟能    |   98 |</span><br><span class="line">+-----------+------+</span><br><span class="line">7 rows in set (0.012 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [hello_mysql]&gt; SELECT name, math FROM exam_result ORDER BY math DESC;</span><br><span class="line">+-----------+------+</span><br><span class="line">| name      | math |</span><br><span class="line">+-----------+------+</span><br><span class="line">| 唐三藏    |   98 |</span><br><span class="line">| 猪悟能    |   98 |</span><br><span class="line">| 刘玄德    |   85 |</span><br><span class="line">| 曹孟德    |   84 |</span><br><span class="line">| 孙悟空    |   78 |</span><br><span class="line">| 孙权      |   73 |</span><br><span class="line">| 宋公明    |   65 |</span><br><span class="line">+-----------+------+</span><br><span class="line">7 rows in set (0.000 sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>NULL比所有字段都小，比如下方排序的时候，NULL会显示在已有数据的下面；</p><p>MySQL对字符串的排序是按<strong>字典序</strong>的！会根据字符的 Unicode 值进行字典顺序的比较；</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; select name,qq from students order by qq desc;</span><br><span class="line">+-----------+--------+</span><br><span class="line">| name      | qq     |</span><br><span class="line">+-----------+--------+</span><br><span class="line">| 唐大师    | 123124 |</span><br><span class="line">| 曹孟德    | NULL   |</span><br><span class="line">| 孙仲谋    | NULL   |</span><br><span class="line">| 闰土      | NULL   |</span><br><span class="line">| 周树人    | NULL   |</span><br><span class="line">+-----------+--------+</span><br><span class="line">5 rows in set (0.001 sec)</span><br></pre></td></tr></table></figure><p>排序的键值不一定需要出现在select的指定列中，如下我们最终返回的结果并没有qq，但依旧可以通过qq进行排序</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; select name from students order by qq desc;</span><br><span class="line">+-----------+</span><br><span class="line">| name      |</span><br><span class="line">+-----------+</span><br><span class="line">| 唐大师    |</span><br><span class="line">| 曹孟德    |</span><br><span class="line">| 孙仲谋    |</span><br><span class="line">| 闰土      |</span><br><span class="line">| 周树人    |</span><br><span class="line">+-----------+</span><br><span class="line">5 rows in set (0.000 sec)</span><br></pre></td></tr></table></figure><h5 id="多字段排序"><a href="#多字段排序" class="headerlink" title="多字段排序"></a>多字段排序</h5><p>多字段排序中，排序的优先级依照这里的<strong>书写顺序</strong>；</p><p>比如下面的语句就会先按数学进行降序排序，再按英语进行升序排序，最后按语文进行升序排序</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> name, math, english, chinese <span class="keyword">FROM</span> exam_result</span><br><span class="line">	<span class="keyword">ORDER</span> <span class="keyword">BY</span> math <span class="keyword">DESC</span>, english, chinese;</span><br></pre></td></tr></table></figure><p>效果如下</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; SELECT name, math, english, chinese FROM exam_result</span><br><span class="line">    -&gt; ORDER BY math DESC, english, chinese;</span><br><span class="line">+-----------+------+---------+---------+</span><br><span class="line">| name      | math | english | chinese |</span><br><span class="line">+-----------+------+---------+---------+</span><br><span class="line">| 唐三藏    |   98 |      56 |      67 |</span><br><span class="line">| 猪悟能    |   98 |      90 |      88 |</span><br><span class="line">| 刘玄德    |   85 |      45 |      55 |</span><br><span class="line">| 曹孟德    |   84 |      67 |      82 |</span><br><span class="line">| 孙悟空    |   78 |      77 |      87 |</span><br><span class="line">| 孙权      |   73 |      78 |      70 |</span><br><span class="line">| 宋公明    |   65 |      30 |      75 |</span><br><span class="line">+-----------+------+---------+---------+</span><br><span class="line">7 rows in set (0.000 sec)</span><br></pre></td></tr></table></figure><h5 id="求和后排序"><a href="#求和后排序" class="headerlink" title="求和后排序"></a>求和后排序</h5><p>在ORDER BY里面是支持表达式的，也支持别名</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 表达式</span></span><br><span class="line"><span class="keyword">SELECT</span> name, chinese <span class="operator">+</span> english <span class="operator">+</span> math <span class="keyword">FROM</span> exam_result</span><br><span class="line">	<span class="keyword">ORDER</span> <span class="keyword">BY</span> chinese <span class="operator">+</span> english <span class="operator">+</span> math <span class="keyword">DESC</span>;</span><br><span class="line"><span class="comment">-- 别名</span></span><br><span class="line"><span class="keyword">SELECT</span> name, chinese <span class="operator">+</span> english <span class="operator">+</span> math 总分 <span class="keyword">FROM</span> exam_result</span><br><span class="line">	<span class="keyword">ORDER</span> <span class="keyword">BY</span> 总分 <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure><p>效果如下</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; SELECT name, chinese + english + math FROM exam_result</span><br><span class="line">    -&gt; ORDER BY chinese + english + math DESC;</span><br><span class="line">+-----------+--------------------------+</span><br><span class="line">| name      | chinese + english + math |</span><br><span class="line">+-----------+--------------------------+</span><br><span class="line">| 猪悟能    |                      276 |</span><br><span class="line">| 孙悟空    |                      242 |</span><br><span class="line">| 曹孟德    |                      233 |</span><br><span class="line">| 唐三藏    |                      221 |</span><br><span class="line">| 孙权      |                      221 |</span><br><span class="line">| 刘玄德    |                      185 |</span><br><span class="line">| 宋公明    |                      170 |</span><br><span class="line">+-----------+--------------------------+</span><br><span class="line">7 rows in set (0.000 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [hello_mysql]&gt; SELECT name, chinese + english + math 总分 FROM exam_result</span><br><span class="line">    -&gt; ORDER BY 总分 DESC;</span><br><span class="line">+-----------+--------+</span><br><span class="line">| name      | 总分   |</span><br><span class="line">+-----------+--------+</span><br><span class="line">| 猪悟能    |    276 |</span><br><span class="line">| 孙悟空    |    242 |</span><br><span class="line">| 曹孟德    |    233 |</span><br><span class="line">| 唐三藏    |    221 |</span><br><span class="line">| 孙权      |    221 |</span><br><span class="line">| 刘玄德    |    185 |</span><br><span class="line">| 宋公明    |    170 |</span><br><span class="line">+-----------+--------+</span><br><span class="line">7 rows in set (0.000 sec)</span><br></pre></td></tr></table></figure><h5 id="where-orderby"><a href="#where-orderby" class="headerlink" title="where+orderby"></a>where+orderby</h5><p>where条件语句和排序语句联合使用</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> name, math <span class="keyword">FROM</span> exam_result</span><br><span class="line">	<span class="keyword">WHERE</span> name <span class="keyword">LIKE</span> <span class="string">&#x27;孙%&#x27;</span> <span class="keyword">OR</span> name <span class="keyword">LIKE</span> <span class="string">&#x27;曹%&#x27;</span></span><br><span class="line">	<span class="keyword">ORDER</span> <span class="keyword">BY</span> math <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; SELECT name, math FROM exam_result</span><br><span class="line">    -&gt; WHERE name LIKE &#x27;孙%&#x27; OR name LIKE &#x27;曹%&#x27;</span><br><span class="line">    -&gt; ORDER BY math DESC;</span><br><span class="line">+-----------+------+</span><br><span class="line">| name      | math |</span><br><span class="line">+-----------+------+</span><br><span class="line">| 曹孟德    |   84 |</span><br><span class="line">| 孙悟空    |   78 |</span><br><span class="line">| 孙权      |   73 |</span><br><span class="line">+-----------+------+</span><br><span class="line">3 rows in set (0.001 sec)</span><br></pre></td></tr></table></figure><h4 id="3-2-8-筛选分页结果"><a href="#3-2-8-筛选分页结果" class="headerlink" title="3.2.8 筛选分页结果"></a>3.2.8 筛选分页结果</h4><p>对表的筛选结果进行分页的语句格式如下</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 起始下标为 0</span></span><br><span class="line"><span class="comment">-- 从 0 开始，筛选 n 条结果</span></span><br><span class="line"><span class="keyword">SELECT</span> ... <span class="keyword">FROM</span> table_name [<span class="keyword">WHERE</span> ...] [<span class="keyword">ORDER</span> <span class="keyword">BY</span> ...] LIMIT n;</span><br><span class="line"><span class="comment">-- 从 s 开始，筛选 n 条结果</span></span><br><span class="line"><span class="keyword">SELECT</span> ... <span class="keyword">FROM</span> table_name [<span class="keyword">WHERE</span> ...] [<span class="keyword">ORDER</span> <span class="keyword">BY</span> ...] LIMIT s, n;</span><br><span class="line"><span class="comment">-- 从 s 开始，筛选 n 条结果，比第二种用法更明确，建议使用</span></span><br><span class="line"><span class="keyword">SELECT</span> ... <span class="keyword">FROM</span> table_name [<span class="keyword">WHERE</span> ...] [<span class="keyword">ORDER</span> <span class="keyword">BY</span> ...] LIMIT n <span class="keyword">OFFSET</span> s;</span><br></pre></td></tr></table></figure><p><strong>为什么需要分页</strong>？</p><p>假设一个表里面有上千万条数据，如果你使用<code>select * from 表</code>进行全列查询，那可能MySQL数据库就会因为要一次性给你返回大量数据而卡死，直接影响其他应用使用该数据库，导致服务宕机！</p><p>所以，在查询一个未知表的时候，建议先使用<code>desc</code>查看表结构，在再加上一个<code>LIMIT 1</code>，来查看很少的几条数据，并对数据进行人为分析，确定这个表的功能；</p><blockquote><p>当然，在项目合作中，肯定需要有人编写文档来说明这些表的作用，遇到这种情况，应该先去查项目文档再进行操作。</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> id, name, math, english, chinese <span class="keyword">FROM</span> exam_result</span><br><span class="line">	<span class="keyword">ORDER</span> <span class="keyword">BY</span> id LIMIT <span class="number">3</span> <span class="keyword">OFFSET</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure><p>上面的语句的意思是，从偏移量为0的未知（即表开头）筛选出3个数据；最终展示的就只有3条数据</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; SELECT id, name, math, english, chinese FROM exam_result</span><br><span class="line">    -&gt; ORDER BY id LIMIT 3 OFFSET 0;</span><br><span class="line">+----+-----------+------+---------+---------+</span><br><span class="line">| id | name      | math | english | chinese |</span><br><span class="line">+----+-----------+------+---------+---------+</span><br><span class="line">|  1 | 唐三藏    |   98 |      56 |      67 |</span><br><span class="line">|  2 | 孙悟空    |   78 |      77 |      87 |</span><br><span class="line">|  3 | 猪悟能    |   98 |      90 |      88 |</span><br><span class="line">+----+-----------+------+---------+---------+</span><br><span class="line">3 rows in set (0.000 sec)</span><br></pre></td></tr></table></figure><p>修改offset，可以通过id看到数据的变化</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; SELECT id, name, math, english, chinese FROM exam_result</span><br><span class="line">    -&gt; ORDER BY id LIMIT 3 OFFSET 4;</span><br><span class="line">+----+-----------+------+---------+---------+</span><br><span class="line">| id | name      | math | english | chinese |</span><br><span class="line">+----+-----------+------+---------+---------+</span><br><span class="line">|  5 | 刘玄德    |   85 |      45 |      55 |</span><br><span class="line">|  6 | 孙权      |   73 |      78 |      70 |</span><br><span class="line">|  7 | 宋公明    |   65 |      30 |      75 |</span><br><span class="line">+----+-----------+------+---------+---------+</span><br><span class="line">3 rows in set (0.001 sec)</span><br></pre></td></tr></table></figure><p>如果offset后并没有3个数据，也不会出问题，能正常显示出来</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; SELECT id, name, math, english, chinese FROM exam_result ORDER BY id LIMIT 3 OFFSET 6;</span><br><span class="line">+----+-----------+------+---------+---------+</span><br><span class="line">| id | name      | math | english | chinese |</span><br><span class="line">+----+-----------+------+---------+---------+</span><br><span class="line">|  7 | 宋公明    |   65 |      30 |      75 |</span><br><span class="line">+----+-----------+------+---------+---------+</span><br><span class="line">1 row in set (0.001 sec)</span><br></pre></td></tr></table></figure><p>如果offset大于表中已有数据数量，那就会显示空，并不会执行出错！</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; SELECT id, name, math, english, chinese FROM exam_result ORDER BY id LIMIT 3 OFFSET 10;</span><br><span class="line">Empty set (0.001 sec)</span><br></pre></td></tr></table></figure><h4 id="3-2-9-执行顺序"><a href="#3-2-9-执行顺序" class="headerlink" title="3.2.9 执行顺序"></a>3.2.9 执行顺序</h4><p>在执行这些sql语句中的语法的时候，MySQL是会有一个执行顺序的</p><ul><li>先通过from表从表中<strong>拿到数据</strong></li><li>再通过where的条件<strong>筛选</strong>数据</li><li>根据 SELECT 子句中指定的列，MySQL 最终确定要返回的数据；</li><li>筛选完毕最终需要显示的数据后，根据<code>order by</code>对数据进行<strong>排序</strong>；<strong>排序可以使用别名</strong>；排序的字段不一定需要出现在select指定的列中；</li><li>如果查询包含 <code>DISTINCT</code> 关键字，MySQL 会进行去重操作，确保结果集中的行是唯一的；</li></ul><p>在后文讲到聚合语句的时候，还会重谈一遍执行顺序</p><h3 id="3-3-更新-Update"><a href="#3-3-更新-Update" class="headerlink" title="3.3 更新 Update"></a>3.3 更新 Update</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> 表名 <span class="keyword">SET</span> 字段名 <span class="operator">=</span> 新值 <span class="keyword">WHERE</span> 查询条件...;</span><br></pre></td></tr></table></figure><h4 id="3-3-1-更新单个记录"><a href="#3-3-1-更新单个记录" class="headerlink" title="3.3.1 更新单个记录"></a>3.3.1 更新单个记录</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">-- 查看原视数据</span><br><span class="line">MariaDB [hello_mysql]&gt; SELECT name, math FROM exam_result WHERE name = &#x27;孙悟空&#x27;;</span><br><span class="line">+-----------+------+</span><br><span class="line">| name      | math |</span><br><span class="line">+-----------+------+</span><br><span class="line">| 孙悟空    |   78 |</span><br><span class="line">+-----------+------+</span><br><span class="line">1 row in set (0.000 sec)</span><br><span class="line"></span><br><span class="line">-- 更新数据</span><br><span class="line">MariaDB [hello_mysql]&gt; UPDATE exam_result SET math = 80 WHERE name = &#x27;孙悟空&#x27;;</span><br><span class="line">Query OK, 1 row affected (0.019 sec)</span><br><span class="line">Rows matched: 1  Changed: 1  Warnings: 0</span><br><span class="line"></span><br><span class="line">-- 再次查看结果，成功更新</span><br><span class="line">MariaDB [hello_mysql]&gt; SELECT name, math FROM exam_result WHERE name = &#x27;孙悟空&#x27;;</span><br><span class="line">+-----------+------+</span><br><span class="line">| name      | math |</span><br><span class="line">+-----------+------+</span><br><span class="line">| 孙悟空    |   80 |</span><br><span class="line">+-----------+------+</span><br><span class="line">1 row in set (0.000 sec)</span><br></pre></td></tr></table></figure><h4 id="3-3-2-一次更新多列"><a href="#3-3-2-一次更新多列" class="headerlink" title="3.3.2 一次更新多列"></a>3.3.2 一次更新多列</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; SELECT name, math, chinese FROM exam_result WHERE name = &#x27;曹孟德&#x27;;</span><br><span class="line">+-----------+------+---------+</span><br><span class="line">| name      | math | chinese |</span><br><span class="line">+-----------+------+---------+</span><br><span class="line">| 曹孟德    |   84 |      82 |</span><br><span class="line">+-----------+------+---------+</span><br><span class="line">1 row in set (0.001 sec)</span><br><span class="line"></span><br><span class="line">-- 一次更新多列 </span><br><span class="line">MariaDB [hello_mysql]&gt; UPDATE exam_result SET math = 60, chinese = 70 WHERE name = &#x27;曹孟德&#x27;;</span><br><span class="line">Query OK, 1 row affected (0.001 sec)</span><br><span class="line">Rows matched: 1  Changed: 1  Warnings: 0</span><br><span class="line"></span><br><span class="line">MariaDB [hello_mysql]&gt; SELECT name, math, chinese FROM exam_result WHERE name = &#x27;曹孟德&#x27;;</span><br><span class="line">+-----------+------+---------+</span><br><span class="line">| name      | math | chinese |</span><br><span class="line">+-----------+------+---------+</span><br><span class="line">| 曹孟德    |   60 |      70 |</span><br><span class="line">+-----------+------+---------+</span><br><span class="line">1 row in set (0.000 sec)</span><br></pre></td></tr></table></figure><h4 id="3-3-3-将总成绩倒数前三的数学成绩加上30分"><a href="#3-3-3-将总成绩倒数前三的数学成绩加上30分" class="headerlink" title="3.3.3 将总成绩倒数前三的数学成绩加上30分"></a>3.3.3 将总成绩倒数前三的数学成绩加上30分</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查看元数据</span></span><br><span class="line"><span class="keyword">SELECT</span> name, math, chinese <span class="operator">+</span> math <span class="operator">+</span> english 总分 <span class="keyword">FROM</span> exam_result</span><br><span class="line">	<span class="keyword">ORDER</span> <span class="keyword">BY</span> 总分 LIMIT <span class="number">3</span>;</span><br><span class="line"><span class="comment">-- 更新，需要注意不支持+=这种运算符</span></span><br><span class="line"><span class="keyword">UPDATE</span> exam_result <span class="keyword">SET</span> math <span class="operator">=</span> math <span class="operator">+</span> <span class="number">30</span></span><br><span class="line">	<span class="keyword">ORDER</span> <span class="keyword">BY</span> chinese <span class="operator">+</span> math <span class="operator">+</span> english LIMIT <span class="number">3</span>;</span><br><span class="line"><span class="comment">-- 查看更新后结果</span></span><br><span class="line"><span class="keyword">SELECT</span> name, math, chinese <span class="operator">+</span> math <span class="operator">+</span> english 总分 <span class="keyword">FROM</span> exam_result</span><br><span class="line">	<span class="keyword">WHERE</span> name <span class="keyword">IN</span> (<span class="string">&#x27;宋公明&#x27;</span>, <span class="string">&#x27;刘玄德&#x27;</span>, <span class="string">&#x27;曹孟德&#x27;</span>);</span><br><span class="line"><span class="comment">-- 按总成绩排序后结果</span></span><br><span class="line"><span class="keyword">SELECT</span> name, math, chinese <span class="operator">+</span> math <span class="operator">+</span> english 总分 <span class="keyword">FROM</span> exam_result</span><br><span class="line">	<span class="keyword">ORDER</span> <span class="keyword">BY</span> 总分 LIMIT <span class="number">3</span>;</span><br></pre></td></tr></table></figure><p>结果如下</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; SELECT name, math, chinese + math + english 总分 FROM exam_result</span><br><span class="line">    -&gt; ORDER BY 总分 LIMIT 3;</span><br><span class="line">+-----------+------+--------+</span><br><span class="line">| name      | math | 总分   |</span><br><span class="line">+-----------+------+--------+</span><br><span class="line">| 宋公明    |   65 |    170 |</span><br><span class="line">| 刘玄德    |   85 |    185 |</span><br><span class="line">| 曹孟德    |   60 |    197 |</span><br><span class="line">+-----------+------+--------+</span><br><span class="line">3 rows in set (0.000 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [hello_mysql]&gt; UPDATE exam_result SET math = math + 30</span><br><span class="line">    -&gt; ORDER BY chinese + math + english LIMIT 3;</span><br><span class="line">Query OK, 3 rows affected (0.043 sec)</span><br><span class="line">Rows matched: 3  Changed: 3  Warnings: 0</span><br><span class="line"></span><br><span class="line">MariaDB [hello_mysql]&gt; SELECT name, math, chinese + math + english 总分 FROM exam_result</span><br><span class="line">    -&gt; WHERE name IN (&#x27;宋公明&#x27;, &#x27;刘玄德&#x27;, &#x27;曹孟德&#x27;);</span><br><span class="line">+-----------+------+--------+</span><br><span class="line">| name      | math | 总分   |</span><br><span class="line">+-----------+------+--------+</span><br><span class="line">| 曹孟德    |   90 |    227 |</span><br><span class="line">| 刘玄德    |  115 |    215 |</span><br><span class="line">| 宋公明    |   95 |    200 |</span><br><span class="line">+-----------+------+--------+</span><br><span class="line">3 rows in set (0.000 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [hello_mysql]&gt; SELECT name, math, chinese + math + english 总分 FROM exam_result</span><br><span class="line">    -&gt; ORDER BY 总分 LIMIT 3;</span><br><span class="line">+-----------+------+--------+</span><br><span class="line">| name      | math | 总分   |</span><br><span class="line">+-----------+------+--------+</span><br><span class="line">| 宋公明    |   95 |    200 |</span><br><span class="line">| 刘玄德    |  115 |    215 |</span><br><span class="line">| 唐三藏    |   98 |    221 |</span><br><span class="line">+-----------+------+--------+</span><br><span class="line">3 rows in set (0.000 sec)</span><br></pre></td></tr></table></figure><h4 id="3-3-4-将所有同学的语文成绩更新为原有的2倍"><a href="#3-3-4-将所有同学的语文成绩更新为原有的2倍" class="headerlink" title="3.3.4 将所有同学的语文成绩更新为原有的2倍"></a>3.3.4 将所有同学的语文成绩更新为原有的2倍</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; SELECT * FROM exam_result;</span><br><span class="line">+----+-----------+---------+------+---------+</span><br><span class="line">| id | name      | chinese | math | english |</span><br><span class="line">+----+-----------+---------+------+---------+</span><br><span class="line">|  1 | 唐三藏    |      67 |   98 |      56 |</span><br><span class="line">|  2 | 孙悟空    |      87 |   80 |      77 |</span><br><span class="line">|  3 | 猪悟能    |      88 |   98 |      90 |</span><br><span class="line">|  4 | 曹孟德    |      70 |   90 |      67 |</span><br><span class="line">|  5 | 刘玄德    |      55 |  115 |      45 |</span><br><span class="line">|  6 | 孙权      |      70 |   73 |      78 |</span><br><span class="line">|  7 | 宋公明    |      75 |   95 |      30 |</span><br><span class="line">+----+-----------+---------+------+---------+</span><br><span class="line">7 rows in set (0.000 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [hello_mysql]&gt; UPDATE exam_result SET chinese = chinese * 2;</span><br><span class="line">Query OK, 7 rows affected (0.001 sec)</span><br><span class="line">Rows matched: 7  Changed: 7  Warnings: 0</span><br><span class="line"></span><br><span class="line">MariaDB [hello_mysql]&gt; SELECT * FROM exam_result;</span><br><span class="line">+----+-----------+---------+------+---------+</span><br><span class="line">| id | name      | chinese | math | english |</span><br><span class="line">+----+-----------+---------+------+---------+</span><br><span class="line">|  1 | 唐三藏    |     134 |   98 |      56 |</span><br><span class="line">|  2 | 孙悟空    |     174 |   80 |      77 |</span><br><span class="line">|  3 | 猪悟能    |     176 |   98 |      90 |</span><br><span class="line">|  4 | 曹孟德    |     140 |   90 |      67 |</span><br><span class="line">|  5 | 刘玄德    |     110 |  115 |      45 |</span><br><span class="line">|  6 | 孙权      |     140 |   73 |      78 |</span><br><span class="line">|  7 | 宋公明    |     150 |   95 |      30 |</span><br><span class="line">+----+-----------+---------+------+---------+</span><br><span class="line">7 rows in set (0.000 sec)</span><br></pre></td></tr></table></figure><p>更新语句的基本操作就只有这些！</p><h3 id="3-4-删除-Delete"><a href="#3-4-删除-Delete" class="headerlink" title="3.4 删除 Delete"></a>3.4 删除 Delete</h3><p>语法</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> table_name [<span class="keyword">WHERE</span> ...] [<span class="keyword">ORDER</span> <span class="keyword">BY</span> ...] [LIMIT ...]</span><br></pre></td></tr></table></figure><h4 id="3-4-1-删除孙悟空的考试成绩"><a href="#3-4-1-删除孙悟空的考试成绩" class="headerlink" title="3.4.1 删除孙悟空的考试成绩"></a>3.4.1 删除孙悟空的考试成绩</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> exam_result <span class="keyword">WHERE</span> name <span class="operator">=</span> <span class="string">&#x27;孙悟空&#x27;</span>;</span><br></pre></td></tr></table></figure><p>效果</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; SELECT * FROM exam_result;</span><br><span class="line">+----+-----------+---------+------+---------+</span><br><span class="line">| id | name      | chinese | math | english |</span><br><span class="line">+----+-----------+---------+------+---------+</span><br><span class="line">|  1 | 唐三藏    |     134 |   98 |      56 |</span><br><span class="line">|  2 | 孙悟空    |     174 |   80 |      77 |</span><br><span class="line">|  3 | 猪悟能    |     176 |   98 |      90 |</span><br><span class="line">|  4 | 曹孟德    |     140 |   90 |      67 |</span><br><span class="line">|  5 | 刘玄德    |     110 |  115 |      45 |</span><br><span class="line">|  6 | 孙权      |     140 |   73 |      78 |</span><br><span class="line">|  7 | 宋公明    |     150 |   95 |      30 |</span><br><span class="line">+----+-----------+---------+------+---------+</span><br><span class="line">7 rows in set (0.000 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [hello_mysql]&gt; DELETE FROM exam_result WHERE name = &#x27;孙悟空&#x27;;</span><br><span class="line">Query OK, 1 row affected (0.043 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [hello_mysql]&gt; SELECT * FROM exam_result;</span><br><span class="line">+----+-----------+---------+------+---------+</span><br><span class="line">| id | name      | chinese | math | english |</span><br><span class="line">+----+-----------+---------+------+---------+</span><br><span class="line">|  1 | 唐三藏    |     134 |   98 |      56 |</span><br><span class="line">|  3 | 猪悟能    |     176 |   98 |      90 |</span><br><span class="line">|  4 | 曹孟德    |     140 |   90 |      67 |</span><br><span class="line">|  5 | 刘玄德    |     110 |  115 |      45 |</span><br><span class="line">|  6 | 孙权      |     140 |   73 |      78 |</span><br><span class="line">|  7 | 宋公明    |     150 |   95 |      30 |</span><br><span class="line">+----+-----------+---------+------+---------+</span><br><span class="line">6 rows in set (0.000 sec)</span><br></pre></td></tr></table></figure><h4 id="3-4-2-删除表中所有数据（不是删除表）"><a href="#3-4-2-删除表中所有数据（不是删除表）" class="headerlink" title="3.4.2 删除表中所有数据（不是删除表）"></a>3.4.2 删除表中所有数据（不是删除表）</h4><p>慎用！不然就是从删库到跑路了！</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> 表名;</span><br></pre></td></tr></table></figure><p>注意，这个语句是删除表中所有数据，表不会被删除， <code>AUTO_INCREMENT</code> 项也不会被重置，会在原有基础上继续增加</p><h4 id="3-4-3-截断表"><a href="#3-4-3-截断表" class="headerlink" title="3.4.3 截断表"></a>3.4.3 截断表</h4><p>语法如下，这个操作更要慎用。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">TRUNCATE</span> [<span class="keyword">TABLE</span>] table_name</span><br></pre></td></tr></table></figure><ol><li>只能对整表操作，不能像 DELETE 一样针对部分数据操作；</li><li>实际上 MySQL 不对数据操作，所以比 DELETE 更快，但是TRUNCATE在删除数据的时候，并不经过真正的<strong>事务</strong>，所以无法回滚；</li><li>会重置 <code>AUTO_INCREMENT</code> 项；</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">-- 准备测试表</span><br><span class="line">CREATE TABLE for_truncate (</span><br><span class="line">id INT PRIMARY KEY AUTO_INCREMENT,</span><br><span class="line">name VARCHAR(20)</span><br><span class="line">);</span><br><span class="line">Query OK, 0 rows affected (0.16 sec)</span><br><span class="line">-- 插入测试数据</span><br><span class="line">INSERT INTO for_truncate (name) VALUES (&#x27;A&#x27;), (&#x27;B&#x27;), (&#x27;C&#x27;);</span><br><span class="line">Query OK, 3 rows affected (1.05 sec)</span><br><span class="line">Records: 3 Duplicates: 0 Warnings: 0</span><br><span class="line">-- 查看测试数据</span><br><span class="line">SELECT * FROM for_truncate;</span><br><span class="line">+----+------+</span><br><span class="line">| id | name |</span><br><span class="line">+----+------+</span><br><span class="line">| 1 | A |</span><br><span class="line">| 2 | B |</span><br><span class="line">| 3 | C |</span><br><span class="line">+----+------+</span><br><span class="line">3 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure><p>截断整表数据，注意影响行数是 0，所以实际上没有对数据真正操作</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-- 截断表</span><br><span class="line">TRUNCATE for_truncate;</span><br><span class="line">Query OK, 0 rows affected (0.10 sec)</span><br><span class="line">-- 查看删除结果</span><br><span class="line">SELECT * FROM for_truncate;</span><br><span class="line">Empty set (0.00 sec)</span><br></pre></td></tr></table></figure><p>截断数据是会重置自增键值的当前值的，新插入的数据会从1开始重新自增；</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">-- 再插入一条数据，自增 id 在重新增长</span><br><span class="line">INSERT INTO for_truncate (name) VALUES (&#x27;D&#x27;);</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line">-- 查看数据</span><br><span class="line">SELECT * FROM for_truncate;</span><br><span class="line">+----+------+</span><br><span class="line">| id | name |</span><br><span class="line">+----+------+</span><br><span class="line">| 1 | D     |</span><br><span class="line">+----+------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure><p>在linux的文件操作里面，也有一个<code>O_TRUNC</code>标记位，作用是打开文件的时候，将文件原有内容清空；</p><h3 id="3-5-插入查询结果"><a href="#3-5-插入查询结果" class="headerlink" title="3.5 插入查询结果"></a>3.5 插入查询结果</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> table_name [(<span class="keyword">column</span> [, <span class="keyword">column</span> ...])] <span class="keyword">SELECT</span> ...</span><br></pre></td></tr></table></figure><p>这个语法的作用有两个</p><ul><li>将表1的数据移植一部分到<strong>完全相同的表2</strong>（表结构要完全一致）</li><li>将表1的数据拷贝一部分到自己，相当于新增一部分冗余数据</li></ul><p>比如我们想将一个表中的重复数据给删除，但是delete语句并没有直接与之相关的语法，这时候我们就可以采取如下措施</p><ul><li>创建与表1完全相同的表2（名字改一下）</li><li>从表1中查询目标数据，并带上<code>distinct</code>对查询结果去重</li><li>将表1查询到的这个去重后的数据插入到表2</li><li>删除表1</li><li>重命名表2为表1的名字</li></ul><p>以下是一个示例操作</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">-- 创建原数据表</span><br><span class="line">CREATE TABLE duplicate_table (id int, name varchar(20));</span><br><span class="line">Query OK, 0 rows affected (0.01 sec)</span><br><span class="line"></span><br><span class="line">-- 插入测试数据，有重复</span><br><span class="line">INSERT INTO duplicate_table VALUES</span><br><span class="line">    (100, &#x27;aaa&#x27;),</span><br><span class="line">    (100, &#x27;aaa&#x27;),</span><br><span class="line">    (200, &#x27;bbb&#x27;),</span><br><span class="line">    (200, &#x27;bbb&#x27;),</span><br><span class="line">    (200, &#x27;bbb&#x27;),</span><br><span class="line">    (300, &#x27;ccc&#x27;);</span><br><span class="line">Query OK, 6 rows affected (0.002 sec)</span><br><span class="line">Records: 6  Duplicates: 0  Warnings: 0</span><br><span class="line"></span><br><span class="line">-- 创建一张空表 no_duplicate_table，结构和 duplicate_table 一样</span><br><span class="line">CREATE TABLE no_duplicate_table LIKE duplicate_table;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">-- 将 duplicate_table 的去重数据插入到 no_duplicate_table</span><br><span class="line">INSERT INTO no_duplicate_table SELECT DISTINCT * FROM duplicate_table;</span><br><span class="line">Query OK, 3 rows affected (0.002 sec)</span><br><span class="line">Records: 3  Duplicates: 0  Warnings: 0</span><br><span class="line"></span><br><span class="line">-- 重命名表</span><br><span class="line">RENAME TABLE duplicate_table TO old_duplicate_table,</span><br><span class="line">no_duplicate_table TO duplicate_table;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">-- 查看最终结果，数据没有重复</span><br><span class="line">SELECT * FROM duplicate_table;</span><br><span class="line">+------+------+</span><br><span class="line">| id | name |</span><br><span class="line">+------+------+</span><br><span class="line">| 100 | aaa |</span><br><span class="line">| 200 | bbb |</span><br><span class="line">| 300 | ccc |</span><br><span class="line">+------+------+</span><br><span class="line">3 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure><h2 id="4-聚合函数"><a href="#4-聚合函数" class="headerlink" title="4.聚合函数"></a>4.聚合函数</h2><p>聚合统计是间接或者直接统计列方向上的某些数据</p><table><thead><tr><th>函数</th><th>说明</th></tr></thead><tbody><tr><td>COUNT([DISTINCT] expr)</td><td>返回查询到的数据的 数量</td></tr><tr><td>SUM([DISTINCT] expr)</td><td>返回查询到的数据的 总和，不是数字没有意义</td></tr><tr><td>AVG([DISTINCT] expr)</td><td>返回查询到的数据的 平均值，不是数字没有意义</td></tr><tr><td>MAX([DISTINCT] expr)</td><td>返回查询到的数据的 最大值，不是数字没有意义</td></tr><tr><td>MIN([DISTINCT] expr)</td><td>返回查询到的数据的 最小值，不是数字没有意义</td></tr></tbody></table><h3 id="4-1-统计班级有多少人"><a href="#4-1-统计班级有多少人" class="headerlink" title="4.1 统计班级有多少人"></a>4.1 统计班级有多少人</h3><p>当我们需要统计表中记录个数时，可以用下面的语句。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> students;</span><br><span class="line"><span class="operator">+</span><span class="comment">----------+</span></span><br><span class="line"><span class="operator">|</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+</span></span><br><span class="line"><span class="operator">|</span>        <span class="number">5</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.000</span> sec)</span><br></pre></td></tr></table></figure><p>也可以使用下面的表达式进行统计。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="number">1</span>) <span class="keyword">FROM</span> students;</span><br><span class="line"><span class="operator">+</span><span class="comment">----------+</span></span><br><span class="line"><span class="operator">|</span> <span class="built_in">COUNT</span>(<span class="number">1</span>) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+</span></span><br><span class="line"><span class="operator">|</span>        <span class="number">5</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.000</span> sec)</span><br></pre></td></tr></table></figure><p>你会发现这里虽然是count1，但是结果依旧是5。这是因为当我们在select的目标列里面添加一个常数或者一个表达式的时候，他会<strong>追加到原有表的末尾</strong>。这里我们直接写个1，<strong>就会把1追加到表中每一行的末尾</strong>（相当于新增一列，内容全为1），所以最终统计出来的结果依旧是表中记录的个数！</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [stu_test]&gt; select * from student;</span><br><span class="line">+------+--------+</span><br><span class="line">| id   | name   |</span><br><span class="line">+------+--------+</span><br><span class="line">|    1 | 张三   |</span><br><span class="line">|    2 | 李四   |</span><br><span class="line">|    3 | 王五   |</span><br><span class="line">|    4 | 赵六   |</span><br><span class="line">|    5 | 刘七   |</span><br><span class="line">+------+--------+</span><br><span class="line">5 rows in set (0.000 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [stu_test]&gt; select *,1 from student;</span><br><span class="line">+------+--------+---+</span><br><span class="line">| id   | name   | 1 |</span><br><span class="line">+------+--------+---+</span><br><span class="line">|    1 | 张三   | 1 |</span><br><span class="line">|    2 | 李四   | 1 |</span><br><span class="line">|    3 | 王五   | 1 |</span><br><span class="line">|    4 | 赵六   | 1 |</span><br><span class="line">|    5 | 刘七   | 1 |</span><br><span class="line">+------+--------+---+</span><br><span class="line">5 rows in set (0.000 sec)</span><br></pre></td></tr></table></figure><h3 id="4-2-统计班级有多少人有qq号"><a href="#4-2-统计班级有多少人有qq号" class="headerlink" title="4.2 统计班级有多少人有qq号"></a>4.2 统计班级有多少人有qq号</h3><p>这里能看出来NULL是不计入count的</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&gt; select * from students;</span><br><span class="line">+-----+-------+-----------+--------+</span><br><span class="line">| id  | sn    | name      | qq     |</span><br><span class="line">+-----+-------+-----------+--------+</span><br><span class="line">|   1 | 10010 | 唐大师    | 123124 |</span><br><span class="line">| 102 | 20001 | 曹孟德    | NULL   |</span><br><span class="line">| 103 | 20002 | 孙仲谋    | NULL   |</span><br><span class="line">| 104 | 20000 | 闰土      | NULL   |</span><br><span class="line">| 105 |  1005 | 周树人    | NULL   |</span><br><span class="line">+-----+-------+-----------+--------+</span><br><span class="line">5 rows in set (0.000 sec)</span><br><span class="line"></span><br><span class="line">&gt; SELECT COUNT(qq) FROM students;</span><br><span class="line">+-----------+</span><br><span class="line">| COUNT(qq) |</span><br><span class="line">+-----------+</span><br><span class="line">|         1 |</span><br><span class="line">+-----------+</span><br><span class="line">1 row in set (0.000 sec)</span><br></pre></td></tr></table></figure><p>但<strong>空字符串</strong>是会被正常统计的。这里又一次展现出了空字符串和NULL的区别，NULL表达的意思就是这条记录的这个字段是没有数据的！而空字符串也是字符串的一种，对于数据库来说依旧代表有数据。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; insert into students values (2,10123,&#x27;胡图图&#x27;,&#x27;&#x27;);</span><br><span class="line">Query OK, 1 row affected (0.001 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [hello_mysql]&gt; select * from students;</span><br><span class="line">+-----+-------+-----------+--------+</span><br><span class="line">| id  | sn    | name      | qq     |</span><br><span class="line">+-----+-------+-----------+--------+</span><br><span class="line">|   1 | 10010 | 唐大师    | 123124 |</span><br><span class="line">|   2 | 10123 | 胡图图    |        |</span><br><span class="line">| 102 | 20001 | 曹孟德    | NULL   |</span><br><span class="line">| 103 | 20002 | 孙仲谋    | NULL   |</span><br><span class="line">| 104 | 20000 | 闰土      | NULL   |</span><br><span class="line">| 105 |  1005 | 周树人    | NULL   |</span><br><span class="line">+-----+-------+-----------+--------+</span><br><span class="line">6 rows in set (0.000 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [hello_mysql]&gt; SELECT COUNT(qq) FROM students;</span><br><span class="line">+-----------+</span><br><span class="line">| COUNT(qq) |</span><br><span class="line">+-----------+</span><br><span class="line">|         2 |</span><br><span class="line">+-----------+</span><br><span class="line">1 row in set (0.000 sec)</span><br></pre></td></tr></table></figure><h3 id="4-3-统计数学成绩分数的个数"><a href="#4-3-统计数学成绩分数的个数" class="headerlink" title="4.3 统计数学成绩分数的个数"></a>4.3 统计数学成绩分数的个数</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">-- COUNT(math) 统计的是全部成绩</span><br><span class="line">SELECT COUNT(math) FROM exam_result;</span><br><span class="line">+-------------+</span><br><span class="line">| COUNT(math) |</span><br><span class="line">+-------------+</span><br><span class="line">|           6 |</span><br><span class="line">+-------------+</span><br><span class="line">1 row in set (0.000 sec)</span><br><span class="line"></span><br><span class="line">-- COUNT(DISTINCT math) 统计的是去重成绩数量</span><br><span class="line">-- 这里的DISTINCT一定要放在括号里，不然是无效的，这点从语义上也能理解；</span><br><span class="line">SELECT COUNT(DISTINCT math) FROM exam_result;</span><br><span class="line">+----------------------+</span><br><span class="line">| COUNT(DISTINCT math) |</span><br><span class="line">+----------------------+</span><br><span class="line">|                    5 |</span><br><span class="line">+----------------------+</span><br><span class="line">1 row in set (0.001 sec)</span><br></pre></td></tr></table></figure><h3 id="4-4-统计数学成绩总分"><a href="#4-4-统计数学成绩总分" class="headerlink" title="4.4 统计数学成绩总分"></a>4.4 统计数学成绩总分</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [hello_mysql]&gt; SELECT SUM(math) FROM exam_result;</span><br><span class="line">+-----------+</span><br><span class="line">| SUM(math) |</span><br><span class="line">+-----------+</span><br><span class="line">|       569 |</span><br><span class="line">+-----------+</span><br><span class="line">1 row in set (0.000 sec)</span><br><span class="line"></span><br><span class="line">-- 没有结果的时候，返回NULL</span><br><span class="line">MariaDB [hello_mysql]&gt; SELECT SUM(math) FROM exam_result WHERE math &lt; 60;</span><br><span class="line">+-----------+</span><br><span class="line">| SUM(math) |</span><br><span class="line">+-----------+</span><br><span class="line">|      NULL |</span><br><span class="line">+-----------+</span><br><span class="line">1 row in set (0.042 sec)</span><br></pre></td></tr></table></figure><h3 id="4-5-统计平均分"><a href="#4-5-统计平均分" class="headerlink" title="4.5 统计平均分"></a>4.5 统计平均分</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT AVG(chinese + math + english) 平均总分 FROM exam_result;</span><br><span class="line">+--------------+</span><br><span class="line">| 平均总分      |</span><br><span class="line">+--------------+</span><br><span class="line">| 297.5        |</span><br><span class="line">+--------------+</span><br></pre></td></tr></table></figure><p>你也可以将sum和count连用来达到这个效果</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT SUM(chinese + math + english)/COUNT(1) 平均总分 FROM exam_result;</span><br><span class="line">+--------------+</span><br><span class="line">| 平均总分     |</span><br><span class="line">+--------------+</span><br><span class="line">|        297.5 |</span><br><span class="line">+--------------+</span><br><span class="line">1 row in set (0.001 sec)</span><br></pre></td></tr></table></figure><h3 id="4-6-统计最高-x2F-最低"><a href="#4-6-统计最高-x2F-最低" class="headerlink" title="4.6 统计最高&#x2F;最低"></a>4.6 统计最高&#x2F;最低</h3><p>返回英语的最高分</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT MAX(english) FROM exam_result;</span><br><span class="line">+--------------+</span><br><span class="line">| MAX(english) |</span><br><span class="line">+--------------+</span><br><span class="line">|          90  |</span><br><span class="line">+--------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure><p>返回大于七十分以上的数学最低分</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT MIN(math) FROM exam_result WHERE math &gt; 70;</span><br><span class="line">+-----------+</span><br><span class="line">| MIN(math) |</span><br><span class="line">+-----------+</span><br><span class="line">|        73 |</span><br><span class="line">+-----------+</span><br><span class="line">1 row in set (0.001 sec)</span><br></pre></td></tr></table></figure><h2 id="5-group-by"><a href="#5-group-by" class="headerlink" title="5.group by"></a>5.group by</h2><p>基本语法如下，含义是在select的时候对结果进行一定的分组</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> column1, column2, .. <span class="keyword">from</span> <span class="keyword">table</span> <span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">column</span>;</span><br></pre></td></tr></table></figure><h3 id="5-0-测试表"><a href="#5-0-测试表" class="headerlink" title="5.0 测试表"></a>5.0 测试表</h3><p>这里给大家准备了一个比较经典的测试表，来自<code>oracle 9i</code>，你可以在我的<a target="_blank" rel="noopener" href="https://gitee.com/musnow/raspberry-practice/commit/68a8b4ee09a8909bf2bbd8c9c61f6dfd63dc7060">Gitee仓库</a>找到他；</p><p>使用ftp将这个sql传到linux里面，进入mysql的命令行，使用<code>source 文件路径</code>的语句，就可以将这个表里面的数据导入到mysql中；</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /root/scott_data.sql</span><br></pre></td></tr></table></figure><p>这个sql里面包含EMP员工表、DEPT部门表、SALGRADE工资等级表三张表结构，很方便我们进行测试；表结构如下</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [scott]&gt; desc dept;</span><br><span class="line">+--------+--------------------------+------+-----+---------+-------+</span><br><span class="line">| Field  | Type                     | Null | Key | Default | Extra |</span><br><span class="line">+--------+--------------------------+------+-----+---------+-------+</span><br><span class="line">| deptno | int(2) unsigned zerofill | NO   |     | NULL    |       |</span><br><span class="line">| dname  | varchar(14)              | YES  |     | NULL    |       |</span><br><span class="line">| loc    | varchar(13)              | YES  |     | NULL    |       |</span><br><span class="line">+--------+--------------------------+------+-----+---------+-------+</span><br><span class="line">3 rows in set (0.001 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [scott]&gt; desc salgrade;</span><br><span class="line">+-------+---------+------+-----+---------+-------+</span><br><span class="line">| Field | Type    | Null | Key | Default | Extra |</span><br><span class="line">+-------+---------+------+-----+---------+-------+</span><br><span class="line">| grade | int(11) | YES  |     | NULL    |       |</span><br><span class="line">| losal | int(11) | YES  |     | NULL    |       |</span><br><span class="line">| hisal | int(11) | YES  |     | NULL    |       |</span><br><span class="line">+-------+---------+------+-----+---------+-------+</span><br><span class="line">3 rows in set (0.001 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [scott]&gt; desc emp;</span><br><span class="line">+----------+--------------------------+------+-----+---------+-------+</span><br><span class="line">| Field    | Type                     | Null | Key | Default | Extra |</span><br><span class="line">+----------+--------------------------+------+-----+---------+-------+</span><br><span class="line">| empno    | int(6) unsigned zerofill | NO   |     | NULL    |       |</span><br><span class="line">| ename    | varchar(10)              | YES  |     | NULL    |       |</span><br><span class="line">| job      | varchar(9)               | YES  |     | NULL    |       |</span><br><span class="line">| mgr      | int(4) unsigned zerofill | YES  |     | NULL    |       |</span><br><span class="line">| hiredate | datetime                 | YES  |     | NULL    |       |</span><br><span class="line">| sal      | decimal(7,2)             | YES  |     | NULL    |       |</span><br><span class="line">| comm     | decimal(7,2)             | YES  |     | NULL    |       |</span><br><span class="line">| deptno   | int(2) unsigned zerofill | YES  |     | NULL    |       |</span><br><span class="line">+----------+--------------------------+------+-----+---------+-------+</span><br><span class="line">8 rows in set (0.001 sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="5-1-如何显示每个部门的平均工资和最高工资"><a href="#5-1-如何显示每个部门的平均工资和最高工资" class="headerlink" title="5.1 如何显示每个部门的平均工资和最高工资"></a>5.1 如何显示每个部门的平均工资和最高工资</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> deptno,<span class="built_in">avg</span>(sal),<span class="built_in">max</span>(sal) <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> deptno;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+-------------+----------+</span></span><br><span class="line"><span class="operator">|</span> deptno <span class="operator">|</span> <span class="built_in">avg</span>(sal)    <span class="operator">|</span> <span class="built_in">max</span>(sal) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+-------------+----------+</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">10</span> <span class="operator">|</span> <span class="number">2916.666667</span> <span class="operator">|</span>  <span class="number">5000.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">20</span> <span class="operator">|</span> <span class="number">2175.000000</span> <span class="operator">|</span>  <span class="number">3000.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">30</span> <span class="operator">|</span> <span class="number">1566.666667</span> <span class="operator">|</span>  <span class="number">2850.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+-------------+----------+</span></span><br><span class="line"><span class="number">3</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.012</span> sec)</span><br></pre></td></tr></table></figure><p>需要注意的是，这里的<strong>聚合函数</strong>（比如<code>avg(sal)</code>）是无法用作where的条件的，因为<strong>where的执行顺序早于聚合函数</strong>，你连目标数据都还没有通过where筛选出来，怎么可以聚合呢？</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> deptno,<span class="built_in">avg</span>(sal),<span class="built_in">max</span>(sal) <span class="keyword">from</span> emp <span class="keyword">where</span> <span class="built_in">avg</span>(sal)<span class="operator">&gt;</span><span class="number">200</span> <span class="keyword">group</span> <span class="keyword">by</span> deptno;</span><br></pre></td></tr></table></figure><p>尝试用聚合函数来做where的筛选条件，执行的时候会报错</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [scott]&gt; select deptno,avg(sal),max(sal) from emp where avg(sal)&gt;200 group by deptno;</span><br><span class="line">ERROR 1111 (HY000): Invalid use of group function</span><br></pre></td></tr></table></figure><h4 id="group-by的限制"><a href="#group-by的限制" class="headerlink" title="group by的限制"></a>group by的限制</h4><p>在MySQL中，当你使用了group by之后，select的结果指定列就只能包含<code>group by</code>里面出现过的列，以及聚合函数；</p><p>但在我当前使用的mariadb中并没有出现这个报错，即便group by后没有出现ename字段，数据依旧可以被筛选出来。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [scott]&gt; select ename,deptno,job,avg(sal) as 平均工资, min(sal) as 最低工资 from emp group by deptno,job;</span><br><span class="line">+--------+--------+-----------+--------------+--------------+</span><br><span class="line">| ename  | deptno | job       | 平均工资     | 最低工资     |</span><br><span class="line">+--------+--------+-----------+--------------+--------------+</span><br><span class="line">| MILLER |     10 | CLERK     |  1300.000000 |      1300.00 |</span><br><span class="line">| CLARK  |     10 | MANAGER   |  2450.000000 |      2450.00 |</span><br><span class="line">| KING   |     10 | PRESIDENT |  5000.000000 |      5000.00 |</span><br><span class="line">| SCOTT  |     20 | ANALYST   |  3000.000000 |      3000.00 |</span><br><span class="line">| SMITH  |     20 | CLERK     |   950.000000 |       800.00 |</span><br><span class="line">| JONES  |     20 | MANAGER   |  2975.000000 |      2975.00 |</span><br><span class="line">| JAMES  |     30 | CLERK     |   950.000000 |       950.00 |</span><br><span class="line">| BLAKE  |     30 | MANAGER   |  2850.000000 |      2850.00 |</span><br><span class="line">| ALLEN  |     30 | SALESMAN  |  1400.000000 |      1250.00 |</span><br><span class="line">+--------+--------+-----------+--------------+--------------+</span><br><span class="line">9 rows in set (0.001 sec)</span><br></pre></td></tr></table></figure><p>为了确认这个问题，我使用docker部署了一个旧版本的MySQL5.7，加载scott表后使用相同的SQL命令进行测试。在Linux中安装完毕docker后，使用如下命令创建一个MySQL5.7版本的docker容器。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo docker run -d \</span><br><span class="line">    -p 13306:3306 \</span><br><span class="line">    -v /home/wsl/docker/mysql5.7/log:/var/log/mysql \</span><br><span class="line">    -v /home/wsl/docker/mysql5.7/data:/var/lib/mysql \</span><br><span class="line">    -v /home/wsl/docker/mysql5.7/conf:/etc/mysql/conf.d \</span><br><span class="line">    -e MYSQL_ROOT_PASSWORD=123456 \</span><br><span class="line">    --name mysql57 \</span><br><span class="line">    mysql:5.7</span><br></pre></td></tr></table></figure><p>将<code>scott_data.sql</code>拷贝到<code>/home/wsl/docker/mysql5.7/conf</code>里面，并使用如下命令在MySQL命令行中加载</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 在linux中执行如下命令进入docker中MySQL的命令行</span></span><br><span class="line">sudo docker <span class="built_in">exec</span> -it mysql57 mysql -uroot -p123456</span><br><span class="line"><span class="comment">## 在MySQL命令行中加载sql文件</span></span><br><span class="line"><span class="built_in">source</span> /etc/mysql/conf.d/scott_data.sql</span><br></pre></td></tr></table></figure><p>随后切换到数据库，尝试执行上面这个group by的SQL语句。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ename,deptno,job,<span class="built_in">avg</span>(sal), <span class="built_in">min</span>(sal)</span><br><span class="line"><span class="keyword">from</span> emp </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> deptno,job;</span><br></pre></td></tr></table></figure><p>会发现在MySQL5.7中是不允许这么执行的，因为ename并不在group by的分组列中。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select ename,deptno,job,avg(sal), min(sal)</span><br><span class="line">    -&gt; from emp </span><br><span class="line">    -&gt; group by deptno,job;</span><br><span class="line">ERROR 1055 (42000): Expression #1 of SELECT list is not in GROUP BY clause and contains nonaggregated column &#x27;scott.emp.ename&#x27; which is not functionally dependent on columns in GROUP BY clause; this is incompatible with sql_mode=only_full_group_by</span><br></pre></td></tr></table></figure><p>如果将select中的ename去掉，则可以被执行</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select deptno,job,avg(sal), min(sal) from emp  group by deptno,job;</span><br><span class="line">+--------+-----------+-------------+----------+</span><br><span class="line">| deptno | job       | avg(sal)    | min(sal) |</span><br><span class="line">+--------+-----------+-------------+----------+</span><br><span class="line">|     10 | CLERK     | 1300.000000 |  1300.00 |</span><br><span class="line">|     10 | MANAGER   | 2450.000000 |  2450.00 |</span><br><span class="line">|     10 | PRESIDENT | 5000.000000 |  5000.00 |</span><br><span class="line">|     20 | ANALYST   | 3000.000000 |  3000.00 |</span><br><span class="line">|     20 | CLERK     |  950.000000 |   800.00 |</span><br><span class="line">|     20 | MANAGER   | 2975.000000 |  2975.00 |</span><br><span class="line">|     30 | CLERK     |  950.000000 |   950.00 |</span><br><span class="line">|     30 | MANAGER   | 2850.000000 |  2850.00 |</span><br><span class="line">|     30 | SALESMAN  | 1400.000000 |  1250.00 |</span><br><span class="line">+--------+-----------+-------------+----------+</span><br><span class="line">9 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure><p>然后，我又在一个<code>MySQL 8.0.30</code>的docker中尝试执行相同操作（这里就不复述加载表的命令了）会发现MySQL8中同样存在这个限制！</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select ename,deptno,job,avg(sal), min(sal)</span><br><span class="line">    -&gt; from emp </span><br><span class="line">    -&gt; group by deptno,job;</span><br><span class="line">ERROR 1055 (42000): Expression #1 of SELECT list is not in GROUP BY clause and contains nonaggregated column &#x27;scott.emp.ename&#x27; which is not functionally dependent on columns in GROUP BY clause; this is incompatible with sql_mode=only_full_group_by</span><br><span class="line">mysql&gt; select deptno,job,avg(sal), min(sal) from emp  group by deptno,job;</span><br><span class="line">+--------+-----------+-------------+----------+</span><br><span class="line">| deptno | job       | avg(sal)    | min(sal) |</span><br><span class="line">+--------+-----------+-------------+----------+</span><br><span class="line">|     20 | CLERK     |  950.000000 |   800.00 |</span><br><span class="line">|     30 | SALESMAN  | 1400.000000 |  1250.00 |</span><br><span class="line">|     20 | MANAGER   | 2975.000000 |  2975.00 |</span><br><span class="line">|     30 | MANAGER   | 2850.000000 |  2850.00 |</span><br><span class="line">|     10 | MANAGER   | 2450.000000 |  2450.00 |</span><br><span class="line">|     20 | ANALYST   | 3000.000000 |  3000.00 |</span><br><span class="line">|     10 | PRESIDENT | 5000.000000 |  5000.00 |</span><br><span class="line">|     30 | CLERK     |  950.000000 |   950.00 |</span><br><span class="line">|     10 | CLERK     | 1300.000000 |  1300.00 |</span><br><span class="line">+--------+-----------+-------------+----------+</span><br><span class="line">9 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure><p>结论：MySQL5.7和8.0.30中都存在对<strong>select后只能出现group by中已出现的列或聚合函数</strong>的限制，而<code>10.6.16-MariaDB</code>不存在这个限制！</p><h3 id="5-2-显示每个部门的每种岗位的平均工资和最低工资"><a href="#5-2-显示每个部门的每种岗位的平均工资和最低工资" class="headerlink" title="5.2 显示每个部门的每种岗位的平均工资和最低工资"></a>5.2 显示每个部门的每种岗位的平均工资和最低工资</h3><p>使用聚合函数和group by来解决，题目要求是每个部门+每个岗位，所以有两个筛选条件，group by后面也要带上这两个列。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&gt; select avg(sal),min(sal),job, deptno from emp group by deptno, job;</span><br><span class="line">+-------------+----------+-----------+--------+</span><br><span class="line">| avg(sal)    | min(sal) | job       | deptno |</span><br><span class="line">+-------------+----------+-----------+--------+</span><br><span class="line">| 1300.000000 |  1300.00 | CLERK     |     10 |</span><br><span class="line">| 2450.000000 |  2450.00 | MANAGER   |     10 |</span><br><span class="line">| 5000.000000 |  5000.00 | PRESIDENT |     10 |</span><br><span class="line">| 3000.000000 |  3000.00 | ANALYST   |     20 |</span><br><span class="line">|  950.000000 |   800.00 | CLERK     |     20 |</span><br><span class="line">| 2975.000000 |  2975.00 | MANAGER   |     20 |</span><br><span class="line">|  950.000000 |   950.00 | CLERK     |     30 |</span><br><span class="line">| 2850.000000 |  2850.00 | MANAGER   |     30 |</span><br><span class="line">| 1400.000000 |  1250.00 | SALESMAN  |     30 |</span><br><span class="line">+-------------+----------+-----------+--------+</span><br><span class="line">9 rows in set (0.000 sec)</span><br></pre></td></tr></table></figure><h3 id="5-3-显示平均工资低于2000的部门和他的平均工资"><a href="#5-3-显示平均工资低于2000的部门和他的平均工资" class="headerlink" title="5.3 显示平均工资低于2000的部门和他的平均工资"></a>5.3 显示平均工资低于2000的部门和他的平均工资</h3><p>因为<strong>聚合函数</strong>的结果无法作为<code>where</code>的条件，所以MySQL额外提供了一个having关键字，用于在聚合查询中，可以使用<strong>聚合函数</strong>对数据进一步进行筛选。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 统计各个部门的平均工资</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">avg</span>(sal) <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> deptno</span><br><span class="line"><span class="comment">-- 通过having筛选出平均工资低于2000的结果</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">avg</span>(sal) <span class="keyword">as</span> myavg <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> deptno <span class="keyword">having</span> myavg<span class="operator">&lt;</span><span class="number">2000</span>;</span><br></pre></td></tr></table></figure><p>这里可以看到，having是可以支持select中设置的<strong>别名</strong>的，这也告诉我们，having的语句是<strong>晚于</strong><code>select指定列</code>执行的；</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt; select avg(sal) as myavg from emp group by deptno having myavg&lt;2000;</span><br><span class="line">+-------------+</span><br><span class="line">| myavg       |</span><br><span class="line">+-------------+</span><br><span class="line">| 1566.666667 |</span><br><span class="line">+-------------+</span><br><span class="line">1 row in set (0.042 sec)</span><br></pre></td></tr></table></figure><h3 id="5-4-显示10号部门的某个岗位的平均工资低于2000的岗位"><a href="#5-4-显示10号部门的某个岗位的平均工资低于2000的岗位" class="headerlink" title="5.4 显示10号部门的某个岗位的平均工资低于2000的岗位"></a>5.4 显示10号部门的某个岗位的平均工资低于2000的岗位</h3><p>having和where可以同时使用，where用于初步的拆选，having用于最终结果的筛选。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> job,<span class="built_in">avg</span>(sal),<span class="built_in">min</span>(sal) <span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">where</span> deptno <span class="operator">=</span> <span class="number">10</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> job</span><br><span class="line"><span class="keyword">having</span> <span class="built_in">avg</span>(sal) <span class="operator">&lt;</span> <span class="number">2000</span>;</span><br></pre></td></tr></table></figure><p>结果如下，可见在10号部门中，只有CLERK岗位的平均工资低于2000元。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [scott]&gt; select job,avg(sal),min(sal) from emp where deptno = 10 group by job having avg(sal) &lt; 2000;</span><br><span class="line">+-------+-------------+----------+</span><br><span class="line">| job   | avg(sal)    | min(sal) |</span><br><span class="line">+-------+-------------+----------+</span><br><span class="line">| CLERK | 1300.000000 |  1300.00 |</span><br><span class="line">+-------+-------------+----------+</span><br><span class="line">1 row in set (0.001 sec)</span><br></pre></td></tr></table></figure><h3 id="5-5-小结"><a href="#5-5-小结" class="headerlink" title="5.5 小结"></a>5.5 小结</h3><ol><li>group by通过对结果集分组，为<strong>聚合统计</strong>提供基本的功能支持；</li><li>group by后跟随的是分组的字段依据，只有在group by后面出现过的字段，在聚合统计时，才能在select中出现（MySQL中存在此限制，MariaDB取消了此限制）；</li><li>where语句是在表中数据初步被筛选的时候，来起效果的;</li><li>having语句是在完成整个分组聚合统计后再进行筛选;</li></ol><h2 id="6-SQL各个语句执行顺序"><a href="#6-SQL各个语句执行顺序" class="headerlink" title="6.SQL各个语句执行顺序"></a>6.SQL各个语句执行顺序</h2><p>面试的时候常考，建议记住</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">from &gt; on &gt; join &gt; where</span><br><span class="line">&gt; group by &gt; with &gt; having &gt; select</span><br><span class="line">&gt; distinct &gt; order by &gt; limit</span><br></pre></td></tr></table></figure><p>以如下的语句为例，执行顺序参考我的圆圈数字标记</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> deptno, <span class="built_in">avg</span>(sal) <span class="keyword">as</span> myavg ④ <span class="keyword">from</span> emp ① </span><br><span class="line">	<span class="keyword">where</span> sal <span class="operator">&gt;</span> <span class="number">1000</span> ②</span><br><span class="line">	<span class="keyword">group</span> <span class="keyword">by</span> deptno ③</span><br><span class="line">	<span class="keyword">having</span> myavg <span class="operator">&lt;</span> <span class="number">2000</span> ⑤; </span><br></pre></td></tr></table></figure><p>注意，select必须等having和group by筛选出数据之后才能执行。group by&#x2F;having中可以使用select中设置的别名是MySQL进行了SQL优化之后的结果。</p><h2 id="7-视图"><a href="#7-视图" class="headerlink" title="7.视图"></a>7.视图</h2><h3 id="7-1-创建视图"><a href="#7-1-创建视图" class="headerlink" title="7.1 创建视图"></a>7.1 创建视图</h3><p>在MySQL中还有一个特殊的虚拟表，被称作视图；其可以将一个select语句的查询结果视作一个新表，供我们使用；</p><p>请注意！这里的视图要和事务中的<code>ReadView</code>做区分，两者毫无关系！</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> 视图名 <span class="keyword">as</span> <span class="keyword">select</span> ...;</span><br></pre></td></tr></table></figure><p>比如在<a target="_blank" rel="noopener" href="https://gitee.com/musnows/raspberry-practice/blob/master/code/test/scott_data.sql">scott的测试表</a>中，包含如下3个表；</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [scott]&gt; show tables;</span><br><span class="line">+-----------------+</span><br><span class="line">| Tables_in_scott |</span><br><span class="line">+-----------------+</span><br><span class="line">| dept            |</span><br><span class="line">| emp             |</span><br><span class="line">| salgrade        |</span><br><span class="line">+-----------------+</span><br><span class="line">3 rows in set (0.001 sec)</span><br></pre></td></tr></table></figure><p>我们可以用如下语句创建一个视图</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> v_ename_dname <span class="keyword">as</span> </span><br><span class="line">	<span class="keyword">select</span> ename, dname</span><br><span class="line">	<span class="keyword">from</span> emp,dept </span><br><span class="line">	<span class="keyword">where</span> emp.deptno<span class="operator">=</span>dept.deptno;</span><br></pre></td></tr></table></figure><p>创建了之后，这个视图会以一个新表的形式出现在tables中</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [scott]&gt; show tables;</span><br><span class="line">+-----------------+</span><br><span class="line">| Tables_in_scott |</span><br><span class="line">+-----------------+</span><br><span class="line">| dept            |</span><br><span class="line">| emp             |</span><br><span class="line">| salgrade        |</span><br><span class="line">| v_ename_dname   |</span><br><span class="line">+-----------------+</span><br><span class="line">4 rows in set (0.000 sec)</span><br></pre></td></tr></table></figure><p>这个表的查询结果和直接执行原有的select语句是完全一致的。</p><p>我们把视图涉及到的数据原有表叫做<strong>基表</strong>；</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [scott]&gt; select * from v_ename_dname;</span><br><span class="line">+--------+------------+</span><br><span class="line">| ename  | dname      |</span><br><span class="line">+--------+------------+</span><br><span class="line">| SMITH  | RESEARCH   |</span><br><span class="line">| ALLEN  | SALES      |</span><br><span class="line">| WARD   | SALES      |</span><br><span class="line">| JONES  | RESEARCH   |</span><br><span class="line">| MARTIN | SALES      |</span><br><span class="line">| BLAKE  | SALES      |</span><br><span class="line">| CLARK  | ACCOUNTING |</span><br><span class="line">| SCOTT  | RESEARCH   |</span><br><span class="line">| KING   | ACCOUNTING |</span><br><span class="line">| TURNER | SALES      |</span><br><span class="line">| ADAMS  | RESEARCH   |</span><br><span class="line">| JAMES  | SALES      |</span><br><span class="line">| FORD   | RESEARCH   |</span><br><span class="line">| MILLER | ACCOUNTING |</span><br><span class="line">+--------+------------+</span><br><span class="line">14 rows in set (0.001 sec)</span><br></pre></td></tr></table></figure><p>进入MySQL的存储路径，你会发现视图只有一个<code>.frm</code>文件，是不会有保存数据的<code>.ibd</code>文件的；这也代表视图是一个变相的数据链接，并不会拷贝数据；</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@vm-cnt8:/var/lib/mysql/scott]# ls</span><br><span class="line">db.opt  dept.frm  dept.ibd  emp.frm  emp.ibd  salgrade.frm  salgrade.ibd  v_ename_dname.frm</span><br></pre></td></tr></table></figure><p><strong>如果修改视图，会对基表数据有影响；修改基表，也会对视图有影响</strong>；</p><p>删除视图不会影响基表中的数据；</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">view</span> 视图;</span><br></pre></td></tr></table></figure><h3 id="7-2-视图的规则和限制"><a href="#7-2-视图的规则和限制" class="headerlink" title="7.2 视图的规则和限制"></a>7.2 视图的规则和限制</h3><p>对于MySQL而言，视图是一个用于权限控制&#x2F;应用控制的好方式。你可以给某些用户特定视图的权限，而不给他们整张表的权限。这样就能在一定程度上避免数据泄露，保护安全性。</p><ul><li>与表一样，必须唯一命名（不能出现同名视图或表名）</li><li>创建视图数目无限制，但要考虑复杂查询创建为视图之后的性能影响</li><li>视图不能添加索引，也不能有关联的触发器或者默认值</li><li>视图可以提高安全性，必须具有足够的访问权限；</li><li>order by 可以用在查询视图的数据中，但是如果从该视图检索数据 select 中也含有 order by，那么该视图查询中的 order by 将被覆盖</li><li>视图可以和表一起使用</li><li><strong>不是所有视图都可以被更新</strong></li></ul><h2 id="8-从文件中加载数据到对应表"><a href="#8-从文件中加载数据到对应表" class="headerlink" title="8.从文件中加载数据到对应表"></a>8.从文件中加载数据到对应表</h2><h3 id="8-1-基本语法"><a href="#8-1-基本语法" class="headerlink" title="8.1 基本语法"></a>8.1 基本语法</h3><p>mariadb 支持通过 load 命令命令加载文件中的数据到对应表。命令格式如下</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">LOAD DATA INFILE <span class="string">&#x27;/path/to/data/file&#x27;</span> <span class="keyword">INTO</span> <span class="keyword">TABLE</span> my_table</span><br><span class="line">FIELDS TERMINATED <span class="keyword">BY</span> <span class="string">&#x27;,&#x27;</span> ENCLOSED <span class="keyword">BY</span> <span class="string">&#x27;&quot;&#x27;</span></span><br><span class="line">LINES TERMINATED <span class="keyword">BY</span> <span class="string">&#x27;\n&#x27;</span>;</span><br></pre></td></tr></table></figure><p>其中 <code>/path/to/data/file</code> 是数据文件的路径，<code>my_table</code> 是要插入数据的表名。<code>FIELDS TERMINATED BY &#39;,&#39;</code> 指定字段之间的分隔符为逗号，<code>ENCLOSED BY &#39;&quot;&#39;</code> 表示字段值被双引号包围，<code>LINES TERMINATED BY &#39;\n&#39;</code>则表示文件中的每一行以换行符结束。</p><h3 id="8-2-测试"><a href="#8-2-测试" class="headerlink" title="8.2 测试"></a>8.2 测试</h3><p>比如我有一个 <code>pc.txt</code> 文件, 文件中的格式如下，每一行都是对齐的，每一列用空格作为分割，和字段要求对应。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1001 2.66 1024 250 2114</span><br><span class="line">1002 2.10 512  250 955</span><br><span class="line">1003 1.42 512  80  478</span><br></pre></td></tr></table></figure><p>那么在创建出来一个对应的表后，可以用如下命令来加载文件中的数据</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> PC(</span><br><span class="line">    model <span class="type">integer</span> unsigned <span class="keyword">primary</span> key,</span><br><span class="line">    speed <span class="type">float</span>(<span class="number">4</span>,<span class="number">2</span>),</span><br><span class="line">    ram <span class="type">integer</span> unsigned,</span><br><span class="line">    hd <span class="type">integer</span> unsigned,</span><br><span class="line">    price <span class="type">integer</span> unsigned</span><br><span class="line">);</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">LOAD DATA INFILE <span class="string">&#x27;/root/pc.txt&#x27;</span></span><br><span class="line"><span class="keyword">INTO</span> <span class="keyword">TABLE</span> PC</span><br><span class="line">FIELDS TERMINATED <span class="keyword">BY</span> <span class="string">&#x27;\t&#x27;</span></span><br><span class="line">(model,speed,ram,hd,price);</span><br></pre></td></tr></table></figure><p>执行后的效果如下，成功加载</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [products]&gt; LOAD DATA INFILE &#x27;/root/pc.txt&#x27;</span><br><span class="line">    -&gt; INTO TABLE PC</span><br><span class="line">    -&gt; FIELDS TERMINATED BY &#x27;\t&#x27;</span><br><span class="line">    -&gt; (model,speed,ram,hd,price);</span><br><span class="line">Query OK, 13 rows affected, 12 warnings (0.015 sec)  </span><br><span class="line">Records: 13  Deleted: 0  Skipped: 0  Warnings: 12</span><br><span class="line"></span><br><span class="line">MariaDB [products]&gt; select * from PC;</span><br><span class="line">+-------+-------+------+------+-------+</span><br><span class="line">| model | speed | ram  | hd   | price |</span><br><span class="line">+-------+-------+------+------+-------+</span><br><span class="line">|  1001 |  2.66 | 1024 |  250 |  2114 |</span><br><span class="line">|  1002 |  2.10 |  512 |  250 |   995 |</span><br><span class="line">|  1003 |  1.42 |  512 |   80 |   478 |</span><br><span class="line">|  1004 |  2.80 | 1024 |  250 |   649 |</span><br><span class="line">|  1005 |  3.20 |  512 |  250 |   630 |</span><br><span class="line">|  1006 |  3.20 | 1024 |  320 |  1049 |</span><br><span class="line">|  1007 |  2.20 | 1024 |  200 |   510 |</span><br><span class="line">|  1008 |  2.20 | 2048 |  250 |   770 |</span><br><span class="line">|  1009 |  2.00 | 1024 |  250 |   650 |</span><br><span class="line">|  1010 |  2.80 | 2048 |  300 |   770 |</span><br><span class="line">|  1011 |  1.86 | 2048 |  160 |   959 |</span><br><span class="line">|  1012 |  2.80 | 1024 |  160 |   649 |</span><br><span class="line">|  1013 |  3.06 |  512 |   80 |   529 |</span><br><span class="line">+-------+-------+------+------+-------+</span><br><span class="line">13 rows in set (0.002 sec)</span><br></pre></td></tr></table></figure><p>请注意，该命令不是万能的，很有可能出错！在加载之前，请在一个空的数据库中进行测试！</p><p>现在还有另外一个办法，就是把表结构和txt内容复制给GPT，让他帮你写个insert的SQL。</p><h2 id="The-end"><a href="#The-end" class="headerlink" title="The end"></a>The end</h2><p>基本知识就这些了!</p></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://blog.musnow.top">慕雪年华</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://blog.musnow.top/posts/2109090510/">https://blog.musnow.top/posts/2109090510/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://blog.musnow.top" target="_blank">慕雪的寒舍</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Linux/">Linux</a><a class="post-meta__tags" href="/tags/mysql/">mysql</a></div><div class="post_share"><div class="social-share" data-image="https://img.musnow.top/i/2023/04/64302610057ae.png" data-sites="wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/butterfly-extsrc/1.1.3/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdnjs.cloudflare.com/ajax/libs/butterfly-extsrc/1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://ifdian.net/a/128ahri" target="_blank"><img class="post-qr-code-img" src="/img/ico/aifadian.png" alt="爱发电"></a><div class="post-qr-code-desc">爱发电</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/2109090511/" title="【MySQL】C/C++代码操作数据库"><img class="cover" src="https://img.musnow.top/i/2023/04/64302610057ae.png" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">【MySQL】C/C++代码操作数据库</div></div></a></div><div class="next-post pull-right"><a href="/posts/577382991/" title="【MySQL】安装和基础环境配置"><img class="cover" src="https://img.musnow.top/i/2023/04/64302610057ae.png" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">【MySQL】安装和基础环境配置</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/posts/577382991/" title="【MySQL】安装和基础环境配置"><img class="cover" src="https://img.musnow.top/i/2023/04/64302610057ae.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-04-06</div><div class="title">【MySQL】安装和基础环境配置</div></div></a></div><div><a href="/posts/2109090511/" title="【MySQL】C&#x2F;C++代码操作数据库"><img class="cover" src="https://img.musnow.top/i/2023/04/64302610057ae.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-04-08</div><div class="title">【MySQL】C&#x2F;C++代码操作数据库</div></div></a></div><div><a href="/posts/2259981507/" title="【Sqlite3】maraidb和sqlite3部分命令操作区别"><img class="cover" src="https://img.musnow.top/i/2023/05/6455b03a09341.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-05-04</div><div class="title">【Sqlite3】maraidb和sqlite3部分命令操作区别</div></div></a></div></div></div><hr class="custom-hr"><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="artalk-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/favicon.jpg" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info__name">慕雪年华</div><div class="author-info__description">爱折腾的代码初学者</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">431</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">73</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">21</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/musnows"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="mailto:muxue@musnow.top" target="_blank" title="email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://gitee.com/musnows" target="_blank" title="Gitee"><i class="fa-sharp fa-solid fa-g"></i></a><a class="social-icon" href="https://blog.csdn.net/muxuen" target="_blank" title="CSDN"><i class="fa-brands fa-blogger-b"></i></a><a class="social-icon" href="https://musnow.top/?utm_source=blog" target="_blank" title="个人主页"><i class="fas fa-globe-asia"></i></a><a class="social-icon" href="https://web.musnow.top/?utm_source=blog" target="_blank" title="导航站点"><i class="fas fa-server"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="RSS"><i class="fas fa-rss-square"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来到寒舍</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80%EF%BC%9ASQL%E8%AF%AD%E5%8F%A5%E7%9A%84%E5%88%86%E7%B1%BB"><span class="toc-text">前言：SQL语句的分类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0-%E8%BF%9E%E6%8E%A5mysql"><span class="toc-text">0.连接mysql</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#0-1-%E6%9F%A5%E7%9C%8B%E6%9C%89%E8%B0%81%E8%BF%9E%E6%8E%A5%E4%BA%86"><span class="toc-text">0.1 查看有谁连接了</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0-2-%E6%9F%A5%E7%9C%8B%E6%94%AF%E6%8C%81%E7%9A%84%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E"><span class="toc-text">0.2 查看支持的存储引擎</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text">1.数据库</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E5%88%9B%E5%BB%BA"><span class="toc-text">1.1 创建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E6%9F%A5%E7%9C%8B%E5%B7%B2%E6%9C%89"><span class="toc-text">1.2 查看已有</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-%E8%BF%9B%E5%85%A5"><span class="toc-text">1.3 进入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-%E5%88%A0%E9%99%A4"><span class="toc-text">1.4 删除</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-5-%E5%AD%97%E7%AC%A6%E9%9B%86%E5%92%8C%E6%A0%A1%E9%AA%8C%E8%A7%84%E5%88%99"><span class="toc-text">1.5 字符集和校验规则</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-5-1-%E5%AD%97%E7%AC%A6%E9%9B%86"><span class="toc-text">1.5.1 字符集</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-5-2-%E6%A0%A1%E9%AA%8C%E8%A7%84%E5%88%99"><span class="toc-text">1.5.2 校验规则</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-5-3-%E5%88%9B%E5%BB%BA%E5%BA%93%E6%97%B6%E6%8C%87%E5%AE%9A"><span class="toc-text">1.5.3 创建库时指定</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-5-4-%E6%A0%A1%E9%AA%8C%E7%9A%84%E5%BD%B1%E5%93%8D"><span class="toc-text">1.5.4 校验的影响</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#utf8-bin"><span class="toc-text">utf8_bin</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#utf8-general-ci"><span class="toc-text">utf8_general_ci</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BB%93%E8%AE%BA"><span class="toc-text">结论</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-6-%E4%BF%AE%E6%94%B9"><span class="toc-text">1.6 修改</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-7-%E5%A4%87%E4%BB%BD%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text">1.7 备份数据库</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-7-1-%E5%A4%87%E4%BB%BD%E4%B8%80%E4%B8%AA%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text">1.7.1 备份一个数据库</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-7-2-%E5%A4%87%E4%BB%BD%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%AD%E7%9A%84%E5%A4%9A%E5%BC%A0%E8%A1%A8"><span class="toc-text">1.7.2 备份数据库中的多张表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-7-3-%E5%90%8C%E6%97%B6%E5%A4%87%E4%BB%BD%E5%A4%9A%E4%B8%AA%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text">1.7.3 同时备份多个数据库</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-7-4-%E8%BF%98%E5%8E%9F"><span class="toc-text">1.7.4 还原</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-7-5-%E5%8C%96%E7%AE%80"><span class="toc-text">1.7.5 化简</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-8-%E6%B8%85%E7%A9%BA%E5%B1%8F%E5%B9%95"><span class="toc-text">1.8 清空屏幕</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E8%A1%A8"><span class="toc-text">2.表</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E5%88%9B%E5%BB%BA%E8%A1%A8"><span class="toc-text">2.1 创建表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E6%9F%A5%E7%9C%8B%E5%B7%B2%E6%9C%89%E8%A1%A8"><span class="toc-text">2.2 查看已有表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E6%9F%A5%E7%9C%8B%E8%A1%A8%E7%9A%84%E5%B1%9E%E6%80%A7-x2F-%E7%BB%93%E6%9E%84"><span class="toc-text">2.3 查看表的属性&#x2F;结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-%E5%88%A0%E9%99%A4%E8%AF%A5%E8%A1%A8"><span class="toc-text">2.4 删除该表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-%E4%BF%AE%E6%94%B9%E8%A1%A8%E7%9A%84%E7%BB%93%E6%9E%84"><span class="toc-text">2.5 修改表的结构</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-0-%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-text">2.5.0 注意事项</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-1-%E6%96%B0%E5%A2%9E%E5%AD%97%E6%AE%B5"><span class="toc-text">2.5.1 新增字段</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-2-%E5%88%A0%E9%99%A4%E5%AD%97%E6%AE%B5"><span class="toc-text">2.5.2 删除字段</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-3-%E4%BF%AE%E6%94%B9%E5%AD%97%E6%AE%B5%E7%B1%BB%E5%9E%8B"><span class="toc-text">2.5.3 修改字段类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-4-%E4%BF%AE%E6%94%B9%E5%AD%97%E6%AE%B5%E5%90%8D%E5%AD%97"><span class="toc-text">2.5.4 修改字段名字</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-6-%E4%BF%AE%E6%94%B9%E8%A1%A8%E5%90%8D"><span class="toc-text">2.6 修改表名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7-%E6%96%B0%E5%A2%9E%E8%87%AA%E5%A2%9E%E4%B8%BB%E9%94%AE%E4%B8%94%E4%B8%8D%E5%BD%B1%E5%93%8D%E5%8E%9F%E6%9C%89%E6%95%B0%E6%8D%AE"><span class="toc-text">2.7 新增自增主键且不影响原有数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-8-%E8%A1%A8%E5%AD%97%E6%AE%B5%E7%9A%84%E7%BA%A6%E6%9D%9F"><span class="toc-text">2.8 表字段的约束</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%95%B0%E6%8D%AE%E8%AE%B0%E5%BD%95-CURD"><span class="toc-text">3.数据记录 CURD</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E6%96%B0%E5%A2%9E-Create"><span class="toc-text">3.1 新增 Create</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-1-%E5%8D%95%E8%A1%8C%E5%85%A8%E5%88%97%E6%8F%92%E5%85%A5"><span class="toc-text">3.1.1 单行全列插入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-2-%E5%A4%9A%E8%A1%8C%E6%8C%87%E5%AE%9A%E5%88%97%E6%8F%92%E5%85%A5"><span class="toc-text">3.1.2 多行指定列插入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-3-%E6%8F%92%E5%85%A5%E5%90%A6%E5%88%99%E6%9B%B4%E6%96%B0"><span class="toc-text">3.1.3 插入否则更新</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-4-%E6%9B%BF%E6%8D%A2-Replace"><span class="toc-text">3.1.4 替换 Replace</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E6%9F%A5%E8%AF%A2-Retrieve"><span class="toc-text">3.2 查询 Retrieve</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-1-%E5%85%A8%E5%88%97%E6%9F%A5%E8%AF%A2"><span class="toc-text">3.2.1 全列查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-2-%E6%8C%87%E5%AE%9A%E5%88%97%E6%9F%A5%E8%AF%A2"><span class="toc-text">3.2.2 指定列查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-3-%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%9F%A5%E8%AF%A2"><span class="toc-text">3.2.3 表达式查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-4-%E4%B8%BA%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%AE%BE%E7%BD%AE%E5%88%AB%E5%90%8D"><span class="toc-text">3.2.4 为表达式设置别名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-5-%E7%BB%93%E6%9E%9C%E5%8E%BB%E9%87%8D-distinct"><span class="toc-text">3.2.5 结果去重 distinct</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-6-where%E6%9D%A1%E4%BB%B6%E6%9F%A5%E8%AF%A2"><span class="toc-text">3.2.6 where条件查询</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-text">运算符</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%A4%A7%E4%BA%8E%E5%B0%8F%E4%BA%8E%E5%92%8C%E5%8C%BA%E9%97%B4%E7%AD%9B%E9%80%89"><span class="toc-text">大于小于和区间筛选</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%9B%B8%E7%AD%89%E7%AD%9B%E9%80%89"><span class="toc-text">相等筛选</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E5%8C%B9%E9%85%8D-LIKE"><span class="toc-text">字符匹配 LIKE</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E5%90%8E%E7%AD%9B%E9%80%89"><span class="toc-text">计算后筛选</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#NULL%E7%9A%84%E6%9F%A5%E8%AF%A2"><span class="toc-text">NULL的查询</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E6%9D%A1%E4%BB%B6%E4%B8%8D%E4%B8%80%E5%AE%9A%E9%9C%80%E8%A6%81%E6%98%BE%E7%A4%BA"><span class="toc-text">查询条件不一定需要显示</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-7-%E7%BB%93%E6%9E%9C%E6%8E%92%E5%BA%8F"><span class="toc-text">3.2.7 结果排序</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8D%95%E5%AD%97%E6%AE%B5%E5%8D%87%E5%BA%8F-x2F-%E9%99%8D%E5%BA%8F%E6%98%BE%E7%A4%BA"><span class="toc-text">单字段升序&#x2F;降序显示</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%A4%9A%E5%AD%97%E6%AE%B5%E6%8E%92%E5%BA%8F"><span class="toc-text">多字段排序</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B1%82%E5%92%8C%E5%90%8E%E6%8E%92%E5%BA%8F"><span class="toc-text">求和后排序</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#where-orderby"><span class="toc-text">where+orderby</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-8-%E7%AD%9B%E9%80%89%E5%88%86%E9%A1%B5%E7%BB%93%E6%9E%9C"><span class="toc-text">3.2.8 筛选分页结果</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-9-%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F"><span class="toc-text">3.2.9 执行顺序</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-%E6%9B%B4%E6%96%B0-Update"><span class="toc-text">3.3 更新 Update</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-1-%E6%9B%B4%E6%96%B0%E5%8D%95%E4%B8%AA%E8%AE%B0%E5%BD%95"><span class="toc-text">3.3.1 更新单个记录</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-2-%E4%B8%80%E6%AC%A1%E6%9B%B4%E6%96%B0%E5%A4%9A%E5%88%97"><span class="toc-text">3.3.2 一次更新多列</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-3-%E5%B0%86%E6%80%BB%E6%88%90%E7%BB%A9%E5%80%92%E6%95%B0%E5%89%8D%E4%B8%89%E7%9A%84%E6%95%B0%E5%AD%A6%E6%88%90%E7%BB%A9%E5%8A%A0%E4%B8%8A30%E5%88%86"><span class="toc-text">3.3.3 将总成绩倒数前三的数学成绩加上30分</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-4-%E5%B0%86%E6%89%80%E6%9C%89%E5%90%8C%E5%AD%A6%E7%9A%84%E8%AF%AD%E6%96%87%E6%88%90%E7%BB%A9%E6%9B%B4%E6%96%B0%E4%B8%BA%E5%8E%9F%E6%9C%89%E7%9A%842%E5%80%8D"><span class="toc-text">3.3.4 将所有同学的语文成绩更新为原有的2倍</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-%E5%88%A0%E9%99%A4-Delete"><span class="toc-text">3.4 删除 Delete</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-1-%E5%88%A0%E9%99%A4%E5%AD%99%E6%82%9F%E7%A9%BA%E7%9A%84%E8%80%83%E8%AF%95%E6%88%90%E7%BB%A9"><span class="toc-text">3.4.1 删除孙悟空的考试成绩</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-2-%E5%88%A0%E9%99%A4%E8%A1%A8%E4%B8%AD%E6%89%80%E6%9C%89%E6%95%B0%E6%8D%AE%EF%BC%88%E4%B8%8D%E6%98%AF%E5%88%A0%E9%99%A4%E8%A1%A8%EF%BC%89"><span class="toc-text">3.4.2 删除表中所有数据（不是删除表）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-3-%E6%88%AA%E6%96%AD%E8%A1%A8"><span class="toc-text">3.4.3 截断表</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5-%E6%8F%92%E5%85%A5%E6%9F%A5%E8%AF%A2%E7%BB%93%E6%9E%9C"><span class="toc-text">3.5 插入查询结果</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0"><span class="toc-text">4.聚合函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E7%BB%9F%E8%AE%A1%E7%8F%AD%E7%BA%A7%E6%9C%89%E5%A4%9A%E5%B0%91%E4%BA%BA"><span class="toc-text">4.1 统计班级有多少人</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%E7%BB%9F%E8%AE%A1%E7%8F%AD%E7%BA%A7%E6%9C%89%E5%A4%9A%E5%B0%91%E4%BA%BA%E6%9C%89qq%E5%8F%B7"><span class="toc-text">4.2 统计班级有多少人有qq号</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-%E7%BB%9F%E8%AE%A1%E6%95%B0%E5%AD%A6%E6%88%90%E7%BB%A9%E5%88%86%E6%95%B0%E7%9A%84%E4%B8%AA%E6%95%B0"><span class="toc-text">4.3 统计数学成绩分数的个数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-%E7%BB%9F%E8%AE%A1%E6%95%B0%E5%AD%A6%E6%88%90%E7%BB%A9%E6%80%BB%E5%88%86"><span class="toc-text">4.4 统计数学成绩总分</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-%E7%BB%9F%E8%AE%A1%E5%B9%B3%E5%9D%87%E5%88%86"><span class="toc-text">4.5 统计平均分</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-6-%E7%BB%9F%E8%AE%A1%E6%9C%80%E9%AB%98-x2F-%E6%9C%80%E4%BD%8E"><span class="toc-text">4.6 统计最高&#x2F;最低</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-group-by"><span class="toc-text">5.group by</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-0-%E6%B5%8B%E8%AF%95%E8%A1%A8"><span class="toc-text">5.0 测试表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E5%A6%82%E4%BD%95%E6%98%BE%E7%A4%BA%E6%AF%8F%E4%B8%AA%E9%83%A8%E9%97%A8%E7%9A%84%E5%B9%B3%E5%9D%87%E5%B7%A5%E8%B5%84%E5%92%8C%E6%9C%80%E9%AB%98%E5%B7%A5%E8%B5%84"><span class="toc-text">5.1 如何显示每个部门的平均工资和最高工资</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#group-by%E7%9A%84%E9%99%90%E5%88%B6"><span class="toc-text">group by的限制</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E6%98%BE%E7%A4%BA%E6%AF%8F%E4%B8%AA%E9%83%A8%E9%97%A8%E7%9A%84%E6%AF%8F%E7%A7%8D%E5%B2%97%E4%BD%8D%E7%9A%84%E5%B9%B3%E5%9D%87%E5%B7%A5%E8%B5%84%E5%92%8C%E6%9C%80%E4%BD%8E%E5%B7%A5%E8%B5%84"><span class="toc-text">5.2 显示每个部门的每种岗位的平均工资和最低工资</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-%E6%98%BE%E7%A4%BA%E5%B9%B3%E5%9D%87%E5%B7%A5%E8%B5%84%E4%BD%8E%E4%BA%8E2000%E7%9A%84%E9%83%A8%E9%97%A8%E5%92%8C%E4%BB%96%E7%9A%84%E5%B9%B3%E5%9D%87%E5%B7%A5%E8%B5%84"><span class="toc-text">5.3 显示平均工资低于2000的部门和他的平均工资</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-4-%E6%98%BE%E7%A4%BA10%E5%8F%B7%E9%83%A8%E9%97%A8%E7%9A%84%E6%9F%90%E4%B8%AA%E5%B2%97%E4%BD%8D%E7%9A%84%E5%B9%B3%E5%9D%87%E5%B7%A5%E8%B5%84%E4%BD%8E%E4%BA%8E2000%E7%9A%84%E5%B2%97%E4%BD%8D"><span class="toc-text">5.4 显示10号部门的某个岗位的平均工资低于2000的岗位</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-5-%E5%B0%8F%E7%BB%93"><span class="toc-text">5.5 小结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-SQL%E5%90%84%E4%B8%AA%E8%AF%AD%E5%8F%A5%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F"><span class="toc-text">6.SQL各个语句执行顺序</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E8%A7%86%E5%9B%BE"><span class="toc-text">7.视图</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-%E5%88%9B%E5%BB%BA%E8%A7%86%E5%9B%BE"><span class="toc-text">7.1 创建视图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-%E8%A7%86%E5%9B%BE%E7%9A%84%E8%A7%84%E5%88%99%E5%92%8C%E9%99%90%E5%88%B6"><span class="toc-text">7.2 视图的规则和限制</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-%E4%BB%8E%E6%96%87%E4%BB%B6%E4%B8%AD%E5%8A%A0%E8%BD%BD%E6%95%B0%E6%8D%AE%E5%88%B0%E5%AF%B9%E5%BA%94%E8%A1%A8"><span class="toc-text">8.从文件中加载数据到对应表</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95"><span class="toc-text">8.1 基本语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-2-%E6%B5%8B%E8%AF%95"><span class="toc-text">8.2 测试</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#The-end"><span class="toc-text">The end</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/7683466939/" title="【SLAM】ubuntu 18.04 下 OpenCV 3.2.0 的 opencv_example 运行闪退">【SLAM】ubuntu 18.04 下 OpenCV 3.2.0 的 opencv_example 运行闪退</a><time datetime="2025-03-01T04:59:29.000Z" title="发表于 2025-03-01 12:59:29">2025-03-01</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/8846864150/" title="【SLAM】ubuntu 18.04 编译安装 OpenCV 3.2.0 时出现哈希错误">【SLAM】ubuntu 18.04 编译安装 OpenCV 3.2.0 时出现哈希错误</a><time datetime="2025-03-01T01:40:48.000Z" title="发表于 2025-03-01 09:40:48">2025-03-01</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/3862916255/" title="【Linux】ubuntu 22.04 通过 apt 安装 python2">【Linux】ubuntu 22.04 通过 apt 安装 python2</a><time datetime="2025-03-01T00:41:16.000Z" title="发表于 2025-03-01 08:41:16">2025-03-01</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/8855455861/" title="【Hexo】hexo-butterfly主题添加影评书评页面">【Hexo】hexo-butterfly主题添加影评书评页面</a><time datetime="2025-02-12T05:49:29.000Z" title="发表于 2025-02-12 13:49:29">2025-02-12</time></div></div></div></div></div></div></main><footer id="footer" style="background-image:url(/img/main/mothra.webp)"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2025 By 慕雪年华</div><div class="footer_custom_text"><img src="/img/ico/gonganbeian.png" height="15">&nbsp;<a href="https://beian.mps.gov.cn/#/query/webSearch?code=44190002007715" rel="noreferrer" target="_blank">粤公网安备44190002007715</a><br><a href="https://icp.gov.moe/?keyword=20230054" target="_blank"><img src="/img/badge/-%E8%90%8CICP%E5%A4%8720230054-ff69b4.svg" height="20px"></a>&nbsp<a href="/sitemap.xml" target="_blank"><img src="/img/badge/-SITEMAP-00CDCD.svg" height="20px"></a>&nbsp<a href="https://beian.miit.gov.cn/" target="_blank"><img src="/img/badge/%E7%B2%A4ICP%E5%A4%872023007189-red.svg" height="20px"></a><br><a href="https://travel.moe/go.html" target="_blank"><img src="/img/ico/moe-default-white.png" style="width:auto;height:25px" title="异次元之旅-跃迁-我们一起去萌站成员的星球旅行吧！"></a>&nbsp<a href="https://www.foreverblog.cn/go.html" target="_blank"><img src="/img/ico/wormhole_1_tp.gif" height="25px"></a>&nbsp<a href="https://www.travellings.cn/go.html" target="_blank"><img src="/img/ico/travelling_icon.gif" height="25px"></a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-butterfly/4.9.0/js/utils.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-butterfly/4.9.0/js/main.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.19/fancybox/fancybox.umd.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/17.8.3/lazyload.iife.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdnjs.cloudflare.com/ajax/libs/pangu/4.0.7/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (true){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script><script>(() => {
  const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaid.length === 0) return
  const runMermaid = () => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    Array.from($mermaid).forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
      const mermaidID = 'mermaid-' + index
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)

      const renderV10 = () => {
        renderFn.then(({svg}) => {
          mermaidSrc.insertAdjacentHTML('afterend', svg)
        })
      }

      const renderV9 = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      typeof renderFn === 'string' ? renderV9(renderFn) : renderV10()
    })
  }

  const loadMermaid = () => {
    window.loadMermaid ? runMermaid() : getScript('https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.2.2/mermaid.min.js').then(runMermaid)
  }

  btf.addModeChange('mermaid', runMermaid)

  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script><script>function loadArtalk () {
  function initArtalk () {
    window.artalkItem = new Artalk(Object.assign({
      el: '#artalk-wrap',
      server: 'https://artk.musnow.top',
      site: 'mublog',
      pageKey: location.pathname,
      darkMode: document.documentElement.getAttribute('data-theme') === 'dark',
      countEl: '.artalk-count'
    },null))

    if (GLOBAL_CONFIG.lightbox === 'null') return
    window.artalkItem.use(ctx => {
      ctx.on('list-loaded', () => {
        ctx.getCommentList().forEach(comment => {
          const $content = comment.getRender().$content
          btf.loadLightbox($content.querySelectorAll('img:not([atk-emoticon])'))
        })
      })
    })
  }

  if (typeof window.artalkItem === 'object') initArtalk()
  else {
    getCSS('https://cdnjs.cloudflare.com/ajax/libs/artalk/2.5.5/Artalk.min.css').then(()=>{
      getScript('https://cdnjs.cloudflare.com/ajax/libs/artalk/2.5.5/Artalk.min.js').then(initArtalk)
    })
  }
}

function artalkChangeMode (theme) {
  const artalkWrap = document.getElementById('artalk-wrap')
  if (!(artalkWrap && artalkWrap.children.length)) return
  const isDark = theme === 'dark'
  window.artalkItem.setDarkMode(isDark)
}

btf.addModeChange('artalk', artalkChangeMode)

if ('Artalk' === 'Artalk' || !false) {
  if (false) btf.loadComment(document.getElementById('artalk-wrap'), loadArtalk)
  else loadArtalk()
} else {
  function loadOtherComment () {
    loadArtalk()
  }
}</script></div><script src="/js/domain_check.js"></script><script id="click-heart" src="https://cdnjs.cloudflare.com/ajax/libs/butterfly-extsrc/1.1.3/click-heart.min.js" async mobile="false"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span> 数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div><hr><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-butterfly/4.9.0/js/search/local-search.min.js"></script></div></div></body></html>