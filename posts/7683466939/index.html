<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"><title>【SLAM】ubuntu 18.04 下 OpenCV 3.2.0 的 opencv_example 运行闪退 | 慕雪的寒舍</title><meta name="author" content="慕雪年华"><meta name="copyright" content="慕雪年华"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="ubuntu 18.04 下 OpenCV 3.2.0 的 opencv_example 运行闪退问题探究"><meta property="og:type" content="article"><meta property="og:title" content="【SLAM】ubuntu 18.04 下 OpenCV 3.2.0 的 opencv_example 运行闪退"><meta property="og:url" content="https://blog.musnow.top/posts/7683466939/index.html"><meta property="og:site_name" content="慕雪的寒舍"><meta property="og:description" content="ubuntu 18.04 下 OpenCV 3.2.0 的 opencv_example 运行闪退问题探究"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://img.musnow.top/i/2025/03/bb2a463bad129932f7cac49ca44d411d.png"><meta property="article:published_time" content="2025-03-01T04:59:29.000Z"><meta property="article:modified_time" content="2025-03-01T05:54:03.000Z"><meta property="article:author" content="慕雪年华"><meta property="article:tag" content="Linux"><meta property="article:tag" content="ubuntu"><meta property="article:tag" content="SLAM"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://img.musnow.top/i/2025/03/bb2a463bad129932f7cac49ca44d411d.png"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="https://blog.musnow.top/posts/7683466939/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"><meta name="google-site-verification" content="iR4A6ntiwhI9JX_YDe2ZFY6DerPD7c-NaLyIDlrDguY"><meta name="msvalidate.01" content="D5CD621F38EE3FB5071F785AD4977161"><meta name="baidu-site-verification" content="codeva-aZGKJiqRSI"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.19/fancybox/fancybox.min.css" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.json","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: {"limitDay":180,"position":"top","messagePrev":"距离上次更新本文已经过去了","messageNext":"天，文章部分内容可能已经过时，请注意甄别"},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":420},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":600,"languages":{"author":"作者: 慕雪年华","link":"链接: ","source":"来源: 慕雪的寒舍","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdnjs.cloudflare.com/ajax/libs/flickr-justified-gallery/2.1.2/fjGallery.min.js',
      css: 'https://cdnjs.cloudflare.com/ajax/libs/flickr-justified-gallery/2.1.2/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"【SLAM】ubuntu 18.04 下 OpenCV 3.2.0 的 opencv_example 运行闪退",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2025-03-01 13:54:03"}</script><noscript><style type="text/css">#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/equipment/equipment.css?1"><link rel="stylesheet" href="/rating/rating.css?1"><script>!function(r){"use strict";!function(){var t=window,s=document,e=r,c="".concat("https:"===s.location.protocol?"https://":"http://","sdk.51.la/js-sdk-pro.min.js"),i=s.createElement("script"),n=s.getElementsByTagName("script")[0];i.type="text/javascript",i.setAttribute("charset","UTF-8"),i.async=!0,i.src=c,i.id="LA_COLLECT",e.d=i;function o(){t.LA.ids.push(e)}t.LA?t.LA.ids&&o():(t.LA=r,t.LA.ids=[],o()),n.parentNode.insertBefore(i,n)}()}({id:"JwxEfuZ8fwQ1GPEq",ck:"JwxEfuZ8fwQ1GPEq"})</script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="慕雪的寒舍" type="application/atom+xml"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/favicon.jpg" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">431</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">73</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">21</div></a></div><hr class="custom-hr"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 归档</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 文章</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/rating/"><i class="fa-fw fas fa-film"></i><span> 书·影</span></a></div><div class="menus_item"><a class="site-page" href="/qa/"><i class="fa-fw fa-fw fas fa-comment-dots"></i><span> 留言</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-user-friends"></i><span> 友人</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li><li><a class="site-page child" href="/fcircle/"><i class="fa-fw fas fa-link"></i><span> 朋友圈</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://www.travellings.cn/go.html"><i class="fa-fw fas fa-train"></i><span> 开往</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://www.foreverblog.cn/go.html"><i class="fa-fw fab fa-superpowers"></i><span> 虫洞</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://travel.moe/go.html?travel=on"><i class="fa-fw fas fa-globe-americas"></i><span> 异次元</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-glass-whiskey"></i><span> 镜像</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="https://blog.musnow.top/?utm_source=mirror"><i class="fa-fw fas fa-home"></i><span> Main</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://blog1.musnow.top/?utm_source=mirror"><i class="fa-fw fa-brands fa-battle-net"></i><span> Netlify</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://musnows.github.io/?utm_source=mirror"><i class="fa-fw fa-brands fa-square-github"></i><span> Github</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://blog2.musnow.top/?utm_source=mirror"><i class="fa-fw fa-solid fa-square-caret-up"></i><span> Vercel</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://blog3.musnow.top/?utm_source=mirror"><i class="fa-fw fas fa-cloud"></i><span> Cloudflare</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://keep-hexo.musnow.top/?utm_source=mirror"><i class="fa-fw fa-brands fa-kickstarter"></i><span> KeepTheme</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://musnow.blog.csdn.net/"><i class="fa-fw fas fa-copyright"></i><span> CSDN</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://blog.51cto.com/u_15307009"><i class="fa-fw fas fa-dice-five"></i><span> 51CTO</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fab fa-blackberry"></i><span> 更多</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page child" href="/gallery/"><i class="fa-fw fas fa-images"></i><span> 画廊</span></a></li><li><a class="site-page child" href="/equipment/"><i class="fa-fw fas fa-laptop"></i><span> 背包</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://memos.musnow.top"><i class="fa-fw fas fa-map-signs"></i><span> 说说</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://stats.uptimerobot.com/qrNpVSLkgV"><i class="fa-fw fas fa-chart-bar"></i><span> Uptime</span></a></li><li><a class="site-page child" href="/atom.xml"><i class="fa-fw fas fa-rss-square"></i><span> RSS</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image:url(https://img.musnow.top/i/2025/03/bb2a463bad129932f7cac49ca44d411d.png)"><nav id="nav"><span id="blog-info"><a href="/" title="慕雪的寒舍"><img class="site-icon" src="/favicon.jpg"><span class="site-name">慕雪的寒舍</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 归档</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 文章</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/rating/"><i class="fa-fw fas fa-film"></i><span> 书·影</span></a></div><div class="menus_item"><a class="site-page" href="/qa/"><i class="fa-fw fa-fw fas fa-comment-dots"></i><span> 留言</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-user-friends"></i><span> 友人</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li><li><a class="site-page child" href="/fcircle/"><i class="fa-fw fas fa-link"></i><span> 朋友圈</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://www.travellings.cn/go.html"><i class="fa-fw fas fa-train"></i><span> 开往</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://www.foreverblog.cn/go.html"><i class="fa-fw fab fa-superpowers"></i><span> 虫洞</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://travel.moe/go.html?travel=on"><i class="fa-fw fas fa-globe-americas"></i><span> 异次元</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-glass-whiskey"></i><span> 镜像</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="https://blog.musnow.top/?utm_source=mirror"><i class="fa-fw fas fa-home"></i><span> Main</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://blog1.musnow.top/?utm_source=mirror"><i class="fa-fw fa-brands fa-battle-net"></i><span> Netlify</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://musnows.github.io/?utm_source=mirror"><i class="fa-fw fa-brands fa-square-github"></i><span> Github</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://blog2.musnow.top/?utm_source=mirror"><i class="fa-fw fa-solid fa-square-caret-up"></i><span> Vercel</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://blog3.musnow.top/?utm_source=mirror"><i class="fa-fw fas fa-cloud"></i><span> Cloudflare</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://keep-hexo.musnow.top/?utm_source=mirror"><i class="fa-fw fa-brands fa-kickstarter"></i><span> KeepTheme</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://musnow.blog.csdn.net/"><i class="fa-fw fas fa-copyright"></i><span> CSDN</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://blog.51cto.com/u_15307009"><i class="fa-fw fas fa-dice-five"></i><span> 51CTO</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fab fa-blackberry"></i><span> 更多</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page child" href="/gallery/"><i class="fa-fw fas fa-images"></i><span> 画廊</span></a></li><li><a class="site-page child" href="/equipment/"><i class="fa-fw fas fa-laptop"></i><span> 背包</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://memos.musnow.top"><i class="fa-fw fas fa-map-signs"></i><span> 说说</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://stats.uptimerobot.com/qrNpVSLkgV"><i class="fa-fw fas fa-chart-bar"></i><span> Uptime</span></a></li><li><a class="site-page child" href="/atom.xml"><i class="fa-fw fas fa-rss-square"></i><span> RSS</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">【SLAM】ubuntu 18.04 下 OpenCV 3.2.0 的 opencv_example 运行闪退</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-03-01T04:59:29.000Z" title="发表于 2025-03-01 12:59:29">2025-03-01</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-03-01T05:54:03.000Z" title="更新于 2025-03-01 13:54:03">2025-03-01</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%BC%96%E7%A8%8B%E5%AD%A6%E4%B9%A0/">编程学习</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%BC%96%E7%A8%8B%E5%AD%A6%E4%B9%A0/Linux/">Linux</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">2.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>11分钟</span></span><span class="post-meta-separator">|</span><span data-flag-title="【SLAM】ubuntu 18.04 下 OpenCV 3.2.0 的 opencv_example 运行闪退"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="ArtalkPV"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>ubuntu 18.04 下 OpenCV 3.2.0 的 opencv_example 运行闪退问题探究。</p><h2 id="1-问题说明"><a href="#1-问题说明" class="headerlink" title="1. 问题说明"></a>1. 问题说明</h2><p>在之前的<a href="https://blog.musnow.top/posts/5090585017/">ORB-SLAM3项目于ROS运行</a>的博客中，提到过安装ROS时会自己安装一个OpenCV 3.2.0版本，所以最好不要安装其他版本的OpenCV，避免和OpenCV 3.2.0产生冲突，导致ROS链接失败。</p><p>今天尝试在ubuntu18.04的虚拟机里面安装OpenCV 3.2.0时，先是遇到了<a href="https://blog.musnow.top/posts/8846864150/">CMake构建问题</a>，又遇到了OpenCV 3.2.0提供的demo代码无法正常运行的问题。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 编译demo文件并运行</span></span><br><span class="line"><span class="built_in">cd</span> opencv-3.2.0/samples/cpp/example_cmake</span><br><span class="line"><span class="built_in">mkdir</span> build &amp;&amp; <span class="built_in">cd</span> build </span><br><span class="line">cmake .. &amp;&amp; make</span><br><span class="line">./opencv_example</span><br></pre></td></tr></table></figure><p>出现的状况就是，当我执行<code>./opencv_example</code>的时候，<strong>程序没有任何反应就直接终止了</strong>。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">king@ubuntu:~/slam/pkg/opencv-3.2.0/samples/cpp/example_cmake/build$ ./opencv_example </span><br><span class="line">Built with OpenCV 3.2.0</span><br><span class="line">Capture is opened</span><br><span class="line">king@ubuntu:~/slam/pkg/opencv-3.2.0/samples/cpp/example_cmake/build$</span><br></pre></td></tr></table></figure><p>理论上执行<code>./opencv_example</code>的时候，应该弹出一个摄像头画面的窗口，且该窗口应一直存在。如下图所示</p><p><img src="/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2025/01/cf9ec531bb3ead1d358fb888106eeab2.png" alt="image.png"></p><p>所以，窗口没有弹出程序就终止了，肯定是有问题的。我们就要看看问题到底在哪里。</p><h2 id="2-问题探究"><a href="#2-问题探究" class="headerlink" title="2. 问题探究"></a>2. 问题探究</h2><h3 id="2-1-是否识别了摄像头设备"><a href="#2-1-是否识别了摄像头设备" class="headerlink" title="2.1. 是否识别了摄像头设备"></a>2.1. 是否识别了摄像头设备</h3><p>首先是确认我们的usb摄像头到底有没有连到主机上。因为我使用的是虚拟机，所以需要在VMware里面设置让摄像头连接到虚拟机上而不是连到宿主机上。</p><p>在VMware的顶栏上，选择<code>虚拟机-可移动设备</code>，在可移动设备的列表里面应该能看到你的USB摄像头。如果看不到，<strong>说明windows上都没认出来这个摄像头</strong>，请检查USB链接或确认摄像头自身是否损坏。</p><p>如下图所示，这里出现了我的USB Camera，且前面有一个勾勾代表摄像头已经练到了虚拟机上。如果没有连接到虚拟机而是宿主机上，这里的弹出菜单会显示“<strong>连接（断开与 主机 的链接）</strong>”，点击它即可让USB设备连接到虚拟机。</p><p><img src="/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2025/03/b132bc0c1281bd934b2c3a1f24993b1e.png" alt="image.png"></p><p>另外，如果你在虚拟机开启的情况下将摄像头插入电脑，VMware会主动弹窗咨询你新的usb设备是要插入到虚拟机还是宿主机。选择虚拟机即可。</p><p>现在VMware里面已经配置好了USB摄像头连到虚拟机，我们就可以进虚拟机内部检查一下是否有摄像头设备了。首先执行<code>ls /dev/video* -l</code>命令，可以看到有两个video设备。说明至少系统是认到了视频输入设备的。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">king@ubuntu:~$ ls /dev/video* -l</span><br><span class="line">crw-rw----+ 1 root video 81, 0 Feb 28 18:08 /dev/video0</span><br><span class="line">crw-rw----+ 1 root video 81, 1 Feb 28 18:08 /dev/video1</span><br></pre></td></tr></table></figure><p>随后安装一下<code>v4l-utils</code>软件包，它提供了一些摄像头相关的工具，可供我们检测当前主机上的摄像头设备。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install -y v4l-utils</span><br></pre></td></tr></table></figure><p>我们可以通过<code>v4l2-ctl -d /dev/video0 --all</code>命令查看某个设备的详细信息，这里可以看到<code>/dev/video0</code>就是我插入的USB摄像头，分辨率是<code>640*480</code>。说明linux系统已经成功识别了摄像头。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">king@ubuntu:~$ v4l2-ctl -d  /dev/video0 --all</span><br><span class="line">Driver Info (not using libv4l2):</span><br><span class="line">        Driver name   : uvcvideo</span><br><span class="line">        Card type     : USB Camera: USB Camera</span><br><span class="line">        Bus info      : usb-0000:02:03.0-1</span><br><span class="line">        Driver version: 5.4.233</span><br><span class="line">        Capabilities  : 0x84A00001</span><br><span class="line">                Video Capture</span><br><span class="line">                Metadata Capture</span><br><span class="line">                Streaming</span><br><span class="line">                Extended Pix Format</span><br><span class="line">                Device Capabilities</span><br><span class="line">        Device Caps   : 0x04200001</span><br><span class="line">                Video Capture</span><br><span class="line">                Streaming</span><br><span class="line">                Extended Pix Format</span><br><span class="line">Priority: 2</span><br><span class="line">Video input : 0 (Camera 1: ok)</span><br><span class="line">Format Video Capture:</span><br><span class="line">        Width/Height      : 640/480</span><br><span class="line">        Pixel Format      : &#x27;MJPG&#x27;</span><br><span class="line">        Field             : None</span><br><span class="line">        Bytes per Line    : 0</span><br><span class="line">        Size Image        : 614400</span><br><span class="line">        Colorspace        : sRGB</span><br><span class="line">        Transfer Function : Default (maps to sRGB)</span><br><span class="line">        YCbCr/HSV Encoding: Default (maps to ITU-R 601)</span><br><span class="line">        Quantization      : Default (maps to Full Range)</span><br><span class="line">        Flags             : </span><br><span class="line">Crop Capability Video Capture:</span><br><span class="line">        Bounds      : Left 0, Top 0, Width 640, Height 480</span><br><span class="line">        Default     : Left 0, Top 0, Width 640, Height 480</span><br><span class="line">        Pixel Aspect: 1/1</span><br><span class="line">Selection: crop_default, Left 0, Top 0, Width 640, Height 480</span><br><span class="line">Selection: crop_bounds, Left 0, Top 0, Width 640, Height 480</span><br><span class="line">Streaming Parameters Video Capture:</span><br><span class="line">        Capabilities     : timeperframe</span><br><span class="line">        Frames per second: 30.000 (30/1)</span><br><span class="line">        Read buffers     : 0</span><br><span class="line">                     brightness 0x00980900 (int)    : min=-64 max=64 step=1 default=0 value=0</span><br><span class="line">                       contrast 0x00980901 (int)    : min=0 max=95 step=1 default=34 value=34</span><br><span class="line">                     saturation 0x00980902 (int)    : min=0 max=100 step=1 default=56 value=56</span><br><span class="line">                            hue 0x00980903 (int)    : min=-2000 max=2000 step=100 default=0 value=0</span><br><span class="line"> white_balance_temperature_auto 0x0098090c (bool)   : default=1 value=1</span><br><span class="line">                          gamma 0x00980910 (int)    : min=100 max=300 step=1 default=120 value=120</span><br><span class="line">           power_line_frequency 0x00980918 (menu)   : min=0 max=2 default=1 value=1</span><br><span class="line">      white_balance_temperature 0x0098091a (int)    : min=2800 max=6500 step=1 default=4600 value=4600 flags=inactive</span><br><span class="line">                      sharpness 0x0098091b (int)    : min=0 max=7 step=1 default=0 value=0</span><br><span class="line">         backlight_compensation 0x0098091c (int)    : min=0 max=3 step=1 default=2 value=2</span><br><span class="line">                  exposure_auto 0x009a0901 (menu)   : min=0 max=3 default=3 value=3</span><br><span class="line">              exposure_absolute 0x009a0902 (int)    : min=78 max=10000 step=1 default=312 value=312 flags=inactive</span><br><span class="line">                 focus_absolute 0x009a090a (int)    : min=0 max=15 step=1 default=0 value=0 flags=inactive</span><br><span class="line">                     focus_auto 0x009a090c (bool)   : default=1 value=1</span><br></pre></td></tr></table></figure><h3 id="2-2-摄像头驱动问题？"><a href="#2-2-摄像头驱动问题？" class="headerlink" title="2.2. 摄像头驱动问题？"></a>2.2. 摄像头驱动问题？</h3><p>既然摄像头设备存在，则需要确认摄像头本身是否能被linux正常调用。</p><p>测试的方法很简单，下载ubuntu的cheese茄子软件（其实就是windows的相机软件），看看是否能正常打开摄像头。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install -y cheese</span><br></pre></td></tr></table></figure><p>安装完毕后，使用cheese命令即可打开摄像头。结果发现，弹窗是黑的。</p><p><img src="/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2025/03/757c04ae77f8590101503248edb539bb.png" alt="image.png"></p><p>这里我拔除了摄像头，可以看到cheese会显示“no device found”（找不到设备），这就说明，<strong>上图中黑屏的情况并不是正常情况</strong>。如果摄像头不存在，会直接提示我们找不到设备，而不会黑屏。</p><p><img src="/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2025/03/bb2a463bad129932f7cac49ca44d411d.png" alt="image.png"></p><p>结合之前的信息，可知我们现在linux系统已经识别到了USB摄像头，<strong>但没有办法调用它来拍照</strong>。</p><p>用<a target="_blank" rel="noopener" href="https://blog.csdn.net/flyingcys/article/details/57406701">ubuntu下摄像头启动与黑屏问题解决</a>博客里面的方式解决了，在VMware的虚拟机设置里面，把usb兼容性改成3.1就可以了（原本是usb2.0）。修改了之后vm会自动重置虚拟机。</p><p><img src="/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2025/03/15a4a260b11cca8f6281fb2a16572fb4.png" alt="image.png"></p><p>虚拟机重置了之后，重新连接一下usb摄像头到虚拟机就ok了。此时cheese已经能识别到我们的摄像头并拍摄画面了。</p><p><img src="/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2025/03/0ed00a1fdc06faa7e174e181a7f0aa27.png" alt="image.png"></p><p>到这里，说明摄像头能被linux成功识别并调用，摄像头本身并没有问题。</p><h3 id="2-3-opencv-example代码探究"><a href="#2-3-opencv-example代码探究" class="headerlink" title="2.3. opencv_example代码探究"></a>2.3. opencv_example代码探究</h3><p>既然摄像头本身没有问题，那问题就是在OpenCV3.2.0或者说是在示例代码上了。示例代码<code>samples/cpp/example_cmake/exmaple.cpp</code>的主体并不长，这里直接给出。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// opencv-3.2.0/samples/cpp/example_cmake/exmaple.cpp</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Built with OpenCV &quot;</span> &lt;&lt; CV_VERSION &lt;&lt; endl;</span><br><span class="line">    Mat image;</span><br><span class="line">    VideoCapture capture;</span><br><span class="line">    capture.<span class="built_in">open</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span>(capture.<span class="built_in">isOpened</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Capture is opened&quot;</span> &lt;&lt; endl;</span><br><span class="line">        <span class="keyword">for</span>(;;)</span><br><span class="line">        &#123;</span><br><span class="line">            capture &gt;&gt; image;</span><br><span class="line">            <span class="keyword">if</span>(image.<span class="built_in">empty</span>())</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="built_in">drawText</span>(image);</span><br><span class="line">            <span class="built_in">imshow</span>(<span class="string">&quot;Sample&quot;</span>, image);</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">waitKey</span>(<span class="number">10</span>) &gt;= <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;No capture&quot;</span> &lt;&lt; endl;</span><br><span class="line">        image = Mat::<span class="built_in">zeros</span>(<span class="number">480</span>, <span class="number">640</span>, CV_8UC1);</span><br><span class="line">        <span class="built_in">drawText</span>(image);</span><br><span class="line">        <span class="built_in">imshow</span>(<span class="string">&quot;Sample&quot;</span>, image);</span><br><span class="line">        <span class="built_in">waitKey</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>首先尝试将代码中的<code>capture.open(0)</code>改成<code>capture.open(&quot;/dev/video0&quot;);</code>，会发现问题依旧，启动之后未出现任何弹窗程序就终止了。</p><p>尝试将其改成<code>capture.open(1);</code>，可以看到这个设备是不存在的，open函数失败了并打印了错误信息，随后程序走到了<code>No capture</code>并正常显示了黑屏的Hello OpenCV页面。</p><p><img src="/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2025/03/5f012640fe78dcf0558ff11f052626e6.png" alt="image.png"></p><p>这里我发现了一个问题，其实在没有修改代码之前，程序已经打印了<code>Capture is opened</code>，说明摄像头其实已经被open成功了，进入了<code>if(capture.isOpened())</code>为真的分支中。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">king@ubuntu:~/slam/pkg/opencv-3.2.0/samples/cpp/example_cmake/build$ ./opencv_example </span><br><span class="line">Built with OpenCV 3.2.0</span><br><span class="line">Capture is opened</span><br><span class="line">king@ubuntu:~/slam/pkg/opencv-3.2.0/samples/cpp/example_cmake/build$</span><br></pre></td></tr></table></figure><p>那么我们就来看看这个分支里面有啥问题会导致程序没有任何报错就退出吧。其中<code>for(;;)</code>是一个死循环，退出条件是内部的两个break。程序没有任何报错就终止，只能是这两个break导致的。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(capture.<span class="built_in">isOpened</span>())</span><br><span class="line">&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Capture is opened&quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">for</span>(;;)</span><br><span class="line">	&#123;</span><br><span class="line">		capture &gt;&gt; image;</span><br><span class="line">		<span class="keyword">if</span>(image.<span class="built_in">empty</span>())</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="built_in">drawText</span>(image);</span><br><span class="line">		<span class="built_in">imshow</span>(<span class="string">&quot;Sample&quot;</span>, image);</span><br><span class="line">		<span class="keyword">if</span>(<span class="built_in">waitKey</span>(<span class="number">10</span>) &gt;= <span class="number">0</span>)</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>所以我们可以修改代码，给这两个break之前加上打印</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">cout &lt;&lt; <span class="string">&quot;Capture is opened&quot;</span> &lt;&lt; endl;</span><br><span class="line"><span class="keyword">for</span>(;;)</span><br><span class="line">&#123;</span><br><span class="line">	capture &gt;&gt; image;</span><br><span class="line">	<span class="keyword">if</span>(image.<span class="built_in">empty</span>())&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Image is empty! break.&quot;</span> &lt;&lt; endl; </span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">drawText</span>(image);</span><br><span class="line">	<span class="built_in">imshow</span>(<span class="string">&quot;Sample&quot;</span>, image);</span><br><span class="line">	<span class="keyword">if</span>(<span class="built_in">waitKey</span>(<span class="number">10</span>) &gt;= <span class="number">0</span>)&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;waitKey() &gt;= 0! break.&quot;</span> &lt;&lt; endl; </span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>再次运行，会发现是第二个break导致程序终止了。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">king@ubuntu:~/slam/pkg/opencv-3.2.0/samples/cpp/example_cmake/build$ ./opencv_example </span><br><span class="line">Built with OpenCV 3.2.0</span><br><span class="line">Capture is opened</span><br><span class="line">waitKey() &gt;= 0! break.</span><br><span class="line">king@ubuntu:~/slam/pkg/opencv-3.2.0/samples/cpp/example_cmake/build$</span><br></pre></td></tr></table></figure><p>那肯定是waitKey的返回值大于等于0命中了判断导致的。该函数的原型如下</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">cv::waitKey</span><span class="params">(<span class="type">int</span> delay = <span class="number">0</span>)</span></span></span><br></pre></td></tr></table></figure><p>这个函数是干啥用的呢？官方的说明如下：</p><blockquote><p>Waits for a pressed key.</p><p>The function waitKey waits for a key event infinitely (when delay &#x3D; 0) or for delay milliseconds, when it is positive. Since the OS has a minimum time between switching threads, the function will not wait exactly delay ms, it will wait at least delay ms, depending on what else is running on your computer at that time. It returns the code of the pressed key or -1 if no key was pressed before the specified time had elapsed.</p></blockquote><p>这个函数会至少等待delay毫秒的键盘输入，并返回键盘输入的ASCII值。当没有键盘被按下的时候，会返回<code>-1</code>。如果delay传入0则代表永久等待。</p><p>既然返回值是按键的ASCII码，我们可以打印一下这个函数的返回值，看看它收到了什么</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> key = <span class="built_in">waitKey</span>(<span class="number">10</span>);</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;waitKey() return: &quot;</span> &lt;&lt; key  &lt;&lt; endl; </span><br><span class="line"><span class="keyword">if</span>(key &gt;= <span class="number">0</span>)&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;waitKey() &gt;= 0! break.&quot;</span> &lt;&lt; endl; </span><br><span class="line">	<span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>打印的结果是255，<strong>但是ASCII码的最大值只到127</strong>，这里的255已经超出键盘上按键可能返回的值了，肯定是个无意义的返回值！</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">waitKey() return: 255</span><br><span class="line">waitKey() &gt;= 0! break.</span><br></pre></td></tr></table></figure><p>bing一搜，就找到了类似的帖子：<a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_47700906/article/details/123305720" title="opencv中waitkey()函数返回值为255_以下哪个选项是使用opencv的waitkey函数的返回值的正确描述?-CSDN博客">opencv中waitkey()函数返回值为255_以下哪个选项是使用opencv的waitkey函数的返回值的正确描述?-CSDN博客</a></p><p>说白了就是，因为操作系统缘故，原本在没有任何键盘输入时应该返回的<code>-1</code>函数，被当作了一字节的无符号整数处理，返回成了255。</p><h2 id="3-问题解决"><a href="#3-问题解决" class="headerlink" title="3. 问题解决"></a>3. 问题解决</h2><p>现在已经知道了问题的来源了，解决方案就是在判断中过滤掉255这个值，或者直接把判断写死成键盘上的某个按键，只有按下键盘上的特定按键的时候才会退出。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> key = <span class="built_in">waitKey</span>(<span class="number">10</span>);</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;waitKey() return: &quot;</span> &lt;&lt; key  &lt;&lt; endl; </span><br><span class="line"><span class="keyword">if</span>(key &gt;= <span class="number">0</span> &amp;&amp; key != <span class="number">255</span>)&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;waitKey() &gt;= 0! break.&quot;</span> &lt;&lt; endl; </span><br><span class="line">	<span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>过滤掉返回值255之后重新编译，demo就能正常显示摄像头的画面了。左侧可以看到waitKey一直在返回255。</p><p><img src="/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2025/03/d213fa5ceb5be1a4b3f4a31d3fcd8d50.png" alt="image.png"></p><p>此时按下键盘上的数字1，可以看到它识别到了ASCII 49并成功退出程序了。</p><p><img src="/img/loading.gif" data-lazy-src="https://img.musnow.top/i/2025/03/57e1cbf54baaa25b1a48d0ab4d9d6e79.png" alt="image.png"></p><h2 id="4-The-end"><a href="#4-The-end" class="headerlink" title="4. The end"></a>4. The end</h2><p>不管咋样，这个困扰了我大半个上午的问题总算是解决啦！</p><p>最开始我没想起来去看源码，以为一直是OpenCV没办法正常打开摄像头的问题，搜了一圈都没有找到解决方案。最后给代码加上了打印调试大法才找到了问题所在。感觉前面的折腾有点钻牛角尖了。</p></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://blog.musnow.top">慕雪年华</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://blog.musnow.top/posts/7683466939/">https://blog.musnow.top/posts/7683466939/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://blog.musnow.top" target="_blank">慕雪的寒舍</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Linux/">Linux</a><a class="post-meta__tags" href="/tags/ubuntu/">ubuntu</a><a class="post-meta__tags" href="/tags/SLAM/">SLAM</a></div><div class="post_share"><div class="social-share" data-image="https://img.musnow.top/i/2025/03/bb2a463bad129932f7cac49ca44d411d.png" data-sites="wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/butterfly-extsrc/1.1.3/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdnjs.cloudflare.com/ajax/libs/butterfly-extsrc/1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://ifdian.net/a/128ahri" target="_blank"><img class="post-qr-code-img" src="/img/ico/aifadian.png" alt="爱发电"></a><div class="post-qr-code-desc">爱发电</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/posts/8846864150/" title="【SLAM】ubuntu 18.04 编译安装 OpenCV 3.2.0 时出现哈希错误"><img class="cover" src="https://img.musnow.top/i/2025/03/b1f8fe34bacaef7b58b4a0481fca6296.png" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">【SLAM】ubuntu 18.04 编译安装 OpenCV 3.2.0 时出现哈希错误</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/posts/3771271576/" title="【SLAM】在 ubuntu 18.04 arm 容器中安装ROS环境"><img class="cover" src="https://img.musnow.top/i/2025/02/0fd67ca21e085e04f3ab28ed1c4f0b5d.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-02-09</div><div class="title">【SLAM】在 ubuntu 18.04 arm 容器中安装ROS环境</div></div></a></div><div><a href="/posts/4284761477/" title="【SLAM】OpenCV在arm64上提示找不到libjasper-dev"><img class="cover" src="/img/bg/gm5.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-01-30</div><div class="title">【SLAM】OpenCV在arm64上提示找不到libjasper-dev</div></div></a></div><div><a href="/posts/8846864150/" title="【SLAM】ubuntu 18.04 编译安装 OpenCV 3.2.0 时出现哈希错误"><img class="cover" src="https://img.musnow.top/i/2025/03/b1f8fe34bacaef7b58b4a0481fca6296.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-01</div><div class="title">【SLAM】ubuntu 18.04 编译安装 OpenCV 3.2.0 时出现哈希错误</div></div></a></div></div></div><hr class="custom-hr"><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="artalk-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/favicon.jpg" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info__name">慕雪年华</div><div class="author-info__description">爱折腾的代码初学者</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">431</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">73</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">21</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/musnows"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="mailto:muxue@musnow.top" target="_blank" title="email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://gitee.com/musnows" target="_blank" title="Gitee"><i class="fa-sharp fa-solid fa-g"></i></a><a class="social-icon" href="https://blog.csdn.net/muxuen" target="_blank" title="CSDN"><i class="fa-brands fa-blogger-b"></i></a><a class="social-icon" href="https://musnow.top/?utm_source=blog" target="_blank" title="个人主页"><i class="fas fa-globe-asia"></i></a><a class="social-icon" href="https://web.musnow.top/?utm_source=blog" target="_blank" title="导航站点"><i class="fas fa-server"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="RSS"><i class="fas fa-rss-square"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来到寒舍</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E9%97%AE%E9%A2%98%E8%AF%B4%E6%98%8E"><span class="toc-text">1. 问题说明</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E9%97%AE%E9%A2%98%E6%8E%A2%E7%A9%B6"><span class="toc-text">2. 问题探究</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E6%98%AF%E5%90%A6%E8%AF%86%E5%88%AB%E4%BA%86%E6%91%84%E5%83%8F%E5%A4%B4%E8%AE%BE%E5%A4%87"><span class="toc-text">2.1. 是否识别了摄像头设备</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E6%91%84%E5%83%8F%E5%A4%B4%E9%A9%B1%E5%8A%A8%E9%97%AE%E9%A2%98%EF%BC%9F"><span class="toc-text">2.2. 摄像头驱动问题？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-opencv-example%E4%BB%A3%E7%A0%81%E6%8E%A2%E7%A9%B6"><span class="toc-text">2.3. opencv_example代码探究</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3"><span class="toc-text">3. 问题解决</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-The-end"><span class="toc-text">4. The end</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/7683466939/" title="【SLAM】ubuntu 18.04 下 OpenCV 3.2.0 的 opencv_example 运行闪退">【SLAM】ubuntu 18.04 下 OpenCV 3.2.0 的 opencv_example 运行闪退</a><time datetime="2025-03-01T04:59:29.000Z" title="发表于 2025-03-01 12:59:29">2025-03-01</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/8846864150/" title="【SLAM】ubuntu 18.04 编译安装 OpenCV 3.2.0 时出现哈希错误">【SLAM】ubuntu 18.04 编译安装 OpenCV 3.2.0 时出现哈希错误</a><time datetime="2025-03-01T01:40:48.000Z" title="发表于 2025-03-01 09:40:48">2025-03-01</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/3862916255/" title="【Linux】ubuntu 22.04 通过 apt 安装 python2">【Linux】ubuntu 22.04 通过 apt 安装 python2</a><time datetime="2025-03-01T00:41:16.000Z" title="发表于 2025-03-01 08:41:16">2025-03-01</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/8855455861/" title="【Hexo】hexo-butterfly主题添加影评书评页面">【Hexo】hexo-butterfly主题添加影评书评页面</a><time datetime="2025-02-12T05:49:29.000Z" title="发表于 2025-02-12 13:49:29">2025-02-12</time></div></div></div></div></div></div></main><footer id="footer" style="background-image:url(/img/main/mothra.webp)"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2025 By 慕雪年华</div><div class="footer_custom_text"><img src="/img/ico/gonganbeian.png" height="15">&nbsp;<a href="https://beian.mps.gov.cn/#/query/webSearch?code=44190002007715" rel="noreferrer" target="_blank">粤公网安备44190002007715</a><br><a href="https://icp.gov.moe/?keyword=20230054" target="_blank"><img src="/img/badge/-%E8%90%8CICP%E5%A4%8720230054-ff69b4.svg" height="20px"></a>&nbsp<a href="/sitemap.xml" target="_blank"><img src="/img/badge/-SITEMAP-00CDCD.svg" height="20px"></a>&nbsp<a href="https://beian.miit.gov.cn/" target="_blank"><img src="/img/badge/%E7%B2%A4ICP%E5%A4%872023007189-red.svg" height="20px"></a><br><a href="https://travel.moe/go.html" target="_blank"><img src="/img/ico/moe-default-white.png" style="width:auto;height:25px" title="异次元之旅-跃迁-我们一起去萌站成员的星球旅行吧！"></a>&nbsp<a href="https://www.foreverblog.cn/go.html" target="_blank"><img src="/img/ico/wormhole_1_tp.gif" height="25px"></a>&nbsp<a href="https://www.travellings.cn/go.html" target="_blank"><img src="/img/ico/travelling_icon.gif" height="25px"></a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-butterfly/4.9.0/js/utils.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-butterfly/4.9.0/js/main.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.19/fancybox/fancybox.umd.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/17.8.3/lazyload.iife.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdnjs.cloudflare.com/ajax/libs/pangu/4.0.7/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (true){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script><script>(() => {
  const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaid.length === 0) return
  const runMermaid = () => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    Array.from($mermaid).forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
      const mermaidID = 'mermaid-' + index
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)

      const renderV10 = () => {
        renderFn.then(({svg}) => {
          mermaidSrc.insertAdjacentHTML('afterend', svg)
        })
      }

      const renderV9 = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      typeof renderFn === 'string' ? renderV9(renderFn) : renderV10()
    })
  }

  const loadMermaid = () => {
    window.loadMermaid ? runMermaid() : getScript('https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.2.2/mermaid.min.js').then(runMermaid)
  }

  btf.addModeChange('mermaid', runMermaid)

  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script><script>function loadArtalk () {
  function initArtalk () {
    window.artalkItem = new Artalk(Object.assign({
      el: '#artalk-wrap',
      server: 'https://artk.musnow.top',
      site: 'mublog',
      pageKey: location.pathname,
      darkMode: document.documentElement.getAttribute('data-theme') === 'dark',
      countEl: '.artalk-count'
    },null))

    if (GLOBAL_CONFIG.lightbox === 'null') return
    window.artalkItem.use(ctx => {
      ctx.on('list-loaded', () => {
        ctx.getCommentList().forEach(comment => {
          const $content = comment.getRender().$content
          btf.loadLightbox($content.querySelectorAll('img:not([atk-emoticon])'))
        })
      })
    })
  }

  if (typeof window.artalkItem === 'object') initArtalk()
  else {
    getCSS('https://cdnjs.cloudflare.com/ajax/libs/artalk/2.5.5/Artalk.min.css').then(()=>{
      getScript('https://cdnjs.cloudflare.com/ajax/libs/artalk/2.5.5/Artalk.min.js').then(initArtalk)
    })
  }
}

function artalkChangeMode (theme) {
  const artalkWrap = document.getElementById('artalk-wrap')
  if (!(artalkWrap && artalkWrap.children.length)) return
  const isDark = theme === 'dark'
  window.artalkItem.setDarkMode(isDark)
}

btf.addModeChange('artalk', artalkChangeMode)

if ('Artalk' === 'Artalk' || !false) {
  if (false) btf.loadComment(document.getElementById('artalk-wrap'), loadArtalk)
  else loadArtalk()
} else {
  function loadOtherComment () {
    loadArtalk()
  }
}</script></div><script src="/js/domain_check.js"></script><script id="click-heart" src="https://cdnjs.cloudflare.com/ajax/libs/butterfly-extsrc/1.1.3/click-heart.min.js" async mobile="false"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span> 数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div><hr><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-butterfly/4.9.0/js/search/local-search.min.js"></script></div></div></body></html>